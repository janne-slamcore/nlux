{"version":3,"file":"bedrock-react.js","sources":["../../../../packages/shared/src/utils/debug.ts","../../../../packages/shared/src/types/error.ts","../../../../packages/react/bedrock/src/hooks/getAdapterBuilder.ts","../../../../packages/react/bedrock/src/hooks/useChatAdapter.ts"],"sourcesContent":["export const debug = (...messages: unknown[]) => {\n    if (process.env.NLUX_DEBUG_ENABLED !== 'true') {\n        return;\n    }\n\n    for (const message of messages) {\n        if (typeof message === 'string') {\n            console.log(`[nlux] ${message}`);\n            continue;\n        }\n\n        if (message && typeof message.toString === 'function') {\n            console.log(`[nlux] ${message.toString()}`);\n            continue;\n        }\n\n        console.log('[nlux] Debug:');\n        console.log(JSON.stringify(message, null, 2));\n    }\n};\n","import {NLErrorId} from './exceptions/errors';\n\nexport type NluxRawError = {\n    readonly message?: string;\n    readonly type?: string;\n    readonly source?: string;\n    readonly exceptionId?: NLErrorId;\n};\n\nexport class NluxError extends Error {\n    readonly exceptionId?: NLErrorId;\n    readonly message: string;\n    readonly source?: string;\n    readonly type: string;\n\n    constructor(rawError: NluxRawError = {}) {\n        super(rawError.message);\n\n        this.message = rawError.message ?? '';\n        this.source = rawError.source;\n        this.type = this.constructor.name;\n        this.exceptionId = rawError.exceptionId;\n    }\n}\n\nexport class NluxUsageError extends NluxError {\n}\n\nexport class NluxValidationError extends NluxError {\n}\n\nexport class NluxRenderingError extends NluxError {\n}\n","import {ChatAdapterBuilder, ChatAdapterOptions, createChatAdapter} from '@nlux/bedrock';\nimport {NluxUsageError} from '@shared/types/error';\n\nconst source = 'hooks/getAdapterBuilder';\n\nexport const getAdapterBuilder = <AiMsg>(options: ChatAdapterOptions): ChatAdapterBuilder<AiMsg> => {\n    const {model, credentials, dataTransferMode} = options || {};\n\n    if (\n        dataTransferMode &&\n        dataTransferMode !== 'stream' &&\n        dataTransferMode !== 'batch'\n    ) {\n        throw new NluxUsageError({\n            source,\n            message:\n                'Data transfer mode for Hugging Face Inference API must be either \"stream\" or \"batch\"',\n        });\n    }\n\n    if (model === undefined) {\n        throw new NluxUsageError({\n            source,\n            message:\n                'You must provide either a model or an endpoint to use Hugging Face Inference API.',\n        });\n    }\n\n    let newAdapter = createChatAdapter<AiMsg>().withModel(model);\n\n    if (credentials !== undefined) {\n        newAdapter = newAdapter.withCredintial(credentials);\n    }\n\n    if (dataTransferMode !== undefined) {\n        newAdapter = newAdapter.withDataTransferMode(dataTransferMode);\n    }\n\n    return newAdapter;\n};\n","import {ChatAdapterOptions, StandardChatAdapter} from '@nlux/bedrock';\nimport {debug} from '@shared/utils/debug';\nimport {useEffect, useState} from 'react';\nimport {getAdapterBuilder} from './getAdapterBuilder';\n\nconst source = 'hooks/useChatAdapter';\n\nexport const useChatAdapter = <AiMsg = string>(options: ChatAdapterOptions): StandardChatAdapter<AiMsg> => {\n    if (!options.model) {\n        throw new Error(\n            'You must provide either a model or an endpoint to use Hugging Face Inference API.',\n        );\n    }\n\n    const [isInitialized, setIsInitialized] = useState(false);\n    const [adapter] = useState<StandardChatAdapter<AiMsg>>(\n        getAdapterBuilder<AiMsg>(options).create(),\n    );\n\n    const {dataTransferMode, model} = options || {};\n\n    useEffect(() => {\n        if (!isInitialized) {\n            setIsInitialized(true);\n            return;\n        }\n\n        debug({\n            source,\n            message:\n                'A new parameter has changed in useChatAdapter(). Adapter cannot be changed after ' +\n                'initialization and the new parameter will not be applied. Please re-initialize the adapter ' +\n                'with the new parameter. or user adapter methods to change the options and behaviour of ' +\n                'the adapter.',\n        });\n    }, [dataTransferMode, model]);\n\n    return adapter;\n};\n"],"names":["source","createChatAdapter","useState","useEffect"],"mappings":"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"}