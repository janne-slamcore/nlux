{"version":3,"file":"langchain-react.js","sources":["../../../../packages/react/langchain/src/hooks/getAdapterBuilder.ts","../../../../packages/react/langchain/src/hooks/useChatAdapter.ts"],"sourcesContent":["import {ChatAdapterBuilder, ChatAdapterOptions, createChatAdapter} from '@nlux/langchain';\n\nexport const getAdapterBuilder = <AiMsg>(options: ChatAdapterOptions<AiMsg>): ChatAdapterBuilder<AiMsg> => {\n    const {\n        url,\n        dataTransferMode,\n        headers,\n        config,\n        inputPreProcessor,\n        outputPreProcessor,\n        useInputSchema,\n    } = options || {};\n\n    if (dataTransferMode && dataTransferMode !== 'stream' && dataTransferMode !== 'batch') {\n        throw new Error(`Data transfer mode not supported`);\n    }\n\n    if (!url) {\n        throw new Error(`Runnable URL is required`);\n    }\n\n    let newAdapter = createChatAdapter<AiMsg>().withUrl(url);\n\n    if (dataTransferMode) {\n        newAdapter = newAdapter.withDataTransferMode(dataTransferMode);\n    }\n\n    if (headers) {\n        newAdapter = newAdapter.withHeaders(headers);\n    }\n\n    if (config) {\n        newAdapter = newAdapter.withConfig(config);\n    }\n\n    if (inputPreProcessor) {\n        newAdapter = newAdapter.withInputPreProcessor(inputPreProcessor);\n    }\n\n    if (outputPreProcessor) {\n        newAdapter = newAdapter.withOutputPreProcessor(outputPreProcessor);\n    }\n\n    if (useInputSchema !== undefined) {\n        newAdapter = newAdapter.withInputSchema(useInputSchema);\n    }\n\n    return newAdapter;\n};\n","import {ChatAdapterOptions, StandardChatAdapter} from '@nlux/langchain';\nimport {useDeepCompareEffect} from '@nlux/react';\nimport {useState} from 'react';\nimport {getAdapterBuilder} from './getAdapterBuilder';\n\nexport const useChatAdapter = <AiMsg = string>(\n    options: ChatAdapterOptions<AiMsg>,\n): StandardChatAdapter<AiMsg> => {\n    const [isInitialized, setIsInitialized] = useState(false);\n    const [adapter, setAdapter] = useState<\n        StandardChatAdapter<AiMsg>\n    >(\n        getAdapterBuilder<AiMsg>(options).create(),\n    );\n\n    const {\n        url,\n        dataTransferMode,\n        headers,\n        config,\n        inputPreProcessor,\n        outputPreProcessor,\n        useInputSchema,\n    } = options || {};\n\n    useDeepCompareEffect(() => {\n        if (!isInitialized) {\n            setIsInitialized(true);\n            return;\n        }\n\n        const newAdapter = getAdapterBuilder<AiMsg>(options).create();\n        setAdapter(newAdapter);\n    }, [\n        isInitialized,\n        url,\n        dataTransferMode,\n        headers || {},\n        config || {},\n        inputPreProcessor,\n        outputPreProcessor,\n        useInputSchema,\n    ]);\n\n    return adapter;\n};\n"],"names":["createChatAdapter","useState","useDeepCompareEffect"],"mappings":";;;;;;AAEO,MAAM,iBAAA,GAAoB,CAAQ,OAAA,KAAkE;AACvG,EAAA,MAAM;AAAA,IACF,GAAA;AAAA,IACA,gBAAA;AAAA,IACA,OAAA;AAAA,IACA,MAAA;AAAA,IACA,iBAAA;AAAA,IACA,kBAAA;AAAA,IACA;AAAA,GACJ,GAAI,WAAW,EAAC;AAEhB,EAAA,IAAI,gBAAA,IAAoB,gBAAA,KAAqB,QAAA,IAAY,gBAAA,KAAqB,OAAA,EAAS;AACnF,IAAA,MAAM,IAAI,MAAM,CAAA,gCAAA,CAAkC,CAAA;AAAA,EACtD;AAEA,EAAA,IAAI,CAAC,GAAA,EAAK;AACN,IAAA,MAAM,IAAI,MAAM,CAAA,wBAAA,CAA0B,CAAA;AAAA,EAC9C;AAEA,EAAA,IAAI,UAAA,GAAaA,2BAAA,EAAyB,CAAE,OAAA,CAAQ,GAAG,CAAA;AAEvD,EAAA,IAAI,gBAAA,EAAkB;AAClB,IAAA,UAAA,GAAa,UAAA,CAAW,qBAAqB,gBAAgB,CAAA;AAAA,EACjE;AAEA,EAAA,IAAI,OAAA,EAAS;AACT,IAAA,UAAA,GAAa,UAAA,CAAW,YAAY,OAAO,CAAA;AAAA,EAC/C;AAEA,EAAA,IAAI,MAAA,EAAQ;AACR,IAAA,UAAA,GAAa,UAAA,CAAW,WAAW,MAAM,CAAA;AAAA,EAC7C;AAEA,EAAA,IAAI,iBAAA,EAAmB;AACnB,IAAA,UAAA,GAAa,UAAA,CAAW,sBAAsB,iBAAiB,CAAA;AAAA,EACnE;AAEA,EAAA,IAAI,kBAAA,EAAoB;AACpB,IAAA,UAAA,GAAa,UAAA,CAAW,uBAAuB,kBAAkB,CAAA;AAAA,EACrE;AAEA,EAAA,IAAI,mBAAmB,MAAA,EAAW;AAC9B,IAAA,UAAA,GAAa,UAAA,CAAW,gBAAgB,cAAc,CAAA;AAAA,EAC1D;AAEA,EAAA,OAAO,UAAA;AACX,CAAA;;AC3CO,MAAM,cAAA,GAAiB,CAC1B,OAAA,KAC6B;AAC7B,EAAA,MAAM,CAAC,aAAA,EAAe,gBAAgB,CAAA,GAAIC,eAAS,KAAK,CAAA;AACxD,EAAA,MAAM,CAAC,OAAA,EAAS,UAAU,CAAA,GAAIA,cAAA;AAAA,IAG1B,iBAAA,CAAyB,OAAO,CAAA,CAAE,MAAA;AAAO,GAC7C;AAEA,EAAA,MAAM;AAAA,IACF,GAAA;AAAA,IACA,gBAAA;AAAA,IACA,OAAA;AAAA,IACA,MAAA;AAAA,IACA,iBAAA;AAAA,IACA,kBAAA;AAAA,IACA;AAAA,GACJ,GAAI,WAAW,EAAC;AAEhB,EAAAC,4BAAA,CAAqB,MAAM;AACvB,IAAA,IAAI,CAAC,aAAA,EAAe;AAChB,MAAA,gBAAA,CAAiB,IAAI,CAAA;AACrB,MAAA;AAAA,IACJ;AAEA,IAAA,MAAM,UAAA,GAAa,iBAAA,CAAyB,OAAO,CAAA,CAAE,MAAA,EAAO;AAC5D,IAAA,UAAA,CAAW,UAAU,CAAA;AAAA,EACzB,CAAA,EAAG;AAAA,IACC,aAAA;AAAA,IACA,GAAA;AAAA,IACA,gBAAA;AAAA,IACA,WAAW,EAAC;AAAA,IACZ,UAAU,EAAC;AAAA,IACX,iBAAA;AAAA,IACA,kBAAA;AAAA,IACA;AAAA,GACH,CAAA;AAED,EAAA,OAAO,OAAA;AACX;;;;;;;;"}