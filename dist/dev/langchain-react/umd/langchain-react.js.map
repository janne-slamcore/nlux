{"version":3,"file":"langchain-react.js","sources":["../../../../packages/react/langchain/src/hooks/getAdapterBuilder.ts","../../../../packages/react/langchain/src/hooks/useChatAdapter.ts"],"sourcesContent":["import {ChatAdapterBuilder, ChatAdapterOptions, createChatAdapter} from '@nlux/langchain';\n\nexport const getAdapterBuilder = <AiMsg>(options: ChatAdapterOptions<AiMsg>): ChatAdapterBuilder<AiMsg> => {\n    const {\n        url,\n        dataTransferMode,\n        headers,\n        config,\n        inputPreProcessor,\n        outputPreProcessor,\n        useInputSchema,\n    } = options || {};\n\n    if (dataTransferMode && dataTransferMode !== 'stream' && dataTransferMode !== 'batch') {\n        throw new Error(`Data transfer mode not supported`);\n    }\n\n    if (!url) {\n        throw new Error(`Runnable URL is required`);\n    }\n\n    let newAdapter = createChatAdapter<AiMsg>().withUrl(url);\n\n    if (dataTransferMode) {\n        newAdapter = newAdapter.withDataTransferMode(dataTransferMode);\n    }\n\n    if (headers) {\n        newAdapter = newAdapter.withHeaders(headers);\n    }\n\n    if (config) {\n        newAdapter = newAdapter.withConfig(config);\n    }\n\n    if (inputPreProcessor) {\n        newAdapter = newAdapter.withInputPreProcessor(inputPreProcessor);\n    }\n\n    if (outputPreProcessor) {\n        newAdapter = newAdapter.withOutputPreProcessor(outputPreProcessor);\n    }\n\n    if (useInputSchema !== undefined) {\n        newAdapter = newAdapter.withInputSchema(useInputSchema);\n    }\n\n    return newAdapter;\n};\n","import {ChatAdapterOptions, StandardChatAdapter} from '@nlux/langchain';\nimport {useDeepCompareEffect} from '@nlux/react';\nimport {useState} from 'react';\nimport {getAdapterBuilder} from './getAdapterBuilder';\n\nexport const useChatAdapter = <AiMsg = string>(\n    options: ChatAdapterOptions<AiMsg>,\n): StandardChatAdapter<AiMsg> => {\n    const [isInitialized, setIsInitialized] = useState(false);\n    const [adapter, setAdapter] = useState<\n        StandardChatAdapter<AiMsg>\n    >(\n        getAdapterBuilder<AiMsg>(options).create(),\n    );\n\n    const {\n        url,\n        dataTransferMode,\n        headers,\n        config,\n        inputPreProcessor,\n        outputPreProcessor,\n        useInputSchema,\n    } = options || {};\n\n    useDeepCompareEffect(() => {\n        if (!isInitialized) {\n            setIsInitialized(true);\n            return;\n        }\n\n        const newAdapter = getAdapterBuilder<AiMsg>(options).create();\n        setAdapter(newAdapter);\n    }, [\n        isInitialized,\n        url,\n        dataTransferMode,\n        headers || {},\n        config || {},\n        inputPreProcessor,\n        outputPreProcessor,\n        useInputSchema,\n    ]);\n\n    return adapter;\n};\n"],"names":["createChatAdapter","useState","useDeepCompareEffect"],"mappings":";;;;;;IAEO,MAAM,iBAAA,GAAoB,CAAQ,OAAA,KAAkE;IACvG,EAAA,MAAM;IAAA,IACF,GAAA;IAAA,IACA,gBAAA;IAAA,IACA,OAAA;IAAA,IACA,MAAA;IAAA,IACA,iBAAA;IAAA,IACA,kBAAA;IAAA,IACA;IAAA,GACJ,GAAI,WAAW,EAAC;IAEhB,EAAA,IAAI,gBAAA,IAAoB,gBAAA,KAAqB,QAAA,IAAY,gBAAA,KAAqB,OAAA,EAAS;IACnF,IAAA,MAAM,IAAI,MAAM,CAAA,gCAAA,CAAkC,CAAA;IAAA,EACtD;IAEA,EAAA,IAAI,CAAC,GAAA,EAAK;IACN,IAAA,MAAM,IAAI,MAAM,CAAA,wBAAA,CAA0B,CAAA;IAAA,EAC9C;IAEA,EAAA,IAAI,UAAA,GAAaA,2BAAA,EAAyB,CAAE,OAAA,CAAQ,GAAG,CAAA;IAEvD,EAAA,IAAI,gBAAA,EAAkB;IAClB,IAAA,UAAA,GAAa,UAAA,CAAW,qBAAqB,gBAAgB,CAAA;IAAA,EACjE;IAEA,EAAA,IAAI,OAAA,EAAS;IACT,IAAA,UAAA,GAAa,UAAA,CAAW,YAAY,OAAO,CAAA;IAAA,EAC/C;IAEA,EAAA,IAAI,MAAA,EAAQ;IACR,IAAA,UAAA,GAAa,UAAA,CAAW,WAAW,MAAM,CAAA;IAAA,EAC7C;IAEA,EAAA,IAAI,iBAAA,EAAmB;IACnB,IAAA,UAAA,GAAa,UAAA,CAAW,sBAAsB,iBAAiB,CAAA;IAAA,EACnE;IAEA,EAAA,IAAI,kBAAA,EAAoB;IACpB,IAAA,UAAA,GAAa,UAAA,CAAW,uBAAuB,kBAAkB,CAAA;IAAA,EACrE;IAEA,EAAA,IAAI,mBAAmB,MAAA,EAAW;IAC9B,IAAA,UAAA,GAAa,UAAA,CAAW,gBAAgB,cAAc,CAAA;IAAA,EAC1D;IAEA,EAAA,OAAO,UAAA;IACX,CAAA;;AC3CO,UAAM,cAAA,GAAiB,CAC1B,OAAA,KAC6B;IAC7B,EAAA,MAAM,CAAC,aAAA,EAAe,gBAAgB,CAAA,GAAIC,eAAS,KAAK,CAAA;IACxD,EAAA,MAAM,CAAC,OAAA,EAAS,UAAU,CAAA,GAAIA,cAAA;IAAA,IAG1B,iBAAA,CAAyB,OAAO,CAAA,CAAE,MAAA;IAAO,GAC7C;IAEA,EAAA,MAAM;IAAA,IACF,GAAA;IAAA,IACA,gBAAA;IAAA,IACA,OAAA;IAAA,IACA,MAAA;IAAA,IACA,iBAAA;IAAA,IACA,kBAAA;IAAA,IACA;IAAA,GACJ,GAAI,WAAW,EAAC;IAEhB,EAAAC,4BAAA,CAAqB,MAAM;IACvB,IAAA,IAAI,CAAC,aAAA,EAAe;IAChB,MAAA,gBAAA,CAAiB,IAAI,CAAA;IACrB,MAAA;IAAA,IACJ;IAEA,IAAA,MAAM,UAAA,GAAa,iBAAA,CAAyB,OAAO,CAAA,CAAE,MAAA,EAAO;IAC5D,IAAA,UAAA,CAAW,UAAU,CAAA;IAAA,EACzB,CAAA,EAAG;IAAA,IACC,aAAA;IAAA,IACA,GAAA;IAAA,IACA,gBAAA;IAAA,IACA,WAAW,EAAC;IAAA,IACZ,UAAU,EAAC;IAAA,IACX,iBAAA;IAAA,IACA,kBAAA;IAAA,IACA;IAAA,GACH,CAAA;IAED,EAAA,OAAO,OAAA;IACX;;;;;;;;;;;;"}