{"version":3,"file":"langchain.js","sources":["../../../../packages/shared/src/types/error.ts","../../../../packages/shared/src/utils/uid.ts","../../../../packages/shared/src/utils/warn.ts","../../../../packages/js/langchain/src/langserve/utils/getDataTransferModeFromEndpointType.ts","../../../../packages/js/langchain/src/langserve/utils/getEndpointTypeFromUrl.ts","../../../../packages/js/langchain/src/langserve/utils/getDataTransferModeToUse.ts","../../../../packages/js/langchain/src/langserve/utils/isUrlWithSupportedEndpoint.ts","../../../../packages/js/langchain/src/langserve/utils/getBaseUrlFromUrlOption.ts","../../../../packages/js/langchain/src/langserve/utils/getEndpointTypeToUse.ts","../../../../packages/js/langchain/src/langserve/utils/getEndpointUrlToUse.ts","../../../../packages/js/langchain/src/langserve/utils/getHeadersToUse.ts","../../../../packages/js/langchain/src/langserve/utils/getRunnableNameToUse.ts","../../../../packages/js/langchain/src/langserve/utils/getSchemaUrlToUse.ts","../../../../packages/js/langchain/src/langserve/utils/transformInputBasedOnSchema.ts","../../../../packages/js/langchain/src/langserve/adapter/adapter.ts","../../../../packages/js/langchain/src/langserve/adapter/batch.ts","../../../../packages/shared/src/utils/debug.ts","../../../../packages/js/langchain/src/langserve/parser/parseStreamedEvent.ts","../../../../packages/js/langchain/src/langserve/parser/parseChunk.ts","../../../../packages/js/langchain/src/langserve/utils/adapterErrorToExceptionId.ts","../../../../packages/js/langchain/src/langserve/adapter/stream.ts","../../../../packages/js/langchain/src/langserve/builder/builderImpl.ts","../../../../packages/js/langchain/src/langserve/builder/createChatAdapter.ts"],"sourcesContent":["import {NLErrorId} from './exceptions/errors';\n\nexport type NluxRawError = {\n    readonly message?: string;\n    readonly type?: string;\n    readonly source?: string;\n    readonly exceptionId?: NLErrorId;\n};\n\nexport class NluxError extends Error {\n    readonly exceptionId?: NLErrorId;\n    readonly message: string;\n    readonly source?: string;\n    readonly type: string;\n\n    constructor(rawError: NluxRawError = {}) {\n        super(rawError.message);\n\n        this.message = rawError.message ?? '';\n        this.source = rawError.source;\n        this.type = this.constructor.name;\n        this.exceptionId = rawError.exceptionId;\n    }\n}\n\nexport class NluxUsageError extends NluxError {\n}\n\nexport class NluxValidationError extends NluxError {\n}\n\nexport class NluxRenderingError extends NluxError {\n}\n","export const uid = () => {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (character) => {\n        const randomValue = Math.random() * 16 | 0;\n        const value = character == 'x' ? randomValue : (randomValue & 0x3 | 0x8);\n        return value.toString(16);\n    });\n};\n","export const warn = (message: unknown) => {\n    if (typeof message === 'string') {\n        console.warn(`[nlux] ${message}`);\n        return;\n    }\n\n    if (message && typeof message.toString === 'function') {\n        console.warn(`[nlux] ${message.toString()}`);\n        return;\n    }\n\n    console.warn('[nlux]');\n    console.log(JSON.stringify(message, null, 2));\n};\n\nconst warnedMessages: string[] = [];\nexport const warnOnce = (message: string) => {\n    if (warnedMessages.includes(message)) {\n        return;\n    }\n\n    warnedMessages.push(message);\n    warn(message);\n};\n","import {DataTransferMode} from '@nlux/core';\nimport {LangServeEndpointType} from '../types/langServe';\n\nexport const getDataTransferModeFromEndpointType = (\n    endpointAction: LangServeEndpointType,\n): DataTransferMode => {\n    if (endpointAction === 'stream') {\n        return 'stream';\n    }\n\n    return 'batch';\n};\n","import {LangServeEndpointType} from '../types/langServe';\n\nexport const getEndpointTypeFromUrl = (url: string): LangServeEndpointType | undefined => {\n    const regEx = /\\/.*\\/(invoke|stream)$/g;\n    const match = regEx.exec(url);\n    if (!match || match.length < 2) {\n        return undefined;\n    }\n\n    const extractedEndpoint = match[1];\n    if (extractedEndpoint === 'invoke' || extractedEndpoint === 'stream') {\n        return extractedEndpoint;\n    }\n\n    return undefined;\n};\n","import {DataTransferMode} from '@nlux/core';\nimport {warnOnce} from '@shared/utils/warn';\nimport {LangServeAbstractAdapter} from '../adapter/adapter';\nimport {ChatAdapterOptions} from '../types/adapterOptions';\nimport {getDataTransferModeFromEndpointType} from './getDataTransferModeFromEndpointType';\nimport {getEndpointTypeFromUrl} from './getEndpointTypeFromUrl';\n\nexport const getDataTransferModeToUse = <AiMsg>(adapterOptions: ChatAdapterOptions<AiMsg>): DataTransferMode => {\n    const runnableEndpointAction = getEndpointTypeFromUrl(\n        adapterOptions.url,\n    );\n\n    const dataTransferModeFromOptions = adapterOptions.dataTransferMode;\n    const dataTransferModeFromAction = runnableEndpointAction\n        ? getDataTransferModeFromEndpointType(runnableEndpointAction)\n        : undefined;\n\n    const dataTransferMode = dataTransferModeFromAction ?? (\n        adapterOptions.dataTransferMode ?? LangServeAbstractAdapter.defaultDataTransferMode\n    );\n\n    if (\n        dataTransferModeFromOptions\n        && dataTransferModeFromAction\n        && dataTransferModeFromOptions !== dataTransferModeFromAction\n    ) {\n        warnOnce(`The data transfer mode provided to LangServe adapter does not match the LangServe runnable ` +\n            `URL action. When you provide a runnable URL that ends with '/${runnableEndpointAction}', ` +\n            `the data transfer mode is automatically set to '${dataTransferModeFromAction}' and ` +\n            `the 'dataTransferMode' option should not be provided or should be set ` +\n            `to '${dataTransferModeFromAction}'`);\n    }\n\n    return dataTransferMode;\n};\n","export const isUrlWithSupportedEndpoint = (url: string) => {\n    const regEx = /\\/.*\\/(invoke|stream)$/g;\n    return regEx.test(url);\n};\n","import {ChatAdapterOptions} from '../types/adapterOptions';\nimport {isUrlWithSupportedEndpoint} from './isUrlWithSupportedEndpoint';\n\n/**\n * When the URL provided by the user does not end with /invoke or /stream we assume that the user has provided\n * the base URL. When the URL provided does end with /invoke or /stream, we assume that the user has provided the\n * endpoint URL, and we strip the endpoint type from it.\n *\n * Examples:\n *\n * For the URL: https://pynlux.api.nlkit.com/einbot/stream\n * The base URL is: https://pynlux.api.nlkit.com/einbot\n *\n * For the URL: https://pynlux.api.nlkit.com/einbot\n * The base URL is also: https://pynlux.api.nlkit.com/einbot\n * Since it does not end with /invoke or /stream.\n */\nexport const getBaseUrlFromUrlOption = <AnyAiMsg>(adapterOptions: ChatAdapterOptions<AnyAiMsg>): string => {\n    const urlOption = adapterOptions.url;\n    if (!isUrlWithSupportedEndpoint(urlOption)) {\n        return urlOption;\n    }\n\n    return urlOption.replace(/\\/(invoke|stream)$/g, '');\n};\n","import {ChatAdapterOptions} from '../types/adapterOptions';\nimport {LangServeEndpointType} from '../types/langServe';\nimport {getDataTransferModeToUse} from './getDataTransferModeToUse';\nimport {getEndpointTypeFromUrl} from './getEndpointTypeFromUrl';\n\nexport const getEndpointTypeToUse = <AiMsg>(\n    adapterOptions: ChatAdapterOptions<AiMsg>,\n): LangServeEndpointType => {\n    const urlFromOptions = adapterOptions.url;\n    const actionFromUrl = getEndpointTypeFromUrl(urlFromOptions);\n    if (actionFromUrl) {\n        return actionFromUrl;\n    }\n\n    const dataTransferMode = getDataTransferModeToUse(adapterOptions);\n    return dataTransferMode === 'batch' ? 'invoke' : 'stream';\n};\n","import {ChatAdapterOptions} from '../types/adapterOptions';\nimport {getBaseUrlFromUrlOption} from './getBaseUrlFromUrlOption';\nimport {getEndpointTypeToUse} from './getEndpointTypeToUse';\n\nexport const getEndpointUrlToUse = <AnyAiMsg>(\n    adapterOptions: ChatAdapterOptions<AnyAiMsg>,\n): string => {\n    const baseUrl = getBaseUrlFromUrlOption(adapterOptions).replace(/\\/$/, '');\n    const endpointType = getEndpointTypeToUse(adapterOptions);\n    return `${baseUrl}/${endpointType}`;\n};\n","import {ChatAdapterOptions} from '../types/adapterOptions';\nimport {LangServeHeaders} from '../types/langServe';\n\nexport const getHeadersToUse = <AnyAiMsg>(\n    adapterOptions: ChatAdapterOptions<AnyAiMsg>,\n): LangServeHeaders => {\n    return adapterOptions.headers || {};\n};","import {ChatAdapterOptions} from '../types/adapterOptions';\nimport {getBaseUrlFromUrlOption} from './getBaseUrlFromUrlOption';\n\nexport const getRunnableNameToUse = <AnyAiMsg>(adapterOptions: ChatAdapterOptions<AnyAiMsg>): string => {\n    const baseUrl = getBaseUrlFromUrlOption(adapterOptions).replace(/\\/$/, '');\n    const runnableName = baseUrl.split('/').pop();\n    return runnableName || 'langserve-runnable';\n};\n","import {ChatAdapterOptions} from '../types/adapterOptions';\nimport {getBaseUrlFromUrlOption} from './getBaseUrlFromUrlOption';\n\nexport const getSchemaUrlToUse = <AnyAiMsg>(\n    adapterOptions: ChatAdapterOptions<AnyAiMsg>,\n    type: 'input' | 'output',\n): string => {\n    const baseUrl = getBaseUrlFromUrlOption(adapterOptions).replace(/\\/$/, '');\n    if (type === 'input') {\n        return `${baseUrl}/input_schema`;\n    }\n\n    return `${baseUrl}/output_schema`;\n};\n","import {ChatItem} from '@nlux/core';\nimport {warn} from '@shared/utils/warn';\n\nexport const transformInputBasedOnSchema = <AiMsg>(\n    message: string,\n    conversationHistory: ChatItem<AiMsg>[] | undefined,\n    schema: unknown,\n    runnableName: string,\n): unknown | undefined => {\n    // TODO - Attempt to include conversation history in the input\n    //   if the schema allows it.\n\n    const typedSchema = schema as Record<string, unknown> | undefined;\n    if (!typedSchema || typeof typedSchema.properties !== 'object') {\n        return message;\n    }\n\n    if (typeof typedSchema !== 'object' || !typedSchema) {\n        warn(\n            `LangServer adapter cannot process the input schema fetched for runnable \"${runnableName}\". ` +\n            'The user message will be sent to LangServe endpoint as is without transformations. ' +\n            `To override this behavior, you can either set the \"useInputSchema\" option to false, ` +\n            `or provide a custom input pre-processor via the \"inputPreProcessor\" option, ` +\n            `or update your endpoint and input schema to have an object with a single ` +\n            `string property or a string as input.`,\n        );\n\n        return message;\n    }\n\n    if (typedSchema.type === 'string') {\n        return message;\n    }\n\n    if (typedSchema.type === 'object') {\n        const properties: Record<string, unknown> = (\n            typeof typedSchema.properties === 'object' && typedSchema.properties\n        )\n            ? typedSchema.properties as Record<string, unknown>\n            : {};\n\n        const schemaStringProps = Object\n            .keys(properties)\n            .filter((key) => key && typeof (properties[key] as Record<string, unknown>).type === 'string')\n            .map((key) => key);\n\n        if (schemaStringProps.length !== 1) {\n            warn(\n                `LangServer adapter cannot find a valid property to match to user input inside ` +\n                'the \"${runnableName}\" input schema. The user message will be sent to LangServe endpoint as ' +\n                `is without transformations. To override this behavior, you can either set the \"useInputSchema\" ` +\n                `option to false, or provide a custom input pre-processor via the \"inputPreProcessor\" option, ` +\n                `or update your endpoint and input schema to have an object with a single ` +\n                `string property or a string accepted as part of input schema.`,\n            );\n        } else {\n            const propToUse = schemaStringProps[0];\n            return ({\n                [propToUse]: message,\n            });\n        }\n    }\n\n    return undefined;\n};\n","import {\n    ChatAdapterExtras,\n    ChatItem,\n    DataTransferMode,\n    StandardAdapterInfo,\n    StandardChatAdapter,\n    StreamingAdapterObserver,\n} from '@nlux/core';\nimport {uid} from '@shared/utils/uid';\nimport {warn} from '@shared/utils/warn';\nimport {ChatAdapterOptions} from '../types/adapterOptions';\nimport {LangServeInputPreProcessor} from '../types/inputPreProcessor';\nimport {LangServeConfig, LangServeHeaders} from '../types/langServe';\nimport {LangServeOutputPreProcessor} from '../types/outputPreProcessor';\nimport {getDataTransferModeToUse} from '../utils/getDataTransferModeToUse';\nimport {getEndpointUrlToUse} from '../utils/getEndpointUrlToUse';\nimport {getHeadersToUse} from '../utils/getHeadersToUse';\nimport {getRunnableNameToUse} from '../utils/getRunnableNameToUse';\nimport {getSchemaUrlToUse} from '../utils/getSchemaUrlToUse';\nimport {transformInputBasedOnSchema} from '../utils/transformInputBasedOnSchema';\n\nexport abstract class LangServeAbstractAdapter<AiMsg> implements StandardChatAdapter<AiMsg> {\n    static defaultDataTransferMode: DataTransferMode = 'stream';\n\n    private readonly __instanceId: string;\n    private readonly __options: ChatAdapterOptions<AiMsg>;\n\n    private readonly theDataTransferModeToUse: DataTransferMode;\n    private readonly theEndpointUrlToUse: string;\n    private readonly theHeadersToUse: LangServeHeaders;\n    private theInputSchemaToUse: object | undefined;\n    private readonly theInputSchemaUrlToUse: string;\n    private readonly theRunnableNameToUse: string;\n    private readonly theUseInputSchemaOptionToUse: boolean;\n\n    protected constructor(options: ChatAdapterOptions<AiMsg>) {\n        this.__instanceId = `${this.info.id}-${uid()}`;\n        this.__options = {...options};\n\n        this.theDataTransferModeToUse = getDataTransferModeToUse(options);\n        this.theHeadersToUse = getHeadersToUse(options);\n        this.theUseInputSchemaOptionToUse = (typeof options.useInputSchema === 'boolean')\n            ? options.useInputSchema\n            : true;\n\n        this.theEndpointUrlToUse = getEndpointUrlToUse(options);\n        this.theRunnableNameToUse = getRunnableNameToUse(options);\n        this.theInputSchemaUrlToUse = getSchemaUrlToUse(options, 'input');\n\n        this.init();\n    }\n\n    get dataTransferMode(): DataTransferMode {\n        return this.theDataTransferModeToUse;\n    }\n\n    get endpointUrl(): string {\n        return this.theEndpointUrlToUse;\n    }\n\n    get headers(): LangServeHeaders {\n        return this.theHeadersToUse;\n    }\n\n    get id(): string {\n        return this.__instanceId;\n    }\n\n    get info(): StandardAdapterInfo {\n        return {\n            id: 'langserve-adapter',\n            capabilities: {\n                chat: true,\n                fileUpload: false,\n                textToSpeech: false,\n                speechToText: false,\n            },\n        };\n    }\n\n    get inputPreProcessor(): LangServeInputPreProcessor<AiMsg> | undefined {\n        return this.__options.inputPreProcessor;\n    }\n\n    get inputSchema(): Readonly<object> | undefined {\n        return this.theInputSchemaToUse;\n    }\n\n    get outputPreProcessor(): LangServeOutputPreProcessor<AiMsg> | undefined {\n        return this.__options.outputPreProcessor;\n    }\n\n    get runnableName(): string {\n        return this.theRunnableNameToUse;\n    }\n\n    get useInputSchema(): boolean {\n        return this.theUseInputSchemaOptionToUse;\n    }\n\n    protected get config(): LangServeConfig | undefined {\n        return this.__options.config;\n    }\n\n    private get inputSchemaUrl(): string {\n        return this.theInputSchemaUrlToUse;\n    }\n\n    abstract batchText(message: string, extras: ChatAdapterExtras<AiMsg>): Promise<string | object | undefined>;\n\n    async fetchSchema(url: string): Promise<object | undefined> {\n        try {\n            const response = await fetch(url);\n            const result = await response.json();\n            if (typeof result !== 'object' || !result) {\n                warn(`LangServe adapter is unable process schema loaded from: ${url}`);\n                return undefined;\n            }\n\n            return result;\n        } catch (_error) {\n            warn(`LangServe adapter is unable to fetch schema from: ${url}`);\n            return undefined;\n        }\n    }\n\n    init() {\n        if (this.useInputSchema) {\n            this.fetchSchema(this.inputSchemaUrl).then((schema) => {\n                this.theInputSchemaToUse = schema;\n            });\n        }\n    }\n\n    preProcessAiBatchedMessage(\n        message: string | object | undefined,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): AiMsg | undefined {\n        if (this.outputPreProcessor) {\n            return this.outputPreProcessor(message);\n        }\n\n        if (typeof message === 'string') {\n            return message as AiMsg;\n        }\n\n        const content = (message as Record<string, unknown>)?.content;\n        if (typeof content === 'string') {\n            return content as AiMsg;\n        }\n\n        warn(\n            'LangServe adapter is unable to process the response from the runnable. Returning empty string. ' +\n            'You may want to implement an output pre-processor to handle custom responses.',\n        );\n\n        return undefined;\n    }\n\n    preProcessAiStreamedChunk(\n        chunk: string | object | undefined,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): AiMsg | undefined {\n        if (this.outputPreProcessor) {\n            return this.outputPreProcessor(chunk);\n        }\n\n        if (typeof chunk === 'string') {\n            return chunk as AiMsg;\n        }\n\n        const content = (chunk as Record<string, unknown>)?.content;\n        if (typeof content === 'string') {\n            return content as AiMsg;\n        }\n\n        warn(\n            'LangServe adapter is unable to process the chunk from the runnable. Returning empty string. ' +\n            'You may want to implement an output pre-processor to handle chunks of custom responses.',\n        );\n\n        return undefined;\n    }\n\n    abstract streamText(\n        message: string,\n        observer: StreamingAdapterObserver<string | object | undefined>,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): void;\n\n    protected getRequestBody(\n        message: string,\n        config?: Record<string, unknown>,\n        conversationHistory?: ChatItem<AiMsg>[],\n    ): string {\n        if (this.inputPreProcessor) {\n            const preProcessedInput = this.inputPreProcessor(message, conversationHistory);\n            return JSON.stringify({\n                input: preProcessedInput,\n                config,\n            });\n        }\n\n        if (this.inputSchema) {\n            const body = transformInputBasedOnSchema(message, conversationHistory, this.inputSchema, this.runnableName);\n            if (typeof body !== 'undefined') {\n                return JSON.stringify({\n                    input: body,\n                    config,\n                });\n            }\n        }\n\n        // By default, we send the message as is\n        return JSON.stringify({\n            input: message,\n            config,\n        });\n    }\n}\n","import {ChatAdapterExtras, StreamingAdapterObserver} from '@nlux/core';\nimport {NluxUsageError} from '@shared/types/error';\nimport {ChatAdapterOptions} from '../types/adapterOptions';\nimport {LangServeAbstractAdapter} from './adapter';\n\nexport class LangServeBatchAdapter<AiMsg = string> extends LangServeAbstractAdapter<AiMsg> {\n    constructor(options: ChatAdapterOptions<AiMsg>) {\n        super(options);\n    }\n\n    async batchText(message: string, extras: ChatAdapterExtras<AiMsg>): Promise<string | object | undefined> {\n        const body = this.getRequestBody(\n            message,\n            this.config,\n            extras.conversationHistory,\n        );\n\n        const response = await fetch(this.endpointUrl, {\n            method: 'POST',\n            headers: {\n                ...this.headers,\n                'Content-Type': 'application/json',\n            },\n            body,\n        });\n\n        if (!response.ok) {\n            throw new Error(`LangServe runnable returned status code: ${response.status}`);\n        }\n\n        const result = await response.json();\n        if (typeof result !== 'object' || !result || result.output === undefined) {\n            throw new Error(\n                'Invalid response from LangServe runnable: Response is not an object ' +\n                'or does not contain an \"output\" property',\n            );\n        }\n\n        return (typeof result === 'object' && result) ? result.output : undefined;\n    }\n\n    streamText(message: string, observer: StreamingAdapterObserver, extras: ChatAdapterExtras<AiMsg>): void {\n        throw new NluxUsageError({\n            source: this.constructor.name,\n            message: 'Cannot stream text from the batch adapter!',\n        });\n    }\n}\n","export const debug = (...messages: unknown[]) => {\n    if (process.env.NLUX_DEBUG_ENABLED !== 'true') {\n        return;\n    }\n\n    for (const message of messages) {\n        if (typeof message === 'string') {\n            console.log(`[nlux] ${message}`);\n            continue;\n        }\n\n        if (message && typeof message.toString === 'function') {\n            console.log(`[nlux] ${message.toString()}`);\n            continue;\n        }\n\n        console.log('[nlux] Debug:');\n        console.log(JSON.stringify(message, null, 2));\n    }\n};\n","import {debug} from '@shared/utils/debug';\nimport {warn} from '@shared/utils/warn';\n\nexport const parseStreamedEvent = (event: string): {\n    event: 'data' | 'end';\n    data: unknown;\n} | undefined => {\n    const regEx = /^event:\\s+(?<event>[\\w]+)((\\r?)\\n(\\r?)data: (?<data>(.|\\n)*))?/gm;\n    const match = regEx.exec(event);\n    if (!match) {\n        return undefined;\n    }\n\n    const {event: eventName, data: rawData} = match.groups || {};\n    if (!eventName) {\n        return undefined;\n    }\n\n    if (eventName !== 'data' && eventName !== 'end') {\n        debug(`LangServe stream adapter received unsupported event \"${eventName}\"`);\n        return undefined;\n    }\n\n    try {\n        const data = rawData ? JSON.parse(rawData) : undefined;\n        return {event: eventName, data};\n    } catch (_error) {\n        warn(`LangServe stream adapter failed to parse data for chunk event \"${eventName}\" | Data: ${rawData}`);\n        return {event: eventName, data: undefined};\n    }\n};\n","import {parseStreamedEvent} from './parseStreamedEvent';\n\nexport const parseChunk = (chunk: string): Array<{\n    event: 'data' | 'end';\n    data: unknown;\n}> | Error => {\n    if (!chunk) {\n        return [];\n    }\n\n    // Extract the line that contains the event name\n    const regEx = /(((?<=^)|(?<=\\n))event:\\s+(\\w+))/g;\n    const eventStartPositions: number[] = [];\n    let match = regEx.exec(chunk);\n    while (match) {\n        eventStartPositions.push(match.index);\n        match = regEx.exec(chunk);\n    }\n\n    const extractEvent = (startPosition: number, index: number) => {\n        const endPosition = eventStartPositions[index + 1] || chunk.length;\n        return chunk.substring(startPosition, endPosition);\n    };\n\n    try {\n        return eventStartPositions\n            .map(extractEvent)\n            .map(parseStreamedEvent)\n            .filter(event => event !== undefined)\n            .map(event => event!);\n    } catch (_error) {\n        if (_error instanceof Error) {\n            return _error;\n        }\n\n        // When no error is thrown, we return empty result\n        return [];\n    }\n};\n","import {NLErrorId} from '@shared/types/exceptions/errors';\n\nexport const adapterErrorToExceptionId = (error: unknown): NLErrorId | null => {\n    if (typeof error === 'object' && error !== null) {\n        const errorAsObject = error as Record<string, unknown>;\n        if (\n            errorAsObject.message && typeof errorAsObject.message === 'string' &&\n            errorAsObject.message.toLowerCase().includes('connection error')\n        ) {\n            return 'connection-error';\n        }\n    }\n\n    return null;\n};\n","import {ChatAdapterExtras, StreamingAdapterObserver} from '@nlux/core';\nimport {NluxError, NluxUsageError} from '@shared/types/error';\nimport {warn} from '@shared/utils/warn';\nimport {parseChunk} from '../parser/parseChunk';\nimport {ChatAdapterOptions} from '../types/adapterOptions';\nimport {adapterErrorToExceptionId} from '../utils/adapterErrorToExceptionId';\nimport {LangServeAbstractAdapter} from './adapter';\n\nexport class LangServeStreamAdapter<AiMsg> extends LangServeAbstractAdapter<AiMsg> {\n    constructor(options: ChatAdapterOptions<AiMsg>) {\n        super(options);\n    }\n\n    async batchText(message: string, extras: ChatAdapterExtras<AiMsg>): Promise<string | object | undefined> {\n        throw new NluxUsageError({\n            source: this.constructor.name,\n            message: 'Cannot fetch text using the stream adapter!',\n        });\n    }\n\n    streamText(\n        message: string,\n        observer: StreamingAdapterObserver<string | object | undefined>,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): void {\n        const body = this.getRequestBody(\n            message,\n            this.config,\n            extras.conversationHistory,\n        );\n\n        fetch(this.endpointUrl, {\n            method: 'POST',\n            headers: {\n                ...this.headers,\n                'Content-Type': 'application/json',\n            },\n            body,\n        })\n            .then(async (response) => {\n                if (!response.ok) {\n                    throw new NluxError({\n                        source: this.constructor.name,\n                        message: `LangServe runnable returned status code: ${response.status}`,\n                    });\n                }\n\n                if (!response.body) {\n                    throw new NluxError({\n                        source: this.constructor.name,\n                        message: `LangServe runnable returned status code: ${response.status}`,\n                    });\n                }\n\n                // Read a stream of server-sent events\n                // and feed them to the observer as they are being generated\n                const reader = response.body.getReader();\n                const textDecoder = new TextDecoder();\n                let doneReading = false;\n\n                while (!doneReading) {\n                    const {value, done} = await reader.read();\n                    if (done) {\n                        doneReading = true;\n                        break;\n                    }\n\n                    const chunk = textDecoder.decode(value);\n                    const chunkContent = parseChunk(chunk);\n                    if (Array.isArray(chunkContent)) {\n                        for (const aiEvent of chunkContent) {\n                            if (aiEvent.event === 'data' && aiEvent.data !== undefined) {\n                                observer.next(aiEvent.data as string | object | undefined);\n                            }\n\n                            if (aiEvent.event === 'end') {\n                                observer.complete();\n                                doneReading = true;\n                                break;\n                            }\n                        }\n                    }\n\n                    if (chunkContent instanceof Error) {\n                        warn(chunkContent);\n                        observer.error(chunkContent);\n                        doneReading = true;\n                    }\n                }\n            })\n            .catch((error) => {\n                warn(error);\n                observer.error(new NluxUsageError({\n                    source: this.constructor.name,\n                    message: error.message,\n                    exceptionId: adapterErrorToExceptionId(error) ?? undefined,\n                }));\n            });\n    }\n}\n","import {DataTransferMode} from '@nlux/core';\nimport {NluxUsageError} from '@shared/types/error';\nimport {LangServeAbstractAdapter} from '../adapter/adapter';\nimport {LangServeBatchAdapter} from '../adapter/batch';\nimport {LangServeStreamAdapter} from '../adapter/stream';\nimport {ChatAdapterOptions} from '../types/adapterOptions';\nimport {LangServeInputPreProcessor} from '../types/inputPreProcessor';\nimport {LangServeConfig, LangServeHeaders} from '../types/langServe';\nimport {LangServeOutputPreProcessor} from '../types/outputPreProcessor';\nimport {getDataTransferModeToUse} from '../utils/getDataTransferModeToUse';\nimport {ChatAdapterBuilder} from './builder';\n\nexport class LangServeAdapterBuilderImpl<AiMsg> implements ChatAdapterBuilder<AiMsg> {\n    private theConfig?: LangServeConfig;\n    private theDataTransferMode?: DataTransferMode;\n    private theHeaders?: LangServeHeaders;\n    private theInputPreProcessor?: LangServeInputPreProcessor<AiMsg>;\n    private theOutputPreProcessor?: LangServeOutputPreProcessor<AiMsg>;\n    private theUrl?: string;\n    private theUseInputSchema?: boolean;\n\n    constructor(cloneFrom?: LangServeAdapterBuilderImpl<AiMsg>) {\n        if (cloneFrom) {\n            this.theDataTransferMode = cloneFrom.theDataTransferMode;\n            this.theHeaders = cloneFrom.theHeaders;\n            this.theConfig = cloneFrom.theConfig;\n            this.theInputPreProcessor = cloneFrom.theInputPreProcessor;\n            this.theOutputPreProcessor = cloneFrom.theOutputPreProcessor;\n            this.theUrl = cloneFrom.theUrl;\n        }\n    }\n\n    create(): LangServeAbstractAdapter<AiMsg> {\n        if (!this.theUrl) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to create LangServe adapter. URL is missing. ' +\n                    'Make sure you are calling withUrl() before calling create().',\n            });\n        }\n\n        const options: ChatAdapterOptions<AiMsg> = {\n            url: this.theUrl,\n            dataTransferMode: this.theDataTransferMode,\n            headers: this.theHeaders,\n            config: this.theConfig,\n            inputPreProcessor: this.theInputPreProcessor,\n            outputPreProcessor: this.theOutputPreProcessor,\n            useInputSchema: this.theUseInputSchema,\n        };\n\n        const dataTransferModeToUse = getDataTransferModeToUse(options);\n        if (dataTransferModeToUse === 'stream') {\n            return new LangServeStreamAdapter<AiMsg>(options);\n        }\n\n        return new LangServeBatchAdapter(options);\n    }\n\n    withConfig(langServeConfig: LangServeConfig): ChatAdapterBuilder<AiMsg> {\n        if (this.theConfig !== undefined) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Cannot set the config option more than once',\n            });\n        }\n\n        this.theConfig = langServeConfig;\n        return this;\n    }\n\n    withDataTransferMode(mode: DataTransferMode): LangServeAdapterBuilderImpl<AiMsg> {\n        if (this.theDataTransferMode !== undefined) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Cannot set the data loading mode more than once',\n            });\n        }\n\n        this.theDataTransferMode = mode;\n        return this;\n    }\n\n    withHeaders(headers: LangServeHeaders): ChatAdapterBuilder<AiMsg> {\n        if (this.theHeaders !== undefined) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Cannot set the headers option more than once',\n            });\n        }\n\n        this.theHeaders = headers;\n        return this;\n    }\n\n    withInputPreProcessor(inputPreProcessor: LangServeInputPreProcessor<AiMsg>): ChatAdapterBuilder<AiMsg> {\n        if (this.theInputPreProcessor !== undefined) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Cannot set the input pre-processor option more than once',\n            });\n        }\n\n        this.theInputPreProcessor = inputPreProcessor;\n        return this;\n    }\n\n    withInputSchema(useInputSchema: boolean): ChatAdapterBuilder<AiMsg> {\n        if (this.theUseInputSchema !== undefined) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Cannot set the input schema option more than once',\n            });\n        }\n\n        this.theUseInputSchema = useInputSchema;\n        return this;\n    }\n\n    withOutputPreProcessor(outputPreProcessor: LangServeOutputPreProcessor<AiMsg>): ChatAdapterBuilder<AiMsg> {\n        if (this.theOutputPreProcessor !== undefined) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Cannot set the output pre-processor option more than once',\n            });\n        }\n\n        this.theOutputPreProcessor = outputPreProcessor;\n        return this;\n    }\n\n    withUrl(runnableUrl: string): ChatAdapterBuilder<AiMsg> {\n        if (this.theUrl !== undefined) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Cannot set the runnable URL option more than once',\n            });\n        }\n\n        this.theUrl = runnableUrl;\n        return this;\n    }\n}\n","import {ChatAdapterBuilder} from './builder';\nimport {LangServeAdapterBuilderImpl} from './builderImpl';\n\nexport const createChatAdapter = <AiMsg = string>(): ChatAdapterBuilder<AiMsg> => {\n    return new LangServeAdapterBuilderImpl();\n};\n"],"names":["__publicField"],"mappings":"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"}