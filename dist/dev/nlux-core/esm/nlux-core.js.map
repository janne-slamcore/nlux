{"version":3,"file":"nlux-core.js","sources":["../../../../packages/shared/src/types/error.ts","../../../../packages/shared/src/utils/debug.ts","../../../../packages/shared/src/utils/warn.ts","../../../../packages/js/core/src/aiChat/comp/registry.ts","../../../../packages/js/core/src/global.ts","../../../../packages/shared/src/utils/dom/domOp.ts","../../../../packages/shared/src/utils/dom/emptyInnerHtml.ts","../../../../packages/shared/src/utils/uid.ts","../../../../packages/js/core/src/aiChat/comp/base.ts","../../../../packages/js/core/src/aiChat/comp/decorators.ts","../../../../packages/shared/src/components/Avatar/utils/createPhotoContainerFromUrl.ts","../../../../packages/shared/src/components/Avatar/create.ts","../../../../packages/shared/src/components/Message/utils/applyNewDirectionClassName.ts","../../../../packages/shared/src/components/Message/utils/applyNewStatusClassName.ts","../../../../packages/shared/src/markdown/copyToClipboard/attachCopyClickListener.ts","../../../../packages/shared/src/markdown/copyToClipboard/insertCopyToClipboardButton.ts","../../../../packages/shared/src/markdown/snapshot/marked/defaults.ts","../../../../packages/shared/src/markdown/snapshot/marked/Hooks.ts","../../../../packages/shared/src/markdown/snapshot/marked/helpers.ts","../../../../packages/shared/src/markdown/snapshot/marked/rules.ts","../../../../packages/shared/src/markdown/snapshot/marked/Tokenizer.ts","../../../../packages/shared/src/markdown/snapshot/marked/Lexer.ts","../../../../packages/shared/src/markdown/snapshot/marked/Renderer.ts","../../../../packages/shared/src/markdown/snapshot/marked/TextRenderer.ts","../../../../packages/shared/src/markdown/snapshot/marked/Parser.ts","../../../../packages/shared/src/markdown/snapshot/marked/Instance.ts","../../../../packages/shared/src/markdown/snapshot/marked/marked.ts","../../../../packages/shared/src/markdown/snapshot/snapshotParser.ts","../../../../packages/shared/src/components/Message/utils/createMessageContent.ts","../../../../packages/shared/src/components/Message/create.ts","../../../../packages/shared/src/components/ChatItem/utils/applyNewDirectionClassName.ts","../../../../packages/shared/src/components/ChatItem/utils/applyNewLayoutClassName.ts","../../../../packages/shared/src/components/ChatItem/create.ts","../../../../packages/shared/src/components/Avatar/utils/updateContentOnAvatarChange.ts","../../../../packages/shared/src/components/Avatar/utils/updateNameOnAvatar.ts","../../../../packages/shared/src/components/Avatar/update.ts","../../../../packages/shared/src/components/Message/utils/updateContentOnMessageChange.ts","../../../../packages/shared/src/components/Message/utils/updateContentOnStatusChange.ts","../../../../packages/shared/src/components/Message/update.ts","../../../../packages/shared/src/components/ChatItem/update.ts","../../../../packages/shared/src/markdown/stream/streamParser.ts","../../../../packages/extra/markdown/src/index.ts","../../../../packages/js/core/src/utils/dom/getElement.ts","../../../../packages/js/core/src/sections/chat/chatItem/chatItem.render.ts","../../../../packages/js/core/src/sections/chat/chatItem/chatItem.update.ts","../../../../packages/js/core/src/sections/chat/chatItem/chatItem.model.ts","../../../../packages/shared/src/utils/throttle.ts","../../../../packages/shared/src/interactions/autoScroll/utils/conversationScrollHandler.ts","../../../../packages/shared/src/interactions/autoScroll/autoScrollController.ts","../../../../packages/js/core/src/aiChat/comp/comp.ts","../../../../packages/js/core/src/utils/propsToCorePropsInEvents.ts","../../../../packages/shared/src/components/Loader/create.ts","../../../../packages/shared/src/components/SendIcon/create.ts","../../../../packages/shared/src/components/Composer/utils/applyNewStatusClassName.ts","../../../../packages/shared/src/components/Composer/create.ts","../../../../packages/js/core/src/utils/dom/listenToElement.ts","../../../../packages/js/core/src/utils/source.ts","../../../../packages/js/core/src/sections/chat/composer/composer.render.ts","../../../../packages/shared/src/components/Composer/utils/updateContentOnStatusChange.ts","../../../../packages/shared/src/components/Composer/update.ts","../../../../packages/js/core/src/sections/chat/composer/composer.update.ts","../../../../packages/js/core/src/sections/chat/composer/composer.model.ts","../../../../packages/shared/src/utils/chat/chatSegmentsToChatItems.ts","../../../../packages/shared/src/utils/dom/getChatSegmentClassName.ts","../../../../packages/js/core/src/sections/chat/chatSegment/chatSegment.render.ts","../../../../packages/js/core/src/sections/chat/chatSegment/chatSegment.update.ts","../../../../packages/shared/src/utils/chat/participantNameFromRoleAndPersona.ts","../../../../packages/shared/src/utils/dom/getConversationLayout.ts","../../../../packages/shared/src/utils/stringifyRandomResponse.ts","../../../../packages/js/core/src/sections/chat/chatSegment/utils/getChatItemProps.ts","../../../../packages/js/core/src/sections/chat/chatSegment/chatSegment.model.ts","../../../../packages/js/core/src/sections/chat/conversation/conversation.render.ts","../../../../packages/js/core/src/sections/chat/conversation/conversation.update.ts","../../../../packages/js/core/src/sections/chat/conversation/conversation.model.ts","../../../../packages/js/core/src/sections/chat/conversationStarters/utils/createConversationStartersDom.ts","../../../../packages/js/core/src/sections/chat/conversationStarters/conversationStarters.renderer.ts","../../../../packages/js/core/src/sections/chat/conversationStarters/conversationStarters.update.ts","../../../../packages/js/core/src/sections/chat/conversationStarters/conversationStarters.model.ts","../../../../packages/shared/src/components/Greeting/utils/updateGreetingText.ts","../../../../packages/shared/src/components/Greeting/create.ts","../../../../packages/shared/src/components/Logo/getNluxSmallPngLogo.ts","../../../../packages/shared/src/components/DefaultGreeting/create.ts","../../../../packages/shared/src/components/Greeting/update.ts","../../../../packages/js/core/src/sections/chat/launchPad/launchPad.renderer.ts","../../../../packages/js/core/src/sections/chat/launchPad/launchPad.update.ts","../../../../packages/js/core/src/sections/chat/launchPad/launchPad.model.ts","../../../../packages/shared/src/types/adapters/chat/standardChatAdapter.ts","../../../../packages/shared/src/services/submitPrompt/utils/triggerAsyncCallback.ts","../../../../packages/shared/src/services/submitPrompt/batchText.ts","../../../../packages/shared/src/services/submitPrompt/streamServerComponent.ts","../../../../packages/shared/src/services/submitPrompt/streamText.ts","../../../../packages/shared/src/services/submitPrompt/utils/contentTypeToGenerate.ts","../../../../packages/shared/src/services/submitPrompt/utils/dataTransferModeToUse.ts","../../../../packages/shared/src/services/submitPrompt/utils/emptyCompleteSegment.ts","../../../../packages/shared/src/services/submitPrompt/utils/emptyErrorSegment.ts","../../../../packages/shared/src/services/submitPrompt/utils/userMessageFromPrompt.ts","../../../../packages/shared/src/services/submitPrompt/submitPromptImpl.ts","../../../../packages/shared/src/types/exceptions/errors.ts","../../../../packages/js/core/src/sections/chat/chatRoom/actions/submitPrompt.ts","../../../../packages/js/core/src/sections/chat/chatRoom/utils/getChatRoomStatus.ts","../../../../packages/js/core/src/sections/chat/chatRoom/chatRoom.render.ts","../../../../packages/js/core/src/sections/chat/chatRoom/chatRoom.update.ts","../../../../packages/js/core/src/sections/chat/chatRoom/chatRoom.model.ts","../../../../packages/shared/src/components/ExceptionsBox/create.ts","../../../../packages/shared/src/components/ExceptionsBox/control.ts","../../../../packages/js/core/src/sections/miscellaneous/exceptionsBox/render.ts","../../../../packages/js/core/src/sections/miscellaneous/exceptionsBox/update.ts","../../../../packages/js/core/src/sections/miscellaneous/exceptionsBox/model.ts","../../../../packages/js/core/src/sections/sections.ts","../../../../packages/js/core/src/aiChat/events/eventManager.ts","../../../../packages/shared/src/utils/dom/getRootClassNames.ts","../../../../packages/js/core/src/aiChat/renderer/renderer.ts","../../../../packages/js/core/src/aiChat/controller/context.ts","../../../../packages/js/core/src/aiChat/controller/controller.ts","../../../../packages/js/core/src/aiChat/aiChat.ts","../../../../packages/js/core/src/bus/observable.ts","../../../../packages/js/core/src/utils/adapters/isContextTasksAdapter.ts","../../../../packages/js/core/src/aiContext/dataSyncService.ts","../../../../packages/js/core/src/aiContext/tasksService.ts","../../../../packages/js/core/src/aiContext/aiContext.ts","../../../../packages/js/core/src/aiContext/options/dataSyncOptions.ts","../../../../packages/js/core/src/index.ts"],"sourcesContent":["import {NLErrorId} from './exceptions/errors';\n\nexport type NluxRawError = {\n    readonly message?: string;\n    readonly type?: string;\n    readonly source?: string;\n    readonly exceptionId?: NLErrorId;\n};\n\nexport class NluxError extends Error {\n    readonly exceptionId?: NLErrorId;\n    readonly message: string;\n    readonly source?: string;\n    readonly type: string;\n\n    constructor(rawError: NluxRawError = {}) {\n        super(rawError.message);\n\n        this.message = rawError.message ?? '';\n        this.source = rawError.source;\n        this.type = this.constructor.name;\n        this.exceptionId = rawError.exceptionId;\n    }\n}\n\nexport class NluxUsageError extends NluxError {\n}\n\nexport class NluxValidationError extends NluxError {\n}\n\nexport class NluxRenderingError extends NluxError {\n}\n","export const debug = (...messages: unknown[]) => {\n    if (process.env.NLUX_DEBUG_ENABLED !== 'true') {\n        return;\n    }\n\n    for (const message of messages) {\n        if (typeof message === 'string') {\n            console.log(`[nlux] ${message}`);\n            continue;\n        }\n\n        if (message && typeof message.toString === 'function') {\n            console.log(`[nlux] ${message.toString()}`);\n            continue;\n        }\n\n        console.log('[nlux] Debug:');\n        console.log(JSON.stringify(message, null, 2));\n    }\n};\n","export const warn = (message: unknown) => {\n    if (typeof message === 'string') {\n        console.warn(`[nlux] ${message}`);\n        return;\n    }\n\n    if (message && typeof message.toString === 'function') {\n        console.warn(`[nlux] ${message.toString()}`);\n        return;\n    }\n\n    console.warn('[nlux]');\n    console.log(JSON.stringify(message, null, 2));\n};\n\nconst warnedMessages: string[] = [];\nexport const warnOnce = (message: string) => {\n    if (warnedMessages.includes(message)) {\n        return;\n    }\n\n    warnedMessages.push(message);\n    warn(message);\n};\n","import {debug} from '@shared/utils/debug';\nimport {warn} from '@shared/utils/warn';\nimport {CompDef, CompRenderer, CompUpdater} from '../../types/comp';\nimport {BaseComp} from './base';\n\nexport class CompRegistry {\n    public static componentDefs: Map<string, CompDef<unknown, unknown, unknown, unknown>> = new Map();\n\n    public static register(compClass: typeof BaseComp) {\n        const compId = compClass.__compId;\n        if (!compId) {\n            warn('Component definition missing valid id');\n            return;\n        }\n\n        if (CompRegistry.componentDefs.get(compId) !== undefined) {\n            debug(`Component with id \"${compId}\" already registered`);\n            return;\n        }\n\n        if (!compClass.__renderer || !compClass.__updater) {\n            warn(`Component with id \"${compId}\" missing renderer or updater`);\n            return;\n        }\n\n        CompRegistry.componentDefs.set(compId, {\n            id: compId,\n            model: compClass,\n            render: compClass.__renderer as CompRenderer<unknown, unknown, unknown, unknown>,\n            update: compClass.__updater as CompUpdater<unknown, unknown, unknown>,\n        });\n    }\n\n    public static retrieve<\n        PropsType = unknown, ElementsType = unknown, EventsType = unknown, ActionsType = unknown\n    >(id: string): CompDef<PropsType, ElementsType, EventsType, ActionsType> | undefined {\n        const def = CompRegistry.componentDefs.get(id);\n        if (!def) {\n            warn(`Component with id \"${id}\" not registered`);\n            return undefined;\n        }\n\n        return def as CompDef<PropsType, ElementsType, EventsType, ActionsType>;\n    }\n}\n","const globalMetaData: {\n    version?: string;\n    [key: string]: unknown;\n} = {\n    version: '{versions.nlux}',\n    [btoa('sectionsRegistered')]: false,\n};\n\nexport const getGlobalMetaData = (): typeof globalMetaData | undefined => {\n    if (typeof window === 'undefined') {\n        return undefined;\n    }\n\n    const theGlobalObject = window as unknown as Window & {NLUX?: typeof globalMetaData};\n    if (typeof theGlobalObject.NLUX === 'object' && typeof theGlobalObject.NLUX.version === 'string') {\n        return theGlobalObject.NLUX;\n    }\n\n    theGlobalObject.NLUX = globalMetaData;\n    return globalMetaData;\n};\n","import {CallbackFunction} from '../../types/callbackFunction';\n\nexport const domOp = (op: CallbackFunction) => {\n    const id = requestAnimationFrame(() => {\n        op();\n    });\n\n    return () => {\n        cancelAnimationFrame(id);\n    };\n};\n","export const emptyInnerHtml = (element: HTMLElement): void => {\n    element.replaceChildren();\n};\n","export const uid = () => {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (character) => {\n        const randomValue = Math.random() * 16 | 0;\n        const value = character == 'x' ? randomValue : (randomValue & 0x3 | 0x8);\n        return value.toString(16);\n    });\n};\n","import {CallbackArgType, CallbackFunction} from '@shared/types/callbackFunction';\nimport {NluxError, NluxUsageError} from '@shared/types/error';\nimport {domOp} from '@shared/utils/dom/domOp';\nimport {emptyInnerHtml} from '@shared/utils/dom/emptyInnerHtml';\nimport {uid} from '@shared/utils/uid';\nimport {warn} from '@shared/utils/warn';\nimport {CompDef, CompDom, CompRenderer, CompUpdater} from '../../types/comp';\nimport {ControllerContext} from '../../types/controllerContext';\nimport {CompRegistry} from './registry';\n\nexport type CompStatus = 'unmounted' | 'rendered' | 'active' | 'destroyed';\n\nexport abstract class BaseComp<AiMsg, PropsType, ElementsType, EventsType, ActionsType> {\n    static __compEventListeners: Map<string | number | symbol, string[]> | null = null;\n    static __compId: string | null = null;\n    static __renderer: CompRenderer<unknown, unknown, unknown, unknown> | null = null;\n    static __updater: CompUpdater<unknown, unknown, unknown> | null = null;\n\n    /**\n     * A reference to the component definition, as retrieved from the registry.\n     */\n    protected readonly def: CompDef<PropsType, ElementsType, EventsType, ActionsType> | null;\n\n    /**\n     * Props that are used to render the component and update the DOM tree.\n     * This map is constructed from the props provided by the user, but it can be modified by\n     * the component using the setProp() method.\n     */\n    protected elementProps: Map<keyof PropsType, PropsType[keyof PropsType]>;\n\n    /**\n     * Props that are provided by the component user.\n     */\n    protected props: Readonly<PropsType>;\n\n    /**\n     * A reference to the DOM tree of the current component, and a callback that is called when the\n     * component is destroyed.\n     */\n    protected renderedDom: CompDom<ElementsType, ActionsType> | null;\n\n    /**\n     * Internally used event listeners that are registerer by the renderer.\n     * Those events are mounted on the DOM tree of the component by the renderer.\n     * This map can be used by components that extend the BaseComp to register listeners.\n     */\n    protected rendererEventListeners: Map<EventsType, () => void>;\n\n    /**\n     * Props that are passed to the renderer.\n     * This map is constructed from the props provided by the user.\n     */\n    protected rendererProps: PropsType;\n\n    /**\n     * A reference to the root element of the current component.\n     * This could be an HTML element (for most of the cases when the component is rendered in the DOM tree)\n     * or it could be a document fragment (for cases when the component is rendered in a virtual DOM tree).\n     * This property is set to null when the component is not rendered.\n     */\n    protected renderingRoot: HTMLElement | DocumentFragment | null;\n\n    /**\n     * Element IDs of the sub-components that are mounted in the DOM tree of the current component.\n     * The key is the ID of the sub-component and the value is the ID of the element in the DOM tree.\n     */\n    protected subComponentElementIds: Map<string, keyof ElementsType> = new Map();\n\n    /**\n     * Sub-components that are mounted in the DOM tree of the current component.\n     * This list should be filled by user by calling addPart() method in constructor of the component.\n     */\n    protected subComponents: Map<string, BaseComp<unknown, unknown, unknown, unknown, unknown>> = new Map();\n\n    /**\n     * The context of the current chat component.\n     */\n    private __context: Readonly<ControllerContext<AiMsg>> | null = null;\n\n    /**\n     * A flag that indicates if the current component is destroyed.\n     * This will prevent the component from being rendered, updated, or used in any way.\n     */\n    private __destroyed: boolean = false;\n\n    /**\n     * A unique identifier of the current component instance.\n     */\n    private readonly __instanceId: string;\n\n    /**\n     * The status of the current component.\n     */\n    private __status: CompStatus = 'unmounted';\n\n    /**\n     * A queue of actions that should be executed on the DOM tree when the component is rendered.\n     * This queue is used to store actions that are called before the component is rendered.\n     */\n    private actionsOnDomReady: (() => void)[] = [];\n    private compEventGetter = (eventName: EventsType) => {\n        if (this.destroyed) {\n            // Ignore event calls on destroyed components\n            return () => {\n            };\n        }\n\n        const callback = this.rendererEventListeners.get(eventName as EventsType);\n        if (!callback) {\n            throw new NluxError({\n                source: this.constructor.name,\n                message: `Unable to call renderer event \"${eventName}\" because no matching event listener was found. ` +\n                    `Make sure that the event listener is registered using @CompEventListener() decorator ` +\n                    `in the component model class, and use class methods instead of arrow function attributes.`,\n            });\n        }\n\n        return callback;\n    };\n\n    protected constructor(context: ControllerContext<AiMsg>, props: PropsType) {\n        const compId = Object.getPrototypeOf(this).constructor.__compId;\n        if (!compId) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to instantiate component: missing compId in implementation. ' +\n                    'Component should be annotated using @Model() to set compId ' +\n                    'before iy can be instantiated.',\n            });\n        }\n\n        this.def = CompRegistry.retrieve(compId) ?? null;\n        if (!this.def) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: `Unable to instantiate component \"${compId}\" because it\\'s not registered. ` +\n                    'Component should be registered using CompRegistry.register(ComponentClass) ' +\n                    'before instantiating a component.',\n            });\n        }\n\n        this.__instanceId = uid();\n        this.__destroyed = false;\n        this.__context = context;\n\n        this.renderedDom = null;\n        this.renderingRoot = null;\n\n        this.props = props;\n        const entries = (props ? Object.entries(props) as unknown : []) as Iterable<unknown>;\n        this.elementProps = new Map(entries as ([keyof PropsType, PropsType[keyof PropsType]])[]);\n        this.rendererEventListeners = new Map();\n\n        const preDefinedEventListeners: Map<string, string[]> | null = (\n            this.constructor as unknown as Record<string, unknown>\n        ).__compEventListeners as Map<string, string[]> | null;\n\n        if (preDefinedEventListeners) {\n            preDefinedEventListeners.forEach((methodNames, eventName) => {\n                methodNames.forEach((methodName) => {\n                    const method = (Object.getPrototypeOf(this))[methodName];\n                    if (typeof method === 'function') {\n                        this.addRendererEventListener(eventName as EventsType, method.bind(this));\n                    } else {\n                        warn(`Unable to set event listener \"${eventName}\" because method \"${methodName}\" ` +\n                            `cannot be found on component \"${this.constructor.name} at runtime!\"`);\n                    }\n                });\n            });\n        }\n\n        this.rendererProps = Object.freeze(props) as PropsType;\n    }\n\n    public get destroyed(): boolean {\n        return this.__destroyed;\n    }\n\n    public get id(): string {\n        return this.__instanceId;\n    }\n\n    public get rendered(): boolean {\n        return this.renderedDom !== null;\n    }\n\n    public get root(): HTMLElement | DocumentFragment | null {\n        this.throwIfDestroyed();\n\n        if (!this.renderedDom || !this.renderingRoot) {\n            return null;\n        }\n\n        return this.renderingRoot;\n    }\n\n    public get status(): CompStatus {\n        return this.__status;\n    }\n\n    protected get context(): ControllerContext<AiMsg> {\n        if (!this.__context) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to get context because it\\'s not set',\n            });\n        }\n\n        return this.__context;\n    }\n\n    public destroy() {\n        this.destroyComponent();\n    }\n\n    public destroyListItemComponent() {\n        this.destroyComponent(true);\n    }\n\n    public getProp(name: keyof PropsType): PropsType[keyof PropsType] | null {\n        this.throwIfDestroyed();\n        return this.elementProps.get(name) ?? null;\n    }\n\n    /**\n     * Renders the current component in the DOM tree.\n     * This method should be called by the component user to render the component. It should only be called once.\n     * If the user attempts to render a mounted or destroyed component, an error will be thrown.\n     *\n     * You can use rendered property to check if the component is rendered before/after calling render().\n     * You can use destroyed property to check if the component is already destroyed before calling render().\n     *\n     * @param root The root element where the component should be rendered.\n     * @param insertBeforeElement The element before which the component should be inserted. If not provided, the\n     * component will be appended to the root element. If provided, the component will be inserted before the\n     * provided element if it exists in the root element.\n     */\n    public render(root: HTMLElement, insertBeforeElement?: HTMLElement) {\n        if (!this.def) {\n            return;\n        }\n\n        if (this.destroyed) {\n            warn(`Unable to render component \"${this.def?.id}\" because it is already destroyed`);\n            return;\n        }\n\n        if (this.rendered || this.renderedDom) {\n            warn(`Unable to render component \"${this.def.id}\" because it is already rendered`);\n            return;\n        }\n\n        // IMPORTANT: This is where rendering happens!\n        // We initially render the component in a virtual root element (document fragment)\n        // Then we render the sub-components in their respective portals\n        // Then we append the virtual root element to the actual root element\n\n        const virtualRoot = document.createDocumentFragment();\n        const compId = Object.getPrototypeOf(this).constructor.__compId;\n        const renderedDom = this.executeRenderer(virtualRoot);\n        if (!renderedDom) {\n            throw new NluxError({\n                source: this.constructor.name,\n                message: `Unable to render component \"${compId}\" because renderer returned null`,\n            });\n        }\n\n        this.renderedDom = renderedDom;\n\n        // We render sub-components in their respective portals\n        for (const [, subComponent] of this.subComponents) {\n            const portal = this.getSubComponentPortal(subComponent.id);\n            if (portal) {\n                this.mountSubComponentToPortal(subComponent.id, portal);\n            }\n        }\n\n        // We append the virtual root element to the actual root element\n        domOp(() => {\n            if (this.destroyed) {\n                return;\n            }\n\n            if (insertBeforeElement) {\n                root.insertBefore(virtualRoot, insertBeforeElement);\n            } else {\n                root.append(virtualRoot);\n            }\n\n            this.renderingRoot = root;\n        });\n    }\n\n    updateSubComponent(subComponentId: string, propName: string, newValue: unknown) {\n        this.throwIfDestroyed();\n\n        const subComp = this.subComponents.get(subComponentId) as BaseComp<\n            AiMsg, PropsType, ElementsType, EventsType, ActionsType\n        > | undefined;\n\n        if (subComp && !subComp.destroyed) {\n            subComp.setProp(propName as keyof PropsType, newValue as PropsType[keyof PropsType]);\n        }\n    }\n\n    protected addSubComponent<SubCompPropsType, SubCompElementsType, SubCompEventsType, SubCompActionsType>(\n        id: string,\n        subComponent: BaseComp<AiMsg, SubCompPropsType, SubCompElementsType, SubCompEventsType, SubCompActionsType>,\n        rendererElementId?: keyof ElementsType,\n    ) {\n        this.throwIfDestroyed();\n\n        if (this.subComponents.has(id)) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: `Unable to add sub-component \"${id}\" because it already exists`,\n            });\n        }\n\n        this.subComponents.set(id, subComponent as BaseComp<unknown, unknown, unknown, unknown, unknown>);\n\n        if (rendererElementId) {\n            this.subComponentElementIds.set(id, rendererElementId);\n        }\n\n        if (this.renderedDom) {\n            const portal = this.getSubComponentPortal(id);\n            if (portal) {\n                this.mountSubComponentToPortal(id, portal);\n            }\n        }\n    }\n\n    /**\n     * Executes a DOM action on the current component.\n     * DOM actions are defined by the renderer and are used to call DOM-defined functions.\n     * DOM actions should not be used to update the DOM tree. Use setProp() to update the DOM tree.\n     *\n     * Example of DOM actions: Focus on an input, scroll to a specific element, select text.\n     *\n     * @param actionName\n     * @param args\n     * @protected\n     */\n    protected executeDomAction(actionName: keyof ActionsType, ...args: Array<unknown>) {\n        this.throwIfDestroyed();\n\n        if (!this.renderedDom) {\n            this.actionsOnDomReady.push(() => this.executeDomAction(actionName, ...args));\n            return;\n        }\n\n        if (!this.renderingRoot) {\n            throw new NluxError({\n                source: this.constructor.name,\n                message: 'Unable to execute DOM action because renderingRoot is not set',\n            });\n        }\n\n        // Execute the action\n        const action = (<ActionsType>this.renderedDom.actions)[actionName];\n        if (!action) {\n            throw new NluxError({\n                source: this.constructor.name,\n                message: `Unable to execute DOM action \"${String(actionName)}\" because it does not exist`,\n            });\n        }\n\n        return domOp(() => (action as CallbackFunction)(...args as CallbackArgType[]));\n    };\n\n    protected executeRenderer(root: HTMLElement | DocumentFragment) {\n        const renderer = this.def?.render;\n        if (!renderer) {\n            return null;\n        }\n\n        if (this.renderingRoot) {\n            throw new NluxError({\n                source: this.constructor.name,\n                message: 'Unable to render component because renderingRoot is already set',\n            });\n        }\n\n        const result = renderer({\n            appendToRoot: (element: HTMLElement) => {\n                root.append(element);\n                // Run pending DOM actions that were queued before the component was rendered\n                this.runDomActionsQueue();\n            },\n            compEvent: this.compEventGetter,\n            props: this.rendererProps,\n            context: this.context as ControllerContext<unknown>,\n        });\n\n        if (result) {\n            // Only keep a reference to the root element of the component on successful rendering.\n            this.renderingRoot = root;\n        }\n\n        return result;\n    }\n\n    protected removeSubComponent(id: string) {\n        this.throwIfDestroyed();\n\n        domOp(() => {\n            const subComp = this.subComponents.get(id);\n            if (subComp) {\n                // Change sub-component root before deleting it to avoid deleting the root element\n                subComp.renderingRoot = null;\n                subComp.destroy();\n                this.subComponents.delete(id);\n            }\n        });\n    }\n\n    protected runDomActionsQueue() {\n        if (this.actionsOnDomReady.length > 0 && this.rendered) {\n            const actionsOnDomReady = this.actionsOnDomReady;\n            this.actionsOnDomReady = [];\n            for (const action of actionsOnDomReady) {\n                domOp(() => action());\n            }\n        }\n    }\n\n    /**\n     * Sets a property of the current component.\n     * This method can be called by the component to change property values.\n     * New values will be passed to updater function to update the DOM tree.\n     *\n     * @param name\n     * @param value\n     * @protected\n     */\n    protected setProp(name: keyof PropsType, value: PropsType[keyof PropsType]) {\n        if (this.destroyed) {\n            warn(`Unable to set prop \"${String(name)}\" because component \"${this.constructor.name}\" is destroyed`);\n            return;\n        }\n\n        if (!this.elementProps.has(name)) {\n            warn(`Unable to set prop \"${String(name)}\" because it does not exist in the component props`);\n            return;\n        }\n\n        this.schedulePropUpdate(\n            name,\n            this.elementProps.get(name)!,\n            value,\n        );\n\n        this.props = Object.freeze(Object.fromEntries(this.elementProps)) as Readonly<PropsType>;\n        this.elementProps.set(name, value);\n    }\n\n    protected throwIfDestroyed() {\n        if (this.__destroyed) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to call method on destroyed component',\n            });\n        }\n    }\n\n    private addRendererEventListener(eventType: EventsType, listener: () => void) {\n        this.throwIfDestroyed();\n\n        if (this.rendererEventListeners.has(eventType)) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: `Unable to add event listener to rendererEvents \"${eventType}\" because it already exists`,\n            });\n        }\n\n        this.rendererEventListeners.set(eventType, listener);\n    };\n\n    private destroyComponent(isListItem = false) {\n        this.throwIfDestroyed();\n\n        this.subComponents.forEach((subComp) => {\n            subComp.destroy();\n        });\n\n        if (this.renderedDom) {\n            if (this.renderedDom.elements) {\n                this.renderedDom.elements = undefined;\n            }\n\n            if (this.renderedDom.actions) {\n                this.renderedDom.actions = undefined;\n            }\n\n            if (this.renderedDom.onDestroy) {\n                this.renderedDom.onDestroy();\n            }\n\n            // IMPORTANT:\n            // Clean up removed DOM elements asynchronously\n            const renderingRoot = this.renderingRoot;\n            domOp(() => {\n                if (!renderingRoot) {\n                    return;\n                }\n\n                if (renderingRoot instanceof DocumentFragment) {\n                    while (renderingRoot.firstChild) {\n                        renderingRoot.removeChild(renderingRoot.firstChild);\n                    }\n                } else {\n                    if (isListItem) {\n                        renderingRoot.parentElement?.removeChild(renderingRoot);\n                    } else {\n                        emptyInnerHtml(renderingRoot);\n                    }\n                }\n            });\n\n            this.renderedDom = null;\n            this.renderingRoot = null;\n        }\n\n        this.__destroyed = true;\n        this.__context = null;\n        this.props = undefined as PropsType;\n\n        this.elementProps.clear();\n        this.rendererEventListeners.clear();\n        this.subComponents.clear();\n    }\n\n    private getSubComponentPortal(id: string): HTMLElement | null {\n        const subComp = this.subComponents.get(id);\n        const rendererElementId = this.subComponentElementIds.get(id);\n\n        if (!subComp || !rendererElementId) {\n            return null;\n        }\n\n        const value = (<ElementsType>this.renderedDom?.elements)[rendererElementId];\n        return value instanceof HTMLElement ? value : null;\n    }\n\n    private mountSubComponentToPortal(subComponentId: string, portal: HTMLElement) {\n        const subComp = this.subComponents.get(subComponentId);\n        subComp?.render(portal);\n    }\n\n    private schedulePropUpdate(\n        propName: keyof PropsType,\n        currentValue: PropsType[keyof PropsType],\n        newValue: PropsType[keyof PropsType],\n    ) {\n        if (!this.renderedDom || !this.def?.update) {\n            return;\n        }\n\n        const renderedDom = this.renderedDom;\n        const renderingRoot = this.renderingRoot;\n        const updater = this.def.update;\n\n        if (!renderingRoot) {\n            return;\n        }\n\n        domOp(() => {\n            updater({\n                propName,\n                currentValue,\n                newValue,\n                dom: {\n                    root: renderingRoot,\n                    elements: renderedDom.elements,\n                    actions: renderedDom.actions,\n                },\n                updateSubComponent: this.updateSubComponent,\n            });\n        });\n    }\n}\n","import {NluxUsageError} from '@shared/types/error';\nimport {CompRenderer, CompUpdater} from '../../types/comp';\nimport {BaseComp} from './base';\n\nexport const Model = <PropsType, ElementsType, EventsType, ActionsType>(\n    compId: string,\n    renderer: CompRenderer<PropsType, ElementsType, EventsType, ActionsType>,\n    updater: CompUpdater<PropsType, ElementsType, ActionsType>,\n) => {\n    return (target: unknown) => {\n        (target as {__compId: typeof compId}).__compId = compId;\n        (target as {__renderer: typeof renderer}).__renderer = renderer;\n        (target as {__updater: typeof updater}).__updater = updater;\n    };\n};\n\nexport const CompEventListener = <EventsType>(eventName: keyof EventsType) => (\n    (target: unknown, methodName: string) => {\n        const typedTarget = target as {\n            constructor: typeof BaseComp;\n        };\n        if (typeof typedTarget.constructor !== 'function') {\n            throw new NluxUsageError({\n                source: 'CallbackFor',\n                message: `@CallbackFor can only be used on methods of a class!`,\n            });\n        }\n\n        if (\n            !typedTarget.constructor.hasOwnProperty('__compEventListeners') ||\n            typedTarget.constructor.__compEventListeners === null\n        ) {\n            typedTarget.constructor.__compEventListeners = new Map<string | number | symbol, string[]>();\n        }\n\n        const compEventListeners: Map<string | number | symbol, string[]> = typedTarget.constructor.__compEventListeners;\n        const methodNames = compEventListeners.get(eventName);\n        if (!methodNames) {\n            compEventListeners.set(eventName, [methodName]);\n        } else {\n            methodNames.push(methodName);\n        }\n    }\n);\n","export const renderedPhotoContainerClassName = 'nlux-comp-avatarContainer';\nexport const renderedPhotoClassName = 'nlux-comp-avatarPicture';\n\nexport const createPhotoContainerFromUrl = (url: string | undefined, name: string | undefined): HTMLElement => {\n    const photoContainer = document.createElement('div');\n    photoContainer.classList.add(renderedPhotoContainerClassName);\n\n    // We load the photo in the foreground\n    if (url) {\n        const photoDomElement = document.createElement('div');\n        photoDomElement.classList.add(renderedPhotoClassName);\n        photoDomElement.style.backgroundImage = `url(\"${encodeURI(url)}\")`;\n        photoContainer.append(photoDomElement);\n    }\n\n    return photoContainer;\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {AvatarProps} from './props';\nimport {createPhotoContainerFromUrl} from './utils/createPhotoContainerFromUrl';\n\nexport const className = 'nlux-comp-avatar';\n\nexport const createAvatarDom: DomCreator<AvatarProps> = (\n    props,\n): HTMLElement => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    if (!props.avatar && !props.name) {\n        return element;\n    }\n\n    if (props.name) {\n        element.title = props.name;\n    }\n\n    // When the avatar is an HTMLElement, we clone it and append it to the persona dom\n    // without any further processing!\n    if (props.avatar && props.avatar instanceof HTMLElement) {\n        element.append(props.avatar.cloneNode(true));\n        return element;\n    }\n\n    // Alternatively, treat the avatar as a string representing a URL of the photo to\n    // be loaded and render the photo accordingly.\n    element.append(createPhotoContainerFromUrl(props.avatar as string, props.name));\n    return element;\n};\n","import {MessageDirection} from '../props';\n\nexport const directionClassName: {[key: string]: string} = {\n    received: 'nlux_msg_received',\n    sent: 'nlux_msg_sent',\n};\n\nexport const applyNewDirectionClassName = (element: HTMLElement, direction: MessageDirection) => {\n    const directions = Object.keys(directionClassName);\n    directions.forEach((directionName) => {\n        element.classList.remove(directionClassName[directionName]);\n    });\n\n    if (directionClassName[direction]) {\n        element.classList.add(directionClassName[direction]);\n    }\n};\n","import {MessageStatus} from '../props';\n\nexport const statusClassName: {[key: string]: string} = {\n    streaming: 'nlux_msg_streaming',\n    complete: 'nlux_msg_complete',\n};\n\nexport const applyNewStatusClassName = (element: HTMLElement, status: MessageStatus) => {\n    const statuses = Object.keys(statusClassName);\n    statuses.forEach((statusName) => {\n        element.classList.remove(statusClassName[statusName]);\n    });\n\n    if (statusClassName[status]) {\n        element.classList.add(statusClassName[status]);\n    }\n};\n","const addListenersToCopyButton = (copyButton: Element) => {\n    if (!(copyButton instanceof HTMLButtonElement)) {\n        return;\n    }\n\n    // If button has click event listener, do not add another one\n    if (copyButton.dataset.clickListenerSet === 'true') {\n        return;\n    }\n\n    let clicked = false;\n    const codeBlock = copyButton.nextElementSibling as HTMLElement;\n    copyButton.addEventListener('click', () => {\n        if (clicked || !codeBlock) {\n            return;\n        }\n\n        // Copy code to clipboard\n        const code = codeBlock.innerText;\n        navigator.clipboard.writeText(code ?? '');\n\n        // Mark button as clicked for 1 second\n        clicked = true;\n        copyButton.classList.add('clicked');\n        setTimeout(() => {\n            clicked = false;\n            copyButton.classList.remove('clicked');\n        }, 1000);\n    });\n\n    // Set data attribute to indicate that click event listener has been set\n    copyButton.dataset.clickListenerSet = 'true';\n};\n\nexport const attachCopyClickListener = (markdownContainer: HTMLElement) => {\n    const copyButtonCssClass = 'nlux-comp-copyButton';\n    if (\n        markdownContainer instanceof HTMLButtonElement &&\n        markdownContainer.classList.contains(copyButtonCssClass)\n    ) {\n        addListenersToCopyButton(markdownContainer);\n        return;\n    }\n\n    markdownContainer.querySelectorAll(`.${copyButtonCssClass}`).forEach(addListenersToCopyButton);\n};\n","export const insertCopyToClipboardButton = (markdownContainer: HTMLElement) => {\n    markdownContainer.querySelectorAll('.code-block').forEach((codeBlockContainer) => {\n        const codeBlock = codeBlockContainer.querySelector('pre');\n        if (!codeBlock) {\n            return;\n        }\n\n        // Check the adjacent element to see if a copy button is already present\n        if (codeBlockContainer.previousElementSibling?.classList.contains('nlux-comp-copyButton')) {\n            return;\n        }\n\n        const title = 'Copy code block to clipboard';\n        const copyButton = document.createElement('button');\n\n        copyButton.classList.add('nlux-comp-copyButton');\n        copyButton.setAttribute('aria-label', title);\n        copyButton.setAttribute('title', title);\n\n        const copyIcon = document.createElement('span');\n        copyIcon.classList.add('icon-copy');\n        copyButton.appendChild(copyIcon);\n\n        codeBlockContainer.appendChild(copyButton);\n    });\n};\n","import type {MarkedOptions} from './MarkedOptions';\n\n/**\n * Gets the original marked default options.\n */\nexport function _getDefaults(): MarkedOptions {\n    return {\n        async: false,\n        breaks: false,\n        extensions: null,\n        gfm: true,\n        hooks: null,\n        pedantic: false,\n        renderer: null,\n        silent: false,\n        tokenizer: null,\n        walkTokens: null,\n    };\n}\n\nexport let _defaults = _getDefaults();\n\nexport function changeDefaults(newDefaults: MarkedOptions) {\n    _defaults = newDefaults;\n}\n","import {_defaults} from './defaults';\nimport type {MarkedOptions} from './MarkedOptions';\nimport type {Token, TokensList} from './Tokens';\n\nexport class _Hooks {\n    static passThroughHooks = new Set([\n        'preprocess',\n        'postprocess',\n        'processAllTokens',\n    ]);\n    options: MarkedOptions;\n\n    constructor(options?: MarkedOptions) {\n        this.options = options || _defaults;\n    }\n\n    /**\n     * Process HTML after marked is finished\n     */\n    postprocess(html: string) {\n        return html;\n    }\n\n    /**\n     * Process markdown before marked\n     */\n    preprocess(markdown: string) {\n        return markdown;\n    }\n\n    /**\n     * Process all tokens before walk tokens\n     */\n    processAllTokens(tokens: Token[] | TokensList) {\n        return tokens;\n    }\n}\n","/**\n * Helpers\n */\nconst escapeTest = /[&<>\"']/;\nconst escapeReplace = new RegExp(escapeTest.source, 'g');\nconst escapeTestNoEncode = /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/;\nconst escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');\nconst escapeReplacements: {[index: string]: string} = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    '\\'': '&#39;',\n};\nconst getEscapeReplacement = (ch: string) => escapeReplacements[ch];\n\nexport function escape(html: string, encode?: boolean) {\n    if (encode) {\n        if (escapeTest.test(html)) {\n            return html.replace(escapeReplace, getEscapeReplacement);\n        }\n    } else {\n        if (escapeTestNoEncode.test(html)) {\n            return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n        }\n    }\n\n    return html;\n}\n\nconst unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\n\nexport function unescape(html: string) {\n    // explicitly match decimal, hex, and named HTML entities\n    return html.replace(unescapeTest, (_, n) => {\n        n = n.toLowerCase();\n        if (n === 'colon') {\n            return ':';\n        }\n        if (n.charAt(0) === '#') {\n            return n.charAt(1) === 'x'\n                ? String.fromCharCode(parseInt(n.substring(2), 16))\n                : String.fromCharCode(+n.substring(1));\n        }\n        return '';\n    });\n}\n\nconst caret = /(^|[^\\[])\\^/g;\n\nexport function edit(regex: string | RegExp, opt?: string) {\n    let source = typeof regex === 'string' ? regex : regex.source;\n    opt = opt || '';\n    const obj = {\n        replace: (name: string | RegExp, val: string | RegExp) => {\n            let valSource = typeof val === 'string' ? val : val.source;\n            valSource = valSource.replace(caret, '$1');\n            source = source.replace(name, valSource);\n            return obj;\n        },\n        getRegex: () => {\n            return new RegExp(source, opt);\n        },\n    };\n    return obj;\n}\n\nexport function cleanUrl(href: string) {\n    try {\n        href = encodeURI(href).replace(/%25/g, '%');\n    } catch (e) {\n        return null;\n    }\n    return href;\n}\n\nexport const noopTest = {exec: () => null} as unknown as RegExp;\n\nexport function splitCells(tableRow: string, count?: number) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    const row = tableRow.replace(/\\|/g, (match, offset, str) => {\n            let escaped = false;\n            let curr = offset;\n            while (--curr >= 0 && str[curr] === '\\\\') {\n                escaped = !escaped;\n            }\n            if (escaped) {\n                // odd number of slashes means | is escaped\n                // so we leave it alone\n                return '|';\n            } else {\n                // add space before unescaped |\n                return ' |';\n            }\n        }),\n        cells = row.split(/ \\|/);\n    let i = 0;\n\n    // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n    if (!cells[0].trim()) {\n        cells.shift();\n    }\n    if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n        cells.pop();\n    }\n\n    if (count) {\n        if (cells.length > count) {\n            cells.splice(count);\n        } else {\n            while (cells.length < count) {\n                cells.push('');\n            }\n        }\n    }\n\n    for (; i < cells.length; i++) {\n        // leading or trailing whitespace is ignored per the gfm spec\n        cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n    return cells;\n}\n\n/**\n * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n * /c*$/ is vulnerable to REDOS.\n *\n * @param str\n * @param c\n * @param invert Remove suffix of non-c chars instead. Default falsey.\n */\nexport function rtrim(str: string, c: string, invert?: boolean) {\n    const l = str.length;\n    if (l === 0) {\n        return '';\n    }\n\n    // Length of suffix matching the invert condition.\n    let suffLen = 0;\n\n    // Step left until we fail to match the invert condition.\n    while (suffLen < l) {\n        const currChar = str.charAt(l - suffLen - 1);\n        if (currChar === c && !invert) {\n            suffLen++;\n        } else {\n            if (currChar !== c && invert) {\n                suffLen++;\n            } else {\n                break;\n            }\n        }\n    }\n\n    return str.slice(0, l - suffLen);\n}\n\nexport function findClosingBracket(str: string, b: string) {\n    if (str.indexOf(b[1]) === -1) {\n        return -1;\n    }\n\n    let level = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str[i] === '\\\\') {\n            i++;\n        } else {\n            if (str[i] === b[0]) {\n                level++;\n            } else {\n                if (str[i] === b[1]) {\n                    level--;\n                    if (level < 0) {\n                        return i;\n                    }\n                }\n            }\n        }\n    }\n    return -1;\n}\n","import {edit, noopTest} from './helpers';\n\n/**\n * Block-Level Grammar\n */\n\nconst newline = /^(?: *(?:\\n|$))+/;\nconst blockCode = /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/;\nconst fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\nconst hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\nconst heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\nconst bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nconst lheading = edit(\n    /^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/)\n    .replace(/bull/g, bullet) // lists can interrupt\n    .replace(/blockCode/g, / {4}/) // indented code blocks can interrupt\n    .replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/) // fenced code blocks can interrupt\n    .replace(/blockquote/g, / {0,3}>/) // blockquote can interrupt\n    .replace(/heading/g, / {0,3}#{1,6}/) // ATX heading can interrupt\n    .replace(/html/g, / {0,3}<[^\\n>]+>\\n/) // block html can interrupt\n    .getRegex();\nconst _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\nconst blockText = /^[^\\n]+/;\nconst _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\nconst def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n *)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/)\n    .replace('label', _blockLabel)\n    .replace('title', /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/)\n    .getRegex();\n\nconst list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/)\n    .replace(/bull/g, bullet)\n    .getRegex();\n\nconst _tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n    + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n    + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n    + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n    + '|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title'\n    + '|tr|track|ul';\nconst _comment = /<!--(?:-?>|[\\s\\S]*?(?:-->|$))/;\nconst html = edit(\n    '^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7)\n    // closing\n    // tag\n    + ')', 'i')\n    .replace('comment', _comment)\n    .replace('tag', _tag)\n    .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n    .getRegex();\n\nconst paragraph = edit(_paragraph)\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n    .replace('|table', '')\n    .replace('blockquote', ' {0,3}>')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n    .getRegex();\n\nconst blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/)\n    .replace('paragraph', paragraph)\n    .getRegex();\n\n/**\n * Normal Block Grammar\n */\n\nconst blockNormal = {\n    blockquote,\n    code: blockCode,\n    def,\n    fences,\n    heading,\n    hr,\n    html,\n    lheading,\n    list,\n    newline,\n    paragraph,\n    table: noopTest,\n    text: blockText,\n};\n\ntype BlockKeys = keyof typeof blockNormal;\n\n/**\n * GFM Block Grammar\n */\n\nconst gfmTable = edit(\n    '^ *([^\\\\n ].*)\\\\n' // Header\n    + ' {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)') // Cells\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('blockquote', ' {0,3}>')\n    .replace('code', ' {4}[^\\\\n]')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // tables can be interrupted by type (6) html blocks\n    .getRegex();\n\nconst blockGfm: Record<BlockKeys, RegExp> = {\n    ...blockNormal,\n    table: gfmTable,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n        .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n        .replace('table', gfmTable) // interrupt paragraphs with table\n        .replace('blockquote', ' {0,3}>')\n        .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n        .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n        .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n        .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n        .getRegex(),\n};\n\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\n\nconst blockPedantic: Record<BlockKeys, RegExp> = {\n    ...blockNormal,\n    html: edit(\n        '^ *(?:comment *(?:\\\\n|\\\\s*$)'\n        + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n        + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n        .replace('comment', _comment)\n        .replace(/tag/g, '(?!(?:'\n            + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n            + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n            + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n        .getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest, // fences not supported\n    lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' *#{1,6} *[^\\n]')\n        .replace('lheading', lheading)\n        .replace('|table', '')\n        .replace('blockquote', ' {0,3}>')\n        .replace('|fences', '')\n        .replace('|list', '')\n        .replace('|html', '')\n        .replace('|tag', '')\n        .getRegex(),\n};\n\n/**\n * Inline-Level Grammar\n */\n\nconst escape = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\nconst inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\nconst br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\nconst inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\n\n// list of unicode punctuation marks, plus any missing characters from CommonMark spec\nconst _punctuation = '\\\\p{P}\\\\p{S}';\nconst punctuation = edit(/^((?![*_])[\\spunctuation])/, 'u')\n    .replace(/punctuation/g, _punctuation).getRegex();\n\n// sequences em should skip over [title](link), `code`, <html>\nconst blockSkip = /\\[[^[\\]]*?\\]\\([^\\(\\)]*?\\)|`[^`]*?`|<[^<>]*?>/g;\n\nconst emStrongLDelim = edit(/^(?:\\*+(?:((?!\\*)[punct])|[^\\s*]))|^_+(?:((?!_)[punct])|([^\\s_]))/, 'u')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n\nconst emStrongRDelimAst = edit(\n    '^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)' // Skip orphan inside strong\n    + '|[^*]+(?=[^*])' // Consume to delim\n    + '|(?!\\\\*)[punct](\\\\*+)(?=[\\\\s]|$)' // (1) #*** can only be a Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?!\\\\*)(?=[punct\\\\s]|$)' // (2) a***#, a*** can only be a Right Delimiter\n    + '|(?!\\\\*)[punct\\\\s](\\\\*+)(?=[^punct\\\\s])' // (3) #***a, ***a can only be Left Delimiter\n    + '|[\\\\s](\\\\*+)(?!\\\\*)(?=[punct])' // (4) ***# can only be Left Delimiter\n    + '|(?!\\\\*)[punct](\\\\*+)(?!\\\\*)(?=[punct])' // (5) #***# can be either Left or Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?=[^punct\\\\s])', 'gu') // (6) a***a can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n\n// (6) Not allowed for _\nconst emStrongRDelimUnd = edit(\n    '^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)' // Skip orphan inside strong\n    + '|[^_]+(?=[^_])' // Consume to delim\n    + '|(?!_)[punct](_+)(?=[\\\\s]|$)' // (1) #___ can only be a Right Delimiter\n    + '|[^punct\\\\s](_+)(?!_)(?=[punct\\\\s]|$)' // (2) a___#, a___ can only be a Right Delimiter\n    + '|(?!_)[punct\\\\s](_+)(?=[^punct\\\\s])' // (3) #___a, ___a can only be Left Delimiter\n    + '|[\\\\s](_+)(?!_)(?=[punct])' // (4) ___# can only be Left Delimiter\n    + '|(?!_)[punct](_+)(?!_)(?=[punct])', 'gu') // (5) #___# can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n\nconst anyPunctuation = edit(/\\\\([punct])/, 'gu')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n\nconst autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/)\n    .replace('scheme', /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/)\n    .replace('email',\n        /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,\n    )\n    .getRegex();\n\nconst _inlineComment = edit(_comment).replace('(?:-->|$)', '-->').getRegex();\nconst tag = edit(\n    '^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>') // CDATA section\n    .replace('comment', _inlineComment)\n    .replace('attribute', /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/)\n    .getRegex();\n\nconst _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\n\nconst link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/)\n    .replace('label', _inlineLabel)\n    .replace('href', /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/)\n    .replace('title', /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/)\n    .getRegex();\n\nconst reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/)\n    .replace('label', _inlineLabel)\n    .replace('ref', _blockLabel)\n    .getRegex();\n\nconst nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/)\n    .replace('ref', _blockLabel)\n    .getRegex();\n\nconst reflinkSearch = edit('reflink|nolink(?!\\\\()', 'g')\n    .replace('reflink', reflink)\n    .replace('nolink', nolink)\n    .getRegex();\n\n/**\n * Normal Inline Grammar\n */\n\nconst inlineNormal = {\n    _backpedal: noopTest, // only used for GFM url\n    anyPunctuation,\n    autolink,\n    blockSkip,\n    br,\n    code: inlineCode,\n    del: noopTest,\n    emStrongLDelim,\n    emStrongRDelimAst,\n    emStrongRDelimUnd,\n    escape,\n    link,\n    nolink,\n    punctuation,\n    reflink,\n    reflinkSearch,\n    tag,\n    text: inlineText,\n    url: noopTest,\n};\n\ntype InlineKeys = keyof typeof inlineNormal;\n\n/**\n * Pedantic Inline Grammar\n */\n\nconst inlinePedantic: Record<InlineKeys, RegExp> = {\n    ...inlineNormal,\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n};\n\n/**\n * GFM Inline Grammar\n */\n\nconst inlineGfm: Record<InlineKeys, RegExp> = {\n    ...inlineNormal,\n    escape: edit(escape).replace('])', '~|])').getRegex(),\n    url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, 'i')\n        .replace('email', /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/)\n        .getRegex(),\n    _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/,\n};\n\n/**\n * GFM + Line Breaks Inline Grammar\n */\n\nconst inlineBreaks: Record<InlineKeys, RegExp> = {\n    ...inlineGfm,\n    br: edit(br).replace('{2,}', '*').getRegex(),\n    text: edit(inlineGfm.text)\n        .replace('\\\\b_', '\\\\b_| {2,}\\\\n')\n        .replace(/\\{2,\\}/g, '*')\n        .getRegex(),\n};\n\n/**\n * exports\n */\n\nexport const block = {\n    normal: blockNormal,\n    gfm: blockGfm,\n    pedantic: blockPedantic,\n};\n\nexport const inline = {\n    normal: inlineNormal,\n    gfm: inlineGfm,\n    breaks: inlineBreaks,\n    pedantic: inlinePedantic,\n};\n\nexport interface Rules {\n    block: Record<BlockKeys, RegExp>;\n    inline: Record<InlineKeys, RegExp>;\n}\n","import {_defaults} from './defaults';\nimport {escape, findClosingBracket, rtrim, splitCells} from './helpers';\nimport type {_Lexer} from './Lexer';\nimport type {MarkedOptions} from './MarkedOptions';\nimport type {Rules} from './rules';\nimport type {Links, Tokens} from './Tokens';\n\nfunction outputLink(cap: string[], link: Pick<Tokens.Link, 'href' | 'title'>, raw: string, lexer: _Lexer): Tokens.Link | Tokens.Image {\n    const href = link.href;\n    const title = link.title ? escape(link.title) : null;\n    const text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n\n    if (cap[0].charAt(0) !== '!') {\n        lexer.state.inLink = true;\n        const token: Tokens.Link = {\n            type: 'link',\n            raw,\n            href,\n            title,\n            text,\n            tokens: lexer.inlineTokens(text),\n        };\n        lexer.state.inLink = false;\n        return token;\n    }\n    return {\n        type: 'image',\n        raw,\n        href,\n        title,\n        text: escape(text),\n    };\n}\n\nfunction indentCodeCompensation(raw: string, text: string) {\n    const matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n\n    if (matchIndentToCode === null) {\n        return text;\n    }\n\n    const indentToCode = matchIndentToCode[1];\n\n    return text\n        .split('\\n')\n        .map(node => {\n            const matchIndentInNode = node.match(/^\\s+/);\n            if (matchIndentInNode === null) {\n                return node;\n            }\n\n            const [indentInNode] = matchIndentInNode;\n\n            if (indentInNode.length >= indentToCode.length) {\n                return node.slice(indentToCode.length);\n            }\n\n            return node;\n        })\n        .join('\\n');\n}\n\n/**\n * Tokenizer\n */\nexport class _Tokenizer {\n    lexer!: _Lexer; // set by the lexer\n    options: MarkedOptions;\n    rules!: Rules; // set by the lexer\n\n    constructor(options?: MarkedOptions) {\n        this.options = options || _defaults;\n    }\n\n    autolink(src: string): Tokens.Link | undefined {\n        const cap = this.rules.inline.autolink.exec(src);\n        if (cap) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape(cap[1]);\n                href = 'mailto:' + text;\n            } else {\n                text = escape(cap[1]);\n                href = text;\n            }\n\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text,\n                    },\n                ],\n            };\n        }\n    }\n\n    blockquote(src: string): Tokens.Blockquote | undefined {\n        const cap = this.rules.block.blockquote.exec(src);\n        if (cap) {\n            // precede setext continuation with 4 spaces so it isn't a setext\n            let text = cap[0].replace(/\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g, '\\n    $1');\n            text = rtrim(text.replace(/^ *>[ \\t]?/gm, ''), '\\n');\n            const top = this.lexer.state.top;\n            this.lexer.state.top = true;\n            const tokens = this.lexer.blockTokens(text);\n            this.lexer.state.top = top;\n            return {\n                type: 'blockquote',\n                raw: cap[0],\n                tokens,\n                text,\n            };\n        }\n    }\n\n    br(src: string): Tokens.Br | undefined {\n        const cap = this.rules.inline.br.exec(src);\n        if (cap) {\n            return {\n                type: 'br',\n                raw: cap[0],\n            };\n        }\n    }\n\n    code(src: string): Tokens.Code | undefined {\n        const cap = this.rules.block.code.exec(src);\n        if (cap) {\n            const text = cap[0].replace(/^ {1,4}/gm, '');\n            return {\n                type: 'code',\n                raw: cap[0],\n                codeBlockStyle: 'indented',\n                text: !this.options.pedantic\n                    ? rtrim(text, '\\n')\n                    : text,\n            };\n        }\n    }\n\n    codespan(src: string): Tokens.Codespan | undefined {\n        const cap = this.rules.inline.code.exec(src);\n        if (cap) {\n            let text = cap[2].replace(/\\n/g, ' ');\n            const hasNonSpaceChars = /[^ ]/.test(text);\n            const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n            if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n                text = text.substring(1, text.length - 1);\n            }\n            text = escape(text, true);\n            return {\n                type: 'codespan',\n                raw: cap[0],\n                text,\n            };\n        }\n    }\n\n    def(src: string): Tokens.Def | undefined {\n        const cap = this.rules.block.def.exec(src);\n        if (cap) {\n            const tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n            const href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline.anyPunctuation, '$1') : '';\n            const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation,\n                '$1',\n            ) : cap[3];\n            return {\n                type: 'def',\n                tag,\n                raw: cap[0],\n                href,\n                title,\n            };\n        }\n    }\n\n    del(src: string): Tokens.Del | undefined {\n        const cap = this.rules.inline.del.exec(src);\n        if (cap) {\n            return {\n                type: 'del',\n                raw: cap[0],\n                text: cap[2],\n                tokens: this.lexer.inlineTokens(cap[2]),\n            };\n        }\n    }\n\n    emStrong(src: string, maskedSrc: string, prevChar = ''): Tokens.Em | Tokens.Strong | undefined {\n        let match = this.rules.inline.emStrongLDelim.exec(src);\n        if (!match) {\n            return;\n        }\n\n        // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n        if (match[3] && prevChar.match(/[\\p{L}\\p{N}]/u)) {\n            return;\n        }\n\n        const nextChar = match[1] || match[2] || '';\n\n        if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\n            // unicode Regex counts emoji as 1 char; spread into array for proper count (used multiple times below)\n            const lLength = [...(match as any)[0]].length - 1;\n            let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\n\n            const endReg = match[0][0] === '*'\n                ? this.rules.inline.emStrongRDelimAst\n                : this.rules.inline.emStrongRDelimUnd;\n            endReg.lastIndex = 0;\n\n            // Clip maskedSrc to same section of string as src (move to lexer?)\n            maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n\n            while ((match = endReg.exec(maskedSrc)) != null) {\n                rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n\n                if (!rDelim) {\n                    continue;\n                } // skip single * in __abc*abc__\n\n                rLength = [...rDelim].length;\n\n                if (match[3] || match[4]) { // found another Left Delim\n                    delimTotal += rLength;\n                    continue;\n                } else {\n                    if (match[5] || match[6]) { // either Left or Right Delim\n                        if (lLength % 3 && !((lLength + rLength) % 3)) {\n                            midDelimTotal += rLength;\n                            continue; // CommonMark Emphasis Rules 9-10\n                        }\n                    }\n                }\n\n                delimTotal -= rLength;\n\n                if (delimTotal > 0) {\n                    continue;\n                } // Haven't found enough closing delimiters\n\n                // Remove extra characters. *a*** -> *a*\n                rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n                // char length can be >1 for unicode characters;\n                const lastCharLength = [...(match as any)[0]][0].length;\n                const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\n\n                // Create `em` if smallest delimiter has odd char count. *a***\n                if (Math.min(lLength, rLength) % 2) {\n                    const text = raw.slice(1, -1);\n                    return {\n                        type: 'em',\n                        raw,\n                        text,\n                        tokens: this.lexer.inlineTokens(text),\n                    };\n                }\n\n                // Create 'strong' if smallest delimiter has even char count. **a***\n                const text = raw.slice(2, -2);\n                return {\n                    type: 'strong',\n                    raw,\n                    text,\n                    tokens: this.lexer.inlineTokens(text),\n                };\n            }\n        }\n    }\n\n    escape(src: string): Tokens.Escape | undefined {\n        const cap = this.rules.inline.escape.exec(src);\n        if (cap) {\n            return {\n                type: 'escape',\n                raw: cap[0],\n                text: escape(cap[1]),\n            };\n        }\n    }\n\n    fences(src: string): Tokens.Code | undefined {\n        const cap = this.rules.block.fences.exec(src);\n        if (cap) {\n            const raw = cap[0];\n            const text = indentCodeCompensation(raw, cap[3] || '');\n\n            return {\n                type: 'code',\n                raw,\n                lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, '$1') : cap[2],\n                text,\n            };\n        }\n    }\n\n    heading(src: string): Tokens.Heading | undefined {\n        const cap = this.rules.block.heading.exec(src);\n        if (cap) {\n            let text = cap[2].trim();\n\n            // remove trailing #s\n            if (/#$/.test(text)) {\n                const trimmed = rtrim(text, '#');\n                if (this.options.pedantic) {\n                    text = trimmed.trim();\n                } else {\n                    if (!trimmed || / $/.test(trimmed)) {\n                        // CommonMark requires space before trailing #s\n                        text = trimmed.trim();\n                    }\n                }\n            }\n\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[1].length,\n                text,\n                tokens: this.lexer.inline(text),\n            };\n        }\n    }\n\n    hr(src: string): Tokens.Hr | undefined {\n        const cap = this.rules.block.hr.exec(src);\n        if (cap) {\n            return {\n                type: 'hr',\n                raw: cap[0],\n            };\n        }\n    }\n\n    html(src: string): Tokens.HTML | undefined {\n        const cap = this.rules.block.html.exec(src);\n        if (cap) {\n            const token: Tokens.HTML = {\n                type: 'html',\n                block: true,\n                raw: cap[0],\n                pre: cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style',\n                text: cap[0],\n            };\n            return token;\n        }\n    }\n\n    inlineText(src: string): Tokens.Text | undefined {\n        const cap = this.rules.inline.text.exec(src);\n        if (cap) {\n            let text;\n            if (this.lexer.state.inRawBlock) {\n                text = cap[0];\n            } else {\n                text = escape(cap[0]);\n            }\n            return {\n                type: 'text',\n                raw: cap[0],\n                text,\n            };\n        }\n    }\n\n    lheading(src: string): Tokens.Heading | undefined {\n        const cap = this.rules.block.lheading.exec(src);\n        if (cap) {\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[2].charAt(0) === '=' ? 1 : 2,\n                text: cap[1],\n                tokens: this.lexer.inline(cap[1]),\n            };\n        }\n    }\n\n    link(src: string): Tokens.Link | Tokens.Image | undefined {\n        const cap = this.rules.inline.link.exec(src);\n        if (cap) {\n            const trimmedUrl = cap[2].trim();\n            if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n                // commonmark requires matching angle brackets\n                if (!(/>$/.test(trimmedUrl))) {\n                    return;\n                }\n\n                // ending angle bracket cannot be escaped\n                const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n                if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n                    return;\n                }\n            } else {\n                // find closing parenthesis\n                const lastParenIndex = findClosingBracket(cap[2], '()');\n                if (lastParenIndex > -1) {\n                    const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n                    const linkLen = start + cap[1].length + lastParenIndex;\n                    cap[2] = cap[2].substring(0, lastParenIndex);\n                    cap[0] = cap[0].substring(0, linkLen).trim();\n                    cap[3] = '';\n                }\n            }\n            let href = cap[2];\n            let title = '';\n            if (this.options.pedantic) {\n                // split pedantic href and title\n                const link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n\n                if (link) {\n                    href = link[1];\n                    title = link[3];\n                }\n            } else {\n                title = cap[3] ? cap[3].slice(1, -1) : '';\n            }\n\n            href = href.trim();\n            if (/^</.test(href)) {\n                if (this.options.pedantic && !(/>$/.test(trimmedUrl))) {\n                    // pedantic allows starting angle bracket without ending angle bracket\n                    href = href.slice(1);\n                } else {\n                    href = href.slice(1, -1);\n                }\n            }\n            return outputLink(cap, {\n                href: href ? href.replace(this.rules.inline.anyPunctuation, '$1') : href,\n                title: title ? title.replace(this.rules.inline.anyPunctuation, '$1') : title,\n            }, cap[0], this.lexer);\n        }\n    }\n\n    list(src: string): Tokens.List | undefined {\n        let cap = this.rules.block.list.exec(src);\n        if (cap) {\n            let bull = cap[1].trim();\n            const isordered = bull.length > 1;\n\n            const list: Tokens.List = {\n                type: 'list',\n                raw: '',\n                ordered: isordered,\n                start: isordered ? +bull.slice(0, -1) : '',\n                loose: false,\n                items: [],\n            };\n\n            bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\n\n            if (this.options.pedantic) {\n                bull = isordered ? bull : '[*+-]';\n            }\n\n            // Get next list item\n            const itemRegex = new RegExp(`^( {0,3}${bull})((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))`);\n            let raw = '';\n            let itemContents = '';\n            let endsWithBlankLine = false;\n            // Check if current bullet point can start a new List Item\n            while (src) {\n                let endEarly = false;\n                if (!(cap = itemRegex.exec(src))) {\n                    break;\n                }\n\n                if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)\n                    break;\n                }\n\n                raw = cap[0];\n                src = src.substring(raw.length);\n\n                let line = cap[2].split('\\n', 1)[0].replace(/^\\t+/, (t: string) => ' '.repeat(3 * t.length));\n                let nextLine = src.split('\\n', 1)[0];\n\n                let indent = 0;\n                if (this.options.pedantic) {\n                    indent = 2;\n                    itemContents = line.trimStart();\n                } else {\n                    indent = cap[2].search(/[^ ]/); // Find first non-space char\n                    indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n                    itemContents = line.slice(indent);\n                    indent += cap[1].length;\n                }\n\n                let blankLine = false;\n\n                if (!line && /^ *$/.test(nextLine)) { // Items begin with at most one blank line\n                    raw += nextLine + '\\n';\n                    src = src.substring(nextLine.length + 1);\n                    endEarly = true;\n                }\n\n                if (!endEarly) {\n                    const nextBulletRegex = new RegExp(\n                        `^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \\t][^\\\\n]*)?(?:\\\\n|$))`);\n                    const hrRegex = new RegExp(\n                        `^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`);\n                    const fencesBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`);\n                    const headingBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`);\n\n                    // Check if following lines should be included in List Item\n                    while (src) {\n                        const rawLine = src.split('\\n', 1)[0];\n                        nextLine = rawLine;\n\n                        // Re-align to follow commonmark nesting rules\n                        if (this.options.pedantic) {\n                            nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n                        }\n\n                        // End list item if found code fences\n                        if (fencesBeginRegex.test(nextLine)) {\n                            break;\n                        }\n\n                        // End list item if found start of new heading\n                        if (headingBeginRegex.test(nextLine)) {\n                            break;\n                        }\n\n                        // End list item if found start of new bullet\n                        if (nextBulletRegex.test(nextLine)) {\n                            break;\n                        }\n\n                        // Horizontal rule found\n                        if (hrRegex.test(src)) {\n                            break;\n                        }\n\n                        if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) { // Dedent if possible\n                            itemContents += '\\n' + nextLine.slice(indent);\n                        } else {\n                            // not enough indentation\n                            if (blankLine) {\n                                break;\n                            }\n\n                            // paragraph continuation unless last line was a different block level element\n                            if (line.search(/[^ ]/) >= 4) { // indented code block\n                                break;\n                            }\n                            if (fencesBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (headingBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (hrRegex.test(line)) {\n                                break;\n                            }\n\n                            itemContents += '\\n' + nextLine;\n                        }\n\n                        if (!blankLine && !nextLine.trim()) { // Check if current line is blank\n                            blankLine = true;\n                        }\n\n                        raw += rawLine + '\\n';\n                        src = src.substring(rawLine.length + 1);\n                        line = nextLine.slice(indent);\n                    }\n                }\n\n                if (!list.loose) {\n                    // If the previous item ended with a blank line, the list is loose\n                    if (endsWithBlankLine) {\n                        list.loose = true;\n                    } else {\n                        if (/\\n *\\n *$/.test(raw)) {\n                            endsWithBlankLine = true;\n                        }\n                    }\n                }\n\n                let istask: RegExpExecArray | null = null;\n                let ischecked: boolean | undefined;\n                // Check for task list items\n                if (this.options.gfm) {\n                    istask = /^\\[[ xX]\\] /.exec(itemContents);\n                    if (istask) {\n                        ischecked = istask[0] !== '[ ] ';\n                        itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n                    }\n                }\n\n                list.items.push({\n                    type: 'list_item',\n                    raw,\n                    task: !!istask,\n                    checked: ischecked,\n                    loose: false,\n                    text: itemContents,\n                    tokens: [],\n                });\n\n                list.raw += raw;\n            }\n\n            // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to\n            // simplify/speed up endsWithBlankLine logic\n            list.items[list.items.length - 1].raw = raw.trimEnd();\n            (list.items[list.items.length - 1]).text = itemContents.trimEnd();\n            list.raw = list.raw.trimEnd();\n\n            // Item child tokens handled here at end because we needed to have the final item to trim it first\n            for (let i = 0; i < list.items.length; i++) {\n                this.lexer.state.top = false;\n                list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n\n                if (!list.loose) {\n                    // Check if list should be loose\n                    const spacers = list.items[i].tokens.filter(t => t.type === 'space');\n                    const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => /\\n.*\\n/.test(t.raw));\n\n                    list.loose = hasMultipleLineBreaks;\n                }\n            }\n\n            // Set all items to loose if list is loose\n            if (list.loose) {\n                for (let i = 0; i < list.items.length; i++) {\n                    list.items[i].loose = true;\n                }\n            }\n\n            return list;\n        }\n    }\n\n    paragraph(src: string): Tokens.Paragraph | undefined {\n        const cap = this.rules.block.paragraph.exec(src);\n        if (cap) {\n            const text = cap[1].charAt(cap[1].length - 1) === '\\n'\n                ? cap[1].slice(0, -1)\n                : cap[1];\n            return {\n                type: 'paragraph',\n                raw: cap[0],\n                text,\n                tokens: this.lexer.inline(text),\n            };\n        }\n    }\n\n    reflink(src: string, links: Links): Tokens.Link | Tokens.Image | Tokens.Text | undefined {\n        let cap;\n        if ((cap = this.rules.inline.reflink.exec(src))\n            || (cap = this.rules.inline.nolink.exec(src))) {\n            const linkString = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n            const link = links[linkString.toLowerCase()];\n            if (!link) {\n                const text = cap[0].charAt(0);\n                return {\n                    type: 'text',\n                    raw: text,\n                    text,\n                };\n            }\n            return outputLink(cap, link, cap[0], this.lexer);\n        }\n    }\n\n    space(src: string): Tokens.Space | undefined {\n        const cap = this.rules.block.newline.exec(src);\n        if (cap && cap[0].length > 0) {\n            return {\n                type: 'space',\n                raw: cap[0],\n            };\n        }\n    }\n\n    table(src: string): Tokens.Table | undefined {\n        const cap = this.rules.block.table.exec(src);\n        if (!cap) {\n            return;\n        }\n\n        if (!/[:|]/.test(cap[2])) {\n            // delimiter row must have a pipe (|) or colon (:) otherwise it is a setext heading\n            return;\n        }\n\n        const headers = splitCells(cap[1]);\n        const aligns = cap[2].replace(/^\\||\\| *$/g, '').split('|');\n        const rows = cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : [];\n\n        const item: Tokens.Table = {\n            type: 'table',\n            raw: cap[0],\n            header: [],\n            align: [],\n            rows: [],\n        };\n\n        if (headers.length !== aligns.length) {\n            // header and align columns must be equal, rows can be different.\n            return;\n        }\n\n        for (const align of aligns) {\n            if (/^ *-+: *$/.test(align)) {\n                item.align.push('right');\n            } else {\n                if (/^ *:-+: *$/.test(align)) {\n                    item.align.push('center');\n                } else {\n                    if (/^ *:-+ *$/.test(align)) {\n                        item.align.push('left');\n                    } else {\n                        item.align.push(null);\n                    }\n                }\n            }\n        }\n\n        for (const header of headers) {\n            item.header.push({\n                text: header,\n                tokens: this.lexer.inline(header),\n            });\n        }\n\n        for (const row of rows) {\n            item.rows.push(splitCells(row, item.header.length).map(cell => {\n                return {\n                    text: cell,\n                    tokens: this.lexer.inline(cell),\n                };\n            }));\n        }\n\n        return item;\n    }\n\n    tag(src: string): Tokens.Tag | undefined {\n        const cap = this.rules.inline.tag.exec(src);\n        if (cap) {\n            if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n                this.lexer.state.inLink = true;\n            } else {\n                if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n                    this.lexer.state.inLink = false;\n                }\n            }\n            if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = true;\n            } else {\n                if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                    this.lexer.state.inRawBlock = false;\n                }\n            }\n\n            return {\n                type: 'html',\n                raw: cap[0],\n                inLink: this.lexer.state.inLink,\n                inRawBlock: this.lexer.state.inRawBlock,\n                block: false,\n                text: cap[0],\n            };\n        }\n    }\n\n    text(src: string): Tokens.Text | undefined {\n        const cap = this.rules.block.text.exec(src);\n        if (cap) {\n            return {\n                type: 'text',\n                raw: cap[0],\n                text: cap[0],\n                tokens: this.lexer.inline(cap[0]),\n            };\n        }\n    }\n\n    url(src: string): Tokens.Link | undefined {\n        let cap;\n        if (cap = this.rules.inline.url.exec(src)) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape(cap[0]);\n                href = 'mailto:' + text;\n            } else {\n                // do extended autolink path validation\n                let prevCapZero;\n                do {\n                    prevCapZero = cap[0];\n                    cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? '';\n                }\n                while (prevCapZero !== cap[0]);\n                text = escape(cap[0]);\n                if (cap[1] === 'www.') {\n                    href = 'http://' + cap[0];\n                } else {\n                    href = cap[0];\n                }\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text,\n                    },\n                ],\n            };\n        }\n    }\n}\n","import {_defaults} from './defaults';\nimport type {MarkedOptions, TokenizerExtension} from './MarkedOptions';\nimport {block, inline} from './rules';\nimport {_Tokenizer} from './Tokenizer';\nimport type {Token, Tokens, TokensList} from './Tokens';\n\n/**\n * Block Lexer\n */\nexport class _Lexer {\n    options: MarkedOptions;\n    state: {\n        inLink: boolean;\n        inRawBlock: boolean;\n        top: boolean;\n    };\n    tokens: TokensList;\n    private inlineQueue: {src: string, tokens: Token[]}[];\n    private tokenizer: _Tokenizer;\n\n    constructor(options?: MarkedOptions) {\n        // TokenList cannot be created in one go\n        this.tokens = [] as unknown as TokensList;\n        this.tokens.links = Object.create(null);\n        this.options = options || _defaults;\n        this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\n        this.tokenizer = this.options.tokenizer;\n        this.tokenizer.options = this.options;\n        this.tokenizer.lexer = this;\n        this.inlineQueue = [];\n        this.state = {\n            inLink: false,\n            inRawBlock: false,\n            top: true,\n        };\n\n        const rules = {\n            block: block.normal,\n            inline: inline.normal,\n        };\n\n        if (this.options.pedantic) {\n            rules.block = block.pedantic;\n            rules.inline = inline.pedantic;\n        } else {\n            if (this.options.gfm) {\n                rules.block = block.gfm;\n                if (this.options.breaks) {\n                    rules.inline = inline.breaks;\n                } else {\n                    rules.inline = inline.gfm;\n                }\n            }\n        }\n        this.tokenizer.rules = rules;\n    }\n\n    /**\n     * Expose Rules\n     */\n    static get rules() {\n        return {\n            block,\n            inline,\n        };\n    }\n\n    /**\n     * Static Lex Method\n     */\n    static lex(src: string, options?: MarkedOptions) {\n        const lexer = new _Lexer(options);\n        return lexer.lex(src);\n    }\n\n    /**\n     * Static Lex Inline Method\n     */\n    static lexInline(src: string, options?: MarkedOptions) {\n        const lexer = new _Lexer(options);\n        return lexer.inlineTokens(src);\n    }\n\n    /**\n     * Lexing\n     */\n    blockTokens(src: string, tokens?: Token[]): Token[];\n\n    blockTokens(src: string, tokens?: TokensList): TokensList;\n\n    blockTokens(src: string, tokens: Token[] = []) {\n        if (this.options.pedantic) {\n            src = src.replace(/\\t/g, '    ').replace(/^ +$/gm, '');\n        } else {\n            src = src.replace(/^( *)(\\t+)/gm, (_, leading, tabs) => {\n                return leading + '    '.repeat(tabs.length);\n            });\n        }\n\n        let token: Tokens.Generic | undefined;\n        let lastToken;\n        let cutSrc;\n        let lastParagraphClipped;\n\n        while (src) {\n            if (this.options.extensions\n                && this.options.extensions.block\n                && this.options.extensions.block.some((extTokenizer: TokenizerExtension['tokenizer']) => {\n                    if (token = extTokenizer.call({lexer: this}, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n\n            // newline\n            if (token = this.tokenizer.space(src)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.length === 1 && tokens.length > 0) {\n                    // if there's a single \\n as a spacer, it's terminating the last line,\n                    // so move it there so that we don't get unnecessary paragraph tags\n                    tokens[tokens.length - 1].raw += '\\n';\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            // code\n            if (token = this.tokenizer.code(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                // An indented code block cannot interrupt a paragraph.\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            // fences\n            if (token = this.tokenizer.fences(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // heading\n            if (token = this.tokenizer.heading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // hr\n            if (token = this.tokenizer.hr(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // blockquote\n            if (token = this.tokenizer.blockquote(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // list\n            if (token = this.tokenizer.list(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // html\n            if (token = this.tokenizer.html(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // def\n            if (token = this.tokenizer.def(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.raw;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                } else {\n                    if (!this.tokens.links[token.tag]) {\n                        this.tokens.links[token.tag] = {\n                            href: token.href,\n                            title: token.title,\n                        };\n                    }\n                }\n                continue;\n            }\n\n            // table (gfm)\n            if (token = this.tokenizer.table(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // lheading\n            if (token = this.tokenizer.lheading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // top-level paragraph\n            // prevent paragraph consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startBlock) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startBlock.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({lexer: this}, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n                lastToken = tokens[tokens.length - 1];\n                if (lastParagraphClipped && lastToken.type === 'paragraph') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                } else {\n                    tokens.push(token);\n                }\n                lastParagraphClipped = (cutSrc.length !== src.length);\n                src = src.substring(token.raw.length);\n                continue;\n            }\n\n            // text\n            if (token = this.tokenizer.text(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                } else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n\n        this.state.top = true;\n        return tokens;\n    }\n\n    inline(src: string, tokens: Token[] = []) {\n        this.inlineQueue.push({src, tokens});\n        return tokens;\n    }\n\n    /**\n     * Lexing/Compiling\n     */\n    inlineTokens(src: string, tokens: Token[] = []): Token[] {\n        let token, lastToken, cutSrc;\n\n        // String with links masked to avoid interference with em and strong\n        let maskedSrc = src;\n        let match;\n        let keepPrevChar, prevChar;\n\n        // Mask out reflinks\n        if (this.tokens.links) {\n            const links = Object.keys(this.tokens.links);\n            if (links.length > 0) {\n                while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n                    if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n                        maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']'\n                            + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n                    }\n                }\n            }\n        }\n        // Mask out other blocks\n        while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(\n                this.tokenizer.rules.inline.blockSkip.lastIndex);\n        }\n\n        // Mask out escaped characters\n        while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(\n                this.tokenizer.rules.inline.anyPunctuation.lastIndex);\n        }\n\n        while (src) {\n            if (!keepPrevChar) {\n                prevChar = '';\n            }\n            keepPrevChar = false;\n\n            // extensions\n            if (this.options.extensions\n                && this.options.extensions.inline\n                && this.options.extensions.inline.some((extTokenizer) => {\n                    if (token = extTokenizer.call({lexer: this}, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n\n            // escape\n            if (token = this.tokenizer.escape(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // tag\n            if (token = this.tokenizer.tag(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            // link\n            if (token = this.tokenizer.link(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // reflink, nolink\n            if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            // em & strong\n            if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // code\n            if (token = this.tokenizer.codespan(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // br\n            if (token = this.tokenizer.br(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // del (gfm)\n            if (token = this.tokenizer.del(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // autolink\n            if (token = this.tokenizer.autolink(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // url (gfm)\n            if (!this.state.inLink && (token = this.tokenizer.url(src))) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // text\n            // prevent inlineText consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startInline) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startInline.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({lexer: this}, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (token = this.tokenizer.inlineText(cutSrc)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started\n                    prevChar = token.raw.slice(-1);\n                }\n                keepPrevChar = true;\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                } else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n\n        return tokens;\n    }\n\n    /**\n     * Preprocessing\n     */\n    lex(src: string) {\n        src = src\n            .replace(/\\r\\n|\\r/g, '\\n');\n\n        this.blockTokens(src, this.tokens);\n\n        for (let i = 0; i < this.inlineQueue.length; i++) {\n            const next = this.inlineQueue[i];\n            this.inlineTokens(next.src, next.tokens);\n        }\n        this.inlineQueue = [];\n\n        return this.tokens;\n    }\n}\n","import {_defaults} from './defaults';\nimport {cleanUrl, escape} from './helpers';\nimport type {MarkedOptions} from './MarkedOptions';\n\n/**\n * Renderer\n */\nexport class _Renderer {\n    options: MarkedOptions;\n\n    constructor(options?: MarkedOptions) {\n        this.options = options || _defaults;\n    }\n\n    blockquote(quote: string): string {\n        return `<blockquote>\\n${quote}</blockquote>\\n`;\n    }\n\n    br(): string {\n        return '<br>';\n    }\n\n    checkbox(checked: boolean): string {\n        return '<input '\n            + (checked ? 'checked=\"\" ' : '')\n            + 'disabled=\"\" type=\"checkbox\">';\n    }\n\n    code(code: string, infostring: string | undefined, escaped: boolean): string {\n        const lang = (infostring || '').match(/^\\S*/)?.[0];\n\n        code = code.replace(/\\n$/, '') + '\\n';\n\n        if (!lang) {\n            return '<pre><code>'\n                + (escaped ? code : escape(code, true))\n                + '</code></pre>\\n';\n        }\n\n        return '<pre><code class=\"language-'\n            + escape(lang)\n            + '\">'\n            + (escaped ? code : escape(code, true))\n            + '</code></pre>\\n';\n    }\n\n    codespan(text: string): string {\n        return `<code>${text}</code>`;\n    }\n\n    del(text: string): string {\n        return `<del>${text}</del>`;\n    }\n\n    em(text: string): string {\n        return `<em>${text}</em>`;\n    }\n\n    heading(text: string, level: number, raw: string): string {\n        // ignore IDs\n        return `<h${level}>${text}</h${level}>\\n`;\n    }\n\n    hr(): string {\n        return '<hr>\\n';\n    }\n\n    html(html: string, block?: boolean): string {\n        return html;\n    }\n\n    image(href: string, title: string | null, text: string): string {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n\n        let out = `<img src=\"${href}\" alt=\"${text}\"`;\n        if (title) {\n            out += ` title=\"${title}\"`;\n        }\n        out += '>';\n        return out;\n    }\n\n    link(href: string, title: string | null | undefined, text: string): string {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = '<a href=\"' + href + '\"';\n        if (title) {\n            out += ' title=\"' + title + '\"';\n        }\n        out += '>' + text + '</a>';\n        return out;\n    }\n\n    list(body: string, ordered: boolean, start: number | ''): string {\n        const type = ordered ? 'ol' : 'ul';\n        const startatt = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n        return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n    }\n\n    listitem(text: string, task: boolean, checked: boolean): string {\n        return `<li>${text}</li>\\n`;\n    }\n\n    paragraph(text: string): string {\n        return `<p>${text}</p>\\n`;\n    }\n\n    /**\n     * span level renderer\n     */\n    strong(text: string): string {\n        return `<strong>${text}</strong>`;\n    }\n\n    table(header: string, body: string): string {\n        if (body) {\n            body = `<tbody>${body}</tbody>`;\n        }\n\n        return '<table>\\n'\n            + '<thead>\\n'\n            + header\n            + '</thead>\\n'\n            + body\n            + '</table>\\n';\n    }\n\n    tablecell(content: string, flags: {\n        header: boolean;\n        align: 'center' | 'left' | 'right' | null;\n    }): string {\n        const type = flags.header ? 'th' : 'td';\n        const tag = flags.align\n            ? `<${type} align=\"${flags.align}\">`\n            : `<${type}>`;\n        return tag + content + `</${type}>\\n`;\n    }\n\n    tablerow(content: string): string {\n        return `<tr>\\n${content}</tr>\\n`;\n    }\n\n    text(text: string): string {\n        return text;\n    }\n}\n","/**\n * TextRenderer\n * returns only the textual part of the token\n */\nexport class _TextRenderer {\n    br() {\n        return '';\n    }\n\n    codespan(text: string) {\n        return text;\n    }\n\n    del(text: string) {\n        return text;\n    }\n\n    em(text: string) {\n        return text;\n    }\n\n    html(text: string) {\n        return text;\n    }\n\n    image(href: string, title: string | null, text: string) {\n        return '' + text;\n    }\n\n    link(href: string, title: string | null | undefined, text: string) {\n        return '' + text;\n    }\n\n    // no need for block level renderers\n    strong(text: string) {\n        return text;\n    }\n\n    text(text: string) {\n        return text;\n    }\n}\n","import {_defaults} from './defaults';\nimport {unescape} from './helpers';\nimport type {MarkedOptions} from './MarkedOptions';\nimport {_Renderer} from './Renderer';\nimport {_TextRenderer} from './TextRenderer';\nimport type {Token, Tokens} from './Tokens';\n\n/**\n * Parsing & Compiling\n */\nexport class _Parser {\n    options: MarkedOptions;\n    renderer: _Renderer;\n    textRenderer: _TextRenderer;\n\n    constructor(options?: MarkedOptions) {\n        this.options = options || _defaults;\n        this.options.renderer = this.options.renderer || new _Renderer();\n        this.renderer = this.options.renderer;\n        this.renderer.options = this.options;\n        this.textRenderer = new _TextRenderer();\n    }\n\n    /**\n     * Static Parse Method\n     */\n    static parse(tokens: Token[], options?: MarkedOptions) {\n        const parser = new _Parser(options);\n        return parser.parse(tokens);\n    }\n\n    /**\n     * Static Parse Inline Method\n     */\n    static parseInline(tokens: Token[], options?: MarkedOptions) {\n        const parser = new _Parser(options);\n        return parser.parseInline(tokens);\n    }\n\n    /**\n     * Parse Loop\n     */\n    parse(tokens: Token[], top = true): string {\n        let out = '';\n\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers\n                && this.options.extensions.renderers[token.type]) {\n                const genericToken = token as Tokens.Generic;\n                const ret = this.options.extensions.renderers[genericToken.type].call({parser: this}, genericToken);\n                if (ret !== false || ![\n                    'space',\n                    'hr',\n                    'heading',\n                    'code',\n                    'table',\n                    'blockquote',\n                    'list',\n                    'html',\n                    'paragraph',\n                    'text',\n                ].includes(genericToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n\n            switch (token.type) {\n                case 'space': {\n                    continue;\n                }\n                case 'hr': {\n                    out += this.renderer.hr();\n                    continue;\n                }\n                case 'heading': {\n                    const headingToken = token as Tokens.Heading;\n                    out += this.renderer.heading(\n                        this.parseInline(headingToken.tokens),\n                        headingToken.depth,\n                        unescape(this.parseInline(headingToken.tokens, this.textRenderer)),\n                    );\n                    continue;\n                }\n                case 'code': {\n                    const codeToken = token as Tokens.Code;\n                    out += this.renderer.code(codeToken.text,\n                        codeToken.lang,\n                        !!codeToken.escaped,\n                    );\n                    continue;\n                }\n                case 'table': {\n                    const tableToken = token as Tokens.Table;\n                    let header = '';\n\n                    // header\n                    let cell = '';\n                    for (let j = 0; j < tableToken.header.length; j++) {\n                        cell += this.renderer.tablecell(\n                            this.parseInline(tableToken.header[j].tokens),\n                            {header: true, align: tableToken.align[j]},\n                        );\n                    }\n                    header += this.renderer.tablerow(cell);\n\n                    let body = '';\n                    for (let j = 0; j < tableToken.rows.length; j++) {\n                        const row = tableToken.rows[j];\n\n                        cell = '';\n                        for (let k = 0; k < row.length; k++) {\n                            cell += this.renderer.tablecell(\n                                this.parseInline(row[k].tokens),\n                                {header: false, align: tableToken.align[k]},\n                            );\n                        }\n\n                        body += this.renderer.tablerow(cell);\n                    }\n                    out += this.renderer.table(header, body);\n                    continue;\n                }\n                case 'blockquote': {\n                    const blockquoteToken = token as Tokens.Blockquote;\n                    const body = this.parse(blockquoteToken.tokens);\n                    out += this.renderer.blockquote(body);\n                    continue;\n                }\n                case 'list': {\n                    const listToken = token as Tokens.List;\n                    const ordered = listToken.ordered;\n                    const start = listToken.start;\n                    const loose = listToken.loose;\n\n                    let body = '';\n                    for (let j = 0; j < listToken.items.length; j++) {\n                        const item = listToken.items[j];\n                        const checked = item.checked;\n                        const task = item.task;\n\n                        let itemBody = '';\n                        if (item.task) {\n                            const checkbox = this.renderer.checkbox(!!checked);\n                            if (loose) {\n                                if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0\n                                        && item.tokens[0].tokens[0].type === 'text') {\n                                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                                    }\n                                } else {\n                                    item.tokens.unshift({\n                                        type: 'text',\n                                        text: checkbox + ' ',\n                                    } as Tokens.Text);\n                                }\n                            } else {\n                                itemBody += checkbox + ' ';\n                            }\n                        }\n\n                        itemBody += this.parse(item.tokens, loose);\n                        body += this.renderer.listitem(itemBody, task, !!checked);\n                    }\n\n                    out += this.renderer.list(body, ordered, start);\n                    continue;\n                }\n                case 'html': {\n                    const htmlToken = token as Tokens.HTML;\n                    out += this.renderer.html(htmlToken.text, htmlToken.block);\n                    continue;\n                }\n                case 'paragraph': {\n                    const paragraphToken = token as Tokens.Paragraph;\n                    out += this.renderer.paragraph(this.parseInline(paragraphToken.tokens));\n                    continue;\n                }\n                case 'text': {\n                    let textToken = token as Tokens.Text;\n                    let body = textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text;\n                    while (i + 1 < tokens.length && tokens[i + 1].type === 'text') {\n                        textToken = tokens[++i] as Tokens.Text;\n                        body += '\\n' + (textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text);\n                    }\n                    out += top ? this.renderer.paragraph(body) : body;\n                    continue;\n                }\n\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    } else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n\n        return out;\n    }\n\n    /**\n     * Parse Inline Tokens\n     */\n    parseInline(tokens: Token[], renderer?: _Renderer | _TextRenderer): string {\n        renderer = renderer || this.renderer;\n        let out = '';\n\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers\n                && this.options.extensions.renderers[token.type]) {\n                const ret = this.options.extensions.renderers[token.type].call({parser: this}, token);\n                if (ret !== false || ![\n                    'escape',\n                    'html',\n                    'link',\n                    'image',\n                    'strong',\n                    'em',\n                    'codespan',\n                    'br',\n                    'del',\n                    'text',\n                ].includes(token.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n\n            switch (token.type) {\n                case 'escape': {\n                    const escapeToken = token as Tokens.Escape;\n                    out += renderer.text(escapeToken.text);\n                    break;\n                }\n                case 'html': {\n                    const tagToken = token as Tokens.Tag;\n                    out += renderer.html(tagToken.text);\n                    break;\n                }\n                case 'link': {\n                    const linkToken = token as Tokens.Link;\n                    out += renderer.link(linkToken.href, linkToken.title, this.parseInline(linkToken.tokens, renderer));\n                    break;\n                }\n                case 'image': {\n                    const imageToken = token as Tokens.Image;\n                    out += renderer.image(imageToken.href, imageToken.title, imageToken.text);\n                    break;\n                }\n                case 'strong': {\n                    const strongToken = token as Tokens.Strong;\n                    out += renderer.strong(this.parseInline(strongToken.tokens, renderer));\n                    break;\n                }\n                case 'em': {\n                    const emToken = token as Tokens.Em;\n                    out += renderer.em(this.parseInline(emToken.tokens, renderer));\n                    break;\n                }\n                case 'codespan': {\n                    const codespanToken = token as Tokens.Codespan;\n                    out += renderer.codespan(codespanToken.text);\n                    break;\n                }\n                case 'br': {\n                    out += renderer.br();\n                    break;\n                }\n                case 'del': {\n                    const delToken = token as Tokens.Del;\n                    out += renderer.del(this.parseInline(delToken.tokens, renderer));\n                    break;\n                }\n                case 'text': {\n                    const textToken = token as Tokens.Text;\n                    out += renderer.text(textToken.text);\n                    break;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    } else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n}\n","import {_getDefaults} from './defaults';\nimport {escape} from './helpers';\nimport {_Hooks} from './Hooks';\nimport {_Lexer} from './Lexer';\nimport type {MarkedExtension, MarkedOptions} from './MarkedOptions';\nimport {_Parser} from './Parser';\nimport {_Renderer} from './Renderer';\nimport {_TextRenderer} from './TextRenderer';\nimport {_Tokenizer} from './Tokenizer';\nimport type {Token, Tokens, TokensList} from './Tokens';\n\nexport type MaybePromise = void | Promise<void>;\n\ntype UnknownFunction = (...args: unknown[]) => unknown;\ntype GenericRendererFunction = (...args: unknown[]) => string | false;\n\nexport class Marked {\n    Hooks = _Hooks;\n    Lexer = _Lexer;\n    Parser = _Parser;\n    Renderer = _Renderer;\n    TextRenderer = _TextRenderer;\n    Tokenizer = _Tokenizer;\n    defaults = _getDefaults();\n    options = this.setOptions;\n    parse = this.#parseMarkdown(_Lexer.lex, _Parser.parse);\n    parseInline = this.#parseMarkdown(_Lexer.lexInline, _Parser.parseInline);\n\n    constructor(...args: MarkedExtension[]) {\n        this.use(...args);\n    }\n\n    lexer(src: string, options?: MarkedOptions) {\n        return _Lexer.lex(src, options ?? this.defaults);\n    }\n\n    parser(tokens: Token[], options?: MarkedOptions) {\n        return _Parser.parse(tokens, options ?? this.defaults);\n    }\n\n    setOptions(opt: MarkedOptions) {\n        this.defaults = {...this.defaults, ...opt};\n        return this;\n    }\n\n    use(...args: MarkedExtension[]) {\n        const extensions: MarkedOptions['extensions'] = this.defaults.extensions || {renderers: {}, childTokens: {}};\n\n        args.forEach((pack) => {\n            // copy options to new object\n            const opts = {...pack} as unknown as MarkedOptions;\n\n            // set async to true if it was set to true before\n            opts.async = this.defaults.async || opts.async || false;\n\n            // ==-- Parse \"addon\" extensions --== //\n            if (pack.extensions) {\n                pack.extensions.forEach((ext) => {\n                    if (!ext.name) {\n                        throw new Error('extension name required');\n                    }\n                    if ('renderer' in ext) { // Renderer extensions\n                        const prevRenderer = extensions.renderers[ext.name];\n                        if (prevRenderer) {\n                            // Replace extension with func to run new extension but fall back if false\n                            extensions.renderers[ext.name] = function (...args) {\n                                let ret = ext.renderer.apply(this, args);\n                                if (ret === false) {\n                                    ret = prevRenderer.apply(this, args);\n                                }\n                                return ret;\n                            };\n                        } else {\n                            extensions.renderers[ext.name] = ext.renderer;\n                        }\n                    }\n                    if ('tokenizer' in ext) { // Tokenizer Extensions\n                        if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {\n                            throw new Error('extension level must be \\'block\\' or \\'inline\\'');\n                        }\n                        const extLevel = extensions[ext.level];\n                        if (extLevel) {\n                            extLevel.unshift(ext.tokenizer);\n                        } else {\n                            extensions[ext.level] = [ext.tokenizer];\n                        }\n                        if (ext.start) { // Function to check for start of token\n                            if (ext.level === 'block') {\n                                if (extensions.startBlock) {\n                                    extensions.startBlock.push(ext.start);\n                                } else {\n                                    extensions.startBlock = [ext.start];\n                                }\n                            } else {\n                                if (ext.level === 'inline') {\n                                    if (extensions.startInline) {\n                                        extensions.startInline.push(ext.start);\n                                    } else {\n                                        extensions.startInline = [ext.start];\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if ('childTokens' in ext && ext.childTokens) { // Child tokens to be visited by walkTokens\n                        extensions.childTokens[ext.name] = ext.childTokens;\n                    }\n                });\n                opts.extensions = extensions;\n            }\n\n            // ==-- Parse \"overwrite\" extensions --== //\n            if (pack.renderer) {\n                const renderer = this.defaults.renderer || new _Renderer(this.defaults);\n                for (const prop in pack.renderer) {\n                    if (!(prop in renderer)) {\n                        throw new Error(`renderer '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const rendererProp = prop as Exclude<keyof _Renderer, 'options'>;\n                    const rendererFunc = pack.renderer[rendererProp] as GenericRendererFunction;\n                    const prevRenderer = renderer[rendererProp] as GenericRendererFunction;\n                    // Replace renderer with func to run extension, but fall back if false\n                    renderer[rendererProp] = (...args: unknown[]) => {\n                        let ret = rendererFunc.apply(renderer, args);\n                        if (ret === false) {\n                            ret = prevRenderer.apply(renderer, args);\n                        }\n                        return ret || '';\n                    };\n                }\n                opts.renderer = renderer;\n            }\n            if (pack.tokenizer) {\n                const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\n                for (const prop in pack.tokenizer) {\n                    if (!(prop in tokenizer)) {\n                        throw new Error(`tokenizer '${prop}' does not exist`);\n                    }\n                    if (['options', 'rules', 'lexer'].includes(prop)) {\n                        // ignore options, rules, and lexer properties\n                        continue;\n                    }\n                    const tokenizerProp = prop as Exclude<keyof _Tokenizer, 'options' | 'rules' | 'lexer'>;\n                    const tokenizerFunc = pack.tokenizer[tokenizerProp] as UnknownFunction;\n                    const prevTokenizer = tokenizer[tokenizerProp] as UnknownFunction;\n\n                    // Replace tokenizer with func to run extension, but fall back if false\n                    // @ts-ignore\n                    tokenizer[tokenizerProp] = (...args: unknown[]) => {\n                        let ret = tokenizerFunc.apply(tokenizer, args);\n                        if (ret === false) {\n                            ret = prevTokenizer.apply(tokenizer, args);\n                        }\n                        return ret;\n                    };\n                }\n                opts.tokenizer = tokenizer;\n            }\n\n            // ==-- Parse Hooks extensions --== //\n            if (pack.hooks) {\n                const hooks = this.defaults.hooks || new _Hooks();\n                for (const prop in pack.hooks) {\n                    if (!(prop in hooks)) {\n                        throw new Error(`hook '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const hooksProp = prop as Exclude<keyof _Hooks, 'options'>;\n                    const hooksFunc = pack.hooks[hooksProp] as UnknownFunction;\n                    const prevHook = hooks[hooksProp] as UnknownFunction;\n                    if (_Hooks.passThroughHooks.has(prop)) {\n                        // @ts-ignore\n                        hooks[hooksProp] = (arg: unknown) => {\n                            if (this.defaults.async) {\n                                return Promise.resolve(hooksFunc.call(hooks, arg)).then(ret => {\n                                    return prevHook.call(hooks, ret);\n                                });\n                            }\n\n                            const ret = hooksFunc.call(hooks, arg);\n                            return prevHook.call(hooks, ret);\n                        };\n                    } else {\n                        // @ts-ignore\n                        hooks[hooksProp] = (...args: unknown[]) => {\n                            let ret = hooksFunc.apply(hooks, args);\n                            if (ret === false) {\n                                ret = prevHook.apply(hooks, args);\n                            }\n                            return ret;\n                        };\n                    }\n                }\n                opts.hooks = hooks;\n            }\n\n            // ==-- Parse WalkTokens extensions --== //\n            if (pack.walkTokens) {\n                const walkTokens = this.defaults.walkTokens;\n                const packWalktokens = pack.walkTokens;\n                opts.walkTokens = function (token) {\n                    let values: MaybePromise[] = [];\n                    values.push(packWalktokens.call(this, token));\n                    if (walkTokens) {\n                        values = values.concat(walkTokens.call(this, token));\n                    }\n                    return values;\n                };\n            }\n\n            this.defaults = {...this.defaults, ...opts};\n        });\n\n        return this;\n    }\n\n    /**\n     * Run callback for every token\n     */\n    walkTokens(tokens: Token[] | TokensList, callback: (token: Token) => MaybePromise | MaybePromise[]) {\n        let values: MaybePromise[] = [];\n        for (const token of tokens) {\n            values = values.concat(callback.call(this, token));\n            switch (token.type) {\n                case 'table': {\n                    const tableToken = token as Tokens.Table;\n                    for (const cell of tableToken.header) {\n                        values = values.concat(this.walkTokens(cell.tokens, callback));\n                    }\n                    for (const row of tableToken.rows) {\n                        for (const cell of row) {\n                            values = values.concat(this.walkTokens(cell.tokens, callback));\n                        }\n                    }\n                    break;\n                }\n                case 'list': {\n                    const listToken = token as Tokens.List;\n                    values = values.concat(this.walkTokens(listToken.items, callback));\n                    break;\n                }\n                default: {\n                    const genericToken = token as Tokens.Generic;\n                    if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\n                        this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\n                            const tokens = genericToken[childTokens].flat(Infinity) as Token[] | TokensList;\n                            values = values.concat(this.walkTokens(tokens, callback));\n                        });\n                    } else {\n                        if (genericToken.tokens) {\n                            values = values.concat(this.walkTokens(genericToken.tokens, callback));\n                        }\n                    }\n                }\n            }\n        }\n        return values;\n    }\n\n    // @ts-ignore\n    #onError(silent: boolean, async: boolean) {\n        return (e: Error): string | Promise<string> => {\n            e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n\n            if (silent) {\n                const msg = '<p>An error occurred:</p><pre>'\n                    + escape(e.message + '', true)\n                    + '</pre>';\n                if (async) {\n                    return Promise.resolve(msg);\n                }\n                return msg;\n            }\n\n            if (async) {\n                return Promise.reject(e);\n            }\n            throw e;\n        };\n    }\n\n    // @ts-ignore\n    #parseMarkdown(lexer: (src: string, options?: MarkedOptions) => TokensList | Token[], parser: (tokens: Token[], options?: MarkedOptions) => string) {\n        return (src: string, options?: MarkedOptions | undefined | null): string | Promise<string> => {\n            const origOpt = {...options};\n            const opt = {...this.defaults, ...origOpt};\n\n            // Show warning if an extension set async to true but the parse was called with async: false\n            if (this.defaults.async === true && origOpt.async === false) {\n                if (!opt.silent) {\n                    console.warn(\n                        'marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored.');\n                }\n\n                opt.async = true;\n            }\n\n            const throwError = this.#onError(!!opt.silent, !!opt.async);\n\n            // throw error in case of non string input\n            if (typeof src === 'undefined' || src === null) {\n                return throwError(new Error('marked(): input parameter is undefined or null'));\n            }\n            if (typeof src !== 'string') {\n                return throwError(new Error('marked(): input parameter is of type '\n                    + Object.prototype.toString.call(src) + ', string expected'));\n            }\n\n            if (opt.hooks) {\n                opt.hooks.options = opt;\n            }\n\n            if (opt.async) {\n                return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src)\n                              .then(src => lexer(src, opt))\n                              .then(tokens => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens)\n                              .then(\n                                  tokens => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(\n                                      () => tokens) : tokens)\n                              .then(tokens => parser(tokens, opt))\n                              .then(html => opt.hooks ? opt.hooks.postprocess(html) : html)\n                              .catch(throwError);\n            }\n\n            try {\n                if (opt.hooks) {\n                    src = opt.hooks.preprocess(src) as string;\n                }\n                let tokens = lexer(src, opt);\n                if (opt.hooks) {\n                    tokens = opt.hooks.processAllTokens(tokens) as Token[] | TokensList;\n                }\n                if (opt.walkTokens) {\n                    this.walkTokens(tokens, opt.walkTokens);\n                }\n                let html = parser(tokens, opt);\n                if (opt.hooks) {\n                    html = opt.hooks.postprocess(html) as string;\n                }\n                return html;\n            } catch (e) {\n                return throwError(e as Error);\n            }\n        };\n    }\n}\n","import {_defaults, _getDefaults, changeDefaults} from './defaults';\nimport {_Hooks} from './Hooks';\nimport type {MaybePromise} from './Instance';\nimport {Marked} from './Instance';\nimport {_Lexer} from './Lexer';\nimport type {MarkedExtension, MarkedOptions} from './MarkedOptions';\nimport {_Parser} from './Parser';\nimport {_Renderer} from './Renderer';\nimport {_TextRenderer} from './TextRenderer';\nimport {_Tokenizer} from './Tokenizer';\nimport type {Token, TokensList} from './Tokens';\n\nconst markedInstance = new Marked();\n\nexport function marked(src: string, opt?: MarkedOptions): string | Promise<string> {\n    return markedInstance.parse(src, opt);\n}\n\n/**\n * Sets the default options.\n *\n * @param options Hash of options\n */\nmarked.options =\n    marked.setOptions = function (options: MarkedOptions) {\n        markedInstance.setOptions(options);\n        marked.defaults = markedInstance.defaults;\n        changeDefaults(marked.defaults);\n        return marked;\n    };\n\n/**\n * Gets the original marked default options.\n */\nmarked.getDefaults = _getDefaults;\n\nmarked.defaults = _defaults;\n\n/**\n * Use Extension\n */\n\nmarked.use = function (...args: MarkedExtension[]) {\n    markedInstance.use(...args);\n    marked.defaults = markedInstance.defaults;\n    changeDefaults(marked.defaults);\n    return marked;\n};\n\n/**\n * Run callback for every token\n */\n\nmarked.walkTokens = function (tokens: Token[] | TokensList, callback: (token: Token) => MaybePromise | MaybePromise[]) {\n    return markedInstance.walkTokens(tokens, callback);\n};\n\n/**\n * Compiles markdown to HTML without enclosing `p` tag.\n *\n * @param src String of markdown source to be compiled\n * @param options Hash of options\n * @return String of compiled HTML\n */\nmarked.parseInline = markedInstance.parseInline;\n\n/**\n * Expose\n */\nmarked.Parser = _Parser;\nmarked.parser = _Parser.parse;\nmarked.Renderer = _Renderer;\nmarked.TextRenderer = _TextRenderer;\nmarked.Lexer = _Lexer;\nmarked.lexer = _Lexer.lex;\nmarked.Tokenizer = _Tokenizer;\nmarked.Hooks = _Hooks;\nmarked.parse = marked;\n\nexport const options = marked.options;\nexport const setOptions = marked.setOptions;\nexport const use = marked.use;\nexport const walkTokens = marked.walkTokens;\nexport const parseInline = marked.parseInline;\nexport const parse = marked;\nexport const parser = _Parser.parse;\nexport const lexer = _Lexer.lex;\nexport {_defaults as defaults, _getDefaults as getDefaults} from './defaults';\nexport {_Lexer as Lexer} from './Lexer';\nexport {_Parser as Parser} from './Parser';\nexport {_Tokenizer as Tokenizer} from './Tokenizer';\nexport {_Renderer as Renderer} from './Renderer';\nexport {_TextRenderer as TextRenderer} from './TextRenderer';\nexport {_Hooks as Hooks} from './Hooks';\nexport {Marked} from './Instance';\nexport type * from './MarkedOptions';\nexport type * from './rules';\nexport type * from './Tokens';\n","import {SnapshotParser} from '../../types/markdown/snapshotParser';\nimport {emptyInnerHtml} from '../../utils/dom/emptyInnerHtml';\nimport {insertCopyToClipboardButton} from '../copyToClipboard/insertCopyToClipboardButton';\nimport {marked} from './marked/marked';\n\nexport const parseMdSnapshot: SnapshotParser = (\n    snapshot,\n    options,\n): string => {\n\n    const {\n        showCodeBlockCopyButton,\n        markdownLinkTarget,\n        syntaxHighlighter,\n        htmlSanitizer,\n    } = options || {};\n\n    const parsedMarkdown = marked(snapshot, {\n        async: false,\n        breaks: true,\n    });\n\n    if (typeof parsedMarkdown !== 'string') {\n        throw new Error('Markdown parsing failed');\n    }\n\n    const element = document.createElement('div');\n    element.innerHTML = htmlSanitizer ? htmlSanitizer(parsedMarkdown) : parsedMarkdown;\n\n    element.querySelectorAll('pre').forEach((block) => {\n        const newBlock = document.createElement('div');\n        newBlock.className = 'code-block';\n\n        const codeElement = block.querySelector('code');\n        if (!codeElement) {\n            // No code can be found, so just copy the innerHTML of the block.\n            const html = block.innerHTML;\n            newBlock.innerHTML = htmlSanitizer ? htmlSanitizer(html) : html;\n            block.replaceWith(newBlock);\n            return;\n        }\n\n        //\n        // When a code block is found\n        // 1. Adjust the class name and HTML structure to style the code block\n        // 2. Apply syntax highlighting\n        // 3. Add a copy to clipboard button\n        // 4. Apply link target\n        //\n\n        let language: string | undefined;\n        for (let i = 0; i < codeElement.classList.length; i++) {\n            const className = codeElement.classList[i];\n            if (className.startsWith('language-')) {\n                language = className.slice(9);\n                break;\n            }\n        }\n\n        const newCodeElement = document.createElement('pre');\n        const newHtml = '<div>' + codeElement.innerHTML + '</div>';\n        newCodeElement.innerHTML = options?.htmlSanitizer ? options.htmlSanitizer(newHtml) : newHtml;\n\n        if (language) {\n            newCodeElement.setAttribute('data-language', language);\n\n            //\n            // Apply syntax highlighting\n            //\n            if (syntaxHighlighter) {\n                const highlight = syntaxHighlighter.createHighlighter();\n                const newHtml = '<div>' + highlight(codeElement.textContent || '', language) + '</div>';\n\n                newCodeElement.innerHTML = htmlSanitizer ? htmlSanitizer(newHtml) : newHtml;\n                newCodeElement.className = 'highlighter-dark';\n            }\n        }\n\n        emptyInnerHtml(newBlock);\n        newBlock.appendChild(newCodeElement);\n        block.replaceWith(newBlock);\n    });\n\n    if (showCodeBlockCopyButton !== false) { // Default to true\n        insertCopyToClipboardButton(element);\n    }\n\n    if (markdownLinkTarget !== 'self') { // Default to 'blank'\n        element.querySelectorAll('a').forEach((link) => {\n            link.setAttribute('target', '_blank');\n        });\n    }\n\n    return element.innerHTML;\n};\n","import {attachCopyClickListener} from '../../../markdown/copyToClipboard/attachCopyClickListener';\nimport {parseMdSnapshot} from '../../../markdown/snapshot/snapshotParser';\nimport {SnapshotParserOptions} from '../../../types/markdown/snapshotParser';\n\nexport const createMessageContent = (\n    message: string,\n    format: 'text' | 'markdown' = 'text',\n    markdownOptions?: SnapshotParserOptions,\n): HTMLElement | DocumentFragment | Text => {\n    if (format === 'markdown') {\n        // Render message as a text node to avoid XSS\n        const htmlElement = document.createElement('div');\n        const html = parseMdSnapshot(message, markdownOptions);\n        htmlElement.innerHTML = markdownOptions?.htmlSanitizer ? markdownOptions.htmlSanitizer(html) : html;\n        attachCopyClickListener(htmlElement);\n\n        const fragment = document.createDocumentFragment();\n        while (htmlElement.firstChild) {\n            fragment.appendChild(htmlElement.firstChild);\n        }\n\n        return fragment;\n    }\n\n    // Render message as a text node to avoid XSS\n    return document.createTextNode(message);\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {MessageProps, MessageStatus} from './props';\nimport {applyNewDirectionClassName} from './utils/applyNewDirectionClassName';\nimport {applyNewStatusClassName} from './utils/applyNewStatusClassName';\nimport {createMessageContent} from './utils/createMessageContent';\n\nexport const className = 'nlux-comp-message';\n\nexport const createMessageDom: DomCreator<MessageProps> = (props): HTMLElement => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    const status: MessageStatus = props.status ? props.status : 'complete';\n    applyNewStatusClassName(element, status);\n    applyNewDirectionClassName(element, props.direction);\n\n    if (status === 'streaming') {\n        return element;\n    }\n\n    //\n    // Default status is — rendered\n    //\n\n    if (props.message) {\n        element.append(createMessageContent(props.message, props.format, {\n            htmlSanitizer: props.htmlSanitizer,\n        }));\n    }\n\n    return element;\n};\n","import {MessageDirection} from '../../Message/props';\n\nexport const directionClassName: {[key: string]: string} = {\n    received: 'nlux-comp-chatItem--received',\n    sent: 'nlux-comp-chatItem--sent',\n};\n\nexport const applyNewDirectionClassName = (element: HTMLElement, direction: MessageDirection) => {\n    const directions = Object.keys(directionClassName);\n    directions.forEach((directionName) => {\n        element.classList.remove(directionClassName[directionName]);\n    });\n\n    if (directionClassName[direction]) {\n        element.classList.add(directionClassName[direction]);\n    }\n};\n","import {ConversationLayout} from '../../../../../js/core/src/aiChat/options/conversationOptions';\n\nexport const conversationLayoutClassName: {[key: string]: string} = {\n    bubbles: 'nlux-comp-chatItem--bubblesLayout',\n    list: 'nlux-comp-chatItem--listLayout',\n};\n\nexport const applyNewLayoutClassName = (element: HTMLElement, layout: ConversationLayout) => {\n    const layouts = Object.keys(conversationLayoutClassName);\n    layouts.forEach((layoutName) => {\n        element.classList.remove(conversationLayoutClassName[layoutName]);\n    });\n\n    if (conversationLayoutClassName[layout]) {\n        element.classList.add(conversationLayoutClassName[layout]);\n    }\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {createAvatarDom} from '../Avatar/create';\nimport {AvatarProps} from '../Avatar/props';\nimport {createMessageDom} from '../Message/create';\nimport {MessageProps} from '../Message/props';\nimport {ChatItemProps} from './props';\nimport {applyNewDirectionClassName} from './utils/applyNewDirectionClassName';\nimport {applyNewLayoutClassName} from './utils/applyNewLayoutClassName';\n\nexport const className = 'nlux-comp-chatItem';\n\nexport const participantInfoContainerClassName = 'nlux-comp-chatItem-participantInfo';\nexport const participantNameClassName = 'nlux-comp-chatItem-participantName';\n\nexport const createChatItemDom: DomCreator<ChatItemProps> = (\n    props,\n): HTMLElement => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    const messageProps: MessageProps = {\n        direction: props.direction,\n        status: props.status,\n        message: props.message,\n        htmlSanitizer: props.htmlSanitizer,\n    };\n\n    // Create an avatar if avatar is provided\n    let avatarDom: HTMLElement | undefined;\n    if (props.avatar !== undefined) {\n        const avatarProps: AvatarProps = {\n            name: props.name,\n            avatar: props.avatar,\n        };\n\n        avatarDom = createAvatarDom(avatarProps);\n    }\n\n    // Create name\n    const participantNameDom = document.createElement('span');\n    participantNameDom.classList.add(participantNameClassName);\n    participantNameDom.textContent = props.name;\n\n    // Add persona and name\n    {\n        const participantInfoContainer = document.createElement('div');\n        participantInfoContainer.classList.add(participantInfoContainerClassName);\n\n        if (avatarDom !== undefined) {\n            participantInfoContainer.append(avatarDom);\n        }\n\n        participantInfoContainer.append(participantNameDom);\n        element.append(participantInfoContainer);\n    }\n\n    applyNewDirectionClassName(element, props.direction);\n    applyNewLayoutClassName(element, props.layout);\n\n    const message = createMessageDom(messageProps);\n    element.append(message);\n    return element;\n};\n","import {emptyInnerHtml} from '../../../utils/dom/emptyInnerHtml';\nimport {AvatarProps} from '../props';\nimport {createPhotoContainerFromUrl} from './createPhotoContainerFromUrl';\n\nexport const updateContentOnAvatarChange = (\n    element: HTMLElement,\n    propsBefore: AvatarProps,\n    propsAfter: AvatarProps,\n): void => {\n    if (propsBefore.avatar === propsAfter.avatar) {\n        return;\n    }\n\n    if (typeof propsAfter.avatar === 'string' && typeof propsBefore.avatar === 'string') {\n        // When the avatar is a string, we update the photo container with the new URL\n        const photoDomElement: HTMLElement | null = element.querySelector(\n            '* > .nlux-comp-avatarContainer > .nlux-comp-avatarPicture',\n        );\n\n        if (photoDomElement !== null) {\n            photoDomElement.style.backgroundImage = `url(\"${encodeURI(propsAfter.avatar)}\")`;\n        }\n    } else {\n        if (typeof propsAfter.avatar === 'string') {\n            // When the new avatar is a string and the old one is not —\n            // we create a new photo container from the URL\n            const newPhotoDomElement = createPhotoContainerFromUrl(\n                propsAfter.avatar,\n                propsAfter.name,\n            );\n            element.replaceChildren(newPhotoDomElement);\n        } else {\n            // When the avatar is an HTMLElement, we clone it and append it to the persona dom\n            if (propsAfter.avatar) {\n                element.replaceChildren(propsAfter.avatar.cloneNode(true));\n            } else {\n                // If the new avatar is null, we remove the old one\n                emptyInnerHtml(element);\n            }\n        }\n    }\n};\n","import {AvatarProps} from '../props';\n\nexport const updateNameOnAvatar = (\n    element: HTMLElement,\n    propsBefore: AvatarProps,\n    propsAfter: AvatarProps,\n): void => {\n    if (propsBefore.name === propsAfter.name) {\n        return;\n    }\n\n    if (typeof propsAfter.avatar === 'string') {\n        const letter = propsAfter.name && propsAfter.name.length > 0 ?\n            propsAfter.name[0].toUpperCase() : '';\n\n        const letterContainer = element.querySelector(\n            '* > .nlux-comp-avatarContainer > .avtr_ltr',\n        );\n\n        letterContainer?.replaceChildren(letter);\n    }\n};\n","import {DomUpdater} from '../../types/dom/DomUpdater';\nimport {AvatarProps} from './props';\nimport {updateContentOnAvatarChange} from './utils/updateContentOnAvatarChange';\nimport {updateNameOnAvatar} from './utils/updateNameOnAvatar';\n\nexport const updateAvatarDom: DomUpdater<AvatarProps> = (\n    element,\n    propsBefore,\n    propsAfter,\n): void => {\n    if (propsBefore.avatar === propsAfter.avatar && propsBefore.name === propsAfter.name) {\n        return;\n    }\n\n    if (propsBefore.avatar !== propsAfter.avatar) {\n        updateContentOnAvatarChange(element, propsBefore, propsAfter);\n    }\n\n    if (propsAfter.name) {\n        if (propsBefore.name !== propsAfter.name) {\n            element.title = propsAfter.name;\n            updateNameOnAvatar(element, propsBefore, propsAfter);\n        }\n    } else {\n        element.title = '';\n        updateNameOnAvatar(element, propsBefore, propsAfter);\n    }\n};\n","import {emptyInnerHtml} from '../../../utils/dom/emptyInnerHtml';\nimport {MessageProps} from '../props';\nimport {createMessageContent} from './createMessageContent';\n\nexport const updateContentOnMessageChange = (\n    element: HTMLElement,\n    propsBefore: MessageProps,\n    propsAfter: MessageProps,\n) => {\n    if (\n        propsBefore.message === propsAfter.message &&\n        propsBefore.format === propsAfter.format\n    ) {\n        return;\n    }\n\n    emptyInnerHtml(element);\n    element.append(\n        createMessageContent(propsAfter.message ?? '', propsAfter.format, {\n            htmlSanitizer: propsAfter.htmlSanitizer,\n        }),\n    );\n};\n","import {emptyInnerHtml} from '../../../utils/dom/emptyInnerHtml';\nimport {MessageProps} from '../props';\nimport {statusClassName} from './applyNewStatusClassName';\n\nexport const updateContentOnStatusChange = (\n    element: HTMLElement,\n    propsBefore: MessageProps,\n    propsAfter: MessageProps,\n) => {\n    const newStatus = propsAfter.status;\n    if (newStatus === 'streaming') {\n        return;\n    }\n\n    if (newStatus === 'complete') {\n        const innerHtml = propsAfter.message ? propsAfter.message : '';\n        const textNode = document.createTextNode(innerHtml);\n        element.classList.add(statusClassName[newStatus]);\n        emptyInnerHtml(element);\n        element.append(textNode);\n\n        return;\n    }\n};\n","import {DomUpdater} from '../../types/dom/DomUpdater';\nimport {MessageProps} from './props';\nimport {applyNewDirectionClassName} from './utils/applyNewDirectionClassName';\nimport {applyNewStatusClassName} from './utils/applyNewStatusClassName';\nimport {updateContentOnMessageChange} from './utils/updateContentOnMessageChange';\nimport {updateContentOnStatusChange} from './utils/updateContentOnStatusChange';\n\nexport const updateMessageDom: DomUpdater<MessageProps> = (\n    element,\n    propsBefore,\n    propsAfter,\n) => {\n    if (\n        propsBefore.message === propsAfter.message &&\n        propsBefore.status === propsAfter.status &&\n        propsBefore.direction === propsAfter.direction\n    ) {\n        return;\n    }\n\n    if (!propsAfter || (\n        !propsAfter.hasOwnProperty('message') &&\n        !propsAfter.hasOwnProperty('status') &&\n        !propsAfter.hasOwnProperty('direction')\n    )) {\n        return;\n    }\n\n    //\n    // Direction change\n    //\n    if (propsBefore.direction !== propsAfter.direction) {\n        applyNewDirectionClassName(element, propsAfter.direction);\n    }\n\n    //\n    // Status change\n    //\n    const currentStatus = propsAfter.status;\n    if (propsBefore.status !== currentStatus) {\n        applyNewStatusClassName(element, propsAfter.status);\n        updateContentOnStatusChange(element, propsBefore, propsAfter);\n        return;\n    }\n\n    if (currentStatus === 'complete') {\n        if (propsBefore.message !== propsAfter.message || propsBefore.format !== propsAfter.format) {\n            updateContentOnMessageChange(element, propsBefore, propsAfter);\n        }\n    }\n};\n","import {DomUpdater} from '../../types/dom/DomUpdater';\nimport {className as avatarClassName, createAvatarDom} from '../Avatar/create';\nimport {AvatarProps} from '../Avatar/props';\nimport {updateAvatarDom} from '../Avatar/update';\nimport {className as messageClassName} from '../Message/create';\nimport {updateMessageDom} from '../Message/update';\nimport {participantInfoContainerClassName, participantNameClassName} from './create';\nimport {ChatItemProps} from './props';\nimport {applyNewDirectionClassName} from './utils/applyNewDirectionClassName';\nimport {applyNewLayoutClassName} from './utils/applyNewLayoutClassName';\n\nexport const updateChatItemDom: DomUpdater<ChatItemProps> = (\n    element,\n    propsBefore,\n    propsAfter,\n) => {\n    if (\n        propsBefore.direction === propsAfter.direction &&\n        propsBefore.layout === propsAfter.layout &&\n        propsBefore.status === propsAfter.status &&\n        propsBefore.message === propsAfter.message &&\n        propsBefore.name === propsAfter.name &&\n        propsBefore.avatar === propsAfter.avatar\n    ) {\n        return;\n    }\n\n    if (!propsAfter || (\n        !propsAfter.hasOwnProperty('direction') &&\n        !propsAfter.hasOwnProperty('layout') &&\n        !propsAfter.hasOwnProperty('status') &&\n        !propsAfter.hasOwnProperty('message') &&\n        !propsAfter.hasOwnProperty('loader') &&\n        !propsAfter.hasOwnProperty('name') &&\n        !propsAfter.hasOwnProperty('avatar')\n    )) {\n        return;\n    }\n\n    if (propsBefore.direction !== propsAfter.direction) {\n        applyNewDirectionClassName(element, propsAfter.direction);\n    }\n\n    if (propsBefore.layout !== propsAfter.layout) {\n        applyNewLayoutClassName(element, propsAfter.layout);\n    }\n\n    if (\n        propsBefore.direction !== propsAfter.direction ||\n        propsBefore.status !== propsAfter.status ||\n        propsBefore.message !== propsAfter.message\n    ) {\n        const messageDom = element.querySelector<HTMLElement>(`.${messageClassName}`);\n        if (messageDom) {\n            updateMessageDom(messageDom, {\n                direction: propsBefore.direction,\n                status: propsBefore.status,\n                message: propsBefore.message,\n                htmlSanitizer: propsBefore.htmlSanitizer,\n            }, {\n                direction: propsAfter.direction,\n                status: propsAfter.status,\n                message: propsAfter.message,\n                htmlSanitizer: propsBefore.htmlSanitizer,\n            });\n        }\n    }\n\n    if (\n        propsBefore.name !== propsAfter.name ||\n        propsBefore.avatar !== propsAfter.avatar\n    ) {\n        const avatarDom = element.querySelector<HTMLElement>(`.${avatarClassName}`);\n        if (!propsAfter.name && !propsAfter.avatar) {\n            avatarDom?.remove();\n            return;\n        } else {\n            if (avatarDom) {\n                updateAvatarDom(avatarDom, {\n                    name: propsBefore.name,\n                    avatar: propsBefore.avatar,\n                }, {\n                    name: propsAfter.name,\n                    avatar: propsAfter.avatar,\n                });\n            } else {\n                // Add the avatar\n                if (propsAfter.name !== undefined || propsAfter.avatar !== undefined) {\n                    const avatarProps: AvatarProps = {\n                        name: propsAfter.name,\n                        avatar: propsAfter.avatar,\n                    };\n\n                    const persona = createAvatarDom(avatarProps);\n                    const participantInfoDom = element.querySelector<HTMLElement>(\n                        `.${participantInfoContainerClassName}`);\n                    if (participantInfoDom) {\n                        participantInfoDom.prepend(persona);\n                    }\n                }\n            }\n        }\n    }\n\n    if (propsBefore.name !== propsAfter.name) {\n        const participantNameContainer = element.querySelector<HTMLElement>(`.${participantNameClassName}`);\n        if (participantNameContainer) {\n            participantNameContainer.textContent = propsAfter.name || '';\n        }\n    }\n};\n","import {StandardStreamParser} from '../../types/markdown/streamParser';\nimport {warn} from '../../utils/warn';\nimport {attachCopyClickListener} from '../copyToClipboard/attachCopyClickListener';\nimport {parseMdSnapshot} from '../snapshot/snapshotParser';\n\nconst defaultDelayInMsBeforeComplete = 2000;\nconst defaultDelayInMsBetweenBufferChecks = 8;\nconst endOfStreamChar = '\\n';\n\nconst getScheduler = (type: 'timeout' | 'animationFrame') => {\n    if (type === 'timeout') {\n        return (callback: () => void) => setTimeout(callback, 0);\n    }\n\n    return (callback: () => void) => requestAnimationFrame(callback);\n};\n\nexport const createMdStreamRenderer: StandardStreamParser = (\n    root: HTMLElement,\n    options,\n) => {\n    let streamIsComplete = false;\n\n    const letterByLetter = true;\n    const {onComplete} = options || {};\n\n    //\n    // Buffer to store the chunks of markdown to be parsed\n    // Scheduler to control the speed of the streaming animation\n    //\n    const buffer: string[] = [];\n    const scheduler = getScheduler(\n        options?.skipStreamingAnimation ? 'timeout' : 'animationFrame',\n    );\n\n    //\n    // Container for markdown being parsed and that can be updated\n    //\n    const wipContainer = document.createElement('div');\n    wipContainer.classList.add('md-in-progress');\n    root.append(wipContainer);\n\n    //\n    // Functions to commit the WIP content to the DOM\n    // And to complete the parsing\n    //\n    const commitWipContent = () => {\n        while (wipContainer.firstChild) {\n            const childToCommit = wipContainer.firstChild;\n            if (childToCommit instanceof HTMLElement) {\n                attachCopyClickListener(childToCommit);\n            }\n\n            wipContainer.before(childToCommit);\n        }\n    };\n\n    const completeParsing = () => {\n        streamIsComplete = true;\n        if (parsingInterval) {\n            clearInterval(parsingInterval);\n            parsingInterval = undefined;\n        }\n\n        commitWipContent();\n        wipContainer.remove();\n        onComplete?.();\n    };\n\n    const delayBetweenBufferChecks = (\n        !options?.skipStreamingAnimation && options?.streamingAnimationSpeed && options.streamingAnimationSpeed >= 0\n    ) ? options.streamingAnimationSpeed : (options?.skipStreamingAnimation ? 0 : defaultDelayInMsBetweenBufferChecks);\n\n    const parsingContext: {\n        timeSinceLastProcessing: number;\n        currentMarkdown: string;\n        previousHtml: string | undefined;\n    } = {\n        timeSinceLastProcessing: new Date().getTime(),\n        currentMarkdown: '',\n        previousHtml: undefined,\n    };\n\n    let parsingInterval: number | undefined = setInterval(() => {\n        const nowTime = new Date().getTime();\n        const shouldAutomaticallyCompleteAfterDelay = options?.waitTimeBeforeStreamCompletion !== 'never';\n        if (buffer.length === 0 && shouldAutomaticallyCompleteAfterDelay) {\n            const delayBeforeCompleteParsing = (typeof options?.waitTimeBeforeStreamCompletion === 'number')\n                ? options.waitTimeBeforeStreamCompletion : defaultDelayInMsBeforeComplete;\n\n            if (streamIsComplete || nowTime - parsingContext.timeSinceLastProcessing > delayBeforeCompleteParsing) {\n                completeParsing();\n            }\n\n            return;\n        }\n\n        parsingContext.timeSinceLastProcessing = nowTime;\n        const chunk = buffer.shift();\n        if (chunk === undefined || typeof chunk !== 'string') {\n            return;\n        }\n\n        scheduler(() => {\n            // We should only parse the last chunk (in it release context) instead of the whole text\n            // In order to do that, we need to distinguish between:\n            //   - We will have WIP text to being parsed, and may be incomplete (example: `# Hello, `)\n            //   - Text that is committed to the DOM and will not change (example: `# Hello World!\\n\\n`)\n\n            // Append the new chunk to the raw text and parse\n            const markdownToParse = parsingContext.currentMarkdown + chunk;\n            const parsedHtml = parseMdSnapshot(markdownToParse, options).trim();\n\n            if (typeof parsedHtml !== 'string') {\n                // Remove the last chunk if parsing failed\n                parsingContext.currentMarkdown = parsingContext.currentMarkdown.slice(0, -chunk.length);\n                warn('Markdown parsing failed');\n                return;\n            }\n\n            if (\n                parsingContext.previousHtml &&\n                parsedHtml.length > parsingContext.previousHtml.length &&\n                parsedHtml.startsWith(parsingContext.previousHtml)\n            ) {\n                // Case 1: No changes to the previous HTML — And new HTML added on top of it\n                // Which means the new chunk added new HTML content outside the last parsed markdown\n                // Which means that the last parsed markdown is complete and should be committed to the DOM\n                // Commit the last parsed content to the DOM\n\n                commitWipContent();\n\n                // Extract new HTML and insert it into WIP container\n                const currentHtml = parsedHtml.slice(parsingContext.previousHtml.length).trim();\n                wipContainer.innerHTML = options?.htmlSanitizer ? options.htmlSanitizer(currentHtml) : currentHtml;\n\n                // Focus on everything that is new\n                parsingContext.currentMarkdown = chunk;\n                parsingContext.previousHtml = undefined;\n            } else {\n                // Case 2: Changes to the previous HTML\n                // This means that new chunk goes inside previous HTML and no root level changes\n\n                // Append the new chunk to the current markdown\n                wipContainer.innerHTML = options?.htmlSanitizer ? options.htmlSanitizer(parsedHtml) : parsedHtml;\n\n                // Update the current markdown and previous HTML for the next iteration\n                parsingContext.currentMarkdown = markdownToParse;\n                parsingContext.previousHtml = parsedHtml;\n            }\n        });\n    }, delayBetweenBufferChecks) as unknown as number;\n\n    return {\n        next: (chunk: string) => {\n            if (streamIsComplete) {\n                warn('Stream is already complete. No more chunks can be added');\n                return;\n            }\n\n            if (letterByLetter) {\n                for (const char of chunk) {\n                    buffer.push(char);\n                }\n            } else {\n                buffer.push(chunk);\n            }\n        },\n        complete: () => {\n            buffer.push(endOfStreamChar);\n            streamIsComplete = true;\n        },\n        cancel: () => {\n            if (parsingInterval) {\n                clearInterval(parsingInterval);\n                parsingInterval = undefined;\n            }\n\n            streamIsComplete = true;\n            wipContainer.remove();\n        },\n        error: () => {\n            // No special handling for errors\n            // Just complete the stream\n            streamIsComplete = true;\n        },\n    };\n};\n","import {HighlighterExtension} from '../../../js/core/src';\nimport {createMdStreamRenderer} from '../../../shared/src/markdown/stream/streamParser';\nimport {SanitizerExtension} from '../../../shared/src/sanitizer/sanitizer';\nimport {CallbackFunction} from '../../../shared/src/types/callbackFunction';\n\nexport type {SnapshotParser, SnapshotParserOptions} from '../../../shared/src/types/markdown/snapshotParser';\nexport {parseMdSnapshot} from '../../../shared/src/markdown/snapshot/snapshotParser';\n\nexport type MarkdownStreamParser = {\n    next(value: string): void;\n    complete(): void;\n};\n\nexport type MarkdownStreamParserOptions = {\n    markdownLinkTarget?: 'blank' | 'self';\n    syntaxHighlighter?: HighlighterExtension;\n    htmlSanitizer?: SanitizerExtension;\n    skipStreamingAnimation?: boolean;\n    streamingAnimationSpeed?: number;\n    waitTimeBeforeStreamCompletion?: number | 'never';\n    showCodeBlockCopyButton?: boolean;\n    onComplete?: CallbackFunction;\n};\n\nexport const createMarkdownStreamParser = (\n    domElement: HTMLElement,\n    options?: MarkdownStreamParserOptions,\n): MarkdownStreamParser => {\n    const nluxMarkdownStreamRenderer = createMdStreamRenderer(\n        domElement,\n        {\n            syntaxHighlighter: options?.syntaxHighlighter,\n            htmlSanitizer: options?.htmlSanitizer,\n            markdownLinkTarget: options?.markdownLinkTarget,\n            showCodeBlockCopyButton: options?.showCodeBlockCopyButton,\n            skipStreamingAnimation: options?.skipStreamingAnimation,\n            streamingAnimationSpeed: options?.streamingAnimationSpeed,\n            waitTimeBeforeStreamCompletion: options?.waitTimeBeforeStreamCompletion,\n            onComplete: options?.onComplete,\n        },\n    );\n\n    return {\n        next(value: string) {\n            nluxMarkdownStreamRenderer.next(value);\n        },\n        complete() {\n            nluxMarkdownStreamRenderer.complete();\n        },\n    };\n};\n","import {NluxRenderingError, NluxUsageError} from '@shared/types/error';\n\nconst source = 'dom/getElement';\n\nexport const getElement = (root: HTMLElement, query: string | undefined): HTMLElement => {\n    if (!query) {\n        throw new NluxUsageError({\n            source,\n            message: 'A query string must be provided to getElement()',\n        });\n    }\n\n    const element = root.querySelector(query);\n    if (!element) {\n        throw new NluxRenderingError({\n            source,\n            message: `Could not find element with query \"${query}\". ` +\n                'Make sure the query provided matches an element that exists in the root element.',\n        });\n    }\n\n    if (!(element instanceof HTMLElement)) {\n        throw new NluxRenderingError({\n            source,\n            message: `Element with query \"${query}\" is not a valid HTMLElement.`,\n        });\n    }\n\n    return element;\n};\n","import {createChatItemDom} from '@shared/components/ChatItem/create';\nimport {ChatItemProps} from '@shared/components/ChatItem/props';\nimport {updateChatItemDom} from '@shared/components/ChatItem/update';\nimport {createMessageContent} from '@shared/components/Message/utils/createMessageContent';\nimport {createMarkdownStreamParser, MarkdownStreamParser} from '../../../../../../extra/markdown/src';\nimport {CompRenderer} from '../../../types/comp';\nimport {getElement} from '../../../utils/dom/getElement';\nimport {CompChatItemActions, CompChatItemElements, CompChatItemEvents, CompChatItemProps} from './chatItem.types';\n\nexport const renderChatItem: CompRenderer<\n    CompChatItemProps, CompChatItemElements, CompChatItemEvents, CompChatItemActions\n> = ({\n    props,\n    appendToRoot,\n    compEvent,\n}) => {\n\n    const root = createChatItemDom({\n        ...props.domProps,\n        htmlSanitizer: props.htmlSanitizer,\n        message: undefined,\n    });\n\n    const messageContainer = getElement(root, '.nlux-comp-message');\n    if (!messageContainer) {\n        throw new Error('Message container not found');\n    }\n\n    const streamingRoot = document.createElement('div');\n    streamingRoot.classList.add('nlux-markdownStream-root');\n\n    const markdownContainer = document.createElement('div');\n    markdownContainer.classList.add('nlux-markdown-container');\n    markdownContainer.setAttribute('nlux-message-id', props.uid);\n\n    streamingRoot.append(markdownContainer);\n    messageContainer.append(streamingRoot);\n\n    if (props.domProps.message) {\n        const parsedMessage = createMessageContent(\n            props.domProps.message ?? '',\n            'markdown',\n            {\n                markdownLinkTarget: props.markdownLinkTarget,\n                syntaxHighlighter: props.syntaxHighlighter,\n                htmlSanitizer: props.htmlSanitizer,\n            },\n        );\n\n        markdownContainer.append(parsedMessage);\n    }\n\n    appendToRoot(root);\n\n    let markdownStreamParser: MarkdownStreamParser | undefined = undefined;\n    let markdownStreamProps: CompChatItemProps = {...props};\n\n    const initMarkdownStreamParser = (newProps: CompChatItemProps) => {\n        return createMarkdownStreamParser(markdownContainer, {\n            syntaxHighlighter: newProps.syntaxHighlighter,\n            htmlSanitizer: newProps.htmlSanitizer,\n            markdownLinkTarget: newProps.markdownLinkTarget,\n            showCodeBlockCopyButton: newProps.showCodeBlockCopyButton,\n            skipStreamingAnimation: newProps.skipStreamingAnimation,\n            streamingAnimationSpeed: newProps.streamingAnimationSpeed,\n            onComplete: () => compEvent('markdown-stream-complete'),\n        });\n    };\n\n    return {\n        elements: {\n            chatItemContainer: root,\n        },\n        actions: {\n            focus: () => {\n                root.focus();\n            },\n            processStreamedChunk: (chunk: string) => {\n                if (!markdownStreamParser) {\n                    markdownStreamParser = initMarkdownStreamParser(markdownStreamProps);\n                }\n\n                markdownStreamParser.next(chunk);\n            },\n            commitStreamedChunks: () => {\n                if (markdownStreamParser) {\n                    markdownStreamParser.complete();\n                }\n            },\n            updateMarkdownStreamRenderer: (newProps: Partial<CompChatItemProps>) => {\n                markdownStreamProps = {\n                    ...markdownStreamProps,\n                    ...newProps,\n                };\n\n                initMarkdownStreamParser(markdownStreamProps);\n            },\n            updateDomProps: (oldProps: ChatItemProps, newProps: ChatItemProps) => {\n                updateChatItemDom(\n                    root,\n                    oldProps,\n                    newProps,\n                );\n            },\n        },\n        onDestroy: () => {\n            root.remove();\n            markdownStreamParser = undefined;\n        },\n    };\n};\n","import {CompUpdater} from '../../../types/comp';\nimport {CompChatItemActions, CompChatItemElements, CompChatItemProps} from './chatItem.types';\n\nexport const updateChatItem: CompUpdater<\n    CompChatItemProps, CompChatItemElements, CompChatItemActions\n> = ({\n    propName,\n    newValue,\n    dom,\n}) => {\n    switch (propName) {\n        case 'markdownLinkTarget':\n        case 'skipStreamingAnimation':\n        case 'syntaxHighlighter':\n        case 'htmlSanitizer':\n        case 'showCodeBlockCopyButton':\n        case 'streamingAnimationSpeed':\n            dom.actions?.updateMarkdownStreamRenderer({\n                [propName]: newValue,\n            });\n            break;\n    }\n};\n","import {ChatItemProps} from '@shared/components/ChatItem/props';\nimport {ChatSegmentItem} from '@shared/types/chatSegment/chatSegment';\nimport {ChatSegmentAiMessage} from '@shared/types/chatSegment/chatSegmentAiMessage';\nimport {ChatSegmentUserMessage} from '@shared/types/chatSegment/chatSegmentUserMessage';\nimport {BaseComp} from '../../../aiChat/comp/base';\nimport {CompEventListener, Model} from '../../../aiChat/comp/decorators';\nimport {HighlighterExtension} from '../../../aiChat/highlighter/highlighter';\nimport {ControllerContext} from '../../../types/controllerContext';\nimport {renderChatItem} from './chatItem.render';\nimport {CompChatItemActions, CompChatItemElements, CompChatItemEvents, CompChatItemProps} from './chatItem.types';\nimport {updateChatItem} from './chatItem.update';\n\n@Model('chatItem', renderChatItem, updateChatItem)\nexport class CompChatItem<AiMsg> extends BaseComp<\n    AiMsg, CompChatItemProps, CompChatItemElements, CompChatItemEvents, CompChatItemActions\n> {\n    private aiMessageContent: AiMsg | undefined;\n    private serverResponse: Array<string | object | undefined> = [];\n    private stringContent: string = '';\n\n    constructor(\n        context: ControllerContext<AiMsg>,\n        props: CompChatItemProps,\n    ) {\n        super(context, props);\n        if (props.domProps.message !== undefined) {\n            this.stringContent = props.domProps.message;\n        }\n    }\n\n    public addChunk(chunk: AiMsg, serverResponse?: string | object) {\n        this.throwIfDestroyed();\n        this.executeDomAction('processStreamedChunk', chunk);\n\n        if (typeof chunk === 'string') {\n            this.stringContent += chunk;\n        }\n\n        this.serverResponse.push(serverResponse);\n    }\n\n    public commitChunks() {\n        this.throwIfDestroyed();\n        this.executeDomAction('commitStreamedChunks');\n    }\n\n    public getChatSegmentItem(): ChatSegmentItem<AiMsg> {\n        const domProps = this.getProp('domProps') as ChatItemProps;\n        if (domProps.direction === 'received') {\n            return {\n                uid: this.props.uid,\n                participantRole: 'assistant',\n                content: this.getItemContent() as AiMsg,\n                contentType: 'text',\n                serverResponse: this.serverResponse,\n                status: 'complete',\n                dataTransferMode: 'batch',\n                time: new Date(),\n            } satisfies ChatSegmentAiMessage<AiMsg>;\n        }\n\n        return {\n            uid: this.props.uid,\n            participantRole: 'user',\n            content: this.getItemContent() as string,\n            contentType: 'text',\n            status: 'complete',\n            time: new Date(),\n        } satisfies ChatSegmentUserMessage;\n    }\n\n    public getItemContent(): AiMsg | string {\n        return this.aiMessageContent ?? this.stringContent;\n    }\n\n    public updateDomProps(updatedProps: Partial<ChatItemProps>) {\n        const oldProps: ChatItemProps = this.getProp('domProps') as ChatItemProps;\n        const newProps: ChatItemProps = {\n            ...oldProps,\n            ...updatedProps,\n        };\n\n        this.setProp('domProps', newProps);\n        this.executeDomAction('updateDomProps', oldProps, newProps);\n    }\n\n    public updateMarkdownStreamRenderer(\n        newProp: keyof CompChatItemProps,\n        newValue: CompChatItemProps[typeof newProp],\n    ) {\n        this.setProp(newProp, newValue);\n\n        if (newProp === 'syntaxHighlighter') {\n            const typedNewValue = newValue as HighlighterExtension | undefined;\n            this.executeDomAction('updateMarkdownStreamRenderer', {\n                syntaxHighlighter: typedNewValue,\n            } satisfies Partial<CompChatItemProps>);\n        }\n\n        if (newProp === 'htmlSanitizer') {\n            const typedNewValue = newValue as ((html: string) => string) | undefined;\n            this.executeDomAction('updateMarkdownStreamRenderer', {\n                htmlSanitizer: typedNewValue,\n            } satisfies Partial<CompChatItemProps>);\n        }\n    }\n\n    @CompEventListener('markdown-stream-complete')\n    private onMarkdownStreamComplete(messageRendered: AiMsg) {\n        this.context.emit('messageRendered', {uid: this.props.uid});\n    }\n}\n","import {NluxError} from '../types/error';\n\nexport const throttle = <CallbackType>(callback: CallbackType, limitInMilliseconds: number) => {\n    let waiting = false;\n    if (typeof callback !== 'function') {\n        throw new NluxError({\n            source: 'x/throttle',\n            message: 'Callback must be a function',\n        });\n    }\n\n    const throttled = ((...args: []) => {\n        if (!waiting) {\n            callback.apply(this, args);\n            waiting = true;\n            setTimeout(function () {\n                waiting = false;\n            }, limitInMilliseconds);\n        }\n    }) as CallbackType;\n\n    return throttled;\n};\n","export type ConversationScrollParams = Readonly<{\n    scrolledToBottom: boolean;\n    scrollDirection: 'up' | 'down' | undefined;\n}>;\n\nexport type ConversationScrollCallback = (params: ConversationScrollParams) => void;\n\nexport const createConversationScrollHandler = (callback: ConversationScrollCallback): EventListener => {\n    let lastScrollTop: number | undefined = undefined;\n    let lastHeight: number | undefined = undefined;\n\n    return (event: Event) => {\n        const target = event.target as HTMLElement | null;\n        if (!(target instanceof HTMLElement)) {\n            return;\n        }\n\n        const {\n            scrollTop,\n            clientHeight,\n            scrollHeight,\n        } = target;\n\n        const minExpectedScrollTop = scrollHeight - 30;\n        const scrolledToBottom = Math.ceil(scrollTop + clientHeight) >= minExpectedScrollTop;\n\n        const scrollDirection = (lastScrollTop === undefined || lastHeight === undefined) ? undefined :\n            (scrollTop > lastScrollTop && lastHeight === scrollHeight) ? 'down' :\n                (scrollTop < lastScrollTop && lastHeight === scrollHeight) ? 'up' :\n                    undefined;\n\n        lastHeight = scrollHeight;\n        lastScrollTop = scrollTop;\n\n        callback({scrolledToBottom, scrollDirection});\n    };\n};\n","import {throttle} from '../../utils/throttle';\nimport {AutoScrollController} from './type';\nimport {createConversationScrollHandler} from './utils/conversationScrollHandler';\n\nexport const createAutoScrollController = (\n    newConversationContainer: HTMLElement,\n    autoScroll: boolean,\n): AutoScrollController => {\n    let shouldScrollWhenGenerating: boolean = autoScroll;\n    let conversationContainer: HTMLElement | undefined = newConversationContainer;\n    let scrollingStickToConversationEnd: boolean = true;\n    let activeChatSegment: {uid: string; container: HTMLElement} | undefined = undefined;\n\n    const scrollHandler = throttle(createConversationScrollHandler((\n        {\n            scrolledToBottom, scrollDirection,\n        }) => {\n        if (scrollingStickToConversationEnd) {\n            // When the user is already at the bottom of the conversation, we stick to the bottom\n            // and only unstick when the user scrolls up.\n            if (scrollDirection === 'up') {\n                scrollingStickToConversationEnd = false;\n            }\n        } else {\n            // When the user is not at the bottom of the conversation, we only stick to the bottom\n            // when the user scrolls down and reaches the bottom.\n            if (scrollDirection === 'down' && scrolledToBottom) {\n                scrollingStickToConversationEnd = true;\n            }\n        }\n    }), 50);\n\n    const initConversationContainer = (newConversationContainer: HTMLElement) => {\n        newConversationContainer.addEventListener('scroll', scrollHandler);\n    };\n\n    const resetConversationContainer = (oldConversationContainer?: HTMLElement) => {\n        oldConversationContainer?.removeEventListener('scroll', scrollHandler);\n    };\n\n    const handleDoneWithSegment = (segmentId: string) => {\n        if (activeChatSegment?.uid === segmentId) {\n            resizeObserver?.disconnect();\n            mutationObserver?.disconnect();\n            activeChatSegment = undefined;\n            resizeObserver = undefined;\n            mutationObserver = undefined;\n        }\n    };\n\n    let resizeObserver: ResizeObserver | undefined;\n    let mutationObserver: MutationObserver | undefined;\n\n    const scrollToBottom = () => {\n        // Using a very large number to make sure the scroll position is set to the bottom.\n        // The alternative is to use scrollHeight, but that would result in an extra reflow - that can\n        // be avoided by using a very large number.\n        // Downside: if the scrollHeight is larger than the max value (50000 pixels), this will not work.\n        conversationContainer?.scrollTo({\n            top: 50000,\n            behavior: 'instant',\n        });\n    };\n\n    const handleActiveChatSegmentResized = () => {\n        if (conversationContainer && shouldScrollWhenGenerating && scrollingStickToConversationEnd) {\n            scrollToBottom();\n        }\n    };\n\n    const handleActiveChatSegmentDomChanged = () => {\n        handleActiveChatSegmentResized();\n    };\n\n    initConversationContainer(conversationContainer);\n\n    return {\n        updateConversationContainer: (newConversationContainer: HTMLElement) => {\n            resetConversationContainer(conversationContainer);\n            initConversationContainer(newConversationContainer);\n            conversationContainer = newConversationContainer;\n        },\n        updateProps: ({autoScroll}) => {\n            shouldScrollWhenGenerating = autoScroll;\n        },\n        handleNewChatSegmentAdded: (segmentId, segmentContainer) => {\n            if (activeChatSegment) {\n                resizeObserver?.disconnect();\n                mutationObserver?.disconnect();\n            }\n\n            activeChatSegment = {uid: segmentId, container: segmentContainer};\n\n            resizeObserver = new ResizeObserver(handleActiveChatSegmentResized);\n            resizeObserver.observe(segmentContainer);\n\n            mutationObserver = new MutationObserver(handleActiveChatSegmentDomChanged);\n            mutationObserver.observe(segmentContainer, {\n                childList: true,\n                subtree: true,\n                characterData: true,\n            });\n\n            if (shouldScrollWhenGenerating) {\n                scrollToBottom();\n            }\n        },\n        handleChatSegmentRemoved: (segmentId) => handleDoneWithSegment(segmentId),\n        handleChatSegmentComplete: (segmentId) => handleDoneWithSegment(segmentId),\n        destroy: () => {\n            if (activeChatSegment) {\n                handleDoneWithSegment(activeChatSegment.uid);\n                activeChatSegment = undefined;\n            }\n\n            resetConversationContainer(conversationContainer);\n            conversationContainer = undefined;\n        },\n    };\n};\n","import {ControllerContext} from '../../types/controllerContext';\nimport {CompRegistry} from './registry';\n\nexport const comp = <\n    CompClass extends new (context: ControllerContext<any>, props: any) => InstanceType<CompClass>,\n>(\n    compClass: CompClass,\n) => {\n    const compId = typeof compClass === 'function'\n        ? (compClass as unknown as {__compId: string}).__compId\n        : undefined;\n\n    if (!compId) {\n        throw new Error('Invalid compClass! Component should be registered before using');\n    }\n\n    type CompClassWithPublicConstructor = new (\n        context: ControllerContext<object>,\n        props: object,\n    ) => InstanceType<CompClass>;\n\n    const CompClass = CompRegistry.retrieve(compId)?.model as CompClassWithPublicConstructor | undefined;\n    if (!CompClass || typeof CompClass !== 'function') {\n        throw new Error(`Component \"${compId}\" is not registered`);\n    }\n\n    // IMPORTANT ✨ The lines below are responsible for creating all instances of all components.\n\n    return {\n        withContext: (newContext: ControllerContext<any>) => {\n            return {\n                create: (): InstanceType<CompClass> => {\n                    return new CompClass(newContext as unknown as ControllerContext<object>, {});\n                },\n                withProps: <PropsType = unknown>(newProps: PropsType) => {\n                    return {\n                        create: (): InstanceType<CompClass> => {\n                            return new CompClass(newContext as unknown as ControllerContext<object>,\n                                newProps as object,\n                            );\n                        },\n                    };\n                },\n            };\n        },\n    };\n};\n","import {AiChatProps, AiChatPropsInEvents} from '../types/aiChat/props';\n\nexport const propsToCorePropsInEvents = <AiMsg>(\n    props: AiChatProps<AiMsg>,\n): AiChatPropsInEvents<AiMsg> => {\n\n    // All keys except the adapter key\n    type KeyType = keyof AiChatPropsInEvents<AiMsg>;\n    const excludeKeys: (keyof AiChatProps<AiMsg>)[] = [\n        'adapter',\n        'events',\n    ];\n\n    const keys: KeyType[] = Object.keys(props).filter(\n        (key) => !excludeKeys.includes(key as keyof AiChatProps<AiMsg>),\n    ) as KeyType[];\n\n    const result = {} as Record<KeyType, AiChatPropsInEvents<AiMsg>[KeyType]>;\n    for (let i = 0; i < keys.length; i++) {\n        const key: KeyType = keys[i];\n        result[key] = props[key];\n    }\n\n    return result as AiChatPropsInEvents<AiMsg>;\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\n\nexport const className = 'nlux-comp-messageLoader';\n\nexport const createLoaderDom: DomCreator<void> = () => {\n    const loader = document.createElement('div');\n    loader.classList.add(className);\n\n    const spinnerLoader = document.createElement('span');\n    spinnerLoader.classList.add('spinning-loader');\n\n    const spinnerLoaderContainer = document.createElement('div');\n    spinnerLoaderContainer.classList.add('nlux-comp-loaderContainer');\n    spinnerLoaderContainer.appendChild(spinnerLoader);\n\n    loader.appendChild(spinnerLoaderContainer);\n    return loader;\n};\n","export const className = 'nlux-comp-sendIcon';\n\nexport const createSendIconDom = () => {\n    const sendIcon = document.createElement('div');\n    sendIcon.classList.add(className);\n\n    const sndIcnCtn = document.createElement('div');\n    sndIcnCtn.classList.add('nlux-comp-sendIcon-container');\n    sendIcon.appendChild(sndIcnCtn);\n\n    return sendIcon;\n};\n","import {ComposerStatus} from '../props';\n\nexport const statusClassName: {[key: string]: string} = {\n    typing: 'nlux-composer--typing',\n    'submitting-prompt': 'nlux-composer--submitting',\n    'submitting-conversation-starter': 'nlux-composer--submitting',\n    waiting: 'nlux-composer--waiting',\n};\n\nexport const applyNewStatusClassName = (element: HTMLElement, status: ComposerStatus) => {\n    const statuses = Object.keys(statusClassName);\n    statuses.forEach((statusName) => {\n        element.classList.remove(statusClassName[statusName]);\n    });\n\n    element.classList.add(statusClassName[status]);\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {createLoaderDom} from '../Loader/create';\nimport {createSendIconDom} from '../SendIcon/create';\nimport {ComposerProps} from './props';\nimport {applyNewStatusClassName} from './utils/applyNewStatusClassName';\n\nexport const className = 'nlux-comp-composer';\n\nexport const createComposerDom: DomCreator<ComposerProps> = (props) => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    const textarea = document.createElement('textarea');\n\n    textarea.placeholder = props.placeholder ?? '';\n    textarea.value = props.message ?? '';\n    if (props.autoFocus) {\n        textarea.autofocus = true;\n    }\n\n    const submitButton = document.createElement('button');\n    submitButton.append(createSendIconDom());\n    submitButton.append(createLoaderDom());\n\n    element.append(textarea);\n    element.append(submitButton);\n    applyNewStatusClassName(element, props.status);\n\n    if (props.status === 'submitting-conversation-starter' || props.status === 'submitting-prompt') {\n        textarea.disabled = true;\n        submitButton.disabled = true;\n    }\n\n    if (props.status === 'waiting') {\n        submitButton.disabled = true;\n    }\n\n    if (props.status === 'typing') {\n        submitButton.disabled = props.disableSubmitButton ?? textarea.value === '';\n    }\n\n    return element;\n};\n","import {CallbackFunction} from '@shared/types/callbackFunction';\nimport {NluxRenderingError} from '@shared/types/error';\n\nconst source = 'dom/listenTo';\n\nexport type ListenToBuilder = {\n    on: (eventName: string, callback?: CallbackFunction | undefined) => ListenToBuilder;\n    get: () => [HTMLElement, () => void];\n};\n\nexport const listenToElement = (element: HTMLElement, query?: string): ListenToBuilder => {\n    let used = false;\n\n    const queryResult = query ? element.querySelector(query) : element;\n    const elementToReturn = queryResult instanceof HTMLElement ? queryResult : undefined;\n\n    if (!elementToReturn) {\n        throw new NluxRenderingError({\n            source,\n            message: `Could not find element with query \"${query}\". ` +\n                'Make sure the query provided matches an element that exists in the root element.',\n        });\n    }\n\n    const domListeners = new Map<string, (event: Event) => void>();\n    const userCallbacks = new Map<string, Set<CallbackFunction>>();\n\n    const removeListeners = () => {\n        if (!elementToReturn) {\n            return;\n        }\n\n        domListeners.forEach((callback, eventName) => {\n            elementToReturn.removeEventListener(eventName, callback);\n        });\n\n        domListeners.clear();\n        userCallbacks.clear();\n    };\n\n    const result: ListenToBuilder = {\n        on: (eventName: string, callback?: CallbackFunction | undefined): ListenToBuilder => {\n            if (!callback || !elementToReturn) {\n                return result;\n            }\n\n            // Register native DOM callback for event\n            // This is the actual callback that should be removed during cleanup\n            if (!domListeners.has(eventName)) {\n                const onEvent = (event: Event) => {\n                    userCallbacks.get(eventName)?.forEach(callback => callback(event));\n                };\n\n                domListeners.set(eventName, onEvent);\n                elementToReturn.addEventListener(eventName, onEvent);\n            }\n\n            // Set user-defined callbacks for event\n            if (!userCallbacks.has(eventName)) {\n                userCallbacks.set(eventName, new Set());\n            }\n\n            // Add user-defined callback to set\n            const callbacksForEvent = userCallbacks.get(eventName)!;\n            callbacksForEvent.add(callback);\n\n            return result;\n        },\n        get: () => {\n            if (used) {\n                throw new Error('listenTo().get() can only be used once!');\n            }\n\n            used = true;\n            return [elementToReturn, removeListeners];\n        },\n    };\n\n    return result;\n};\n","export const source = (component: string, file: string) => {\n    return `#${component}/${file}`;\n};\n","import {createComposerDom} from '@shared/components/Composer/create';\nimport {CallbackFunction} from '@shared/types/callbackFunction';\nimport {NluxRenderingError} from '@shared/types/error';\nimport {domOp} from '@shared/utils/dom/domOp';\nimport {CompRenderer} from '../../../types/comp';\nimport {listenToElement} from '../../../utils/dom/listenToElement';\nimport {source} from '../../../utils/source';\nimport {CompComposerActions, CompComposerElements, CompComposerEvents, CompComposerProps} from './composer.types';\n\nexport const renderChatbox: CompRenderer<\n    CompComposerProps, CompComposerElements, CompComposerEvents, CompComposerActions\n> = ({\n    appendToRoot,\n    props,\n    compEvent,\n}) => {\n    const composerRoot = createComposerDom(props.domCompProps);\n\n    appendToRoot(composerRoot);\n\n    const [textBoxElement, removeTextBoxListeners] = listenToElement(composerRoot, ':scope > textarea')\n        .on('input', compEvent('text-updated'))\n        .on('keydown', ((event: KeyboardEvent) => {\n            const isEnter = event.key === 'Enter' && !event.isComposing;\n            const aModifierKeyIsPressed = event.altKey || event.ctrlKey || event.metaKey || event.shiftKey;\n            if (isEnter && !aModifierKeyIsPressed) {\n                compEvent('enter-key-pressed')(event);\n                return;\n            }\n\n            const isCommandEnter = event.getModifierState('Meta') && event.key === 'Enter';\n            const isControlEnter = event.getModifierState('Control') && event.key === 'Enter';\n            if (isCommandEnter || isControlEnter) {\n                compEvent('command-enter-key-pressed')(event);\n                return;\n            }\n        }) as CallbackFunction).get();\n\n    const [sendButtonElement, removeSendButtonListeners] = listenToElement(composerRoot, ':scope > button')\n        .on('click', compEvent('send-message-clicked')).get();\n\n    if (!(sendButtonElement instanceof HTMLButtonElement)) {\n        throw new Error('Expected a button element');\n    }\n\n    if (!(textBoxElement instanceof HTMLTextAreaElement)) {\n        throw new NluxRenderingError({\n            source: source('composer', 'render'),\n            message: 'Expected a textarea element',\n        });\n    }\n\n    const focusTextInput = () => domOp(() => {\n        textBoxElement.focus();\n        textBoxElement.setSelectionRange(textBoxElement.value.length, textBoxElement.value.length);\n    });\n\n    return {\n        elements: {\n            root: composerRoot,\n            textInput: textBoxElement,\n            sendButton: sendButtonElement,\n        },\n        actions: {\n            focusTextInput,\n        },\n        onDestroy: () => {\n            removeTextBoxListeners();\n            removeSendButtonListeners();\n        },\n    };\n};\n","import {ComposerProps} from '../props';\n\nexport const updateContentOnStatusChange = (\n    element: HTMLElement,\n    propsBefore: ComposerProps,\n    propsAfter: ComposerProps,\n) => {\n    if (propsBefore.status === propsAfter.status) {\n        return;\n    }\n\n    const textArea: HTMLTextAreaElement = element.querySelector('* > textarea')!;\n    if ((propsAfter.status === 'typing' || propsAfter.status === 'waiting') && textArea.disabled) {\n        textArea.disabled = false;\n    } else {\n        if ((propsAfter.status === 'submitting-prompt' || propsAfter.status === 'submitting-conversation-starter')\n            && !textArea.disabled) {\n            textArea.disabled = true;\n        }\n    }\n\n    const submitButton: HTMLButtonElement = element.querySelector('* > button')!;\n    if (propsAfter.status === 'typing') {\n        const disableSubmitButton = propsBefore.disableSubmitButton !== propsAfter.disableSubmitButton ?\n            propsAfter.disableSubmitButton :\n            propsBefore.disableSubmitButton;\n\n        const shouldDisableSubmit = disableSubmitButton ?? textArea.value === '';\n        if (submitButton.disabled !== shouldDisableSubmit) {\n            submitButton.disabled = shouldDisableSubmit;\n        }\n    } else {\n        if (\n            (\n                propsAfter.status === 'waiting' || propsAfter.status === 'submitting-prompt'\n                || propsAfter.status === 'submitting-conversation-starter'\n            )\n            && !submitButton.disabled\n        ) {\n            submitButton.disabled = true;\n        }\n    }\n\n    if (propsBefore.placeholder !== propsAfter.placeholder) {\n        textArea.placeholder = propsAfter.placeholder ?? '';\n    }\n\n    if (propsBefore.message !== propsAfter.message) {\n        textArea.value = propsAfter.message ?? '';\n    }\n\n    if (propsBefore.autoFocus !== propsAfter.autoFocus) {\n        textArea.autofocus = propsAfter.autoFocus ?? false;\n    }\n};\n","import {DomUpdater} from '../../types/dom/DomUpdater';\nimport {ComposerProps} from './props';\nimport {applyNewStatusClassName} from './utils/applyNewStatusClassName';\nimport {updateContentOnStatusChange} from './utils/updateContentOnStatusChange';\n\nexport const updateComposerDom: DomUpdater<ComposerProps> = (\n    element,\n    propsBefore,\n    propsAfter,\n) => {\n    if (\n        propsBefore.status === propsAfter.status &&\n        propsBefore.message === propsAfter.message &&\n        propsBefore.placeholder === propsAfter.placeholder &&\n        propsBefore.autoFocus === propsAfter.autoFocus &&\n        propsBefore.disableSubmitButton === propsAfter.disableSubmitButton\n    ) {\n        return;\n    }\n\n    const textArea: HTMLTextAreaElement = element.querySelector('* > textarea')!;\n    if (propsBefore.status !== propsAfter.status) {\n        applyNewStatusClassName(element, propsAfter.status);\n        updateContentOnStatusChange(element, propsBefore, propsAfter);\n        //try to update textarea height after recieving new value or after sumbit \n        adjustHeight(textArea);\n        return;\n    }\n\n\n    if (propsBefore.placeholder !== propsAfter.placeholder) {\n        textArea.placeholder = propsAfter.placeholder ?? '';\n    }\n\n    if (propsBefore.autoFocus !== propsAfter.autoFocus) {\n        textArea.autofocus = propsAfter.autoFocus ?? false;\n    }\n\n    if (propsBefore.message !== propsAfter.message) {\n        textArea.value = propsAfter.message ?? '';\n        //try to update textarea height after recieving new value or after sumbit \n        adjustHeight(textArea);\n    }\n\n    if (propsBefore.status === 'typing') {\n        const button: HTMLButtonElement = element.querySelector('* > button')!;\n        const disableSubmitButton = propsBefore.disableSubmitButton !== propsAfter.disableSubmitButton ?\n            propsAfter.disableSubmitButton :\n            propsBefore.disableSubmitButton;\n\n        const shouldDisableSubmit = disableSubmitButton ?? textArea.value === '';\n        if (button.disabled !== shouldDisableSubmit) {\n            button.disabled = shouldDisableSubmit;\n        }\n    }\n};\n\nconst adjustHeight = (target: HTMLElement) => {\n    target.style.height = 'auto'; // Reset height\n    target.style.height = `${target.scrollHeight}px`; // Set new height based on content\n};","import {updateComposerDom} from '@shared/components/Composer/update';\nimport {CompUpdater} from '../../../types/comp';\nimport {CompComposerActions, CompComposerElements, CompComposerProps} from './composer.types';\n\nexport const updateChatbox: CompUpdater<CompComposerProps, CompComposerElements, CompComposerActions> = (\n    {\n        propName,\n        currentValue,\n        newValue,\n        dom,\n    }) => {\n    if (propName === 'domCompProps' && dom.elements?.root) {\n        updateComposerDom(dom.elements.root, currentValue, newValue);\n    }\n};\n","import {ComposerProps} from '@shared/components/Composer/props';\nimport {BaseComp} from '../../../aiChat/comp/base';\nimport {CompEventListener, Model} from '../../../aiChat/comp/decorators';\nimport {ControllerContext} from '../../../types/controllerContext';\nimport {renderChatbox} from './composer.render';\nimport {\n    CompComposerActions,\n    CompComposerElements,\n    CompComposerEventListeners,\n    CompComposerEvents,\n    CompComposerProps,\n} from './composer.types';\nimport {updateChatbox} from './composer.update';\n\n@Model('composer', renderChatbox, updateChatbox)\nexport class CompComposer<AiMsg> extends BaseComp<\n    AiMsg, CompComposerProps, CompComposerElements, CompComposerEvents, CompComposerActions\n> {\n\n    private userEventListeners?: CompComposerEventListeners;\n\n    constructor(context: ControllerContext<AiMsg>, {props, eventListeners}: {\n        props: CompComposerProps,\n        eventListeners?: CompComposerEventListeners\n    }) {\n        super(context, props);\n        this.userEventListeners = eventListeners;\n    }\n\n    public focusTextInput() {\n        this.executeDomAction('focusTextInput');\n    }\n\n    @CompEventListener('command-enter-key-pressed')\n    handleCommandEnterKeyPressed(event?: KeyboardEvent) {\n        const submitShortcut = this.getProp('domCompProps')?.submitShortcut;\n        if (submitShortcut === 'CommandEnter') {\n            this.handleSendButtonClick();\n            event?.preventDefault();\n        }\n    }\n\n    @CompEventListener('enter-key-pressed')\n    handleEnterKeyPressed(event?: KeyboardEvent) {\n        const submitShortcut = this.getProp('domCompProps')?.submitShortcut;\n        if (!submitShortcut || (submitShortcut === 'Enter' && !event?.isComposing)) {\n            this.handleSendButtonClick();\n            event?.preventDefault();\n        }\n    }\n\n    @CompEventListener('send-message-clicked')\n    handleSendButtonClick() {\n        const domCompProps = this.getProp('domCompProps');\n        if (domCompProps?.disableSubmitButton) {\n            return;\n        }\n\n        const message = domCompProps?.message;\n        if (!message) {\n            return;\n        }\n\n        const callback = this.userEventListeners?.onSubmit;\n        if (callback) {\n            callback();\n        }\n    }\n\n    handleTextChange(newValue: string) {\n        const callback = this.userEventListeners?.onTextUpdated;\n        if (callback) {\n            callback(newValue);\n        }\n\n        const currentCompProps = this.getProp('domCompProps') as ComposerProps;\n        this.setDomProps({\n            ...currentCompProps,\n            message: newValue,\n        });\n    }\n\n    @CompEventListener('text-updated')\n    handleTextInputUpdated(event: Event) {\n        const target = event.target;\n        if (!(target instanceof HTMLTextAreaElement)) {\n            return;\n        }\n\n        this.handleTextChange(target.value);\n    }\n\n    public setDomProps(props: ComposerProps) {\n        this.setProp('domCompProps', props);\n    }\n}\n","import {ChatSegment} from '../../types/chatSegment/chatSegment';\nimport {ChatItem} from '../../types/conversation';\n\nexport const chatSegmentsToChatItems = <AiMsg>(\n    chatSegments: ChatSegment<AiMsg>[],\n): ChatItem<AiMsg>[] => {\n    const chatItems: ChatItem<AiMsg>[] = [];\n    chatSegments.forEach((segment) => {\n        segment.items.forEach((item) => {\n            if (item.status !== 'complete') {\n                return;\n            }\n\n            if (item.participantRole === 'assistant') {\n                chatItems.push({\n                    role: 'assistant',\n                    message: item.content as AiMsg,\n                });\n            } else {\n                if (item.participantRole === 'user') {\n                    return chatItems.push({\n                        role: 'user',\n                        message: item.content,\n                    });\n                }\n            }\n        });\n    });\n\n    return chatItems;\n};\n","import {ChatSegmentStatus} from '../../types/chatSegment/chatSegment';\n\nexport const getChatSegmentClassName = (status: ChatSegmentStatus): string => {\n    const baseClassName = 'nlux-chatSegment';\n    if (status === 'complete') {\n        return `${baseClassName} nlux-chatSegment--complete`;\n    }\n\n    if (status === 'error') {\n        return `${baseClassName} nlux-chatSegment--error`;\n    }\n\n    // Active status\n    return `${baseClassName} nlux-chatSegment--active`;\n};\n","import {createLoaderDom} from '@shared/components/Loader/create';\nimport {getChatSegmentClassName} from '@shared/utils/dom/getChatSegmentClassName';\nimport {CompRenderer} from '../../../types/comp';\nimport {\n    CompChatSegmentActions,\n    CompChatSegmentElements,\n    CompChatSegmentEvents,\n    CompChatSegmentProps,\n} from './chatSegment.types';\n\nexport const renderChatSegment: CompRenderer<\n    CompChatSegmentProps, CompChatSegmentElements, CompChatSegmentEvents, CompChatSegmentActions\n> = ({\n    props,\n    compEvent,\n    appendToRoot,\n}) => {\n\n    // Create container\n    let loaderContainer: HTMLElement | undefined;\n    const container = document.createElement('div');\n    container.className = getChatSegmentClassName(props.status);\n\n    const showLoader = () => {\n        if (!loaderContainer) {\n            loaderContainer = document.createElement('div');\n            loaderContainer.className = 'nlux-chatSegment-loader-container';\n\n            const loaderDom = createLoaderDom();\n            loaderContainer.appendChild(loaderDom);\n            container.appendChild(loaderContainer);\n            compEvent('loader-shown')(loaderContainer);\n        }\n    };\n\n    const hideLoader = () => {\n        if (loaderContainer) {\n            loaderContainer.remove();\n            loaderContainer = undefined;\n            compEvent('loader-hidden')();\n        }\n    };\n\n    if (props.status === 'active') {\n        showLoader();\n    }\n\n    appendToRoot(container);\n    compEvent('chat-segment-ready')();\n\n    return {\n        elements: {\n            chatSegmentContainer: container,\n            loaderContainer: loaderContainer,\n        },\n        actions: {\n            showLoader,\n            hideLoader,\n        },\n        onDestroy: () => {\n            container.remove();\n        },\n    };\n};\n","import {ChatSegmentStatus} from '@shared/types/chatSegment/chatSegment';\nimport {debug} from '@shared/utils/debug';\nimport {getChatSegmentClassName} from '@shared/utils/dom/getChatSegmentClassName';\nimport {CompUpdater} from '../../../types/comp';\nimport {CompChatSegmentActions, CompChatSegmentElements, CompChatSegmentProps} from './chatSegment.types';\n\nexport const updateChatSegment: CompUpdater<\n    CompChatSegmentProps, CompChatSegmentElements, CompChatSegmentActions\n> = ({propName, newValue, dom}) => {\n    if (propName === 'status') {\n        const rootContainer: HTMLElement | undefined = dom.elements?.chatSegmentContainer;\n        if (!rootContainer) {\n            return;\n        }\n\n        const newStatus = newValue as ChatSegmentStatus;\n        rootContainer.className = getChatSegmentClassName(newStatus);\n        if (newStatus === 'active') {\n            dom.actions?.showLoader();\n        } else {\n            dom.actions?.hideLoader();\n        }\n    }\n\n    if (propName === 'uid') {\n        debug('updateChatSegment — uid is not updatable');\n        // Do nothing\n    }\n};\n","import {ParticipantRole} from '../../../../js/core/src/index';\n\nconst defaultAiName = 'Assistant';\nconst defaultHumanName = 'User';\n\nexport const participantNameFromRoleAndPersona = (\n    role: ParticipantRole,\n    personaOptions: {\n        // Only using names as PersonaOptions differs between React and Vanilla JS\n        assistant?: {name?: string};\n        user?: {name?: string}\n    } | undefined,\n): string => {\n    if (role === 'assistant') {\n        return personaOptions?.assistant?.name ?? defaultAiName;\n    }\n\n    if (role === 'user') {\n        return personaOptions?.user?.name ?? defaultHumanName;\n    }\n\n    return '';\n};\n","import {ConversationLayout} from '../../../../js/core/src';\n\nexport const conversationDefaultLayout: ConversationLayout = 'bubbles';\n\nexport const getConversationLayout = (layout?: ConversationLayout): ConversationLayout => {\n    return layout ?? conversationDefaultLayout;\n};\n","export const stringifyRandomResponse = <AiMsg>(randomResponse: AiMsg): string => {\n    if (typeof randomResponse === 'string') {\n        return randomResponse;\n    }\n\n    if (typeof randomResponse === 'object') {\n        return `${randomResponse}`;\n    }\n\n    if (randomResponse === null || randomResponse === undefined) {\n        return '';\n    }\n\n    if (typeof randomResponse.toString === 'function') {\n        return randomResponse.toString();\n    }\n\n    return JSON.stringify(randomResponse);\n};\n","import {ChatItemProps} from '@shared/components/ChatItem/props';\nimport {ChatSegmentItem} from '@shared/types/chatSegment/chatSegment';\nimport {participantNameFromRoleAndPersona} from '@shared/utils/chat/participantNameFromRoleAndPersona';\nimport {conversationDefaultLayout} from '@shared/utils/dom/getConversationLayout';\nimport {stringifyRandomResponse} from '@shared/utils/stringifyRandomResponse';\nimport {ConversationLayout} from '../../../../aiChat/options/conversationOptions';\nimport {UserPersona} from '../../../../aiChat/options/personaOptions';\n\nexport const getChatItemPropsFromSegmentItem = <AiMsg>(\n    segmentItem: ChatSegmentItem<AiMsg>,\n    conversationLayout?: ConversationLayout,\n    userPersona?: UserPersona,\n    assistantPersona?: UserPersona,\n): ChatItemProps | undefined => {\n    const layout = conversationLayout ?? conversationDefaultLayout;\n    if (segmentItem.participantRole === 'assistant') {\n        const status = segmentItem.status === 'complete' ? 'complete' : 'streaming';\n\n        if (segmentItem.dataTransferMode === 'stream') {\n            return {\n                status,\n                layout,\n                direction: 'received',\n                name: participantNameFromRoleAndPersona('assistant', {assistant: assistantPersona}),\n                avatar: assistantPersona?.avatar,\n                // We do not provide am received message for streaming segments - As it's rendered by the chat item\n                // while it's being streamed.\n            };\n        }\n\n        if (segmentItem.status === 'complete') {\n            return {\n                status,\n                layout,\n                direction: 'received',\n                name: participantNameFromRoleAndPersona('assistant', {assistant: assistantPersona}),\n                avatar: assistantPersona?.avatar,\n                message: stringifyRandomResponse<AiMsg>(segmentItem.content),\n            };\n        }\n\n        return {\n            status,\n            layout,\n            direction: 'received',\n            name: participantNameFromRoleAndPersona('assistant', {assistant: assistantPersona}),\n            avatar: assistantPersona?.avatar,\n        };\n    }\n\n    return {\n        status: 'complete',\n        layout,\n        direction: 'sent',\n        message: segmentItem.content,\n        name: participantNameFromRoleAndPersona('user', {user: userPersona}),\n        avatar: userPersona?.avatar,\n    } satisfies ChatItemProps;\n};\n","import {ChatItemProps} from '@shared/components/ChatItem/props';\nimport {ChatSegmentItem} from '@shared/types/chatSegment/chatSegment';\nimport {domOp} from '@shared/utils/dom/domOp';\nimport {warnOnce} from '@shared/utils/warn';\nimport {BaseComp} from '../../../aiChat/comp/base';\nimport {comp} from '../../../aiChat/comp/comp';\nimport {CompEventListener, Model} from '../../../aiChat/comp/decorators';\nimport {HighlighterExtension} from '../../../aiChat/highlighter/highlighter';\nimport {ConversationLayout} from '../../../aiChat/options/conversationOptions';\nimport {AssistantPersona, UserPersona} from '../../../aiChat/options/personaOptions';\nimport {ControllerContext} from '../../../types/controllerContext';\nimport {CompChatItem} from '../chatItem/chatItem.model';\nimport {CompChatItemProps} from '../chatItem/chatItem.types';\nimport {renderChatSegment} from './chatSegment.render';\nimport {\n    CompChatSegmentActions,\n    CompChatSegmentElements,\n    CompChatSegmentEvents,\n    CompChatSegmentProps,\n} from './chatSegment.types';\nimport {updateChatSegment} from './chatSegment.update';\nimport {getChatItemPropsFromSegmentItem} from './utils/getChatItemProps';\n\n@Model('chatSegment', renderChatSegment, updateChatSegment)\nexport class CompChatSegment<AiMsg> extends BaseComp<\n    AiMsg, CompChatSegmentProps, CompChatSegmentElements, CompChatSegmentEvents, CompChatSegmentActions\n> {\n    private chatItemCompIdsByIndex: string[] = [];\n    private chatItemComponentsById: Map<string, CompChatItem<AiMsg>> = new Map();\n\n    constructor(\n        context: ControllerContext<AiMsg>,\n        props: CompChatSegmentProps,\n    ) {\n        super(context, props);\n    }\n\n    public addChatItem(item: ChatSegmentItem<AiMsg>) {\n        this.throwIfDestroyed();\n        if (this.chatItemComponentsById.has(item.uid)) {\n            throw new Error(`CompChatSegment: chat item with id \"${item.uid}\" already exists`);\n        }\n\n        const compChatItemProps: ChatItemProps | undefined = getChatItemPropsFromSegmentItem(\n            item,\n            this.getProp('conversationLayout') as ConversationLayout | undefined,\n            this.getProp('userPersona') as UserPersona | undefined,\n            this.getProp('assistantPersona') as AssistantPersona | undefined,\n        );\n\n        if (!compChatItemProps) {\n            throw new Error(`CompChatSegment: chat item with id \"${item.uid}\" has invalid props`);\n        }\n\n        const newChatItemComp = comp(CompChatItem<AiMsg>)\n            .withContext(this.context)\n            .withProps({\n                uid: item.uid,\n                domProps: compChatItemProps,\n                markdownLinkTarget: this.getProp('markdownLinkTarget') as 'blank' | 'self' | undefined,\n                showCodeBlockCopyButton: this.getProp('showCodeBlockCopyButton') as boolean | undefined,\n                skipStreamingAnimation: this.getProp('skipStreamingAnimation') as boolean | undefined,\n                syntaxHighlighter: this.getProp('syntaxHighlighter') as HighlighterExtension | undefined,\n                htmlSanitizer: this.getProp('htmlSanitizer') as ((html: string) => string) | undefined,\n                streamingAnimationSpeed: this.getProp('streamingAnimationSpeed') as number | undefined,\n            } satisfies CompChatItemProps)\n            .create();\n\n        // Add the chat item to the list of chat items\n        this.chatItemComponentsById.set(item.uid, newChatItemComp);\n        this.chatItemCompIdsByIndex.push(item.uid);\n\n        if (!this.rendered) {\n            // If the chat segment is not rendered, we don't need to render the chat item yet!\n            return;\n        }\n\n        if (!this.renderedDom?.elements?.chatSegmentContainer) {\n            warnOnce('CompChatSegment: chatSegmentContainer is not available');\n            return;\n        }\n\n        newChatItemComp.render(\n            this.renderedDom.elements.chatSegmentContainer,\n            this.renderedDom.elements.loaderContainer,\n        );\n    }\n\n    public addChunk(\n        chatItemId: string,\n        chunk: AiMsg,\n        serverResponse?: string | object | undefined,\n    ) {\n        if (this.destroyed) {\n            return;\n        }\n\n        const chatItem = this.chatItemComponentsById.get(chatItemId);\n        if (!chatItem) {\n            throw new Error(`CompChatSegment: chat item with id \"${chatItemId}\" not found`);\n        }\n\n        chatItem.addChunk(chunk, serverResponse);\n    }\n\n    public complete() {\n        this.throwIfDestroyed();\n        this.chatItemComponentsById.forEach((comp) => comp.commitChunks());\n        this.setProp('status', 'complete');\n    }\n\n    destroy() {\n        this.chatItemComponentsById.forEach((comp) => comp.destroy());\n        this.chatItemComponentsById.clear();\n        this.chatItemCompIdsByIndex = [];\n        super.destroy();\n    }\n\n    public getChatItems() {\n        return this.chatItemCompIdsByIndex.map(\n            (id) => this.chatItemComponentsById.get(id),\n        ).filter((comp) => !!comp) as CompChatItem<AiMsg>[];\n    }\n\n    @CompEventListener('loader-shown')\n    onLoaderShown(loader: HTMLElement) {\n        if (this.renderedDom?.elements) {\n            this.renderedDom.elements.loaderContainer = loader;\n        }\n    }\n\n    public setAssistantPersona(assistantPersona: AssistantPersona | undefined) {\n        this.setProp('assistantPersona', assistantPersona);\n        const newProps: Partial<ChatItemProps> = {\n            name: assistantPersona?.name,\n            avatar: assistantPersona?.avatar,\n        };\n\n        this.chatItemComponentsById.forEach((comp) => {\n            if (comp.getChatSegmentItem().participantRole === 'assistant') {\n                comp.updateDomProps(newProps);\n            }\n        });\n    }\n\n    public setLayout(conversationLayout: ConversationLayout) {\n        this.setProp('conversationLayout', conversationLayout);\n        this.chatItemComponentsById.forEach((comp) => {\n            comp.updateDomProps({\n                layout: conversationLayout,\n            });\n        });\n    }\n\n    public setUserPersona(userPersona: UserPersona | undefined) {\n        this.setProp('userPersona', userPersona);\n        const newProps: Partial<ChatItemProps> = {\n            name: userPersona?.name,\n            avatar: userPersona?.avatar,\n        };\n\n        this.chatItemComponentsById.forEach((comp) => {\n            if (comp.getChatSegmentItem().participantRole === 'user') {\n                comp.updateDomProps(newProps);\n            }\n        });\n    }\n\n    public updateMarkdownStreamRenderer(\n        newProp: keyof CompChatSegmentProps,\n        newValue: CompChatSegmentProps[keyof CompChatSegmentProps],\n    ) {\n        this.setProp(newProp, newValue);\n    }\n\n    protected setProp<K extends keyof CompChatSegmentProps>(key: K, value: CompChatSegmentProps[K]) {\n        super.setProp(key, value);\n\n        if (\n            key === 'markdownLinkTarget' || key === 'syntaxHighlighter' || key === 'htmlSanitizer' ||\n            key === 'skipStreamingAnimation' || key === 'streamingAnimationSpeed'\n        ) {\n            this.chatItemComponentsById.forEach((comp) => {\n                comp.updateMarkdownStreamRenderer(\n                    key satisfies keyof CompChatItemProps,\n                    value as CompChatItemProps[keyof CompChatItemProps],\n                );\n            });\n        }\n    }\n\n    @CompEventListener('chat-segment-ready')\n    private onChatSegmentReady() {\n        domOp(() => {\n            if (!this.renderedDom?.elements?.chatSegmentContainer) {\n                return;\n            }\n\n            const chatSegmentContainer = this.renderedDom?.elements?.chatSegmentContainer;\n            this.chatItemComponentsById.forEach((comp) => {\n                if (!comp.rendered) {\n                    comp.render(chatSegmentContainer);\n                }\n            });\n        });\n    }\n\n    @CompEventListener('loader-hidden')\n    private onLoaderHidden() {\n        if (this.renderedDom?.elements) {\n            this.renderedDom.elements.loaderContainer = undefined;\n        }\n    }\n}\n","import {AnyAiMsg} from '@shared/types/anyAiMsg';\nimport {CompRenderer} from '../../../types/comp';\nimport {\n    CompConversationActions,\n    CompConversationElements,\n    CompConversationEvents,\n    CompConversationProps,\n} from './conversation.types';\n\nexport const renderConversation: CompRenderer<\n    CompConversationProps<AnyAiMsg>, CompConversationElements, CompConversationEvents, CompConversationActions\n> = ({appendToRoot}) => {\n\n    const segmentsContainer = document.createElement('div') as HTMLElement;\n    segmentsContainer.classList.add('nlux-chatSegments-container');\n    appendToRoot(segmentsContainer);\n\n    return {\n        elements: {\n            segmentsContainer,\n        },\n        actions: {},\n    };\n};\n","import {AnyAiMsg} from '@shared/types/anyAiMsg';\nimport {CompUpdater} from '../../../types/comp';\nimport {CompConversationActions, CompConversationElements, CompConversationProps} from './conversation.types';\n\nexport const updateConversation: CompUpdater<\n    CompConversationProps<AnyAiMsg>, CompConversationElements, CompConversationActions\n> = () => {\n    // No update logic\n};\n","import {ChatSegment, ChatSegmentItem, ChatSegmentStatus} from '@shared/types/chatSegment/chatSegment';\nimport {ChatItem} from '@shared/types/conversation';\nimport {chatSegmentsToChatItems} from '@shared/utils/chat/chatSegmentsToChatItems';\nimport {debug} from '@shared/utils/debug';\nimport {uid} from '@shared/utils/uid';\nimport {warnOnce} from '@shared/utils/warn';\nimport {BaseComp} from '../../../aiChat/comp/base';\nimport {comp} from '../../../aiChat/comp/comp';\nimport {Model} from '../../../aiChat/comp/decorators';\nimport {HighlighterExtension} from '../../../aiChat/highlighter/highlighter';\nimport {ConversationLayout, HistoryPayloadSize} from '../../../aiChat/options/conversationOptions';\nimport {AssistantPersona, UserPersona} from '../../../aiChat/options/personaOptions';\nimport {ControllerContext} from '../../../types/controllerContext';\nimport {CompChatSegment} from '../chatSegment/chatSegment.model';\nimport {CompChatSegmentProps} from '../chatSegment/chatSegment.types';\nimport {renderConversation} from './conversation.render';\nimport {\n    CompConversationActions,\n    CompConversationElements,\n    CompConversationEvents,\n    CompConversationProps,\n} from './conversation.types';\nimport {updateConversation} from './conversation.update';\n\n@Model('conversation', renderConversation, updateConversation)\nexport class CompConversation<AiMsg> extends BaseComp<\n    AiMsg, CompConversationProps<AiMsg>, CompConversationElements, CompConversationEvents, CompConversationActions\n> {\n    private chatSegmentCompIdsByIndex: string[] = [];\n    private chatSegmentComponentsById: Map<string, CompChatSegment<AiMsg>> = new Map();\n\n    constructor(context: ControllerContext<AiMsg>, props: CompConversationProps<AiMsg>) {\n        super(context, props);\n\n        if (props.messages && props.messages.length > 0) {\n            this.addChatSegment('complete', props.messages);\n        }\n    }\n\n    public addChatItem(segmentId: string, item: ChatSegmentItem<AiMsg>) {\n        const chatSegment = this.chatSegmentComponentsById.get(segmentId);\n        if (!chatSegment) {\n            throw new Error(`CompConversation: chat segment with id \"${segmentId}\" not found`);\n        }\n\n        if (chatSegment.destroyed) {\n            // This could happen when streaming messages are received after the chat segment is destroyed\n            warnOnce(`CompConversation: chat segment with id \"${segmentId}\" is destroyed and cannot be used`);\n            return;\n        }\n\n        chatSegment.addChatItem(item);\n    }\n\n    public addChatSegment(\n        status: ChatSegmentStatus = 'active',\n        initialConversation?: ChatItem<AiMsg>[],\n    ) {\n        this.throwIfDestroyed();\n\n        const segmentId = uid();\n        const newChatSegmentComp: CompChatSegment<AiMsg> = comp(CompChatSegment<AiMsg>)\n            .withContext(this.context)\n            .withProps({\n                uid: segmentId,\n                status,\n                conversationLayout: this.getProp('conversationLayout') as ConversationLayout,\n                userPersona: this.getProp('userPersona') as UserPersona | undefined,\n                assistantPersona: this.getProp('assistantPersona') as AssistantPersona | undefined,\n                markdownLinkTarget: this.getProp('markdownLinkTarget') as 'blank' | 'self' | undefined,\n                showCodeBlockCopyButton: this.getProp('showCodeBlockCopyButton') as boolean | undefined,\n                skipStreamingAnimation: this.getProp('skipStreamingAnimation') as boolean | undefined,\n                syntaxHighlighter: this.getProp('syntaxHighlighter') as HighlighterExtension | undefined,\n                htmlSanitizer: this.getProp('htmlSanitizer') as ((html: string) => string) | undefined,\n                streamingAnimationSpeed: this.getProp('streamingAnimationSpeed') as number | undefined,\n            } satisfies CompChatSegmentProps)\n            .create();\n\n        if (initialConversation) {\n            for (const item of initialConversation) {\n                if (item.role === 'assistant') {\n                    newChatSegmentComp.addChatItem({\n                        uid: uid(),\n                        participantRole: 'assistant',\n                        time: new Date(),\n                        dataTransferMode: 'batch',\n                        status: 'complete',\n                        content: item.message,\n                        serverResponse: item.serverResponse,\n                        contentType: 'text',\n                    });\n                } else {\n                    if (item.role === 'user') {\n                        newChatSegmentComp.addChatItem({\n                            uid: uid(),\n                            participantRole: 'user',\n                            time: new Date(),\n                            status: 'complete',\n                            content: item.message,\n                            contentType: 'text',\n                        });\n                    } else {\n                        // System messages will not be displayed in the chat\n                    }\n                }\n            }\n        }\n\n        // Add the chat segment to the map and the index\n        this.chatSegmentComponentsById.set(segmentId, newChatSegmentComp);\n        this.chatSegmentCompIdsByIndex.push(segmentId);\n\n        const segmentComponentId = newChatSegmentComp.id;\n        this.addSubComponent(segmentComponentId, newChatSegmentComp, 'segmentsContainer');\n        this.notifyAboutSegmentCountChange(this.chatSegmentCompIdsByIndex.length);\n\n        return segmentId;\n    };\n\n    public addChunk(\n        segmentId: string,\n        chatItemId: string,\n        chunk: AiMsg,\n        serverResponse?: string | object | undefined,\n    ) {\n        const chatSegment = this.chatSegmentComponentsById.get(segmentId);\n        if (!chatSegment) {\n            throw new Error(`CompConversation: chat segment with id \"${segmentId}\" not found`);\n        }\n\n        chatSegment.addChunk(chatItemId, chunk, serverResponse);\n    }\n\n    public completeChatSegment(segmentId: string) {\n        const chatSegment = this.chatSegmentComponentsById.get(segmentId);\n        if (!chatSegment) {\n            throw new Error(`CompConversation: chat segment with id \"${segmentId}\" not found`);\n        }\n\n        if (chatSegment.destroyed) {\n            // This could happen when streaming messages are received after the chat segment is destroyed\n            debug(`CompConversation: chat segment with id \"${segmentId}\" is destroyed and cannot be used`);\n            return;\n        }\n\n        chatSegment.complete();\n    }\n\n    public getChatSegmentContainer(segmentId: string): HTMLElement | undefined {\n        const chatSegment = this.chatSegmentComponentsById.get(segmentId);\n        if (chatSegment?.root instanceof HTMLElement) {\n            return chatSegment.root;\n        }\n    }\n\n    public getConversationContentForAdapter(\n        historyPayloadSize: HistoryPayloadSize = 'max',\n    ): ChatItem<AiMsg>[] | undefined {\n        if (typeof historyPayloadSize === 'number' && historyPayloadSize < 0) {\n            warnOnce(\n                `Invalid value provided for 'historyPayloadSize' : \"${historyPayloadSize}\"! ` +\n                `Value must be a positive integer or 'max'.`,\n            );\n\n            return undefined;\n        }\n\n        if (historyPayloadSize === 0) {\n            return undefined;\n        }\n\n        const allSegmentsSorted: ChatSegment<AiMsg>[] = this.chatSegmentCompIdsByIndex.map(\n            (segmentId) => this.chatSegmentComponentsById.get(segmentId),\n        ).filter(\n            item => item !== undefined,\n        ).map(\n            (item) => {\n                return {\n                    uid: item!.id,\n                    status: 'complete',\n                    items: item!.getChatItems().map(\n                        compChatItem => compChatItem.getChatSegmentItem(),\n                    ),\n                } satisfies ChatSegment<AiMsg>;\n            },\n        ); // Filter out undefined values\n\n        const allChatItems = chatSegmentsToChatItems(allSegmentsSorted);\n\n        if (historyPayloadSize === 'max') {\n            return allChatItems;\n        }\n\n        return allChatItems.slice(-historyPayloadSize);\n    }\n\n    public removeChatSegment(segmentId: string) {\n        const chatSegment = this.chatSegmentComponentsById.get(segmentId);\n        if (!chatSegment) {\n            return;\n        }\n\n        const segmentCompId = chatSegment.id;\n        if (this.subComponents.has(segmentCompId)) {\n            this.removeSubComponent(segmentCompId);\n        }\n\n        // Remove the chat segment from the map and the index\n        this.chatSegmentComponentsById.delete(chatSegment.id);\n        const index = this.chatSegmentCompIdsByIndex.indexOf(segmentId);\n        if (index >= 0) {\n            this.chatSegmentCompIdsByIndex.splice(index, 1);\n        }\n\n        this.notifyAboutSegmentCountChange(this.chatSegmentCompIdsByIndex.length);\n    }\n\n    public setAssistantPersona(assistantPersona: AssistantPersona | undefined) {\n        this.setProp('assistantPersona', assistantPersona);\n        this.chatSegmentComponentsById.forEach((comp) => {\n            comp.setAssistantPersona(assistantPersona);\n        });\n    }\n\n    public setConversationLayout(layout: ConversationLayout) {\n        this.setProp('conversationLayout', layout);\n        this.chatSegmentComponentsById.forEach((comp) => {\n            comp.setLayout(layout);\n        });\n    }\n\n    public setUserPersona(userPersona: UserPersona | undefined) {\n        this.setProp('userPersona', userPersona);\n        this.chatSegmentComponentsById.forEach((comp) => {\n            comp.setUserPersona(userPersona);\n        });\n    }\n\n    public updateMarkdownStreamRenderer(\n        newProp: keyof CompConversationProps<AiMsg>,\n        newValue: CompConversationProps<AiMsg>[typeof newProp],\n    ) {\n        this.setProp(newProp, newValue);\n    }\n\n    protected setProp<K extends keyof CompConversationProps<AiMsg>>(key: K, value: CompConversationProps<AiMsg>[K]) {\n        super.setProp(key, value);\n\n        if (\n            key === 'markdownLinkTarget' || key === 'syntaxHighlighter' || key === 'htmlSanitizer' ||\n            key === 'skipStreamingAnimation' || key === 'streamingAnimationSpeed' ||\n            key === 'showCodeBlockCopyButton'\n        ) {\n            const typedKey = key satisfies keyof CompChatSegmentProps;\n            const typedValue = value as CompChatSegmentProps[typeof typedKey];\n\n            this.chatSegmentComponentsById.forEach((comp) => {\n                comp.updateMarkdownStreamRenderer(typedKey, typedValue);\n            });\n        }\n    }\n\n    private notifyAboutSegmentCountChange(newCount: number) {\n        const callback = this.getProp(\n            'onSegmentCountChange',\n        ) as CompConversationProps<AiMsg>[ 'onSegmentCountChange'] | undefined;\n\n        if (callback) {\n            callback(newCount);\n        }\n    }\n}\n","import {ConversationStarter} from '../../../../types/conversationStarter';\n\nexport const createConversationStartersDom = (\n    conversationStarters: ConversationStarter[],\n): HTMLElement => {\n    const conversationStartersContainer = document.createElement('div');\n    conversationStartersContainer.classList.add('nlux-comp-conversationStarters');\n\n    conversationStarters.forEach((item, index) => {\n        const conversationStarter = document.createElement('button');\n        conversationStarter.classList.add('nlux-comp-conversationStarter');\n\n        // start with empty html tag\n        let conversationStarterIcon: HTMLElement = document.createElement('div');\n        if (item.icon) {\n            // if icon is specified\n            // check if it is a string\n            if (typeof item.icon === 'string') {\n                conversationStarterIcon = document.createElement('img');\n                conversationStarterIcon.setAttribute('src', item.icon);\n                conversationStarterIcon.setAttribute('width', '16px');\n            } else {\n                // if not, icon must be a html element\n                conversationStarterIcon.className =\n                    'nlux-comp-conversationStarter-icon-container';\n\n                conversationStarterIcon.appendChild(item.icon);\n            }\n        }\n\n        const conversationStarterText = document.createElement('span');\n        conversationStarterText.classList.add(\n            'nlux-comp-conversationStarter-prompt',\n        );\n        conversationStarterText.textContent = item.label ?? item.prompt;\n\n        conversationStarter.appendChild(conversationStarterIcon);\n        conversationStarter.appendChild(conversationStarterText);\n        conversationStartersContainer.appendChild(conversationStarter);\n    });\n\n    return conversationStartersContainer;\n};\n","import {CompRenderer} from '../../../types/comp';\nimport {listenToElement} from '../../../utils/dom/listenToElement';\nimport {\n    CompConversationStartersActions,\n    CompConversationStartersElements,\n    CompConversationStartersEvents,\n    CompConversationStartersProps,\n} from './conversationStarters.types';\nimport {createConversationStartersDom} from './utils/createConversationStartersDom';\n\nexport const renderConversationStarters: CompRenderer<\n    CompConversationStartersProps,\n    CompConversationStartersElements,\n    CompConversationStartersEvents,\n    CompConversationStartersActions\n> = ({\n    appendToRoot,\n    props,\n    compEvent,\n}) => {\n    const conversationStartersContainer = createConversationStartersDom(\n        props.conversationStarters,\n    );\n\n    appendToRoot(conversationStartersContainer);\n\n    // Register click event listeners for each conversation starter\n    let conversationStarterEventListenersCleanupFns: (() => void)[] = [];\n    props.conversationStarters.forEach((conversationStarter, index) => {\n        const [_element, removeListener] = listenToElement(\n            conversationStartersContainer,\n            `:scope > :nth-child(${index + 1})`,\n        ).on('click', () => {\n            compEvent('conversation-starter-selected')(conversationStarter);\n        }).get();\n\n        conversationStarterEventListenersCleanupFns.push(removeListener);\n    });\n\n    return {\n        elements: {},\n        actions: {},\n        onDestroy: () => {\n            conversationStarterEventListenersCleanupFns.forEach((fn) => fn());\n            conversationStarterEventListenersCleanupFns = [];\n            conversationStartersContainer.remove();\n        },\n    };\n};\n","import {CompUpdater} from '../../../types/comp';\nimport {\n    CompConversationStartersActions,\n    CompConversationStartersElements,\n    CompConversationStartersProps,\n} from './conversationStarters.types';\n\nexport const updateConversationStarters: CompUpdater<\n    CompConversationStartersProps,\n    CompConversationStartersElements,\n    CompConversationStartersActions\n> = ({}) => {\n    // No update logic\n};\n","import {BaseComp} from '../../../aiChat/comp/base';\nimport {CompEventListener, Model} from '../../../aiChat/comp/decorators';\nimport {ControllerContext} from '../../../types/controllerContext';\nimport {ConversationStarter} from '../../../types/conversationStarter';\nimport {renderConversationStarters} from './conversationStarters.renderer';\nimport {\n    CompConversationStartersActions,\n    CompConversationStartersElements,\n    CompConversationStartersEvents,\n    CompConversationStartersProps,\n} from './conversationStarters.types';\nimport {updateConversationStarters} from './conversationStarters.update';\n\n@Model('conversationStarters', renderConversationStarters, updateConversationStarters)\nexport class CompConversationStarters<AiMsg> extends BaseComp<\n    AiMsg,\n    CompConversationStartersProps,\n    CompConversationStartersElements,\n    CompConversationStartersEvents,\n    CompConversationStartersActions\n> {\n    public updateConversationStarters = (items: ConversationStarter[] | undefined): void => {\n        // TODO\n    };\n\n    constructor(context: ControllerContext<AiMsg>, props: CompConversationStartersProps) {\n        super(context, props);\n    }\n\n    @CompEventListener('conversation-starter-selected')\n    conversationStarterClicked(conversationStarter: ConversationStarter) {\n        const handler = this.getProp(\n            'onConversationStarterSelected') as CompConversationStartersProps['onConversationStarterSelected'];\n        handler(conversationStarter);\n    };\n}\n","export const greetingTextClassName = 'nlux-comp-welcomeMessage-text';\n\nexport const updateGreetingText = (\n    root: HTMLElement,\n    newGreeting: string | undefined,\n) => {\n    const greetingContainer = root.querySelector(`.${greetingTextClassName}`);\n    if (newGreeting === '' || newGreeting === undefined) {\n        greetingContainer?.remove();\n        return;\n    }\n\n    if (greetingContainer) {\n        greetingContainer.textContent = newGreeting;\n    } else {\n        const greetingTextContainer = document.createElement('div');\n        greetingTextContainer.classList.add(greetingTextClassName);\n        greetingTextContainer.textContent = newGreeting;\n        root.appendChild(greetingTextContainer);\n    }\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {createAvatarDom} from '../Avatar/create';\nimport {GreetingProps} from './props';\nimport {updateGreetingText} from './utils/updateGreetingText';\n\nexport const className = 'nlux-comp-welcomeMessage';\nexport const personaNameClassName = 'nlux-comp-welcomeMessage-personaName';\n\nexport const createGreetingDom: DomCreator<GreetingProps> = (\n    props,\n): HTMLElement => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    const personaAvatar = createAvatarDom({\n        name: props.name,\n        avatar: props.avatar,\n    });\n    element.append(personaAvatar);\n\n    const personaName = document.createElement('div');\n    const nameTextNode = document.createTextNode(props.name);\n    personaName.append(nameTextNode);\n    personaName.classList.add(personaNameClassName);\n    element.append(personaName);\n\n    updateGreetingText(element, props.message);\n\n    return element;\n};\n","export const getNluxSmallPngLogo = () => {\n    return (\n        `data:image/png;base64,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`\n    );\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {createGreetingDom} from '../Greeting/create';\nimport {getNluxSmallPngLogo} from '../Logo/getNluxSmallPngLogo';\n\nexport const createDefaultGreetingDom: DomCreator<void> = (): HTMLElement => {\n    return createGreetingDom({\n        name: '',\n        avatar: getNluxSmallPngLogo(),\n    });\n};\n","import {DomUpdater} from '../../types/dom/DomUpdater';\nimport {className as avatarClassName} from '../Avatar/create';\nimport {updateAvatarDom} from '../Avatar/update';\nimport {personaNameClassName} from './create';\nimport {GreetingProps} from './props';\nimport {updateGreetingText} from './utils/updateGreetingText';\n\nexport const updateGreetingDom: DomUpdater<GreetingProps> = (\n    element,\n    propsBefore,\n    propsAfter,\n): void => {\n    if (\n        propsBefore.message === propsAfter.message &&\n        propsBefore.name === propsAfter.name &&\n        propsBefore.avatar === propsAfter.avatar\n    ) {\n        return;\n    }\n\n    if (propsBefore.message !== propsAfter.message) {\n        updateGreetingText(element, propsAfter.message);\n    }\n\n    if (propsBefore.name !== propsAfter.name) {\n        const nameElement = element.querySelector(`.${personaNameClassName}`);\n        if (nameElement) {\n            const nameTextNode = document.createTextNode(propsAfter.name);\n            nameElement.replaceChildren(nameTextNode);\n        }\n    }\n\n    if (\n        propsBefore.avatar !== propsAfter.avatar ||\n        propsBefore.name !== propsAfter.name\n    ) {\n        const avatarElement = element.querySelector<HTMLElement>(`.${avatarClassName}`);\n        if (avatarElement) {\n            updateAvatarDom(\n                avatarElement,\n                {\n                    name: propsBefore.name,\n                    avatar: propsBefore.avatar,\n                },\n                {\n                    name: propsAfter.name,\n                    avatar: propsAfter.avatar,\n                },\n            );\n        }\n    }\n};\n","import {createDefaultGreetingDom} from '@shared/components/DefaultGreeting/create';\nimport {createGreetingDom} from '@shared/components/Greeting/create';\nimport {updateGreetingDom} from '@shared/components/Greeting/update';\nimport {AssistantPersona} from '../../../aiChat/options/personaOptions';\nimport {CompRenderer} from '../../../types/comp';\nimport {ConversationStarter} from '../../../types/conversationStarter';\nimport {CompLaunchPadActions, CompLaunchPadElements, CompLaunchPadEvents, CompLaunchPadProps} from './launchPad.types';\n\nexport const renderLaunchPad: CompRenderer<\n    CompLaunchPadProps,\n    CompLaunchPadElements,\n    CompLaunchPadEvents,\n    CompLaunchPadActions\n> = ({appendToRoot, props},\n) => {\n\n    const renderingContext: {\n        assistantPersona: AssistantPersona | undefined;\n        conversationStarters: ConversationStarter[] | undefined;\n        showGreeting: boolean;\n\n        greetingElement?: HTMLElement,\n        conversationStartersContainer?: HTMLElement,\n    } = {\n        assistantPersona: props.assistantPersona,\n        conversationStarters: props.conversationStarters,\n        showGreeting: props.showGreeting !== false,\n    };\n\n    //\n    // Create greetings container\n    // and append it to the root if personaOptions are provided\n    //\n    let greetingDom: HTMLElement | undefined;\n    if (renderingContext.showGreeting) {\n        if (props.assistantPersona) {\n            const assistant = props.assistantPersona;\n            greetingDom = createGreetingDom({\n                name: assistant.name,\n                avatar: assistant.avatar,\n                message: assistant.tagline,\n            });\n        } else {\n            // No assistant persona provided, render default greeting message\n            // which is the NLUX logo\n            greetingDom = createDefaultGreetingDom();\n        }\n    }\n\n    if (greetingDom) {\n        appendToRoot(greetingDom);\n        renderingContext.greetingElement = greetingDom;\n    }\n\n    //\n    // Containers\n    //\n\n    const conversationStartersContainer = document.createElement('div') as HTMLElement;\n    conversationStartersContainer.classList.add('nlux-conversationStarters-container');\n    appendToRoot(conversationStartersContainer);\n\n    const resetGreeting = (showGreeting: boolean = true) => {\n        renderingContext.showGreeting = showGreeting;\n\n        if (renderingContext.greetingElement) {\n            renderingContext.greetingElement.remove();\n            renderingContext.greetingElement = undefined;\n        }\n\n        if (!showGreeting) {\n            return;\n        }\n\n        renderingContext.greetingElement = renderingContext.assistantPersona\n            ? createGreetingDom({\n                name: renderingContext.assistantPersona.name,\n                avatar: renderingContext.assistantPersona.avatar,\n                message: renderingContext.assistantPersona.tagline,\n            })\n            : createDefaultGreetingDom();\n\n        if (renderingContext.greetingElement) {\n            conversationStartersContainer.insertAdjacentElement(\n                'beforebegin',\n                renderingContext.greetingElement,\n            );\n        }\n    };\n\n    return {\n        elements: {\n            conversationStartersContainer,\n        },\n        actions: {\n            resetGreeting: (showGreeting: boolean = true) => {\n                // This will reset the assistant greeting\n                // It can either result in displaying the NLUX logo or the assistant greeting\n                // depending on the assistant persona value provided\n                resetGreeting(showGreeting);\n            },\n            updateAssistantPersona: (newValue: AssistantPersona | undefined) => {\n                const previousAssistantPersona = renderingContext.assistantPersona;\n                renderingContext.assistantPersona = newValue;\n\n                // Nothing has changed, do nothing\n                if ((!previousAssistantPersona && !newValue) || !renderingContext.showGreeting) {\n                    return;\n                }\n\n                // This will remove the assistant greeting and display the NLUX logo\n                if (!newValue) {\n                    resetGreeting();\n                    return;\n                }\n\n                if (previousAssistantPersona) {\n                    // This will update the assistant greeting\n                    updateGreetingDom(renderingContext.greetingElement!, {\n                        name: previousAssistantPersona?.name,\n                        avatar: previousAssistantPersona?.avatar,\n                        message: previousAssistantPersona?.tagline,\n                    }, {\n                        name: newValue.name,\n                        avatar: newValue.avatar,\n                        message: newValue.tagline,\n                    });\n                } else {\n                    // This will add the assistant greeting\n                    resetGreeting();\n                }\n            },\n        },\n        onDestroy: () => {\n            renderingContext.greetingElement?.remove();\n            conversationStartersContainer.remove();\n        },\n    };\n};\n","import {CompUpdater} from '../../../types/comp';\nimport {CompLaunchPadActions, CompLaunchPadElements, CompLaunchPadProps} from './launchPad.types';\n\nexport const updateLaunchPad: CompUpdater<\n    CompLaunchPadProps,\n    CompLaunchPadElements,\n    CompLaunchPadActions\n> = ({}) => {\n    // No update logic\n};\n","import {BaseComp} from '../../../aiChat/comp/base';\nimport {comp} from '../../../aiChat/comp/comp';\nimport {Model} from '../../../aiChat/comp/decorators';\nimport {AssistantPersona} from '../../../aiChat/options/personaOptions';\nimport {ControllerContext} from '../../../types/controllerContext';\nimport {ConversationStarter} from '../../../types/conversationStarter';\nimport {CompConversationStarters} from '../conversationStarters/conversationStarters.model';\nimport {CompConversationStartersProps} from '../conversationStarters/conversationStarters.types';\nimport {renderLaunchPad} from './launchPad.renderer';\nimport {CompLaunchPadActions, CompLaunchPadElements, CompLaunchPadEvents, CompLaunchPadProps} from './launchPad.types';\nimport {updateLaunchPad} from './launchPad.update';\n\n@Model('launchPad', renderLaunchPad, updateLaunchPad)\nexport class CompLaunchPad<AiMsg> extends BaseComp<\n    AiMsg,\n    CompLaunchPadProps,\n    CompLaunchPadElements,\n    CompLaunchPadEvents,\n    CompLaunchPadActions\n> {\n    private conversationStartersComp: CompConversationStarters<AiMsg> | undefined;\n\n    constructor(context: ControllerContext<AiMsg>, props: CompLaunchPadProps) {\n        super(context, props);\n        this.setConversationStarters(props.conversationStarters);\n    }\n\n    public setAssistantPersona(assistantPersona: AssistantPersona | undefined) {\n        this.setProp('assistantPersona', assistantPersona);\n        this.executeDomAction('updateAssistantPersona', assistantPersona);\n    }\n\n    public setConversationStarters(conversationStarters: ConversationStarter[] | undefined) {\n        if (!conversationStarters && !this.conversationStartersComp) {\n            return;\n        }\n\n        if (conversationStarters && !this.conversationStartersComp) {\n            const onConversationStarterSelected = this.getProp(\n                'onConversationStarterSelected',\n            ) as CompLaunchPadProps['onConversationStarterSelected'];\n\n            this.conversationStartersComp = comp(CompConversationStarters<AiMsg>)\n                .withContext(this.context)\n                .withProps({\n                    conversationStarters,\n                    onConversationStarterSelected,\n                } satisfies CompConversationStartersProps)\n                .create();\n\n            this.addSubComponent(\n                this.conversationStartersComp.id,\n                this.conversationStartersComp,\n                'conversationStartersContainer',\n            );\n\n            return;\n        }\n\n        if (!conversationStarters && this.conversationStartersComp) {\n            this.removeSubComponent(this.conversationStartersComp.id);\n            this.conversationStartersComp = undefined;\n        } else {\n            this.conversationStartersComp?.updateConversationStarters(conversationStarters);\n        }\n    }\n\n    public setShowGreeting(showGreeting: boolean) {\n        this.setProp('showGreeting', showGreeting);\n        this.executeDomAction('resetGreeting', showGreeting);\n    }\n\n    private resetConversationStarters() {\n        const conversationStarters = this.getProp('conversationStarters') as ConversationStarter[] | undefined;\n        this.setConversationStarters(conversationStarters);\n    }\n}\n","import {DataTransferMode, StreamingAdapterObserver} from './chatAdapter';\nimport {ChatAdapterExtras} from './chatAdapterExtras';\nimport {StandardAdapterInfo} from './standardAdapterConfig';\n\n/**\n * This interface is used by standard adapters provided by nlux to communicate with the AiChat component.\n */\nexport interface StandardChatAdapter<AiMsg = string> {\n    batchText(\n        message: string,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): Promise<string | object | undefined>;\n    get dataTransferMode(): DataTransferMode;\n    get id(): string;\n\n    get info(): StandardAdapterInfo;\n\n    // Receives a message from the API and returns a message that can be sent to the user.\n    // can be displayed to the user (either text or input for a custom component).\n    preProcessAiBatchedMessage(\n        message: string | object | undefined,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): AiMsg | undefined;\n    // This method is called by AiChat when the API sends a message to convert that message into a format that\n    preProcessAiStreamedChunk(\n        chunk: string | object | undefined,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): AiMsg | undefined;\n    streamText(\n        message: string,\n        observer: StreamingAdapterObserver<string | object | undefined>,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): void;\n}\n\n/**\n * This function is used to determine if an object is a standard chat adapter or not.\n * @param adapter\n */\nexport const isStandardChatAdapter = (adapter: unknown): boolean => {\n    if (typeof adapter !== 'object' || adapter === null) {\n        return false;\n    }\n\n    const typedAdapter = adapter as Record<string, unknown>;\n    return (typeof typedAdapter.streamText === 'function' || typeof typedAdapter.batchText === 'function')\n        && ['stream', 'batch'].includes(typedAdapter.dataTransferMode as string)\n        && typeof typedAdapter.id === 'string'\n        && (typeof typedAdapter.info === 'object' && typedAdapter.info !== null)\n        && (typeof typedAdapter.preProcessAiBatchedMessage === 'function')\n        && (typeof typedAdapter.preProcessAiStreamedChunk === 'function');\n};\n","import {CallbackFunction} from '../../../types/callbackFunction';\n\nconst isHighPerfJsEngine = typeof navigator !== 'undefined' && navigator?.userAgent?.includes('Safari');\n\n// TODO: To be replaced with a pure React implementation for submitPrompt that relies on React rendering cycle\nconst defaultAsyncDelay: 1 | 100 = isHighPerfJsEngine ? 100 : 1; // Efficient async scheduling for Safari\n\nexport const triggerAsyncCallback = (trigger: CallbackFunction, delay: number = defaultAsyncDelay) => {\n    setTimeout(() => {\n        trigger();\n    }, delay);\n};\n","import {ChatAdapter} from '../../types/adapters/chat/chatAdapter';\nimport {ChatAdapterExtras} from '../../types/adapters/chat/chatAdapterExtras';\nimport {isStandardChatAdapter, StandardChatAdapter} from '../../types/adapters/chat/standardChatAdapter';\nimport {ChatSegment} from '../../types/chatSegment/chatSegment';\nimport {AiBatchedMessage} from '../../types/chatSegment/chatSegmentAiMessage';\nimport {\n    AiMessageReceivedCallback,\n    ChatSegmentCompleteCallback,\n    ChatSegmentErrorCallback,\n} from '../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentUserMessage} from '../../types/chatSegment/chatSegmentUserMessage';\nimport {NLErrorId} from '../../types/exceptions/errors';\nimport {uid} from '../../utils/uid';\nimport {warn} from '../../utils/warn';\nimport {triggerAsyncCallback} from './utils/triggerAsyncCallback';\n\nexport const submitAndBatchTextResponse = async <AiMsg>(\n    segmentId: string,\n    userMessage: ChatSegmentUserMessage,\n    adapter: ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n    extras: ChatAdapterExtras<AiMsg>,\n    aiMessageReceivedCallbacks: Set<AiMessageReceivedCallback<AiMsg>>,\n    chatSegmentCompleteCallbacks: Set<ChatSegmentCompleteCallback<AiMsg>>,\n    chatSegmentExceptionCallbacks: Set<ChatSegmentErrorCallback>,\n): Promise<void> => {\n    try {\n        const prompt = userMessage.content;\n\n        const adapterAsStandardAdapter = isStandardChatAdapter(adapter)\n            ? adapter as unknown as StandardChatAdapter<AiMsg>\n            : undefined;\n\n        const isStandardAdapter = adapterAsStandardAdapter !== undefined;\n\n\n        const responseUid = uid();\n        const participantRole = 'assistant';\n        const status = 'complete';\n        const time = new Date();\n        const dataTransferMode = 'batch';\n\n        let aiResponse: AiBatchedMessage<AiMsg> | undefined = undefined;\n        if (isStandardAdapter) {\n            const rawResponse = await adapterAsStandardAdapter.batchText!(prompt, extras);\n            const preProcessedResponse = adapterAsStandardAdapter.preProcessAiBatchedMessage(rawResponse, extras);\n            if (preProcessedResponse !== undefined && preProcessedResponse !== null) {\n                aiResponse = {\n                    uid: responseUid,\n                    content: preProcessedResponse,\n                    contentType: 'text',\n                    serverResponse: rawResponse,\n                    participantRole, status, time, dataTransferMode,\n                };\n            }\n        } else {\n            const response = await (adapter as ChatAdapter<AiMsg>).batchText!(prompt, extras);\n            aiResponse = {\n                uid: responseUid,\n                content: response,\n                contentType: 'text',\n                serverResponse: undefined,\n                participantRole, status, time, dataTransferMode,\n            };\n        }\n\n        if (!aiResponse) {\n            throw new Error('Response from adapter was undefined or cannot be processed');\n        }\n\n        //\n        // We emit the AI message received event.\n        //\n        const validAiResponse = aiResponse as AiBatchedMessage<AiMsg> & {\n            status: 'complete';\n        };\n\n        triggerAsyncCallback(() => {\n            aiMessageReceivedCallbacks.forEach((callback) => {\n                callback(validAiResponse);\n            });\n        });\n\n        //\n        // We emit the chat segment complete event.\n        //\n        const updatedChatSegment: ChatSegment<AiMsg> = {\n            uid: segmentId,\n            status: 'complete',\n            items: [\n                userMessage,\n                aiResponse,\n            ],\n        };\n\n        triggerAsyncCallback(() => {\n            chatSegmentCompleteCallbacks.forEach((callback) => {\n                callback(updatedChatSegment);\n            });\n        });\n    } catch (error) {\n        warn(error);\n\n        const errorObject = error instanceof Error\n            ? error\n            : (\n                typeof error === 'string' ? new Error(error) : new Error('Unknown error')\n            );\n\n        triggerAsyncCallback(() => {\n            const errorId: NLErrorId = 'failed-to-load-content';\n            chatSegmentExceptionCallbacks\n                .forEach((callback) => callback(errorId, errorObject));\n        });\n    }\n};\n","import {ChatAdapterExtras} from '../../types/adapters/chat/chatAdapterExtras';\nimport {\n    ServerComponentChatAdapter,\n    ServerComponentExecutionResult,\n} from '../../types/adapters/chat/serverComponentChatAdapter';\nimport {ChatSegment} from '../../types/chatSegment/chatSegment';\nimport {AiStreamedServerComponentMessage} from '../../types/chatSegment/chatSegmentAiMessage';\nimport {\n    AiServerComponentStreamedCallback,\n    AiServerComponentStreamStartedCallback,\n    ChatSegmentCompleteCallback,\n    ChatSegmentErrorCallback,\n} from '../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentUserMessage} from '../../types/chatSegment/chatSegmentUserMessage';\nimport {NLErrorId} from '../../types/exceptions/errors';\nimport {uid} from '../../utils/uid';\nimport {warn} from '../../utils/warn';\nimport {triggerAsyncCallback} from './utils/triggerAsyncCallback';\n\nexport const submitAndStreamServerComponentResponse = <AiMsg>(\n    segmentId: string,\n    userMessage: ChatSegmentUserMessage,\n    adapter: ServerComponentChatAdapter<AiMsg>,\n    extras: ChatAdapterExtras<AiMsg>,\n    aiServerComponentStreamStartedCallbacks: Set<AiServerComponentStreamStartedCallback>,\n    aiServerComponentStreamedCallbacks: Set<AiServerComponentStreamedCallback>,\n    chatSegmentCompleteCallbacks: Set<ChatSegmentCompleteCallback<AiMsg>>,\n    chatSegmentExceptionCallbacks: Set<ChatSegmentErrorCallback>,\n): Promise<void> => {\n    return new Promise((resolve, reject) => {\n        try {\n            const prompt = userMessage.content;\n            const responseUid = uid();\n            const participantRole = 'assistant';\n            const status: 'streaming' | 'complete' | 'error' = 'streaming';\n            const time = new Date();\n            const dataTransferMode = 'stream';\n\n            let aiResponse: AiStreamedServerComponentMessage | undefined = undefined;\n            let serverComponent: ServerComponentExecutionResult | undefined = undefined;\n\n            const handleComplete = () => {\n                //\n                // We emit the AI message received event.\n                //\n                triggerAsyncCallback(() => {\n                    aiServerComponentStreamedCallbacks.forEach((callback) => {\n                        if (aiResponse && serverComponent) {\n                            callback({\n                                ...aiResponse,\n                                content: serverComponent,\n                                status: 'complete',\n                            });\n                        }\n                    });\n                }, 20);\n\n                //\n                // We emit the chat segment complete event.\n                //\n                const updatedChatSegment: ChatSegment<AiMsg> = {\n                    uid: segmentId,\n                    status: 'complete',\n                    items: [\n                        userMessage,\n                        aiResponse!,\n                    ],\n                };\n\n                triggerAsyncCallback(() => {\n                    chatSegmentCompleteCallbacks.forEach((callback) => {\n                        callback(updatedChatSegment);\n                    });\n\n                    resolve();\n                }, 20);\n            };\n\n            const handleError = () => {\n                chatSegmentExceptionCallbacks.forEach((callback) => {\n                    callback('failed-to-stream-server-component', new Error('Failed to load content'));\n                });\n            };\n\n            serverComponent = adapter.streamServerComponent!(\n                prompt,\n                extras,\n                {\n                    onServerComponentReceived: handleComplete,\n                    onError: handleError,\n                },\n            );\n\n            aiResponse = {\n                uid: responseUid,\n                content: serverComponent,\n                contentType: 'server-component',\n                participantRole,\n                status,\n                time,\n                dataTransferMode,\n            };\n\n            //\n            // We emit the AI message received event.\n            //\n            triggerAsyncCallback(() => {\n                aiServerComponentStreamStartedCallbacks.forEach((callback) => {\n                    callback(aiResponse);\n                });\n            }, 10);\n        } catch (error) {\n            warn(error);\n\n            const errorObject = error instanceof Error\n                ? error\n                : (\n                    typeof error === 'string' ? new Error(error) : new Error('Unknown error')\n                );\n\n            triggerAsyncCallback(() => {\n                const errorId: NLErrorId = 'failed-to-load-content';\n                chatSegmentExceptionCallbacks\n                    .forEach((callback) => callback(errorId, errorObject));\n            });\n        }\n    });\n};\n","import {ChatAdapter, StreamingAdapterObserver} from '../../types/adapters/chat/chatAdapter';\nimport {ChatAdapterExtras} from '../../types/adapters/chat/chatAdapterExtras';\nimport {isStandardChatAdapter, StandardChatAdapter} from '../../types/adapters/chat/standardChatAdapter';\nimport {ChatSegment} from '../../types/chatSegment/chatSegment';\nimport {AiStreamedMessage} from '../../types/chatSegment/chatSegmentAiMessage';\nimport {\n    AiMessageChunkReceivedCallback,\n    AiMessageStreamedCallback,\n    AiMessageStreamStartedCallback,\n    ChatSegmentCompleteCallback,\n    ChatSegmentErrorCallback,\n} from '../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentUserMessage} from '../../types/chatSegment/chatSegmentUserMessage';\nimport {NLErrorId} from '../../types/exceptions/errors';\nimport {uid} from '../../utils/uid';\nimport {warn} from '../../utils/warn';\nimport {triggerAsyncCallback} from './utils/triggerAsyncCallback';\n\nexport const submitAndStreamTextResponse = <AiMsg>(\n    segmentId: string,\n    userMessage: ChatSegmentUserMessage,\n    adapter: ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n    extras: ChatAdapterExtras<AiMsg>,\n    aiMessageStreamStartedCallbacks: Set<AiMessageStreamStartedCallback<AiMsg>>,\n    aiMessageStreamedCallbacks: Set<AiMessageStreamedCallback<AiMsg>>,\n    aiMessageChunkReceivedCallbacks: Set<AiMessageChunkReceivedCallback<AiMsg>>,\n    chatSegmentCompleteCallbacks: Set<ChatSegmentCompleteCallback<AiMsg>>,\n    chatSegmentErrorCallbacks: Set<ChatSegmentErrorCallback>,\n): Promise<void> => {\n    return new Promise<void>((resolve) => {\n        const streamedMessageId = uid();\n        const streamedContent: Array<AiMsg> = [];\n        const streamedRawContent: Array<string | object | undefined> = [];\n\n        let firstChunkReceived = false;\n        let errorOccurred = false;\n        let completeOccurred = false;\n\n        const emitAiMessageStreamStartedEvent = () => {\n            if (firstChunkReceived) {\n                return;\n            }\n\n            firstChunkReceived = true;\n            triggerAsyncCallback(() => {\n                aiMessageStreamStartedCallbacks.forEach(callback => {\n                    callback({\n                        uid: streamedMessageId,\n                        status: 'streaming',\n                        time: new Date(),\n                        participantRole: 'assistant',\n                        dataTransferMode: 'stream',\n                    });\n                });\n            });\n        };\n\n        const isStandardAdapter = isStandardChatAdapter(adapter);\n        const observer: StreamingAdapterObserver<unknown> = {\n            next: (chunk: unknown) => {\n                if (errorOccurred || completeOccurred) {\n                    return;\n                }\n\n                let aiMsgChunk: AiMsg | undefined;\n                let rawChunk: string | object | undefined;\n                if (isStandardAdapter) {\n                    const chunkAsRaw = chunk as string | object | undefined;\n\n                    const adapterAsStandardAdapter = adapter as unknown as StandardChatAdapter<AiMsg>;\n                    const preProcessedChunk = adapterAsStandardAdapter.preProcessAiStreamedChunk(chunkAsRaw, extras);\n                    if (preProcessedChunk !== undefined && preProcessedChunk !== null) {\n                        aiMsgChunk = preProcessedChunk;\n                        rawChunk = chunkAsRaw;\n\n                        streamedContent.push(aiMsgChunk);\n                        streamedRawContent.push(rawChunk);\n                    }\n                } else {\n                    // For non-standard adapters, the check pre-processed chunk is done by the adapter.\n                    aiMsgChunk = chunk as AiMsg;\n                    streamedContent.push(aiMsgChunk);\n                }\n\n                if (aiMsgChunk === undefined || aiMsgChunk === null) {\n                    warn('Adapter returned an undefined or null value from streamText. This chunk will be ignored.');\n                    return;\n                }\n\n                if (!firstChunkReceived) {\n                    emitAiMessageStreamStartedEvent();\n                }\n\n                triggerAsyncCallback(() => {\n                    aiMessageChunkReceivedCallbacks.forEach(callback => {\n                        callback({\n                            chunk: aiMsgChunk,\n                            messageId: streamedMessageId,\n                            serverResponse: rawChunk,\n                        });\n                    });\n                });\n            },\n            complete: () => {\n                if (errorOccurred || completeOccurred) {\n                    return;\n                }\n\n                completeOccurred = true;\n\n                //\n                // EVENT: AI MESSAGE FULLY STREAMED\n                //\n                triggerAsyncCallback(() => {\n                    type StreamedAiMessage<AiMsg> = AiStreamedMessage<AiMsg> & {\n                        status: 'complete',\n                        content: Array<AiMsg>\n                    };\n\n                    const aiMessage: StreamedAiMessage<AiMsg> = {\n                        uid: streamedMessageId,\n                        status: 'complete',\n                        content: streamedContent,\n                        contentType: 'text',\n                        serverResponse: undefined,\n                        time: new Date(),\n                        participantRole: 'assistant',\n                        dataTransferMode: 'stream',\n                    };\n\n                    aiMessageStreamedCallbacks.forEach(callback => {\n                        callback(aiMessage);\n                    });\n\n                    //\n                    // WE RESOLVE THE PROMISE HERE\n                    // Only after the AI message has been fully streamed\n                    //\n                    resolve();\n                });\n\n                //\n                // EVENT: CHAT SEGMENT COMPLETE\n                //\n                triggerAsyncCallback(() => {\n                    const updatedChatSegment: ChatSegment<AiMsg> = {\n                        uid: segmentId,\n                        status: 'complete',\n                        items: [\n                            userMessage,\n                            {\n                                uid: streamedMessageId,\n                                status: 'complete',\n                                contentType: 'text',\n                                content: streamedContent,\n                                serverResponse: streamedRawContent,\n                                time: new Date(),\n                                participantRole: 'assistant',\n                                dataTransferMode: 'stream',\n                            },\n                        ],\n                    };\n\n                    chatSegmentCompleteCallbacks.forEach(callback => {\n                        callback(updatedChatSegment);\n                    });\n                });\n            },\n            error: (error) => {\n                if (errorOccurred || completeOccurred) {\n                    return;\n                }\n\n                errorOccurred = true;\n\n                //\n                // EVENT: CHAT SEGMENT STREAMING ERROR\n                //\n                triggerAsyncCallback(() => {\n                    const errorId: NLErrorId = 'failed-to-stream-content';\n                    chatSegmentErrorCallbacks.forEach(callback => {\n                        callback(errorId, error);\n                    });\n\n                    //\n                    // WE RESOLVE THE PROMISE HERE\n                    // Only after the AI message has been fully streamed\n                    //\n                    resolve();\n                });\n            },\n        };\n\n        adapter.streamText!(userMessage.content, observer, extras);\n    });\n};\n","import {ChatAdapter} from '../../../types/adapters/chat/chatAdapter';\nimport {ServerComponentChatAdapter} from '../../../types/adapters/chat/serverComponentChatAdapter';\nimport {StandardChatAdapter} from '../../../types/adapters/chat/standardChatAdapter';\n\nexport const getContentTypeToGenerate = <AiMsg>(\n    adapter: ChatAdapter<AiMsg> | ServerComponentChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n): 'text' | 'server-component' => {\n    if ('streamServerComponent' in adapter) {\n        return 'server-component';\n    }\n\n    return 'text';\n};\n","import {ChatAdapter as CoreChatAdapter, DataTransferMode} from '../../../types/adapters/chat/chatAdapter';\nimport {ServerComponentChatAdapter} from '../../../types/adapters/chat/serverComponentChatAdapter';\nimport {isStandardChatAdapter, StandardChatAdapter} from '../../../types/adapters/chat/standardChatAdapter';\n\nexport const getDataTransferModeToUse = <AiMsg>(\n    adapter: CoreChatAdapter<AiMsg> | ServerComponentChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n): DataTransferMode => {\n    const supportedDataTransferModes: DataTransferMode[] = [];\n    const adapterAsCoreAdapter: CoreChatAdapter<AiMsg> | undefined = adapter as CoreChatAdapter<AiMsg> | undefined;\n    const adapterAsEsmAdapter: ServerComponentChatAdapter<AiMsg> | undefined = adapter as ServerComponentChatAdapter<AiMsg> | undefined;\n\n    if (adapterAsCoreAdapter?.streamText !== undefined || adapterAsEsmAdapter?.streamServerComponent !== undefined) {\n        supportedDataTransferModes.push('stream');\n    }\n    if (adapterAsCoreAdapter?.batchText !== undefined) {\n        supportedDataTransferModes.push('batch');\n    }\n\n    const adapterAsStandardAdapter: StandardChatAdapter<AiMsg> | undefined = isStandardChatAdapter(\n        adapter,\n    ) ? adapter as StandardChatAdapter<AiMsg> : undefined;\n\n    const adapterDataTransferMode: DataTransferMode | undefined = adapterAsStandardAdapter?.dataTransferMode\n        ?? undefined;\n\n    const defaultDataTransferMode = supportedDataTransferModes.length === 1\n        ? supportedDataTransferModes[0]\n        : 'stream';\n\n    return adapterDataTransferMode ?? defaultDataTransferMode;\n};\n","import {ChatSegment} from '../../../types/chatSegment/chatSegment';\nimport {ChatSegmentCompleteCallback, ChatSegmentEventsMap} from '../../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentObservable} from '../../../types/chatSegment/chatSegmentObservable';\nimport {uid} from '../../../utils/uid';\nimport {triggerAsyncCallback} from './triggerAsyncCallback';\n\nexport const createEmptyCompleteSegment = <AiMsg>(): {\n    segment: ChatSegment<AiMsg>,\n    observable: ChatSegmentObservable<AiMsg>,\n    dataTransferMode: 'batch',\n} => {\n    const completeListeners = new Set<\n        ChatSegmentEventsMap<AiMsg>['complete']\n    >();\n\n    const segmentId = uid();\n\n    const segment: ChatSegment<AiMsg> = {\n        uid: segmentId,\n        status: 'complete',\n        items: [],\n    };\n\n    triggerAsyncCallback(() => {\n        completeListeners.forEach((listener) => {\n            listener(segment);\n        });\n\n        completeListeners.clear();\n    });\n\n    return {\n        segment,\n        observable: {\n            on: (event, callback) => {\n                if (event === 'complete') {\n                    completeListeners.add(callback as unknown as ChatSegmentCompleteCallback<AiMsg>);\n                }\n            },\n            removeListener: (event, callback) => {\n                completeListeners.delete(callback as unknown as ChatSegmentCompleteCallback<AiMsg>);\n            },\n            destroy: () => {\n                completeListeners.clear();\n            },\n            get segmentId(): string {\n                return segmentId;\n            },\n        },\n        dataTransferMode: 'batch',\n    };\n};\n","import {ChatSegment} from '../../../types/chatSegment/chatSegment';\nimport {ChatSegmentErrorCallback, ChatSegmentEventsMap} from '../../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentObservable} from '../../../types/chatSegment/chatSegmentObservable';\nimport {NLErrorId} from '../../../types/exceptions/errors';\nimport {uid} from '../../../utils/uid';\nimport {triggerAsyncCallback} from './triggerAsyncCallback';\n\nexport const createEmptyErrorSegment = <AiMsg>(\n    errorId: NLErrorId,\n): {\n    segment: ChatSegment<AiMsg>,\n    dataTransferMode: 'stream',\n    observable: ChatSegmentObservable<AiMsg>,\n} => {\n    const errorListeners = new Set<\n        ChatSegmentEventsMap<AiMsg>['error']\n    >();\n\n    const segmentId = uid();\n\n    const segment: ChatSegment<AiMsg> = {\n        uid: segmentId,\n        status: 'error',\n        items: [],\n    };\n\n    triggerAsyncCallback(() => {\n        errorListeners.forEach((listener) => listener(errorId));\n        errorListeners.clear();\n    });\n\n    return {\n        segment,\n        dataTransferMode: 'stream',\n        observable: {\n            on: (event, callback) => {\n                if (event === 'error') {\n                    errorListeners.add(callback as unknown as ChatSegmentErrorCallback);\n                }\n            },\n            removeListener: (event, callback) => {\n                errorListeners.delete(callback as unknown as ChatSegmentErrorCallback);\n            },\n            destroy: () => {\n                errorListeners.clear();\n            },\n            get segmentId(): string {\n                return segmentId;\n            },\n        },\n    };\n};\n","import {ChatSegmentUserMessage} from '../../../types/chatSegment/chatSegmentUserMessage';\nimport {uid} from '../../../utils/uid';\n\nexport const getUserMessageFromPrompt = (prompt: string): ChatSegmentUserMessage => {\n    return {\n        uid: uid(),\n        time: new Date(),\n        status: 'complete',\n        participantRole: 'user',\n        content: prompt,\n        contentType: 'text',\n    };\n};\n","import {ChatAdapter} from '../../types/adapters/chat/chatAdapter';\nimport {ChatAdapterExtras} from '../../types/adapters/chat/chatAdapterExtras';\nimport {ServerComponentChatAdapter} from '../../types/adapters/chat/serverComponentChatAdapter';\nimport {StandardChatAdapter} from '../../types/adapters/chat/standardChatAdapter';\nimport {\n    AiMessageChunkReceivedCallback,\n    AiMessageReceivedCallback,\n    AiMessageStreamedCallback,\n    AiMessageStreamStartedCallback,\n    AiServerComponentStreamedCallback,\n    AiServerComponentStreamStartedCallback,\n    ChatSegmentCompleteCallback,\n    ChatSegmentErrorCallback,\n    UserMessageReceivedCallback,\n} from '../../types/chatSegment/chatSegmentEvents';\nimport {uid} from '../../utils/uid';\nimport {submitAndBatchTextResponse} from './batchText';\nimport {submitAndStreamServerComponentResponse} from './streamServerComponent';\nimport {submitAndStreamTextResponse} from './streamText';\nimport {SubmitPrompt} from './submitPrompt';\nimport {getContentTypeToGenerate} from './utils/contentTypeToGenerate';\nimport {getDataTransferModeToUse} from './utils/dataTransferModeToUse';\nimport {createEmptyCompleteSegment} from './utils/emptyCompleteSegment';\nimport {createEmptyErrorSegment} from './utils/emptyErrorSegment';\nimport {triggerAsyncCallback} from './utils/triggerAsyncCallback';\nimport {getUserMessageFromPrompt} from './utils/userMessageFromPrompt';\n\nexport const submitPrompt: SubmitPrompt = <AiMsg>(\n    prompt: string,\n    adapter: ChatAdapter<AiMsg> | ServerComponentChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n    extras: ChatAdapterExtras<AiMsg>,\n) => {\n    //\n    // We check if the prompt is empty and that the adapter supports at least one data transfer mode.\n    //\n    if (!prompt) {\n        return createEmptyCompleteSegment<AiMsg>();\n    }\n\n    const adapterAsAny = adapter as Record<string, unknown>;\n    if (adapterAsAny.streamText === undefined && adapterAsAny.batchText === undefined\n        && adapterAsAny.streamServerComponent === undefined) {\n        return createEmptyErrorSegment<AiMsg>('no-data-transfer-mode-supported');\n    }\n\n    //\n    // We know that we will attempt to submit the prompt to the adapter.\n    // We create data structures for event listeners and submit function.\n    //\n    const segmentId = uid();\n    const userMessage = getUserMessageFromPrompt(prompt);\n\n    // (a.i). USER MESSAGE RECEIVED + (a.ii) CHAT SEGMENT COMPLETE + (a.iii) CHAT SEGMENT EXCEPTION\n    let userMessageReceivedCallbacks: Set<UserMessageReceivedCallback> | undefined = new Set();\n    let chatSegmentCompleteCallbacks: Set<ChatSegmentCompleteCallback<AiMsg>> | undefined = new Set();\n    let chatSegmentExceptionCallbacks: Set<ChatSegmentErrorCallback> | undefined = new Set();\n\n    // (b). AI MESSAGE RECEIVED\n    let aiMessageReceivedCallbacks: Set<AiMessageReceivedCallback<AiMsg>> | undefined = undefined;\n\n    // (c). AI ESM RECEIVED\n    let aiEsmStreamStartedCallbacks: Set<AiServerComponentStreamStartedCallback> | undefined = undefined;\n    let aiEsmStreamedCallbacks: Set<AiServerComponentStreamedCallback> | undefined = undefined;\n\n    // (d). AI MESSAGE STREAMED ( 3 events )\n    let aiMessageStreamStartedCallbacks: Set<AiMessageStreamStartedCallback<AiMsg>> | undefined = undefined;\n    let aiMessageStreamedCallbacks: Set<AiMessageStreamedCallback<AiMsg>> | undefined = undefined;\n    let aiMessageChunkReceivedCallbacks: Set<AiMessageChunkReceivedCallback<AiMsg>> | undefined = undefined;\n\n    //\n    // We start by emitting a user message received event.\n    //\n    triggerAsyncCallback(() => {\n        if (!userMessageReceivedCallbacks?.size) {\n            return;\n        }\n\n        userMessageReceivedCallbacks.forEach((callback) => {\n            callback(userMessage);\n        });\n\n        //\n        // (a.i) — USER MESSAGE RECEIVED — NOT NEEDED ANYMORE AFTER THIS POINT.\n        //\n        // Since the user message can only be emitted once, we don't need to keep the callbacks around.\n        // - We clear the callbacks after they have been called.\n        // - We also set the set to indicate that we should not register any more callbacks.\n        userMessageReceivedCallbacks.clear();\n        userMessageReceivedCallbacks = undefined;\n    });\n\n    const dataTransferModeToUse = getDataTransferModeToUse(adapter);\n    const contentTypeToGenerate = getContentTypeToGenerate(adapter);\n\n    if (contentTypeToGenerate === 'server-component') {\n        // (c). AI ESM RECEIVED — Only needed in ESM mode.\n        aiEsmStreamedCallbacks = new Set();\n        aiEsmStreamStartedCallbacks = new Set();\n\n        submitAndStreamServerComponentResponse(\n            segmentId,\n            userMessage,\n            adapter as ServerComponentChatAdapter<AiMsg>,\n            extras,\n            aiEsmStreamStartedCallbacks,\n            aiEsmStreamedCallbacks,\n            chatSegmentCompleteCallbacks,\n            chatSegmentExceptionCallbacks,\n        ).finally(() => {\n                // Finally -> Final status of the segment after complete or error has been emitted.\n                // At this point:\n                //   - No more items can be added to the segment.\n                //   - No more events will be emitted.\n                // We remove all listeners in an async manner to ensure that all events have been emitted.\n                triggerAsyncCallback(() => removeAllListeners());\n            },\n        );\n    } else {\n        if (dataTransferModeToUse === 'batch') {\n            // (b). AI MESSAGE RECEIVED — Only needed in batch mode.\n            aiMessageReceivedCallbacks = new Set();\n\n            submitAndBatchTextResponse(\n                segmentId,\n                userMessage,\n                adapter as ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n                extras,\n                aiMessageReceivedCallbacks,\n                chatSegmentCompleteCallbacks,\n                chatSegmentExceptionCallbacks,\n            ).finally(() => {\n                // Finally -> Final status of the segment after complete or error has been emitted.\n                // At this point:\n                //   - No more items can be added to the segment.\n                //   - No more events will be emitted.\n                // We remove all listeners in an async manner to ensure that all events have been emitted.\n                triggerAsyncCallback(() => removeAllListeners());\n            });\n        } else {\n            // (d). AI MESSAGE STREAMED ( 3 events ) — Only needed in streaming mode.\n            aiMessageStreamStartedCallbacks = new Set();\n            aiMessageStreamedCallbacks = new Set();\n            aiMessageChunkReceivedCallbacks = new Set();\n\n            submitAndStreamTextResponse(\n                segmentId,\n                userMessage,\n                adapter as ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n                extras,\n                aiMessageStreamStartedCallbacks,\n                aiMessageStreamedCallbacks,\n                aiMessageChunkReceivedCallbacks,\n                chatSegmentCompleteCallbacks,\n                chatSegmentExceptionCallbacks,\n            ).finally(() => {\n                // Finally -> Final status of the segment after complete or error has been emitted.\n                // At this point:\n                //   - No more items can be added to the segment.\n                //   - No more events will be emitted.\n                // We remove all listeners in an async manner to ensure that all events have been emitted.\n                triggerAsyncCallback(() => removeAllListeners());\n            });\n        }\n    }\n\n    // Remove all listeners and destroy the segment.\n    const removeAllListeners = () => {\n        userMessageReceivedCallbacks?.clear();\n        userMessageReceivedCallbacks = undefined;\n\n        aiMessageReceivedCallbacks?.clear();\n        aiMessageReceivedCallbacks = undefined;\n\n        aiEsmStreamStartedCallbacks?.clear();\n        aiEsmStreamStartedCallbacks = undefined;\n\n        aiEsmStreamedCallbacks?.clear();\n        aiEsmStreamedCallbacks = undefined;\n\n        aiMessageStreamStartedCallbacks?.clear();\n        aiMessageStreamStartedCallbacks = undefined;\n\n        aiMessageStreamedCallbacks?.clear();\n        aiMessageStreamedCallbacks = undefined;\n\n        aiMessageChunkReceivedCallbacks?.clear();\n        aiMessageChunkReceivedCallbacks = undefined;\n\n        chatSegmentCompleteCallbacks?.clear();\n        chatSegmentCompleteCallbacks = undefined;\n\n        chatSegmentExceptionCallbacks?.clear();\n        chatSegmentExceptionCallbacks = undefined;\n    };\n\n    return {\n        segment: {\n            status: 'active',\n            uid: segmentId,\n            items: [], // Initially empty — User message will be added in callback above.\n        },\n        dataTransferMode: dataTransferModeToUse,\n        observable: {\n            get segmentId(): string {\n                return segmentId;\n            },\n            on: (event, callback) => {\n                if (event === 'userMessageReceived' && userMessageReceivedCallbacks) {\n                    userMessageReceivedCallbacks.add(\n                        callback as UserMessageReceivedCallback,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageReceived' && aiMessageReceivedCallbacks) {\n                    aiMessageReceivedCallbacks.add(\n                        callback as AiMessageReceivedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiServerComponentStreamStarted' && aiEsmStreamStartedCallbacks) {\n                    aiEsmStreamStartedCallbacks.add(\n                        callback as unknown as AiServerComponentStreamStartedCallback,\n                    );\n                    return;\n                }\n\n                if (event === 'aiServerComponentStreamed' && aiEsmStreamedCallbacks) {\n                    aiEsmStreamedCallbacks.add(\n                        callback as unknown as AiServerComponentStreamedCallback,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageStreamStarted' && aiMessageStreamStartedCallbacks) {\n                    aiMessageStreamStartedCallbacks.add(\n                        callback as AiMessageStreamStartedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageStreamed' && aiMessageStreamedCallbacks) {\n                    aiMessageStreamedCallbacks.add(\n                        callback as AiMessageStreamedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiChunkReceived' && aiMessageChunkReceivedCallbacks) {\n                    aiMessageChunkReceivedCallbacks.add(\n                        callback as unknown as AiMessageChunkReceivedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'complete' && chatSegmentCompleteCallbacks) {\n                    chatSegmentCompleteCallbacks.add(\n                        callback as unknown as ChatSegmentCompleteCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'error' && chatSegmentExceptionCallbacks) {\n                    chatSegmentExceptionCallbacks.add(\n                        callback as ChatSegmentErrorCallback,\n                    );\n                    return;\n                }\n            },\n            removeListener: (event, callback) => {\n                if (event === 'userMessageReceived') {\n                    userMessageReceivedCallbacks?.delete(\n                        callback as UserMessageReceivedCallback,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageReceived') {\n                    aiMessageReceivedCallbacks?.delete(\n                        callback as AiMessageReceivedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageStreamStarted') {\n                    aiMessageStreamStartedCallbacks?.delete(\n                        callback as AiMessageStreamStartedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageStreamed') {\n                    aiMessageStreamedCallbacks?.delete(\n                        callback as AiMessageStreamedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiChunkReceived') {\n                    aiMessageChunkReceivedCallbacks?.delete(\n                        callback as unknown as AiMessageChunkReceivedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'complete') {\n                    chatSegmentCompleteCallbacks?.delete(\n                        callback as unknown as ChatSegmentCompleteCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'error') {\n                    chatSegmentExceptionCallbacks?.delete(\n                        callback as ChatSegmentErrorCallback,\n                    );\n                    return;\n                }\n            },\n            destroy: () => removeAllListeners(),\n        },\n    };\n};\n","export const NLErrors = {\n    //\n    // Adapter config errors\n    //\n    'data-transfer-mode-not-supported': 'Requested data transfer mode is not supported',\n    'no-data-transfer-mode-supported': 'Adapter does not support any valid data transfer modes',\n\n    //\n    // Internet, HTTP, and API errors\n    //\n    'connection-error': 'Connection error',\n    'invalid-credentials': 'Invalid credentials',\n    'invalid-api-key': 'Invalid API key',\n    'http-server-side-error': 'HTTP server side error',\n    'http-client-side-error': 'HTTP client side error',\n\n    //\n    // Generic data loading errors\n    //\n    'failed-to-load-content': 'Failed to load content',\n    'failed-to-stream-content': 'Failed to stream content',\n    'failed-to-stream-server-component': 'Failed to stream server component',\n\n    //\n    // Content rendering errors\n    //\n    'failed-to-render-content': 'Failed to display content',\n};\n\nexport type NLErrorId = keyof typeof NLErrors;\n","import {AutoScrollController} from '@shared/interactions/autoScroll/type';\nimport {submitPrompt} from '@shared/services/submitPrompt/submitPromptImpl';\nimport {ChatAdapterExtras} from '@shared/types/adapters/chat/chatAdapterExtras';\nimport {ChatSegmentItem} from '@shared/types/chatSegment/chatSegment';\nimport {NLErrors} from '@shared/types/exceptions/errors';\nimport {domOp} from '@shared/utils/dom/domOp';\nimport {warn} from '@shared/utils/warn';\nimport {ControllerContext} from '../../../../types/controllerContext';\nimport {CompComposer} from '../../composer/composer.model';\nimport {CompConversation} from '../../conversation/conversation.model';\n\nexport const submitPromptFactory = <\n    AiMsg\n>({\n    context,\n    composerInstance,\n    conversation,\n    autoScrollController,\n    messageToSend,\n    resetComposer,\n    setComposerAsWaiting,\n}: {\n    context: ControllerContext<AiMsg>;\n    composerInstance: CompComposer<AiMsg>;\n    conversation: CompConversation<AiMsg>;\n    autoScrollController?: AutoScrollController;\n    messageToSend: string;\n    resetComposer: (resetTextInput?: boolean) => void;\n    setComposerAsWaiting: () => void;\n}) => {\n    return () => {\n        const segmentId = conversation.addChatSegment();\n\n        try {\n            // Disable prompt while sending message\n            const currentComposerProps = composerInstance.getProp('domCompProps');\n            composerInstance.setDomProps({...currentComposerProps, status: 'submitting-prompt'});\n\n            // Build request and submit prompt\n            const extras: ChatAdapterExtras<AiMsg> = {\n                aiChatProps: context.aiChatProps,\n                conversationHistory: conversation.getConversationContentForAdapter(\n                    context.aiChatProps?.conversationOptions?.historyPayloadSize,\n                ),\n            };\n\n            const result = submitPrompt(\n                messageToSend,\n                context.adapter,\n                extras,\n            );\n\n            // Listen to observable events\n            // Always listen to error event\n            result.observable.on('error', (errorId, errorObject) => {\n                conversation.removeChatSegment(segmentId);\n                autoScrollController?.handleChatSegmentRemoved(segmentId);\n                resetComposer(false);\n\n                context.exception(errorId);\n                context.emit('error', {\n                    errorId,\n                    message: NLErrors[errorId],\n                    errorObject,\n                });\n            });\n\n            result.observable.on('userMessageReceived', (userMessage) => {\n                conversation.addChatItem(segmentId, userMessage);\n                context.emit('messageSent', {uid: userMessage.uid, message: userMessage.content});\n\n                domOp(() => {\n                    if (autoScrollController) {\n                        const chatSegmentContainer = conversation.getChatSegmentContainer(segmentId);\n                        if (chatSegmentContainer) {\n                            autoScrollController.handleNewChatSegmentAdded(segmentId, chatSegmentContainer);\n                        }\n                    }\n                });\n            });\n\n            if (result.dataTransferMode === 'batch') {\n                // In batch mode — Listen to aiMessageReceived event and complete event\n                result.observable.on('aiMessageReceived', (aiMessage) => {\n                    const isStringContent = typeof aiMessage.content === 'string';\n                    const newAiMessage = {\n                        ...aiMessage,\n                        // When content is a string, we stream is instead of adding it into the chat segment\n                        content: (isStringContent ? '' : aiMessage.content),\n                    } as ChatSegmentItem<AiMsg>;\n\n                    conversation.addChatItem(segmentId, newAiMessage);\n                    if (isStringContent) {\n                        conversation.addChunk(\n                            segmentId,\n                            newAiMessage.uid,\n                            aiMessage.content,\n                            aiMessage.serverResponse,\n                        );\n                    }\n\n                    conversation.completeChatSegment(segmentId);\n                    context.emit('messageReceived', {\n                        uid: aiMessage.uid,\n                        message: aiMessage.content,\n                    });\n\n                    resetComposer(true);\n                });\n            } else {\n                result.observable.on('aiMessageStreamStarted', (aiMessageStream) => {\n                    conversation.addChatItem(segmentId, aiMessageStream);\n                    setComposerAsWaiting();\n                    context.emit('messageStreamStarted', {uid: aiMessageStream.uid});\n                });\n\n                result.observable.on('aiChunkReceived', (item) => {\n                    const {messageId, chunk, serverResponse} = item;\n                    conversation.addChunk(segmentId, messageId, chunk, serverResponse);\n                });\n\n                result.observable.on('aiMessageStreamed', (aiMessage) => {\n                    if (aiMessage.status === 'complete') {\n                        context.emit('messageReceived', {\n                            uid: aiMessage.uid,\n                            // We only pass the response to custom renderer when the status is 'complete'.\n                            message: aiMessage.content as AiMsg,\n                        });\n                    }\n                });\n\n                result.observable.on('aiServerComponentStreamStarted', (aiMessage) => {\n                    conversation.addChatItem(segmentId, aiMessage);\n                    setComposerAsWaiting();\n                    context.emit('messageStreamStarted', {uid: aiMessage.uid});\n                });\n\n                result.observable.on('aiServerComponentStreamed', (aiMessage) => {\n                    if (aiMessage.status === 'complete') {\n                        context.emit('messageReceived', {\n                            uid: aiMessage.uid,\n                            // We only pass the response to custom renderer when the status is 'complete'.\n                            message: aiMessage.content as AiMsg,\n                        });\n                    }\n                });\n\n                result.observable.on('complete', () => {\n                    conversation.completeChatSegment(segmentId);\n\n                    resetComposer(false);\n                });\n            }\n        } catch (error) {\n            warn(error);\n            resetComposer(false);\n        }\n    };\n};\n","import {ChatItem} from '@shared/types/conversation';\n\nexport const getChatRoomStatus = <AiMsg = string>(\n    initialConversationContent: ChatItem<AiMsg>[] | undefined,\n    segmentsCount?: number,\n): 'starting' | 'active' => {\n    if (initialConversationContent !== undefined && initialConversationContent.length > 0) {\n        return 'active';\n    }\n\n    if (segmentsCount !== undefined && segmentsCount > 0) {\n        return 'active';\n    }\n\n    return 'starting';\n};\n","import {AnyAiMsg} from '@shared/types/anyAiMsg';\nimport {CompRenderer} from '../../../types/comp';\nimport {listenToElement} from '../../../utils/dom/listenToElement';\nimport {CompChatRoomActions, CompChatRoomElements, CompChatRoomEvents, CompChatRoomProps} from './chatRoom.types';\nimport {getChatRoomStatus} from './utils/getChatRoomStatus';\n\nexport const renderChatRoom: CompRenderer<\n    CompChatRoomProps<AnyAiMsg>, CompChatRoomElements, CompChatRoomEvents, CompChatRoomActions\n> = ({appendToRoot, compEvent, props}) => {\n\n    //\n    // The parent container for all messages, segments, and the actual conversation\n    //\n    const conversationContainer = document.createElement('div');\n    conversationContainer.classList.add('nlux-conversation-container');\n\n    //\n    // The parent container for the composer\n    // Contains the input field and submit button\n    //\n    const composerContainer = document.createElement('div');\n    composerContainer.classList.add('nlux-composer-container');\n\n    //\n    // The parent container for the launch pad (shown when no messages are present)\n    // Contains the assistant greeting and conversation starters\n    //\n    const launchPadContainer = document.createElement('div');\n    launchPadContainer.classList.add('nlux-launchPad-container');\n\n    //\n    // Group and render all containers in a fragment before appending to the root\n    //\n    const dom = document.createDocumentFragment();\n    dom.appendChild(launchPadContainer);\n    dom.appendChild(conversationContainer);\n    dom.appendChild(composerContainer);\n\n    const visibleProp = props.visible ?? true;\n    const chatRoomContainer = document.createElement('div');\n    const setChatRoomStatusClass = (status: 'starting' | 'active') => {\n        chatRoomContainer.classList.remove('nlux-chatRoom-starting');\n        chatRoomContainer.classList.remove('nlux-chatRoom-active');\n        chatRoomContainer.classList.add(`nlux-chatRoom-${status}`);\n    };\n\n    //\n    // Render containers into main chat room div\n    // And add listeners\n    //\n    chatRoomContainer.classList.add('nlux-chatRoom-container');\n    setChatRoomStatusClass(\n        getChatRoomStatus(props.initialConversationContent),\n    );\n\n    chatRoomContainer.append(dom);\n    chatRoomContainer.style.display = visibleProp ? '' : 'none';\n\n    const [_, removeConversationContainerListeners] = listenToElement(chatRoomContainer,\n        ':scope > .nlux-conversation-container',\n    ).on('click', compEvent('conversation-container-clicked'))\n     .get();\n\n    //\n    // Render the chat room\n    // And trigger ready event\n    //\n    appendToRoot(chatRoomContainer);\n    compEvent('chat-room-ready')();\n\n    return {\n        elements: {\n            composerContainer,\n            conversationContainer,\n            launchPadContainer,\n        },\n        actions: {\n            updateChatRoomStatus: (newStatus) => {\n                setChatRoomStatusClass(newStatus);\n            },\n        },\n        onDestroy: () => {\n            removeConversationContainerListeners();\n        },\n    };\n};\n","import {AnyAiMsg} from '@shared/types/anyAiMsg';\nimport {CompUpdater} from '../../../types/comp';\nimport {CompChatRoomActions, CompChatRoomElements, CompChatRoomProps} from './chatRoom.types';\n\nexport const updateChatRoom: CompUpdater<CompChatRoomProps<AnyAiMsg>, CompChatRoomElements, CompChatRoomActions> = (\n    {\n        propName,\n        newValue,\n        dom: {elements},\n    }) => {\n};\n","import {ComposerProps} from '@shared/components/Composer/props';\nimport {createAutoScrollController} from '@shared/interactions/autoScroll/autoScrollController';\nimport {AutoScrollController} from '@shared/interactions/autoScroll/type';\nimport {ChatItem} from '@shared/types/conversation';\nimport {domOp} from '@shared/utils/dom/domOp';\nimport {BaseComp} from '../../../aiChat/comp/base';\nimport {comp} from '../../../aiChat/comp/comp';\nimport {CompEventListener, Model} from '../../../aiChat/comp/decorators';\nimport {HighlighterExtension} from '../../../aiChat/highlighter/highlighter';\nimport {ConversationLayout, HistoryPayloadSize} from '../../../aiChat/options/conversationOptions';\nimport {AssistantPersona, UserPersona} from '../../../aiChat/options/personaOptions';\nimport {ControllerContext} from '../../../types/controllerContext';\nimport {ConversationStarter} from '../../../types/conversationStarter';\nimport {propsToCorePropsInEvents} from '../../../utils/propsToCorePropsInEvents';\nimport {CompComposer} from '../composer/composer.model';\nimport {CompComposerProps} from '../composer/composer.types';\nimport {CompConversation} from '../conversation/conversation.model';\nimport {CompConversationProps} from '../conversation/conversation.types';\nimport {CompLaunchPad} from '../launchPad/launchPad.model';\nimport {CompLaunchPadProps} from '../launchPad/launchPad.types';\nimport {submitPromptFactory} from './actions/submitPrompt';\nimport {renderChatRoom} from './chatRoom.render';\nimport {CompChatRoomActions, CompChatRoomElements, CompChatRoomEvents, CompChatRoomProps} from './chatRoom.types';\nimport {updateChatRoom} from './chatRoom.update';\nimport {getChatRoomStatus} from './utils/getChatRoomStatus';\n\n@Model('chatRoom', renderChatRoom, updateChatRoom)\nexport class CompChatRoom<AiMsg> extends BaseComp<\n    AiMsg, CompChatRoomProps<AiMsg>, CompChatRoomElements, CompChatRoomEvents, CompChatRoomActions\n> {\n    private autoScrollController: AutoScrollController | undefined;\n    private chatRoomStatus: 'starting' | 'active'; // Starting = Display launch pad, Active = Display conversation\n    private composer!: CompComposer<AiMsg>;\n    private conversation!: CompConversation<AiMsg>;\n    private handleConversationStarterClick = (conversationStarter: ConversationStarter) => {\n        // Set the prompt\n        // Disable the composer and submit button\n        // Set the composer as waiting\n        // Submit the prompt\n\n        this.composer.setDomProps({status: 'submitting-conversation-starter'});\n        this.composer.handleTextChange(conversationStarter.prompt);\n        this.composer.handleSendButtonClick();\n    };\n    private handleSegmentCountChange = (newSegmentCount: number) => {\n        if (this.segmentCount === newSegmentCount) {\n            return;\n        }\n\n        this.segmentCount = newSegmentCount;\n        const newChatRoomStatus = getChatRoomStatus(\n            (this.getProp('initialConversationContent') || undefined) as ChatItem<AiMsg>[] | undefined,\n            this.segmentCount,\n        );\n\n        if (this.chatRoomStatus !== newChatRoomStatus) {\n            this.chatRoomStatus = newChatRoomStatus;\n            this.executeDomAction('updateChatRoomStatus', this.chatRoomStatus);\n\n            if (this.chatRoomStatus === 'active') {\n                if (this.launchPad?.id) {\n                    this.removeSubComponent(this.launchPad?.id);\n                    this.launchPad = undefined;\n                }\n            } else {\n                this.addLaunchPad(\n                    (this.getProp('showGreeting') as boolean | undefined) ?? true,\n                    this.getProp('assistantPersona') as AssistantPersona | undefined,\n                    this.getProp('conversationStarters') as ConversationStarter[] | undefined,\n                    this.handleConversationStarterClick,\n                );\n            }\n        }\n    };\n    private launchPad: CompLaunchPad<AiMsg> | undefined;\n    private prompt: string = '';\n    private segmentCount: number; // How many segments are in the conversation (used to determine the chat room status)\n\n    constructor(\n        context: ControllerContext<AiMsg>, {\n            conversationLayout,\n            autoScroll,\n            streamingAnimationSpeed,\n            visible = true,\n            composer,\n            assistantPersona,\n            userPersona,\n            showGreeting,\n            conversationStarters,\n            initialConversationContent,\n            syntaxHighlighter,\n            htmlSanitizer,\n            markdownLinkTarget,\n            showCodeBlockCopyButton,\n            skipStreamingAnimation,\n        }: CompChatRoomProps<AiMsg>,\n    ) {\n        super(context, {\n            conversationLayout,\n            visible,\n            autoScroll,\n            streamingAnimationSpeed,\n            assistantPersona,\n            userPersona,\n            conversationStarters,\n            showGreeting,\n            initialConversationContent,\n            composer,\n            syntaxHighlighter,\n            htmlSanitizer,\n            markdownLinkTarget,\n            showCodeBlockCopyButton,\n            skipStreamingAnimation,\n        });\n\n        // Set status\n        this.segmentCount = initialConversationContent && initialConversationContent.length > 0 ? 1 : 0;\n        this.chatRoomStatus = getChatRoomStatus(initialConversationContent, this.segmentCount);\n\n        // Add optional launch pad component\n        if (this.chatRoomStatus === 'starting') {\n            this.addLaunchPad(\n                showGreeting, assistantPersona,\n                conversationStarters, this.handleConversationStarterClick,\n            );\n        }\n\n        // Add required conversation and composer components\n        this.addConversation(assistantPersona, userPersona, initialConversationContent);\n        this.addComposer(\n            composer?.placeholder, composer?.autoFocus,\n            composer?.disableSubmitButton, composer?.submitShortcut,\n        );\n\n        if (!this.conversation || !this.composer) {\n            // The conversation and the composer are mandatory components\n            throw new Error('Chat room not initialized — An error occurred while initializing key components.');\n        }\n    }\n\n    public getConversationContentForAdapter(historyPayloadSize: HistoryPayloadSize = 'max') {\n        return this.conversation.getConversationContentForAdapter(historyPayloadSize);\n    }\n\n    public hide() {\n        this.setProp('visible', false);\n    }\n\n    @CompEventListener('conversation-container-clicked')\n    messagesContainerClicked() {\n        this.composer?.focusTextInput();\n    }\n\n    @CompEventListener('chat-room-ready')\n    onChatRoomReady() {\n        domOp(() => {\n            const conversationContainer = this.renderedDom?.elements?.conversationContainer;\n            if (conversationContainer instanceof HTMLElement) {\n                this.autoScrollController = createAutoScrollController(\n                    conversationContainer,\n                    (this.getProp('autoScroll') as boolean | undefined) ?? true,\n                );\n\n                // Attempt to scroll to the bottom of the conversation container on initial render.\n                // Initially do it every 10ms for 200ms, then stop.\n                let numberOfScrollToBottomAttempts = 0;\n                const maxNumberOfScrollToBottomAttempts = 20;\n                const attemptsInterval = 10;\n\n                const attemptScrollToBottom = () => {\n                    // Only scroll to the bottom if the conversation container is already rendered\n                    if (conversationContainer.scrollHeight > conversationContainer.clientHeight) {\n                        conversationContainer.scrollTo({behavior: 'smooth', top: 50000});\n                        clearInterval(intervalId);\n                    }\n                };\n\n                const intervalId = setInterval(() => {\n                    if (numberOfScrollToBottomAttempts >= maxNumberOfScrollToBottomAttempts) {\n                        clearInterval(intervalId);\n                        return;\n                    }\n\n                    attemptScrollToBottom();\n                    numberOfScrollToBottomAttempts++;\n                }, attemptsInterval);\n            }\n\n            this.context.emit('ready', {\n                aiChatProps: propsToCorePropsInEvents(this.context.aiChatProps),\n            });\n        });\n    }\n\n    public setProps(props: Partial<CompChatRoomProps<AiMsg>>) {\n        if (props.hasOwnProperty('autoScroll')) {\n            const autoScroll = props.autoScroll!;\n            this.autoScrollController?.updateProps({autoScroll});\n        }\n\n        if (props.hasOwnProperty('conversationLayout')) {\n            this.conversation?.setConversationLayout(props.conversationLayout!);\n        }\n\n        if (props.hasOwnProperty('syntaxHighlighter')) {\n            this.setProp('syntaxHighlighter', props.syntaxHighlighter!);\n        }\n\n        if (props.hasOwnProperty('htmlSanitizer')) {\n            this.setProp('htmlSanitizer', props.htmlSanitizer!);\n        }\n\n        if (props.hasOwnProperty('markdownLinkTarget')) {\n            this.setProp('markdownLinkTarget', props.markdownLinkTarget!);\n        }\n\n        if (props.hasOwnProperty('skipStreamingAnimation')) {\n            this.setProp('skipStreamingAnimation', props.skipStreamingAnimation!);\n        }\n\n        if (props.hasOwnProperty('streamingAnimationSpeed')) {\n            this.setProp('streamingAnimationSpeed', props.streamingAnimationSpeed!);\n        }\n\n        if (props.hasOwnProperty('assistantPersona')) {\n            this.conversation?.setAssistantPersona(props.assistantPersona ?? undefined);\n            this.launchPad?.setAssistantPersona(props.assistantPersona ?? undefined);\n        }\n\n        if (props.hasOwnProperty('userPersona')) {\n            this.conversation?.setUserPersona(props.userPersona ?? undefined);\n        }\n\n        if (props.hasOwnProperty('showGreeting')) {\n            this.launchPad?.setShowGreeting(props.showGreeting ?? true);\n        }\n\n        if (props.hasOwnProperty('conversationStarters')) {\n            this.launchPad?.setConversationStarters(props.conversationStarters);\n        }\n\n        if (props.hasOwnProperty('composer')) {\n            if (this.composer) {\n                const currentDomProps = this.composer.getProp('domCompProps')!;\n                const newProps: ComposerProps = {...currentDomProps, ...props.composer};\n                this.composer.setDomProps(newProps);\n            }\n        }\n    }\n\n    public show() {\n        this.setProp('visible', true);\n    }\n\n    protected setProp<K extends keyof CompChatRoomProps<AiMsg>>(key: K, value: CompChatRoomProps<AiMsg>[K]) {\n        super.setProp(key, value);\n\n        if (\n            key === 'markdownLinkTarget' || key === 'syntaxHighlighter' || key === 'htmlSanitizer' ||\n            key === 'skipStreamingAnimation' || key === 'streamingAnimationSpeed'\n        ) {\n            const updateKey = key satisfies keyof CompConversationProps<AiMsg>;\n            const updateValue = value as CompConversationProps<AiMsg>[typeof updateKey];\n            this.conversation.updateMarkdownStreamRenderer(updateKey, updateValue);\n        }\n    }\n\n    private addComposer(\n        placeholder?: string,\n        autoFocus?: boolean,\n        disableSubmitButton?: boolean,\n        submitShortcut?: 'Enter' | 'CommandEnter',\n    ) {\n        this.composer = comp(CompComposer<AiMsg>).withContext(this.context).withProps({\n            props: {\n                domCompProps: {\n                    status: 'typing',\n                    placeholder,\n                    autoFocus,\n                    disableSubmitButton,\n                    submitShortcut,\n                },\n            } satisfies CompComposerProps,\n            eventListeners: {\n                onTextUpdated: (newValue: string) => this.handleComposerTextChange(newValue),\n                onSubmit: () => this.handleComposerSubmit(),\n            },\n        }).create();\n\n        this.addSubComponent(this.composer.id, this.composer, 'composerContainer');\n    }\n\n    private addConversation(\n        assistantPersona?: AssistantPersona,\n        userPersona?: UserPersona,\n        initialConversationContent?: ChatItem<AiMsg>[],\n    ) {\n        this.conversation = comp(CompConversation<AiMsg>)\n            .withContext(this.context)\n            .withProps<CompConversationProps<AiMsg>>({\n                assistantPersona,\n                userPersona,\n                messages: initialConversationContent,\n                conversationLayout: this.getProp('conversationLayout') as ConversationLayout,\n                markdownLinkTarget: this.getProp('markdownLinkTarget') as 'blank' | 'self' | undefined,\n                showCodeBlockCopyButton: this.getProp('showCodeBlockCopyButton') as boolean | undefined,\n                skipStreamingAnimation: this.getProp('skipStreamingAnimation') as boolean | undefined,\n                streamingAnimationSpeed: this.getProp('streamingAnimationSpeed') as number | undefined,\n                syntaxHighlighter: this.getProp('syntaxHighlighter') as HighlighterExtension | undefined,\n                htmlSanitizer: this.getProp('htmlSanitizer') as ((html: string) => string) | undefined,\n                onSegmentCountChange: this.handleSegmentCountChange,\n            })\n            .create();\n\n        this.addSubComponent(this.conversation.id, this.conversation, 'conversationContainer');\n    }\n\n    private addLaunchPad(\n        showGreeting: boolean | undefined,\n        assistantPersona: AssistantPersona | undefined,\n        conversationStarters: ConversationStarter[] | undefined,\n        onConversationStarterSelected: (conversationStarter: ConversationStarter) => void,\n    ) {\n        this.launchPad = comp(CompLaunchPad<AiMsg>)\n            .withContext(this.context)\n            .withProps({\n                showGreeting,\n                assistantPersona,\n                conversationStarters,\n                onConversationStarterSelected,\n            } satisfies CompLaunchPadProps)\n            .create();\n\n        this.addSubComponent(this.launchPad.id, this.launchPad, 'launchPadContainer');\n    }\n\n    private handleComposerSubmit() {\n        const composerProps: Partial<ComposerProps> | undefined = this.props.composer;\n        submitPromptFactory({\n            context: this.context,\n            composerInstance: this.composer,\n            conversation: this.conversation,\n            messageToSend: this.prompt,\n            autoScrollController: this.autoScrollController,\n            resetComposer: (resetTextInput?: boolean) => {\n                // Check to handle edge case when reset is called after the component is destroyed!\n                // Example: When the user submits a message and the component is destroyed before the response is\n                // received.\n                if (!this.destroyed) {\n                    this.resetComposer(resetTextInput, composerProps?.autoFocus);\n                }\n            },\n            setComposerAsWaiting: () => {\n                if (!this.destroyed) {\n                    this.composer.setDomProps({status: 'waiting'});\n                }\n            },\n        })();\n    }\n\n    private handleComposerTextChange(newValue: string) {\n        this.prompt = newValue;\n    }\n\n    private resetComposer(resetTextInput: boolean = false, focusOnReset: boolean = false) {\n        if (!this.composer) {\n            return;\n        }\n\n        const currentCompProps = this.composer.getProp('domCompProps') as ComposerProps;\n        const newProps: ComposerProps = {...currentCompProps, status: 'typing'};\n        if (resetTextInput) {\n            newProps.message = '';\n        }\n\n        this.composer.setDomProps(newProps);\n        if (focusOnReset) {\n            this.composer.focusTextInput();\n        }\n    }\n}\n","import {DomCreator} from '../../types/dom/DomCreator';\n\nexport const className = 'nlux-comp-exceptionBox';\n\nexport const createExceptionsBoxDom: DomCreator<void> = () => {\n    const exceptionsBox = document.createElement('div');\n    exceptionsBox.classList.add(className);\n\n    return exceptionsBox;\n};\n\nexport const createExceptionItemDom: DomCreator<{\n    message: string;\n}> = ({message}) => {\n    const exception = document.createElement('div');\n    exception.classList.add('nlux-comp-exceptionItem');\n\n    const messageElement = document.createElement('span');\n    messageElement.classList.add('nlux-comp-exp_itm_msg');\n    messageElement.append(document.createTextNode(message));\n    exception.append(messageElement);\n\n    return exception;\n};\n","import {createExceptionItemDom} from './create';\n\nconst exceptionDisplayTime = 3000;\nconst exceptionHideAnimationTime = 500;\n\nexport type ExceptionsBoxController = {\n    displayException: (message: string, ref?: string) => void;\n    destroy: () => void;\n};\n\nexport const createExceptionsBoxController = (root: HTMLElement): ExceptionsBoxController => {\n    const exceptionsQueue = new Set<{message: string}>();\n\n    let exceptionShown: boolean = false;\n    let exceptionItem: HTMLElement | null = null;\n    let timeout: ReturnType<typeof setTimeout> | null = null;\n\n    const processExceptionsQueue = () => {\n        if (exceptionShown) {\n            // If exception is shown, we need to wait for it to hide\n            // This method will be called again when it hides\n            return;\n        }\n\n        if (exceptionsQueue.size === 0) {\n            return;\n        }\n\n        exceptionShown = true;\n        const victim = exceptionsQueue.values().next().value;\n        exceptionsQueue.delete(victim);\n\n        exceptionItem = createExceptionItemDom(victim);\n        root.append(exceptionItem);\n        timeout = setTimeout(hideException, exceptionDisplayTime);\n    };\n\n    const hideException = () => {\n        exceptionItem?.classList.add('nlux-comp-exceptionItem--hiding');\n\n        // Wait for animation to finish\n        timeout = setTimeout(() => {\n            exceptionShown = false;\n            exceptionItem?.remove();\n            exceptionItem = null;\n\n            // Process next exception\n            processExceptionsQueue();\n        }, exceptionHideAnimationTime);\n    };\n\n    return {\n        displayException: (message: string) => {\n            exceptionsQueue.add({message});\n            if (!exceptionShown) {\n                processExceptionsQueue();\n            }\n        },\n        destroy: () => {\n            exceptionsQueue.clear();\n            exceptionItem?.remove();\n            if (timeout) {\n                clearTimeout(timeout);\n            }\n        },\n    };\n};\n","import {createExceptionsBoxController, ExceptionsBoxController} from '@shared/components/ExceptionsBox/control';\nimport {createExceptionsBoxDom} from '@shared/components/ExceptionsBox/create';\nimport {CompRenderer} from '../../../types/comp';\nimport {\n    CompExceptionsBoxActions,\n    CompExceptionsBoxElements,\n    CompExceptionsBoxEvents,\n    CompExceptionsBoxProps,\n} from './types';\n\nexport const renderExceptionsBox: CompRenderer<\n    CompExceptionsBoxProps,\n    CompExceptionsBoxElements,\n    CompExceptionsBoxEvents,\n    CompExceptionsBoxActions\n> = ({\n    props,\n    appendToRoot,\n}) => {\n    const exceptionsBoxRoot = createExceptionsBoxDom();\n    appendToRoot(exceptionsBoxRoot);\n\n    let controller: ExceptionsBoxController | undefined = createExceptionsBoxController(exceptionsBoxRoot);\n\n    return {\n        elements: {\n            root: exceptionsBoxRoot,\n        },\n        actions: {\n            displayException: (message: string) => {\n                controller?.displayException(message);\n            },\n        },\n        onDestroy: () => {\n            controller?.destroy();\n            exceptionsBoxRoot.remove();\n            controller = undefined;\n        },\n    };\n};\n","import {CompUpdater} from '../../../types/comp';\nimport {CompExceptionsBoxActions, CompExceptionsBoxElements, CompExceptionsBoxProps} from './types';\n\nexport const updateExceptionsBox: CompUpdater<\n    CompExceptionsBoxProps, CompExceptionsBoxElements, CompExceptionsBoxActions\n> = () => {\n};\n","import {NLErrorId} from '@shared/types/exceptions/errors';\nimport {BaseComp} from '../../../aiChat/comp/base';\nimport {Model} from '../../../aiChat/comp/decorators';\nimport {ControllerContext} from '../../../types/controllerContext';\nimport {renderExceptionsBox} from './render';\nimport {\n    CompExceptionsBoxActions,\n    CompExceptionsBoxElements,\n    CompExceptionsBoxEvents,\n    CompExceptionsBoxProps,\n} from './types';\nimport {updateExceptionsBox} from './update';\n\n@Model('exceptionsBox', renderExceptionsBox, updateExceptionsBox)\nexport class CompExceptionsBox<AiMsg> extends BaseComp<\n    AiMsg,\n    CompExceptionsBoxProps,\n    CompExceptionsBoxElements,\n    CompExceptionsBoxEvents,\n    CompExceptionsBoxActions\n> {\n    constructor(\n        context: ControllerContext<AiMsg>,\n        props: CompExceptionsBoxProps,\n    ) {\n        super(context, props);\n    }\n\n    public destroy() {\n        super.destroy();\n    }\n\n    public showAlert(type: NLErrorId, message: string) {\n        this.executeDomAction('displayException', message);\n    }\n}\n","import {BaseComp} from '../aiChat/comp/base';\nimport {CompRegistry} from '../aiChat/comp/registry';\nimport {getGlobalMetaData} from '../global';\nimport {CompChatItem} from './chat/chatItem/chatItem.model';\nimport {CompChatRoom} from './chat/chatRoom/chatRoom.model';\nimport {CompChatSegment} from './chat/chatSegment/chatSegment.model';\nimport {CompComposer} from './chat/composer/composer.model';\nimport {CompConversation} from './chat/conversation/conversation.model';\nimport {CompConversationStarters} from './chat/conversationStarters/conversationStarters.model';\nimport {CompLaunchPad} from './chat/launchPad/launchPad.model';\nimport {CompExceptionsBox} from './miscellaneous/exceptionsBox/model';\n\n// Sections, in the Vanilla JavaScript version of NLUX, are a part of the library that combine user interface\n// components, as well as the logic that drives them. They are not called `components` because the term `component` is\n// reserved for ` pure `UI components that do not contain any business logic.\n\nconst sectionsById = () => ({\n    // The main chat room component\n    'chatRoom': CompChatRoom,\n\n    // Kep top level components\n    'launchPad': CompLaunchPad,\n    'conversation': CompConversation,\n    'composer': CompComposer,\n\n    // Additional sub-components\n    'conversationStarters': CompConversationStarters,\n    'chatSegment': CompChatSegment,\n    'chatItem': CompChatItem,\n\n    // Miscellaneous\n    'exceptionsBox': CompExceptionsBox,\n});\n\nexport const registerAllSections = () => {\n    const globalNlux = getGlobalMetaData();\n    const sectionsRegistered = btoa('sectionsRegistered');\n    if (globalNlux && globalNlux[sectionsRegistered] === true) {\n        return;\n    }\n\n    Object.entries(sectionsById()).forEach(([, comp]) => {\n        CompRegistry.register(comp as typeof BaseComp);\n    });\n\n    if (typeof globalNlux === 'object') {\n        globalNlux[sectionsRegistered] = true;\n    }\n};\n","import {CallbackFunction} from '@shared/types/callbackFunction';\nimport {EventName, EventsConfig, EventsMap} from '../../types/event';\n\nexport class EventManager<AiMsg> {\n\n    public emit = <EventToEmit extends EventName>(\n        event: EventToEmit,\n        ...params: Parameters<EventsMap<AiMsg>[EventToEmit]>\n    ) => {\n        if (!this.eventListeners.has(event)) {\n            return;\n        }\n\n        this.eventListeners.get(event)?.forEach((callback: EventsMap<AiMsg>[EventName]) => {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            (callback as CallbackFunction)(...params);\n        });\n    };\n    public on = <EventToAdd extends EventName>(\n        event: EventToAdd,\n        callback: EventsMap<AiMsg>[EventToAdd],\n    ) => {\n        if (!this.eventListeners.has(event)) {\n            this.eventListeners.set(event, new Set());\n        }\n\n        this.eventListeners.get(event)?.add(callback);\n    };\n    public removeAllEventListeners = (eventName: EventName) => this.eventListeners.delete(eventName);\n    public removeAllEventListenersForAllEvent = () => this.eventListeners.clear();\n    public removeEventListener = <EventToUpdate extends EventName>(\n        event: EventToUpdate,\n        callback: EventsMap<AiMsg>[EventToUpdate],\n    ) => {\n        if (!this.eventListeners.has(event)) {\n            return;\n        }\n\n        this.eventListeners.get(event)?.delete(callback);\n        if (!this.eventListeners.get(event)?.size) {\n            this.eventListeners.delete(event);\n        }\n    };\n    public updateEventListeners = (\n        events: EventsConfig<AiMsg>,\n    ) => {\n        //\n        // Replace all listeners for events present in the new events object\n        // This overwrites any existing listeners for these events! But it will not remove\n        // listeners for events that are not present in the `events: EventsMap` object.\n        //\n        const eventKeys = Object.keys(events) as Array<keyof EventsMap<AiMsg>>;\n        for (const eventName of eventKeys) {\n            this.eventListeners.set(\n                eventName,\n                new Set([events[eventName] as EventsMap<AiMsg>[EventName]]),\n            );\n        }\n    };\n    private readonly eventListeners: Map<\n        EventName,\n        Set<EventsMap<AiMsg>[EventName]>\n    > = new Map();\n}\n","const rootClassName = 'nlux-AiChat-root';\nconst defaultThemeId = 'nova';\n\nexport const getSystemColorScheme = () => {\n    if (typeof globalThis !== undefined && globalThis.matchMedia && globalThis.matchMedia(\n        '(prefers-color-scheme: dark)')?.matches) {\n        return 'dark';\n    }\n\n    return 'light';\n};\n\nexport const getRootClassNames = (props: {\n    themeId?: string;\n    className?: string;\n}): string[] => {\n    const result = [rootClassName];\n    const themeId = props.themeId || defaultThemeId;\n    const themeClassName = `nlux-theme-${themeId}`;\n\n    result.push(themeClassName);\n\n    if (props.className) {\n        result.push(props.className);\n    }\n\n    return result;\n};\n","import {ChatItem} from '@shared/types/conversation';\nimport {NluxRenderingError} from '@shared/types/error';\nimport {NLErrorId} from '@shared/types/exceptions/errors';\nimport {emptyInnerHtml} from '@shared/utils/dom/emptyInnerHtml';\nimport {getConversationLayout} from '@shared/utils/dom/getConversationLayout';\nimport {getRootClassNames, getSystemColorScheme} from '@shared/utils/dom/getRootClassNames';\nimport {warn} from '@shared/utils/warn';\nimport {CompChatRoom} from '../../sections/chat/chatRoom/chatRoom.model';\nimport {CompChatRoomProps} from '../../sections/chat/chatRoom/chatRoom.types';\nimport {CompExceptionsBox} from '../../sections/miscellaneous/exceptionsBox/model';\nimport {AiChatInternalProps, UpdatableAiChatProps} from '../../types/aiChat/props';\nimport {ControllerContext} from '../../types/controllerContext';\nimport {propsToCorePropsInEvents} from '../../utils/propsToCorePropsInEvents';\nimport {comp} from '../comp/comp';\nimport {CompRegistry} from '../comp/registry';\nimport {ComposerOptions} from '../options/composerOptions';\nimport {ConversationOptions} from '../options/conversationOptions';\nimport {DisplayOptions} from '../options/displayOptions';\nimport {MessageOptions} from '../options/messageOptions';\nimport {PersonaOptions} from '../options/personaOptions';\n\nexport class NluxRenderer<AiMsg> {\n    private readonly __context: ControllerContext<AiMsg>;\n\n    private chatRoom: CompChatRoom<AiMsg> | null = null;\n    private exceptionsBox: CompExceptionsBox<AiMsg> | null = null;\n    private isDestroyed: boolean = false;\n    private isMounted: boolean = false;\n    private rootCompId: string | null = null;\n    private rootElement: HTMLElement | null = null;\n    private rootElementInitialClassName: string | null;\n\n    private theClassName: string | null = null;\n    private theComposerOptions: ComposerOptions = {};\n    private theConversationOptions: ConversationOptions = {};\n    private theDisplayOptions: DisplayOptions = {};\n    private theInitialConversationContent: ChatItem<AiMsg>[] | null = null;\n    private theMessageOptions: MessageOptions<AiMsg> = {};\n    private thePersonasOptions: PersonaOptions = {};\n\n    constructor(\n        context: ControllerContext<AiMsg>,\n        rootCompId: string,\n        rootElement: HTMLElement,\n        props: AiChatInternalProps<AiMsg> | null = null,\n    ) {\n        if (!rootCompId) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Root component ID is not a valid component name',\n            });\n        }\n\n        this.__context = context;\n\n        this.rootElement = rootElement;\n        this.rootElementInitialClassName = rootElement.className;\n        this.rootCompId = rootCompId;\n        this.chatRoom = null;\n\n        this.theClassName = props?.className ?? null;\n        this.theDisplayOptions = props?.displayOptions ?? {};\n        this.theConversationOptions = props?.conversationOptions ?? {};\n        this.theMessageOptions = props?.messageOptions ?? {};\n        this.theInitialConversationContent = props?.initialConversation ?? null;\n        this.theComposerOptions = props?.composerOptions ?? {};\n        this.thePersonasOptions = props?.personaOptions ?? {};\n    }\n\n    public get className(): string | undefined {\n        return this.theClassName ?? undefined;\n    }\n\n    public get colorScheme(): 'light' | 'dark' | 'auto' | undefined {\n        return this.theDisplayOptions.colorScheme;\n    }\n\n    get context() {\n        return this.__context;\n    }\n\n    public get mounted() {\n        return this.isMounted;\n    }\n\n    public get themeId() {\n        return this.theDisplayOptions.themeId;\n    }\n\n    destroy() {\n        if (this.mounted) {\n            this.unmount();\n        }\n\n        if (this.chatRoom) {\n            this.chatRoom.destroy();\n        }\n\n        this.rootElement = null;\n        this.rootElementInitialClassName = null;\n\n        this.rootCompId = null;\n        this.chatRoom = null;\n        this.isMounted = false;\n        this.isDestroyed = true;\n\n        this.theDisplayOptions = {};\n        this.theConversationOptions = {};\n        this.theComposerOptions = {};\n    }\n\n    hide() {\n        if (!this.mounted) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Renderer is not mounted and cannot be hidden',\n            });\n        }\n\n        this.chatRoom?.hide();\n    }\n\n    mount() {\n        if (this.isDestroyed) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Renderer is destroyed and cannot be mounted',\n            });\n        }\n\n        if (!this.rootCompId || !this.rootElement) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Root component or root class is not set',\n            });\n        }\n\n        let rootComp: CompChatRoom<AiMsg> | null = null;\n        let exceptionAlert: CompExceptionsBox<AiMsg> | null = null;\n\n        try {\n            // Root component can only be a chat room component.\n            if (this.rootCompId !== 'chatRoom') {\n                throw new NluxRenderingError({\n                    source: this.constructor.name,\n                    message: 'Root component is not a chat room',\n                });\n            }\n\n            //\n            // IMPORTANT ✨ This is where the CompChatRoom is instantiated!\n            //\n            rootComp = comp(CompChatRoom<AiMsg>)\n                .withContext(this.context)\n                .withProps<CompChatRoomProps<AiMsg>>({\n                    visible: true,\n                    conversationLayout: getConversationLayout(this.theConversationOptions.layout),\n                    assistantPersona: this.thePersonasOptions?.assistant ?? undefined,\n                    userPersona: this.thePersonasOptions?.user ?? undefined,\n                    conversationStarters: this.theConversationOptions?.conversationStarters ?? undefined,\n                    showGreeting: this.theConversationOptions?.showWelcomeMessage,\n                    initialConversationContent: this.theInitialConversationContent ?? undefined,\n                    autoScroll: this.theConversationOptions?.autoScroll,\n                    syntaxHighlighter: this.context.syntaxHighlighter,\n                    htmlSanitizer: this.context.htmlSanitizer,\n                    markdownLinkTarget: this.theMessageOptions?.markdownLinkTarget,\n                    showCodeBlockCopyButton: this.theMessageOptions?.showCodeBlockCopyButton,\n                    streamingAnimationSpeed: this.theMessageOptions?.streamingAnimationSpeed,\n                    skipStreamingAnimation: this.theMessageOptions?.skipStreamingAnimation,\n                    composer: {\n                        placeholder: this.theComposerOptions?.placeholder,\n                        autoFocus: this.theComposerOptions?.autoFocus,\n                        disableSubmitButton: this.theComposerOptions?.disableSubmitButton,\n                        submitShortcut: this.theComposerOptions?.submitShortcut,\n                    },\n                }).create();\n\n            const CompExceptionsBoxConstructor = CompRegistry.retrieve(\n                'exceptionsBox',\n            )?.model as typeof CompExceptionsBox | undefined;\n\n            if (CompExceptionsBoxConstructor) {\n                exceptionAlert = comp(CompExceptionsBox<AiMsg>)\n                    .withContext(this.context)\n                    .create();\n            } else {\n                warn('Exception alert component is not registered! No exceptions will be shown.');\n            }\n\n            if (!rootComp) {\n                throw new NluxRenderingError({\n                    source: this.constructor.name,\n                    message: 'Root component failed to instantiate',\n                });\n            }\n\n            this.setRootElementClassNames();\n            this.setRoomElementDimensions(this.theDisplayOptions);\n\n            if (exceptionAlert) {\n                exceptionAlert.render(this.rootElement);\n            }\n\n            rootComp.render(this.rootElement);\n\n            if (rootComp && !rootComp.rendered) {\n                this.rootElement.className = this.rootElementInitialClassName || '';\n\n                throw new NluxRenderingError({\n                    source: this.constructor.name,\n                    message: 'Root component did not render',\n                });\n            } else {\n                this.chatRoom = rootComp;\n                this.exceptionsBox = exceptionAlert ?? null;\n                this.isMounted = true;\n            }\n        } catch (_error) {\n            this.rootElement.className = this.rootElementInitialClassName || '';\n            this.renderEx('failed-to-render-content', _error?.toString() ?? 'Unknown error');\n        }\n    }\n\n    public renderEx(type: NLErrorId, message: string) {\n        if (!this.mounted) {\n            warn('Renderer is not mounted and cannot render exceptions');\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: message,\n            });\n        }\n\n        this.exceptionsBox?.showAlert(type, message);\n    }\n\n    show() {\n        if (!this.mounted) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Renderer is not mounted and cannot be shown',\n            });\n        }\n\n        this.chatRoom?.show();\n    }\n\n    unmount() {\n        if (this.isDestroyed) {\n            warn('Renderer is destroyed and cannot be unmounted');\n            return;\n        }\n\n        if (!this.chatRoom || !this.rootElement) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Root component or root element is not set',\n            });\n        }\n\n        //\n        // Trigger pre-destroy event\n        //\n        this.context.emit('preDestroy', {\n            aiChatProps: propsToCorePropsInEvents(this.context.aiChatProps),\n            conversationHistory: this.chatRoom.getConversationContentForAdapter(\n                this.context.aiChatProps.conversationOptions?.historyPayloadSize,\n            ) ?? [],\n        });\n\n        //\n        // Destroy UI components\n        //\n        if (this.exceptionsBox) {\n            this.exceptionsBox.destroy();\n        }\n\n        this.chatRoom.destroy();\n        if (this.rootElement) {\n            emptyInnerHtml(this.rootElement);\n            this.rootElement.className = this.rootElementInitialClassName || '';\n        }\n\n        this.chatRoom = null;\n        this.exceptionsBox = null;\n        this.isMounted = false;\n    }\n\n    public updateProps(props: UpdatableAiChatProps<AiMsg>) {\n        if (props.hasOwnProperty('adapter') && props.adapter) {\n            this.context.update({\n                adapter: props.adapter,\n            });\n        }\n\n        let classNameUpdated = false;\n        if (props.hasOwnProperty('className') && props.className !== this.className) {\n            this.theClassName = props.className ?? null;\n            classNameUpdated = true;\n        }\n\n        let themeIdUpdated = false;\n        let colorSchemeUpdated = false;\n\n        if (props.hasOwnProperty('displayOptions')) {\n            const newDisplayOptions: Partial<DisplayOptions> = {};\n\n            if (props.displayOptions?.themeId !== this.theDisplayOptions.themeId) {\n                newDisplayOptions.themeId = props.displayOptions?.themeId;\n                themeIdUpdated = true;\n            }\n\n            if (props.displayOptions?.colorScheme !== this.theDisplayOptions.colorScheme) {\n                newDisplayOptions.colorScheme = props.displayOptions?.colorScheme;\n                colorSchemeUpdated = true;\n            }\n\n            if (props.displayOptions?.height !== this.theDisplayOptions.height) {\n                newDisplayOptions.height = props.displayOptions?.height;\n            }\n\n            if (props.displayOptions?.width !== this.theDisplayOptions.width) {\n                newDisplayOptions.width = props.displayOptions?.width;\n            }\n\n            if (Object.keys(newDisplayOptions).length > 0) {\n                const displayOptions: DisplayOptions = {\n                    ...this.theDisplayOptions,\n                    ...newDisplayOptions,\n                };\n\n                this.theDisplayOptions = displayOptions;\n                this.setRoomElementDimensions(displayOptions);\n            }\n        }\n\n        if (themeIdUpdated || colorSchemeUpdated || classNameUpdated) {\n            this.setRootElementClassNames();\n        }\n\n        if (props.hasOwnProperty('conversationOptions')) {\n            const newConversationOptions: Partial<ConversationOptions> = {};\n            const newProps: Partial<CompChatRoomProps<AiMsg>> = {};\n\n            if (props.conversationOptions?.layout !== this.theConversationOptions.layout) {\n                newConversationOptions.layout = props.conversationOptions?.layout;\n                newProps.conversationLayout = getConversationLayout(props.conversationOptions?.layout);\n            }\n\n            if (props.conversationOptions?.autoScroll !== this.theConversationOptions.autoScroll) {\n                newConversationOptions.autoScroll = props.conversationOptions?.autoScroll;\n                newProps.autoScroll = props.conversationOptions?.autoScroll;\n            }\n\n            if (props.conversationOptions?.showWelcomeMessage !== this.theConversationOptions.showWelcomeMessage) {\n                newConversationOptions.showWelcomeMessage = props.conversationOptions?.showWelcomeMessage;\n                newProps.showGreeting = props.conversationOptions?.showWelcomeMessage;\n            }\n\n            if (props.conversationOptions?.conversationStarters !== this.theConversationOptions.conversationStarters) {\n                newConversationOptions.conversationStarters = props.conversationOptions?.conversationStarters;\n                newProps.conversationStarters = props.conversationOptions?.conversationStarters;\n            }\n\n            if (Object.keys(newConversationOptions).length > 0) {\n                this.theConversationOptions = {\n                    ...this.theConversationOptions,\n                    ...newConversationOptions,\n                };\n\n                this.chatRoom?.setProps(newProps);\n            }\n        }\n\n        if (props.hasOwnProperty('messageOptions')) {\n            this.theMessageOptions = props.messageOptions ?? {};\n            this.chatRoom?.setProps({\n                streamingAnimationSpeed: props.messageOptions?.streamingAnimationSpeed ?? undefined,\n                markdownLinkTarget: props.messageOptions?.markdownLinkTarget ?? undefined,\n                syntaxHighlighter: props.messageOptions?.syntaxHighlighter,\n                htmlSanitizer: props.messageOptions?.htmlSanitizer,\n            });\n\n            this.context.update({\n                syntaxHighlighter: props.messageOptions?.syntaxHighlighter,\n                htmlSanitizer: props.messageOptions?.htmlSanitizer,\n            });\n        }\n\n        if (props.hasOwnProperty('composerOptions')) {\n            const changedComposerOptions: Partial<ComposerOptions> = {};\n\n            if (\n                props.composerOptions?.hasOwnProperty('placeholder')\n                && props.composerOptions.placeholder !== this.theComposerOptions.placeholder\n            ) {\n                changedComposerOptions.placeholder = props.composerOptions.placeholder;\n            }\n\n            if (\n                props.composerOptions?.hasOwnProperty('autoFocus')\n                && props.composerOptions.autoFocus !== this.theComposerOptions.autoFocus\n            ) {\n                changedComposerOptions.autoFocus = props.composerOptions.autoFocus;\n            }\n\n            if (\n                props.composerOptions?.hasOwnProperty('disableSubmitButton')\n                && props.composerOptions.disableSubmitButton !== this.theComposerOptions.disableSubmitButton\n            ) {\n                changedComposerOptions.disableSubmitButton = props.composerOptions.disableSubmitButton;\n            }\n\n            if (\n                props.composerOptions?.hasOwnProperty('submitShortcut')\n                && props.composerOptions.submitShortcut !== this.theComposerOptions.submitShortcut\n            ) {\n                changedComposerOptions.submitShortcut = props.composerOptions.submitShortcut;\n            }\n\n            if (Object.keys(changedComposerOptions).length > 0) {\n                this.theComposerOptions = {\n                    ...this.theComposerOptions,\n                    ...changedComposerOptions,\n                };\n\n                this.chatRoom?.setProps({\n                    composer: this.theComposerOptions,\n                });\n            }\n        }\n\n        if (props.hasOwnProperty('personaOptions')) {\n            const changedPersonaProps: Partial<CompChatRoomProps<AiMsg>> = {};\n            if (props.personaOptions?.assistant !== this.thePersonasOptions?.assistant) {\n                changedPersonaProps.assistantPersona = props.personaOptions?.assistant ?? undefined;\n            }\n\n            if (props.personaOptions?.user !== this.thePersonasOptions?.user) {\n                changedPersonaProps.userPersona = props.personaOptions?.user ?? undefined;\n            }\n\n            this.thePersonasOptions = {\n                ...this.thePersonasOptions,\n                ...props.personaOptions,\n            };\n\n            this.chatRoom?.setProps(changedPersonaProps);\n        }\n    }\n\n    private setRoomElementDimensions(newDimensions: {\n        width?: number | string;\n        height?: number | string;\n    }) {\n        if (!this.rootElement) {\n            return;\n        }\n\n        if (newDimensions.hasOwnProperty('width')) {\n            this.rootElement.style.width = (typeof newDimensions.width === 'number') ? `${newDimensions.width}px` : (\n                typeof newDimensions.width === 'string' ? newDimensions.width : ''\n            );\n        }\n\n        if (newDimensions.hasOwnProperty('height')) {\n            this.rootElement.style.height = (typeof newDimensions.height === 'number') ? `${newDimensions.height}px` : (\n                typeof newDimensions.height === 'string' ? newDimensions.height : ''\n            );\n        }\n    }\n\n    private setRootElementClassNames() {\n        if (!this.rootElement) {\n            return;\n        }\n\n        const rootClassNames = getRootClassNames({\n            themeId: this.themeId,\n            className: this.className,\n        });\n\n        this.rootElement.className = '';\n        this.rootElement.classList.add(...rootClassNames);\n        this.rootElement.dataset.colorScheme = (this.colorScheme === 'auto' || !this.colorScheme)\n            ? getSystemColorScheme()\n            : this.colorScheme;\n    }\n}\n","import {AiChatProps} from '../../types/aiChat/props';\nimport {ControllerContext, ControllerContextProps} from '../../types/controllerContext';\nimport {EventName, EventsMap} from '../../types/event';\n\nexport const createControllerContext = <AiMsg>(\n    props: ControllerContextProps<AiMsg>,\n    getAiChatProps: () => AiChatProps<AiMsg>,\n    emitEvent: <EventToEmit extends EventName>(\n        event: EventToEmit,\n        ...params: Parameters<EventsMap<AiMsg>[EventToEmit]>\n    ) => void,\n): ControllerContext<AiMsg> => {\n    const context: ControllerContext<AiMsg> = {\n        ...props,\n        update: (newProps: Partial<ControllerContextProps<AiMsg>>) => {\n            Object.assign(context, newProps);\n        },\n        emit: <EventToEmit extends EventName>(\n            eventName: EventToEmit,\n            ...params: Parameters<EventsMap<AiMsg>[EventToEmit]>\n        ) => {\n            emitEvent(eventName, ...params);\n        },\n        get aiChatProps() {\n            return getAiChatProps();\n        },\n    };\n\n    return context;\n};\n","import {NLErrorId, NLErrors} from '@shared/types/exceptions/errors';\nimport {uid} from '@shared/utils/uid';\nimport {warn} from '@shared/utils/warn';\nimport {AiChatInternalProps, AiChatProps, UpdatableAiChatProps} from '../../types/aiChat/props';\nimport {ControllerContext} from '../../types/controllerContext';\nimport {EventCallback, EventName} from '../../types/event';\nimport {EventManager} from '../events/eventManager';\nimport {NluxRenderer} from '../renderer/renderer';\nimport {createControllerContext} from './context';\n\nexport class NluxController<AiMsg> {\n\n    private readonly eventManager = new EventManager<AiMsg>();\n    private internalProps: AiChatInternalProps<AiMsg>;\n    private readonly nluxInstanceId = uid();\n    private renderException = (errorId: string) => {\n        if (!this.mounted || !this.renderer) {\n            return null;\n        }\n\n        const errorMessage = NLErrors[errorId as NLErrorId];\n        if (!errorMessage) {\n            warn(`Exception with id '${errorId}' is not defined`);\n            return null;\n        }\n\n        this.renderer.renderEx(errorId as NLErrorId, errorMessage);\n    };\n    private renderer: NluxRenderer<AiMsg> | null = null;\n    private readonly rootCompId: string;\n    private readonly rootElement: HTMLElement;\n\n    constructor(\n        rootElement: HTMLElement,\n        props: AiChatInternalProps<AiMsg>,\n    ) {\n        this.rootCompId = 'chatRoom';\n        this.rootElement = rootElement;\n        this.internalProps = props;\n    }\n\n    public get mounted() {\n        return this.renderer?.mounted;\n    }\n\n    public hide() {\n        if (!this.mounted) {\n            return;\n        }\n\n        this.renderer?.hide();\n    }\n\n    public mount() {\n        if (this.mounted) {\n            return;\n        }\n\n        const newContext: ControllerContext<AiMsg> = createControllerContext<AiMsg>({\n                instanceId: this.nluxInstanceId,\n                exception: this.renderException,\n                adapter: this.internalProps.adapter,\n                syntaxHighlighter: this.internalProps.messageOptions.syntaxHighlighter,\n                htmlSanitizer: this.internalProps.messageOptions.htmlSanitizer,\n            },\n            () => this.getUpdatedAiChatPropsFromInternalProps(this.internalProps),\n            this.eventManager.emit,\n        );\n\n        this.renderer = new NluxRenderer(\n            newContext,\n            this.rootCompId,\n            this.rootElement,\n            this.internalProps,\n        );\n\n        this.renderer.mount();\n    }\n\n    public on(event: EventName, callback: EventCallback<AiMsg>) {\n        this.eventManager.on(event, callback);\n    }\n\n    removeAllEventListeners(eventName: EventName) {\n        this.eventManager.removeAllEventListeners(eventName);\n    }\n\n    removeAllEventListenersForAllEvent() {\n        this.eventManager.removeAllEventListenersForAllEvent();\n    }\n\n    removeEventListener(event: EventName, callback: EventCallback<AiMsg>) {\n        this.eventManager.removeEventListener(event, callback);\n    }\n\n    public show() {\n        if (!this.mounted) {\n            return;\n        }\n\n        this.renderer?.show();\n    }\n\n    public unmount() {\n        if (!this.mounted) {\n            return;\n        }\n\n        this.renderer?.unmount();\n        this.renderer = null;\n    }\n\n    public updateProps(props: UpdatableAiChatProps<AiMsg>) {\n        this.renderer?.updateProps(props);\n\n        this.internalProps = {\n            ...this.internalProps,\n            ...props,\n        };\n\n        if (props.events) {\n            this.internalProps.events = props.events;\n            this.eventManager.updateEventListeners(props.events);\n        }\n    }\n\n    private getUpdatedAiChatPropsFromInternalProps(\n        internalProps: AiChatInternalProps<AiMsg>,\n    ): AiChatProps<AiMsg> {\n        const updatedProps: AiChatProps<AiMsg> = {...internalProps};\n        type AiChatPropsKey = keyof AiChatProps<AiMsg>;\n\n        // We remove any undefined or null values from the props\n        // or any empty objects\n        for (const key of Object.keys(updatedProps) as AiChatPropsKey[]) {\n            if (updatedProps[key] === undefined || updatedProps[key] === null || (\n                typeof updatedProps[key] === 'object' && Object.keys(updatedProps[key] as object).length === 0\n            )) {\n                delete updatedProps[key];\n            }\n        }\n\n        return updatedProps;\n    };\n}\n","import {ChatAdapter} from '@shared/types/adapters/chat/chatAdapter';\nimport {ChatAdapterBuilder} from '@shared/types/adapters/chat/chatAdapterBuilder';\nimport {StandardChatAdapter} from '@shared/types/adapters/chat/standardChatAdapter';\nimport {ChatItem} from '@shared/types/conversation';\nimport {NluxRenderingError, NluxUsageError, NluxValidationError} from '@shared/types/error';\nimport {debug} from '@shared/utils/debug';\nimport {registerAllSections} from '../sections/sections';\nimport {AiChatStatus, IAiChat} from '../types/aiChat/aiChat';\nimport {UpdatableAiChatProps} from '../types/aiChat/props';\nimport {EventCallback, EventName, EventsMap} from '../types/event';\nimport {NluxController} from './controller/controller';\nimport {ComposerOptions} from './options/composerOptions';\nimport {ConversationOptions} from './options/conversationOptions';\nimport {DisplayOptions} from './options/displayOptions';\nimport {MessageOptions} from './options/messageOptions';\nimport {PersonaOptions} from './options/personaOptions';\n\nexport class AiChat<AiMsg = string> implements IAiChat<AiMsg> {\n    protected theAdapter: ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg> | null = null;\n    protected theAdapterBuilder: ChatAdapterBuilder<AiMsg> | null = null;\n    protected theAdapterType: 'builder' | 'instance' | null = null;\n    protected theClassName: string | null = null;\n    protected theComposerOptions: ComposerOptions | null = null;\n    protected theConversationOptions: ConversationOptions | null = null;\n    protected theDisplayOptions: DisplayOptions | null = null;\n    protected theInitialConversation: ChatItem<AiMsg>[] | null = null;\n    protected theMessageOptions: MessageOptions<AiMsg> | null = null;\n    protected thePersonasOptions: PersonaOptions | null = null;\n    // Variable to track if the chat component was unmounted (and thus cannot be used anymore).\n    private aiChatStatus: AiChatStatus = 'idle';\n    // Controller instance\n    private controller: NluxController<AiMsg> | null = null;\n    // Event listeners provided before the controller is mounted, when the aiChat instance is being built.\n    private unregisteredEventListeners: Map<EventName, Set<EventCallback<AiMsg>>> = new Map();\n\n    public get status(): AiChatStatus {\n        return this.aiChatStatus;\n    }\n\n    private get isIdle() {\n        return this.status === 'idle';\n    }\n\n    hide() {\n        if (!this.controller) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Unable to hide. nlux is not mounted.',\n            });\n        }\n\n        this.controller.hide();\n    }\n\n    public mount(rootElement: HTMLElement) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to create nlux instance. nlux is already or was previously mounted. '\n                    + 'You can only mount a nlux instance once, when the status is `idle`.',\n            });\n        }\n\n        const adapterToUser: ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg> | null =\n            this.theAdapter && this.theAdapterType === 'instance' ? this.theAdapter\n                : (this.theAdapterType === 'builder' && this.theAdapterBuilder)\n                    ? this.theAdapterBuilder.create()\n                    : null;\n\n        if (!adapterToUser) {\n            throw new NluxValidationError({\n                source: this.constructor.name,\n                message: 'Unable to create nlux instance. ChatAdapter is not properly set. '\n                    + 'You should call `withAdapter(adapter)` method before mounting nlux.',\n            });\n        }\n\n        registerAllSections();\n\n        const aiChatRoot = document.createElement('div');\n        rootElement.appendChild(aiChatRoot);\n\n        const controller = new NluxController(\n            aiChatRoot,\n            {\n                adapter: adapterToUser,\n                className: this.theClassName ?? undefined,\n                initialConversation: this.theInitialConversation ?? undefined,\n                messageOptions: this.theMessageOptions ?? {},\n                displayOptions: this.theDisplayOptions ?? {},\n                conversationOptions: this.theConversationOptions ?? {},\n                composerOptions: this.theComposerOptions ?? {},\n                personaOptions: this.thePersonasOptions ?? {},\n            },\n        );\n\n        // Register all unregistered event listeners\n        for (const [eventName, eventListeners] of this.unregisteredEventListeners.entries()) {\n            for (const eventCallback of eventListeners) {\n                controller.on(eventName, eventCallback);\n            }\n        }\n\n        controller.mount();\n\n        if (controller.mounted) {\n            this.aiChatStatus = 'mounted';\n            this.controller = controller;\n            this.unregisteredEventListeners.clear();\n        } else {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'AiChat root component did not render.',\n            });\n        }\n    };\n\n    on(event: EventName, callback: EventsMap<AiMsg>[EventName]) {\n        if (this.status === 'unmounted') {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to add event listener. nlux was previously unmounted.',\n            });\n        }\n\n        if (this.controller) {\n            this.controller.on(event, callback);\n\n            // No need to keep track of event callbacks if the controller is already mounted.\n            return this;\n        }\n\n        if (!this.unregisteredEventListeners.has(event)) {\n            this.unregisteredEventListeners.set(event, new Set());\n        }\n\n        this.unregisteredEventListeners.get(event)?.add(callback);\n        return this;\n    }\n\n    removeAllEventListeners(event: EventName) {\n        // When an event is provided, remove all event listeners for that specific event.\n        this.controller?.removeAllEventListeners(event);\n        this.unregisteredEventListeners.get(event)?.clear();\n    }\n\n    removeEventListener(event: EventName, callback: EventCallback<AiMsg>) {\n        this.controller?.removeEventListener(event, callback);\n        this.unregisteredEventListeners.get(event)?.delete(callback);\n    }\n\n    show() {\n        if (!this.controller) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Unable to show. nlux is not mounted.',\n            });\n        }\n\n        this.controller.show();\n    }\n\n    public unmount() {\n        debug('Unmounting nlux.');\n\n        if (!this.controller) {\n            debug('Invalid call to aiChat.unmount() on an already unmounted nlux instance!');\n            return;\n        }\n\n        this.controller.unmount();\n        if (this.controller.mounted) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Unable to unmount. Root component did not unmount.',\n            });\n        }\n\n        this.controller = null;\n        this.unregisteredEventListeners.clear();\n        this.aiChatStatus = 'unmounted';\n    }\n\n    public updateProps(props: UpdatableAiChatProps<AiMsg>) {\n        if (!this.controller) {\n            throw new NluxRenderingError({\n                source: this.constructor.name,\n                message: 'Unable to update props. nlux is not mounted.',\n            });\n        }\n\n        if (props.hasOwnProperty('adapter')) {\n            this.theAdapter = props.adapter ?? null;\n        }\n\n        if (props.hasOwnProperty('events')) {\n            // Re-register all event listeners\n            this.clearEventListeners();\n            for (const [eventName, eventCallback] of Object.entries(props.events ?? {})) {\n                this.on(eventName as EventName, eventCallback as EventCallback<AiMsg>);\n            }\n        }\n\n        if (props.hasOwnProperty('className')) {\n            this.theClassName = props.className ?? null;\n        }\n\n        if (props.hasOwnProperty('displayOptions')) {\n            this.theDisplayOptions = props.displayOptions ?? null;\n        }\n\n        if (props.hasOwnProperty('composerOptions')) {\n            this.theComposerOptions = props.composerOptions ?? null;\n        }\n\n        if (props.hasOwnProperty('personaOptions')) {\n            this.thePersonasOptions = props.personaOptions ?? null;\n        }\n\n        if (props.hasOwnProperty('conversationOptions')) {\n            this.theConversationOptions = props.conversationOptions ?? null;\n        }\n\n        if (props.hasOwnProperty('messageOptions')) {\n            this.theMessageOptions = props.messageOptions ?? null;\n        }\n\n        this.controller.updateProps(props);\n    }\n\n    public withAdapter(adapter: ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg> | ChatAdapterBuilder<AiMsg>) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set adapter. nlux is already or was previously mounted. ' +\n                    'You can only set the adapter once, when the status is `idle`.',\n            });\n        }\n\n        if (this.theAdapterBuilder || this.theAdapter) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to change config. A adapter or adapter builder was already set.',\n            });\n        }\n\n        if (typeof adapter !== 'object' || adapter === null) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set adapter. Invalid adapter or adapter-builder type.',\n            });\n        }\n\n        const anAdapterOrAdapterBuilder = adapter as Record<string, unknown>;\n        if (typeof anAdapterOrAdapterBuilder.create === 'function') {\n            this.theAdapterType = 'builder';\n            this.theAdapterBuilder = anAdapterOrAdapterBuilder as unknown as ChatAdapterBuilder<AiMsg>;\n            return this;\n        }\n\n        if (\n            (typeof anAdapterOrAdapterBuilder.batchText === 'function') ||\n            (typeof anAdapterOrAdapterBuilder.streamText === 'function')\n        ) {\n            this.theAdapterType = 'instance';\n            this.theAdapter = anAdapterOrAdapterBuilder as ChatAdapter<AiMsg>;\n            return this;\n        }\n\n        throw new NluxUsageError({\n            source: this.constructor.name,\n            message: 'Unable to set adapter. Invalid adapter or adapter-builder implementation! '\n                + 'When an `ChatAdapterBuilder` is provided, it must implement either `create()` method that returns an '\n                + 'ChatAdapter instance. When an ChatAdapter instance is provided, must implement `batchText()` and/or '\n                + '`streamText()` methods. None of the above were found.',\n        });\n    };\n\n    public withClassName(className: string) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set class name. nlux is already or was previously mounted. ' +\n                    'You can only set the class name once, when the status is `idle`.',\n            });\n        }\n\n        if (this.theClassName) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to change config. A class name was already set.',\n            });\n        }\n\n        this.theClassName = className;\n        return this;\n    }\n\n    public withComposerOptions(composerOptions: ComposerOptions) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set composer options. nlux is already or was previously mounted. ' +\n                    'You can only set the composer options once, when the status is `idle`.',\n            });\n        }\n\n        if (this.theComposerOptions) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to change config. Composer options were already set.',\n            });\n        }\n\n        this.theComposerOptions = {...composerOptions};\n        return this;\n    }\n\n    public withConversationOptions(conversationOptions: ConversationOptions) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set conversation options. nlux is already or was previously mounted. ' +\n                    'You can only set the conversation options once, when the status is `idle`.',\n            });\n        }\n\n        if (this.theConversationOptions) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to change config. Conversation options were already set.',\n            });\n        }\n\n        this.theConversationOptions = {...conversationOptions};\n        return this;\n    }\n\n    public withDisplayOptions(displayOptions: DisplayOptions) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set display options. nlux is already or was previously mounted. ' +\n                    'You can only set the display options once, when the status is `idle`.',\n            });\n        }\n\n        if (this.theDisplayOptions) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to change config. Display options were already set.',\n            });\n        }\n\n        this.theDisplayOptions = {...displayOptions};\n        return this;\n    }\n\n    public withInitialConversation(initialConversation: ChatItem<AiMsg>[]) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set initial conversation. nlux is already or was previously mounted. ' +\n                    'You can only set the initial conversation once, when the status is `idle`.',\n            });\n        }\n\n        if (this.theInitialConversation) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to change config. Conversation history was already set.',\n            });\n        }\n\n        this.theInitialConversation = [...initialConversation];\n        return this;\n    }\n\n    public withMessageOptions(messageOptions: MessageOptions<AiMsg>) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set message options. nlux is already or was previously mounted. ' +\n                    'You can only set the message options once, when the status is `idle`.',\n            });\n        }\n\n        if (this.theMessageOptions) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to change config. Message options were already set.',\n            });\n        }\n\n        this.theMessageOptions = {...messageOptions};\n        return this;\n    }\n\n    public withPersonaOptions(personaOptions: PersonaOptions) {\n        if (!this.isIdle) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to set persona options. nlux is already or was previously mounted. ' +\n                    'You can only set the persona options once, when the status is `idle`.',\n            });\n        }\n\n        if (this.thePersonasOptions) {\n            throw new NluxUsageError({\n                source: this.constructor.name,\n                message: 'Unable to change config. Personas were already set.',\n            });\n        }\n\n        this.thePersonasOptions = {...personaOptions};\n        return this;\n    }\n\n    private clearEventListeners() {\n        this.controller?.removeAllEventListenersForAllEvent();\n        this.unregisteredEventListeners.clear();\n        return;\n    }\n}\n","import {IObserver} from './observer';\n\nexport class Observable<DataType> {\n\n    private buffer: DataType[] = [];\n    private errorReceived: Error | null = null;\n    private isCompleted: boolean = false;\n    private readonly isReplayObservable: boolean = false;\n    private subscribers: Set<IObserver<DataType>> = new Set();\n\n    constructor({replay}: {replay?: boolean} = {}) {\n        this.isReplayObservable = replay ?? false;\n    }\n\n    complete() {\n        this.subscribers.forEach(observer => observer.complete?.());\n        this.isCompleted = true;\n    }\n\n    error(error: Error) {\n        this.subscribers.forEach(observer => observer.error?.(error));\n        if (this.isReplayObservable) {\n            this.errorReceived = error;\n        }\n    }\n\n    next(value: DataType) {\n        this.subscribers.forEach(observer => observer.next(value));\n        if (this.isReplayObservable) {\n            this.buffer.push(value);\n        }\n    }\n\n    reset() {\n        this.subscribers.clear();\n        this.buffer = [];\n    }\n\n    subscribe(observer: IObserver<DataType>) {\n        this.subscribers.add(observer);\n        if (this.isReplayObservable) {\n            this.sendBufferToObserver(observer);\n        }\n\n        return {\n            unsubscribe: () => this.unsubscribe(observer),\n        };\n    }\n\n    unsubscribe(observer: IObserver<DataType>) {\n        this.subscribers.delete(observer);\n    }\n\n    private sendBufferToObserver(observer: IObserver<DataType>) {\n        this.buffer.forEach(value => observer.next(value));\n        if (this.errorReceived) {\n            observer.error?.(this.errorReceived);\n        } else {\n            if (this.isCompleted) {\n                observer.complete?.();\n            }\n        }\n    }\n}\n","import {ContextTasksAdapter} from '@shared/types/adapters/context/contextTasksAdapter';\n\nexport const isContextTasksAdapter = (adapter: unknown): ContextTasksAdapter | false => {\n    const typedAdapter = adapter as Partial<ContextTasksAdapter> | undefined;\n    if (\n        typedAdapter &&\n        typeof typedAdapter.resetTasks === 'function' &&\n        typeof typedAdapter.updateTasks === 'function' &&\n        typeof typedAdapter.removeTasks === 'function'\n    ) {\n        return typedAdapter as ContextTasksAdapter;\n    }\n\n    return false;\n};\n","import {ContextAdapter} from '@shared/types/adapters/context/contextAdapter';\nimport {ContextDataAdapter} from '@shared/types/adapters/context/contextDataAdapter';\nimport {DestroyContextResult, InitializeContextResult} from '@shared/types/aiContext/contextResults';\nimport {ContextItemDataType, ContextItems} from '@shared/types/aiContext/data';\nimport {warn} from '@shared/utils/warn';\n\ntype UpdateQueueItem = {\n    operation: 'set';\n    data: ContextItemDataType;\n    description: string;\n} | {\n    operation: 'update';\n    data?: ContextItemDataType;\n    description?: string;\n} | {\n    operation: 'delete';\n};\n\nexport class DataSyncService {\n\n    private actionToPerformWhenIdle: 'flush' | 'reset' | 'none' = 'none';\n    private dataAdapter: ContextDataAdapter;\n    private readonly itemIds = new Set<string>();\n    private status: 'idle' | 'updating' | 'destroyed' = 'idle';\n    private theContextId: string | null = null;\n    private readonly updateQueueByItemId: Map<string, UpdateQueueItem> = new Map();\n\n    constructor(adapter: ContextDataAdapter | ContextAdapter) {\n        this.dataAdapter = adapter;\n    }\n\n    get contextId(): string | null {\n        return this.theContextId;\n    }\n\n    async createContext(initialItems?: ContextItems): Promise<InitializeContextResult> {\n        if (this.status === 'destroyed') {\n            return {\n                success: false,\n                error: 'The context has been destroyed',\n            };\n        }\n\n        const contextItems = initialItems ?? null;\n        this.itemIds.clear();\n        if (contextItems !== null) {\n            const itemIds = Object.keys(contextItems);\n            itemIds.forEach((itemId) => {\n                this.itemIds.add(itemId);\n            });\n        }\n\n        this.actionToPerformWhenIdle = 'none';\n\n        try {\n            // TODO - Handle retry on failure.\n            const result = await this.dataAdapter.create(contextItems ?? {});\n            if (result.success) {\n                this.theContextId = result.contextId;\n                return {\n                    success: true,\n                    contextId: result.contextId,\n                };\n            } else {\n                return {\n                    success: false,\n                    error: 'Failed to set the context',\n                };\n            }\n        } catch (error) {\n            return {\n                success: false,\n                error: `${error}`,\n            };\n        }\n    }\n\n    async destroy(): Promise<DestroyContextResult> {\n        if (this.status === 'destroyed') {\n            warn(`Context.DataSyncService.destroy() called on a state that has already been destroyed`);\n            return {\n                success: true,\n            };\n        }\n\n        if (this.status === 'updating' && !this.contextId) {\n            warn(`Context.DataSyncService.destroy() called with no contextId!`);\n        }\n\n        if (this.contextId) {\n            this.status = 'updating';\n            await this.dataAdapter.discard(this.contextId);\n            // TODO - Handle failure to reset context data.\n        }\n\n        this.status = 'destroyed';\n        this.theContextId = null;\n        this.updateQueueByItemId.clear();\n        this.actionToPerformWhenIdle = 'none';\n\n        return {\n            success: true,\n        };\n    }\n\n    async flush(): Promise<void> {\n        if (!this.contextId) {\n            throw new Error('Context not initialized');\n        }\n\n        if (this.status === 'updating') {\n            this.actionToPerformWhenIdle = 'flush';\n            return;\n        }\n\n        this.status = 'updating';\n\n        const itemsInQueue = this.updateQueueByItemId.keys();\n        const itemsToUpdate: string[] = [];\n        const itemsToDelete: string[] = [];\n        for (const itemId of itemsInQueue) {\n            const item = this.updateQueueByItemId.get(itemId);\n            if (!item) {\n                continue;\n            }\n\n            if (item.operation === 'delete') {\n                itemsToDelete.push(itemId);\n                continue;\n            }\n\n            if (['set', 'update'].includes(item.operation)) {\n                itemsToUpdate.push(itemId);\n\n            }\n        }\n\n        const itemsUpdateObject: Partial<ContextItems> = itemsToUpdate.reduce(\n            (acc: Partial<ContextItems>, itemId) => {\n                const op = this.updateQueueByItemId.get(itemId);\n                if (!op) {\n                    return acc;\n                }\n\n                if (op.operation === 'set') {\n                    acc[itemId] = {\n                        value: op.data,\n                        description: op.description,\n                    };\n                }\n\n                if (\n                    op.operation === 'update' &&\n                    (op.data !== undefined || op.description !== undefined)\n                ) {\n                    // We know that at least one of the two arguments is not undefined.\n                    acc[itemId] = {value: op.data!, description: op.description!};\n                }\n\n                return acc;\n            },\n            {},\n        );\n\n        if (Object.keys(itemsUpdateObject).length > 0) {\n            Object.keys(itemsUpdateObject).forEach((itemId) => {\n                this.updateQueueByItemId.delete(itemId);\n            });\n\n            try {\n                await this.dataAdapter.updateItems(this.contextId, itemsUpdateObject);\n            } catch (error) {\n                warn(`Failed to update context data: ${error}`);\n\n                // Reset the items that failed to update.\n                Object.keys(itemsUpdateObject).forEach((itemId) => {\n                    const item = itemsUpdateObject[itemId];\n                    if (!item) {\n                        return;\n                    }\n\n                    this.updateQueueByItemId.set(itemId, {\n                        operation: 'update',\n                        data: item.value,\n                        description: item.description,\n                    });\n                });\n            }\n        }\n\n        if (itemsToDelete.length > 0) {\n            itemsToDelete.forEach((itemId) => {\n                this.itemIds.delete(itemId);\n                this.updateQueueByItemId.delete(itemId);\n            });\n\n            try {\n                await this.dataAdapter.removeItems(this.contextId, itemsToDelete);\n            } catch (error) {\n                warn(`Failed to delete context data: ${error}`);\n\n                // Reset the items that failed to delete.\n                itemsToDelete.forEach((itemId) => {\n                    this.itemIds.add(itemId);\n                    this.updateQueueByItemId.set(itemId, {operation: 'delete'});\n                });\n            }\n        }\n\n        await this.backToIdle();\n    }\n\n    hasActiveItemWithId(itemId: string): boolean {\n        return this.itemIds.has(itemId) && (\n            !this.updateQueueByItemId.has(itemId) ||\n            this.updateQueueByItemId.get(itemId)?.operation !== 'delete'\n        );\n    }\n\n    hasItemWithId(itemId: string): boolean {\n        return this.itemIds.has(itemId);\n    }\n\n    removeItem(itemId: string) {\n        if (this.status === 'destroyed') {\n            throw new Error('The context has been destroyed');\n        }\n\n        if (!this.contextId) {\n            throw new Error('Context not initialized');\n        }\n\n        if (!this.itemIds.has(itemId)) {\n            throw new Error('Item not found');\n        }\n\n        this.updateQueueByItemId.set(itemId, {operation: 'delete'});\n    }\n\n    async resetContextData(newInitialData?: ContextItems): Promise<void> {\n        const victimContextId = this.contextId;\n\n        this.itemIds.clear();\n        this.updateQueueByItemId.clear();\n\n        if (this.status === 'updating') {\n            this.actionToPerformWhenIdle = 'reset';\n            return;\n        }\n\n        if (!victimContextId) {\n            warn(`resetContextData() called with no contextId!`);\n            await this.backToIdle();\n            return;\n        }\n\n        try {\n            this.status = 'updating';\n            await this.dataAdapter.resetItems(victimContextId, newInitialData);\n        } catch (error) {\n            warn(`Failed to reset context data: ${error}`);\n            // TODO - Handle retry on failure.\n        }\n\n        this.updateQueueByItemId.clear();\n        if (newInitialData) {\n            this.itemIds.clear();\n            const newItems = Object.keys(newInitialData);\n            newItems.forEach((itemId) => {\n                this.itemIds.add(itemId);\n            });\n        } else {\n            this.itemIds.clear();\n        }\n\n        await this.backToIdle();\n    }\n\n    setItemData(itemId: string, description: string, data: ContextItemDataType) {\n        if (this.status === 'destroyed') {\n            throw new Error('The context has been destroyed');\n        }\n\n        this.updateQueueByItemId.set(\n            itemId,\n            {\n                operation: 'set',\n                description,\n                data,\n            },\n        );\n\n        this.itemIds.add(itemId);\n    }\n\n    updateItemData(itemId: string, description?: string, data?: ContextItemDataType) {\n        if (this.status === 'destroyed') {\n            throw new Error('The context has been destroyed');\n        }\n\n        if (data === undefined && description === undefined) {\n            return;\n        }\n\n        const currentInQueue: UpdateQueueItem | undefined = this.updateQueueByItemId.get(itemId);\n        if (currentInQueue?.operation === 'delete') {\n            throw new Error('Item has been deleted');\n        }\n\n        const updatedData = data ?? currentInQueue?.data ?? undefined;\n        const updatedDescription = description ?? currentInQueue?.description ?? undefined;\n\n        // We know that at least one of the two arguments is not undefined, which is what's required by\n        // updateQueueByItemId[itemId] type.\n\n        this.updateQueueByItemId.set(itemId, {\n            operation: 'update', data: updatedData, description: updatedDescription,\n        });\n    }\n\n    private async backToIdle() {\n        this.status = 'idle';\n        const actionToPerformWhenIdle = this.actionToPerformWhenIdle;\n        this.actionToPerformWhenIdle = 'none';\n\n        if (actionToPerformWhenIdle === 'flush') {\n            await this.flush();\n            return;\n        }\n\n        if (actionToPerformWhenIdle === 'reset') {\n            await this.resetContextData();\n            return;\n        }\n    }\n}\n","import {ContextTasksAdapter} from '@shared/types/adapters/context/contextTasksAdapter';\nimport {ContextActionResult, DestroyContextResult, RunTaskResult} from '@shared/types/aiContext/contextResults';\nimport {ContextTask, ContextTasks} from '@shared/types/aiContext/data';\nimport {CallbackArgType, CallbackFunction} from '@shared/types/callbackFunction';\nimport {warn} from '@shared/utils/warn';\n\ntype UpdateQueueItem = {\n    operation: 'set';\n    description: string;\n    paramDescriptions: string[];\n    callback: CallbackFunction;\n} | {\n    operation: 'update';\n    description?: string;\n    paramDescriptions?: string[];\n    callback?: CallbackFunction;\n} | {\n    operation: 'delete';\n};\n\nexport class TasksService {\n    private actionToPerformWhenIdle: 'flush' | 'reset' | 'none' = 'none';\n    private adapter: ContextTasksAdapter;\n    private readonly contextId: string;\n    private status: 'idle' | 'updating' | 'destroyed' = 'idle';\n    private readonly taskCallbacks: Map<string, CallbackFunction> = new Map();\n    private readonly tasks: Set<string> = new Set();\n    private readonly updateQueueByTaskId: Map<string, UpdateQueueItem> = new Map();\n\n    constructor(contextId: string, adapter: ContextTasksAdapter) {\n        this.contextId = contextId;\n        this.adapter = adapter;\n    }\n\n    canRunTask(taskId: string): boolean {\n        return this.taskCallbacks.has(taskId);\n    }\n\n    async destroy(): Promise<DestroyContextResult> {\n        if (this.status === 'destroyed') {\n            warn(`Context.TasksService.destroy() called on a state that has already been destroyed`);\n            return {\n                success: true,\n            };\n        }\n\n        this.status = 'updating';\n        await this.unregisterAllTasks();\n\n        this.status = 'destroyed';\n        this.updateQueueByTaskId.clear();\n        this.tasks.clear();\n\n        return {\n            success: true,\n        };\n    }\n\n    async flush(): Promise<void> {\n        if (this.status === 'updating') {\n            this.actionToPerformWhenIdle = 'flush';\n            return;\n        }\n\n        const itemsInQueue = this.updateQueueByTaskId.keys();\n        const tasksToSet: string[] = [];\n        const tasksToUpdate: string[] = [];\n        const tasksToDelete: string[] = [];\n\n        for (const itemId of itemsInQueue) {\n            const item = this.updateQueueByTaskId.get(itemId);\n            if (!item) {\n                continue;\n            }\n\n            if (item.operation === 'delete') {\n                tasksToDelete.push(itemId);\n                continue;\n            }\n\n            if (item.operation === 'set') {\n                tasksToSet.push(itemId);\n                continue;\n            }\n\n            if (item.operation === 'update') {\n                tasksToUpdate.push(itemId);\n\n            }\n        }\n\n        if (tasksToSet.length === 0 && tasksToUpdate.length === 0 && tasksToDelete.length === 0) {\n            return;\n        }\n\n        // At least one item is in the queue, so we need to update the context.\n        this.status = 'updating';\n\n        const itemsToSetByItemIdData = this.buildUpdateObject(tasksToSet);\n        const itemsToUpdateByItemIdData = this.buildUpdateObject(tasksToUpdate);\n        const allItemsToUpdate = {\n            ...itemsToSetByItemIdData,\n            ...itemsToUpdateByItemIdData,\n        };\n\n        if (Object.keys(allItemsToUpdate).length > 0) {\n            try {\n                const registerTasksResult = await this.adapter.updateTasks(\n                    this.contextId, allItemsToUpdate,\n                );\n\n                if (!registerTasksResult.success) {\n                    warn(\n                        `Context.TasksService.flush() failed to register tasks for context ID ${this.contextId}\\n` +\n                        `Error: ${registerTasksResult.error}`,\n                    );\n                } else {\n                    for (const taskId of Object.keys(allItemsToUpdate)) {\n                        const queuedTask = this.updateQueueByTaskId.get(taskId);\n                        if (queuedTask && queuedTask.operation === 'set') {\n                            this.taskCallbacks.set(taskId, queuedTask.callback);\n                            this.updateQueueByTaskId.delete(taskId);\n                        }\n                    }\n                }\n            } catch (error) {\n                warn(\n                    `Context.TasksService.flush() failed to register tasks for context ID ${this.contextId}\\n` +\n                    `Error: ${error}`,\n                );\n            }\n        }\n\n        if (tasksToDelete.length > 0) {\n            try {\n                const unregisterTasksResult = await this.adapter.removeTasks(\n                    this.contextId, tasksToDelete,\n                );\n\n                if (!unregisterTasksResult.success) {\n                    warn(\n                        `Context.TasksService.flush() failed to unregister tasks for context ID ${this.contextId}\\n` +\n                        `Error: ${unregisterTasksResult.error}`,\n                    );\n                } else {\n                    for (const taskId of tasksToDelete) {\n                        this.taskCallbacks.delete(taskId);\n                        this.updateQueueByTaskId.delete(taskId);\n                    }\n                }\n            } catch (error) {\n                warn(\n                    `Context.TasksService.flush() failed to unregister tasks for context ID ${this.contextId}\\n` +\n                    `Error: ${error}`,\n                );\n            }\n        }\n\n        await this.backToIdle();\n    }\n\n    hasTask(taskId: string): boolean {\n        return this.tasks.has(taskId);\n    }\n\n    async registerTask(\n        taskId: string,\n        description: string,\n        callback: CallbackFunction,\n        paramDescriptions?: string[],\n    ): Promise<void> {\n        if (this.status === 'destroyed') {\n            throw new Error('Context has been destroyed');\n        }\n\n        if (this.tasks.has(taskId)) {\n            throw new Error(`A task with ID \\'${taskId}\\' already exists. Task IDs must be unique.`);\n        }\n\n        this.updateQueueByTaskId.set(taskId, {\n            operation: 'set',\n            description,\n            paramDescriptions: paramDescriptions || [],\n            callback,\n        });\n\n        this.tasks.add(taskId);\n    }\n\n    async resetContextData(): Promise<void> {\n        const victimContextId = this.contextId;\n\n        this.tasks.clear();\n        this.taskCallbacks.clear();\n        this.updateQueueByTaskId.clear();\n\n        if (this.status === 'updating') {\n            this.actionToPerformWhenIdle = 'reset';\n            return;\n        }\n\n        if (!victimContextId) {\n            warn(`resetContextData() called with no contextId!`);\n            await this.backToIdle();\n            return;\n        }\n\n        try {\n            this.status = 'updating';\n            await this.unregisterAllTasks();\n        } catch (error) {\n            warn(`Failed to reset context data: ${error}`);\n            // TODO - Handle retry on failure.\n        }\n\n        await this.backToIdle();\n    }\n\n    async runTask(taskId: string, parameters?: Array<unknown>): Promise<RunTaskResult> {\n        if (this.status === 'destroyed') {\n            throw new Error('Context has been destroyed');\n        }\n\n        if (!this.tasks.has(taskId)) {\n            return {\n                success: false,\n                error: `Task with ID ${taskId} not found`,\n            };\n        }\n\n        const callback = this.taskCallbacks.get(taskId);\n        if (!callback) {\n            return {\n                success: false,\n                error: `The task with ID \\'${taskId}\\' has no callback. This is potential due to failed registration.`,\n            };\n        }\n\n        try {\n            const result = callback(\n                ...(parameters ?? []) as CallbackArgType[],\n            );\n            return {\n                success: true,\n                result,\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: `${error}`,\n            };\n        }\n    }\n\n    async unregisterAllTasks(): Promise<ContextActionResult> {\n        if (this.tasks.size === 0) {\n            return {\n                success: true,\n            };\n        }\n\n        const result = await this.adapter.resetTasks(this.contextId);\n        if (result.success) {\n            this.tasks.clear();\n            this.taskCallbacks.clear();\n            this.updateQueueByTaskId.clear();\n        }\n\n        return result;\n    }\n\n    async unregisterTask(taskId: string): Promise<ContextActionResult> {\n        if (this.status === 'destroyed') {\n            throw new Error('Context has been destroyed');\n        }\n\n        if (!this.tasks.has(taskId)) {\n            return {\n                success: true,\n            };\n        }\n\n        this.tasks.delete(taskId);\n        this.taskCallbacks.delete(taskId);\n        this.updateQueueByTaskId.set(taskId, {\n            operation: 'delete',\n        });\n\n        return {\n            success: true,\n        };\n    }\n\n    async updateTaskCallback(taskId: string, callback: CallbackFunction): Promise<void> {\n        if (this.status === 'destroyed') {\n            throw new Error('The context has been destroyed');\n        }\n\n        if (!this.tasks.has(taskId)) {\n            throw new Error(`Task with ID ${taskId} not found`);\n        }\n\n        this.taskCallbacks.set(taskId, callback);\n    }\n\n    async updateTaskDescription(taskId: string, description: string): Promise<void> {\n        if (this.status === 'destroyed') {\n            throw new Error('The context has been destroyed');\n        }\n\n        if (!this.tasks.has(taskId)) {\n            throw new Error(`Task with ID ${taskId} not found`);\n        }\n\n        const item = this.updateQueueByTaskId.get(taskId);\n        if (item) {\n            if (item.operation !== 'update') {\n                const newItem: UpdateQueueItem = {\n                    operation: 'update',\n                    description,\n                };\n\n                this.updateQueueByTaskId.set(taskId, newItem);\n            } else {\n                item.description = description;\n            }\n        } else {\n            this.updateQueueByTaskId.set(taskId, {\n                operation: 'update',\n                description,\n            });\n        }\n    }\n\n    async updateTaskParamDescriptions(\n        taskId: string, paramDescriptions: string[],\n    ): Promise<void> {\n        if (this.status === 'destroyed') {\n            throw new Error('The context has been destroyed');\n        }\n\n        if (!this.tasks.has(taskId)) {\n            throw new Error(`Task with ID ${taskId} not found`);\n        }\n\n        const item = this.updateQueueByTaskId.get(taskId);\n        if (item) {\n            if (item.operation !== 'update') {\n                const newItem: UpdateQueueItem = {\n                    operation: 'update',\n                    paramDescriptions,\n                };\n\n                this.updateQueueByTaskId.set(taskId, newItem);\n            } else {\n                item.paramDescriptions = paramDescriptions;\n            }\n        } else {\n            this.updateQueueByTaskId.set(taskId, {\n                operation: 'update',\n                paramDescriptions,\n            });\n        }\n    }\n\n    private async backToIdle() {\n        this.status = 'idle';\n        const actionToPerformWhenIdle = this.actionToPerformWhenIdle;\n        this.actionToPerformWhenIdle = 'none';\n\n        if (actionToPerformWhenIdle === 'flush') {\n            await this.flush();\n            return;\n        }\n\n        if (actionToPerformWhenIdle === 'reset') {\n            await this.unregisterAllTasks();\n            return;\n        }\n    }\n\n    private buildUpdateObject(itemIds: string[]): ContextTasks {\n        return itemIds.reduce(\n            (acc: ContextTasks, itemId) => {\n                const item = this.updateQueueByTaskId.get(itemId);\n                if (!item) {\n                    return acc;\n                }\n\n                if (item.operation === 'set') {\n                    acc[itemId] = {\n                        description: item.description,\n                        paramDescriptions: item.paramDescriptions,\n                    };\n                }\n\n                if (\n                    item.operation === 'update' &&\n                    (item.description !== undefined || item.paramDescriptions !== undefined)\n                ) {\n                    const updateData: Partial<ContextTask> = {};\n                    if (item.description !== undefined) {\n                        updateData.description = item.description;\n                    }\n\n                    if (item.paramDescriptions !== undefined) {\n                        updateData.paramDescriptions = item.paramDescriptions;\n                    }\n\n                    acc[itemId] = updateData as ContextTask;\n                }\n\n                return acc;\n            },\n            {},\n        );\n    }\n}\n","import {ContextAdapter} from '@shared/types/adapters/context/contextAdapter';\nimport {ContextAdapterBuilder} from '@shared/types/adapters/context/contextAdapterBuilder';\nimport {ContextTasksAdapter} from '@shared/types/adapters/context/contextTasksAdapter';\nimport {AiContext, AiContextItemStatus, AiContextStatus} from '@shared/types/aiContext/aiContext';\nimport {ContextItemHandler, ContextTaskHandler} from '@shared/types/aiContext/contextObservers';\nimport {\n    ContextActionResult,\n    DestroyContextResult,\n    FlushContextResult,\n    InitializeContextResult,\n    RunTaskResult,\n} from '@shared/types/aiContext/contextResults';\nimport {ContextItemDataType, ContextItems} from '@shared/types/aiContext/data';\nimport {CallbackFunction} from '@shared/types/callbackFunction';\nimport {warn} from '@shared/utils/warn';\nimport {isContextTasksAdapter} from '../utils/adapters/isContextTasksAdapter';\nimport {DataSyncService} from './dataSyncService';\nimport {DataSyncOptions} from './options/dataSyncOptions';\nimport {TasksService} from './tasksService';\n\n/**\n * Default implementation of the AiContext.\n * This class is responsible for managing the context and its observers.\n */\nclass AiContextImpl implements AiContext {\n\n    public destroy = async (): Promise<DestroyContextResult> => {\n        if (this.theStatus === 'destroyed') {\n            return {\n                success: true,\n            };\n        }\n\n        // We immediately set the status to 'destroyed' to prevent the context from being used.\n        // This is to prevent any use of the context while it is being destroyed, including any ongoing data sync\n        // or initialization.\n        this.theStatus = 'destroyed';\n\n        // TODO - Handle error recovery and retry\n        await Promise.all([\n            this.theDataSyncService?.destroy(),\n            this.theTasksService?.destroy(),\n        ]);\n\n        this.theDataSyncService = null;\n        this.theTasksService = null;\n\n        this.theDataAdapter = null;\n        this.theTasksAdapter = null;\n\n        return {\n            success: true,\n        };\n    };\n    public flush = async (): Promise<FlushContextResult> => {\n        try {\n            await this.theDataSyncService?.flush();\n        } catch (_error) {\n            return {\n                success: false,\n                error: 'Failed to flush context data',\n            };\n        }\n\n        try {\n            await this.theTasksService?.flush();\n        } catch (_error) {\n            return {\n                success: false,\n                error: 'Failed to flush context tasks',\n            };\n        }\n\n        return {\n            success: true,\n        };\n    };\n    public initialize = async (data?: ContextItems): Promise<InitializeContextResult> => {\n        // Among the possible context statuses: 'idle' | 'initializing' | 'syncing' | 'error' | 'destroyed'\n        // Initialization cannot happen when the context is 'idle'.\n\n        if (this.theStatus === 'initializing') {\n            warn(\n                `${this.constructor.name}.initialize() called while context is still initializing! ` +\n                `You cannot initialize twice at the same time. Use ${this.constructor.name}.status or await ` +\n                `${this.constructor.name}.initialize() to make sure that the context is not initializing before ` +\n                `calling this method.`,\n            );\n\n            return {\n                success: false,\n                error: 'Context is still initializing! Use AiContext.status to check the context status ' +\n                    'before calling this method.',\n            };\n        }\n\n        if (this.theStatus === 'syncing') {\n            warn(\n                `${this.constructor.name}.initialize() called on an already initialized context! ` +\n                `Use ${this.constructor.name}.status to check the context status before calling this method. `,\n            );\n\n            return {\n                success: false,\n                error: 'Context already initialized! Use AiContext.status to check the context status ' +\n                    'before calling this method.',\n            };\n        }\n\n        if (this.theStatus === 'destroyed') {\n            warn(\n                `${this.constructor.name}.initialize() called on destroyed context! ` +\n                `Use ${this.constructor.name}.status to check the context status before calling this method. ` +\n                `When the context is destroyed, it cannot be used anymore and you should create a new context.`,\n            );\n\n            return {\n                success: false,\n                error: 'Context has been destroyed',\n            };\n        }\n\n        if (this.theStatus === 'error') {\n            warn(\n                `${this.constructor.name}.initialize() called on a context in error state! ` +\n                `Use ${this.constructor.name}.status to check the context status before calling this method. ` +\n                `When the context is in error state, it cannot be used anymore and you should create a new context.`,\n            );\n\n            // TODO - Enable recovery from error state.\n\n            return {\n                success: false,\n                error: 'Context is in error state',\n            };\n        }\n\n        if (!this.theDataAdapter) {\n            warn(\n                `Adapter not set! You must set the adapter before initializing the context. ` +\n                `Use ${this.constructor.name}.withAdapter() to set the adapter before calling this method.`,\n            );\n\n            return {\n                success: false,\n                error: 'Adapter not set',\n            };\n        }\n\n        this.theStatus = 'initializing';\n        this.theDataSyncService = new DataSyncService(this.theDataAdapter);\n\n        try {\n            const result = await this.theDataSyncService.createContext(data);\n\n            // Status can change to 'destroyed' if the context is destroyed while adapter.set is in progress.\n            // In that case, we should not set the contextId and we should immediately clear the context.\n            if (this.status === 'destroyed') {\n                if (result.success) {\n                    await this.theDataSyncService?.resetContextData();\n                }\n\n                return {\n                    success: false,\n                    error: 'Context has been destroyed',\n                };\n            }\n\n            if (!result.success) {\n                this.theStatus = 'error';\n                return {\n                    success: false,\n                    error: 'Failed to initialize context',\n                };\n            }\n\n            if (!this.contextId) {\n                this.theStatus = 'error';\n                return {\n                    success: false,\n                    error: 'Failed to obtain context ID',\n                };\n            }\n\n            //\n            // Handling the happy path, when the context is successfully initialized.\n            //\n            this.theStatus = 'syncing';\n\n            if (this.theTasksAdapter) {\n                this.theTasksService = new TasksService(this.contextId, this.theTasksAdapter);\n            } else {\n                warn(\n                    'Initializing nlux AiContext without tasks adapter. The context will not handle registering and ' +\n                    'executing tasks by AI. If you want to use tasks triggered by AI, you should provide an adapter ' +\n                    'that implements ContextAdapter interface ' +\n                    '[type ContextAdapter = ContextDataAdapter & ContextTasksAdapter]',\n                );\n            }\n\n            return {\n                success: true,\n                contextId: result.contextId,\n            };\n        } catch (error) {\n            this.theStatus = 'error';\n            return {\n                success: false,\n                error: `${error}`,\n            };\n        }\n    };\n    public observeState = (\n        itemId: string,\n        description: string,\n        initialData?: ContextItemDataType,\n    ): ContextItemHandler | undefined => {\n        if (this.theStatus === 'idle') {\n            warn(\n                `${this.constructor.name}.observeState() called on idle context! ` +\n                `Use ${this.constructor.name}.status to check the context status before calling this method. ` +\n                `Use ${this.constructor.name}.initialize() to initialize the context when it is not initialized.`,\n            );\n\n            return undefined;\n        }\n\n        if (this.theStatus === 'initializing') {\n            warn(\n                `${this.constructor.name}.observeState() called while context is still initializing! ` +\n                `You cannot observe state items while the context is initializing. ` +\n                `Use ${this.constructor.name}.status or await ${this.constructor.name}.initialize() to make sure ` +\n                `that the context is not initializing before calling this method.`,\n            );\n\n            return undefined;\n        }\n\n        if (this.theStatus === 'destroyed') {\n            warn(\n                `${this.constructor.name}.observeState() called on destroyed context! ` +\n                `Use ${this.constructor.name}.status to check the context status before calling this method. ` +\n                `When the context is destroyed, it cannot be used anymore and you should create a new context.`,\n            );\n\n            return undefined;\n        }\n\n        // TODO - Look for a way to handle this\n        this.theDataSyncService?.setItemData(itemId, description, initialData ?? null);\n\n        return {\n            setData: (data: ContextItemDataType) => {\n                this.theDataSyncService?.updateItemData(itemId, undefined, data);\n            },\n            setDescription: (description: string) => {\n                this.theDataSyncService?.updateItemData(itemId, description, undefined);\n            },\n            discard: () => {\n                this.theDataSyncService?.removeItem(itemId);\n            },\n        };\n    };\n    public registerTask = (\n        taskId: string,\n        description: string,\n        callback: CallbackFunction,\n        parameters: string[],\n    ): ContextTaskHandler | undefined => {\n        if (this.theStatus === 'idle') {\n            warn(\n                `${this.constructor.name}.registerTask() called on idle context! ` +\n                `Use ${this.constructor.name}.status to check the context status before calling this method. ` +\n                `Use ${this.constructor.name}.initialize() to initialize the context when it is not initialized.`,\n            );\n\n            return undefined;\n        }\n\n        if (!this.theTasksService) {\n            warn(\n                `${this.constructor.name}.registerTask() called on a context that has does not have tasks service! ` +\n                `You should use an adapter that implements ContextTasksAdapter interface in order to register tasks. ` +\n                `Use ${this.constructor.name}.withAdapter() to set the right adapter before calling this method.`,\n            );\n\n            return undefined;\n        }\n\n        if (this.theStatus === 'destroyed') {\n            warn(\n                `${this.constructor.name}.registerTask() called on destroyed context! ` +\n                `Use ${this.constructor.name}.status to check the context status before calling this method. ` +\n                `When the context is destroyed, it cannot be used anymore and you should create a new context.`,\n            );\n\n            return undefined;\n        }\n\n\n        let status: AiContextItemStatus = 'updating';\n\n        if (this.theTasksService.hasTask(taskId)) {\n            console.warn(\n                `${this.constructor.name}.registerTask() called with existing taskId: ${taskId}! ` +\n                `It's only possible to register a task once. Use ${this.constructor.name}.hasTask() to check ` +\n                `if the task already exists. Use ${this.constructor.name}.registerTask() with a different taskId if ` +\n                `you want to register a different task.`,\n            );\n\n            return undefined;\n        }\n\n        this.theTasksService.registerTask(taskId, description, callback, parameters)\n            .then(() => {\n                if (status === 'updating') {\n                    status = 'set';\n                }\n            })\n            .catch(() => {\n                warn(\n                    `${this.constructor.name}.registerTask() failed to register task \\'${taskId}\\'!\\n` +\n                    `The task will be marked as deleted and will not be updated anymore.`,\n                );\n\n                // TODO - Better error handling\n\n                if (status === 'updating') {\n                    status = 'deleted';\n                    this.unregisterTask(taskId);\n                }\n            });\n\n        return {\n            discard: () => {\n                status = 'deleted';\n                this.unregisterTask(taskId);\n            },\n            setDescription: (description: string) => {\n                if (status === 'deleted') {\n                    throw new Error('Task has been deleted');\n                }\n\n                status = 'updating';\n\n                this.theTasksService?.updateTaskDescription(taskId, description)\n                    .then(() => {\n                        if (status === 'updating') {\n                            status = 'set';\n                        }\n                    })\n                    .catch(() => {\n                        if (status === 'updating') {\n                            status = 'set';\n                        }\n                    });\n            },\n            setCallback: (callback) => {\n                if (status === 'deleted') {\n                    throw new Error('Task has been deleted');\n                }\n\n                status = 'updating';\n\n                this.theTasksService?.updateTaskCallback(taskId, callback)\n                    .then(() => {\n                        if (status === 'updating') {\n                            status = 'set';\n                        }\n                    })\n                    .catch(() => {\n                        if (status === 'updating') {\n                            status = 'set';\n                        }\n                    });\n            },\n            setParamDescriptions: (paramDescriptions: string[]) => {\n                if (status === 'deleted') {\n                    throw new Error('Task has been deleted');\n                }\n\n                status = 'updating';\n\n                this.theTasksService?.updateTaskParamDescriptions(\n                    taskId, paramDescriptions,\n                )\n                    .then(() => {\n                        if (status === 'updating') {\n                            status = 'set';\n                        }\n                    })\n                    .catch(() => {\n                        if (status === 'updating') {\n                            status = 'set';\n                        }\n                    });\n            },\n        };\n    };\n    public reset = async (data?: ContextItems): Promise<ContextActionResult> => {\n        if (!this.theDataSyncService) {\n            warn(\n                `${this.constructor.name}.reset() called on a state that has not been initialized! ` +\n                `Use ${this.constructor.name}.initialize() to initialize the context before attempting any reset.`,\n            );\n\n            return {\n                success: false,\n                error: 'Context has not been initialized',\n            };\n        }\n\n        try {\n            await this.theDataSyncService?.resetContextData(data);\n            await this.theTasksService?.resetContextData();\n            this.theStatus = 'syncing';\n\n            return {\n                success: true,\n            };\n        } catch (error) {\n            // TODO - Handle retry and error recovery\n            this.theStatus = 'error';\n            return {\n                success: false,\n                error: `${error}`,\n            };\n        }\n    };\n    public runTask = async (taskId: string, parameters?: Array<unknown>): Promise<RunTaskResult> => {\n        if (!this.theTasksService) {\n            warn(\n                `${this.constructor.name}.runTask() called on a state that has not been initialized! ` +\n                `Use ${this.constructor.name}.initialize() to initialize the context before attempting any task ` +\n                `execution.`,\n            );\n\n            return Promise.resolve({\n                success: false,\n                error: 'Context has not been initialized with tasks service. An adapter that implements ' +\n                    'ContextTasksAdapter interface should be provided to the context, and the context should be ' +\n                    'initialized before running any tasks.',\n            });\n        }\n\n        return this.theTasksService.runTask(taskId, parameters);\n    };\n    public withAdapter = (\n        adapter: ContextAdapterBuilder | ContextAdapter,\n    ): AiContext => {\n        if (this.theDataAdapter) {\n            throw new Error('Adapter already set');\n        }\n\n        const isBuilder = typeof (\n            adapter as unknown as Record<string, unknown>\n        )?.build === 'function';\n\n        if (isBuilder) {\n            this.theDataAdapter = (adapter as ContextAdapterBuilder).build();\n        } else {\n            this.theDataAdapter = adapter as ContextAdapter;\n        }\n\n        const adapterAsTaskAdapter = isContextTasksAdapter(this.theDataAdapter);\n        if (adapterAsTaskAdapter) {\n            this.theTasksAdapter = adapterAsTaskAdapter;\n        }\n\n        return this;\n    };\n    public withDataSyncOptions = (\n        options: DataSyncOptions,\n    ): AiContext => {\n        if (this.theDataSyncOptions) {\n            throw new Error('Data sync options already set');\n        }\n\n        this.theDataSyncOptions = {...options};\n        return this;\n    };\n    private theDataAdapter: ContextAdapter | null = null;\n    private theDataSyncOptions: DataSyncOptions | null = null;\n    private theDataSyncService: DataSyncService | null = null;\n    private theStatus: AiContextStatus = 'idle';\n    private theTasksAdapter: ContextTasksAdapter | null = null;\n    private theTasksService: TasksService | null = null;\n    private unregisterTask = (taskId: string): Promise<ContextActionResult> => {\n        if (!this.theTasksService) {\n            warn(\n                `${this.constructor.name}.unregisterTask() called on a state that has not been initialized! ` +\n                `Use ${this.constructor.name}.initialize() to initialize the context before attempting any task ` +\n                `unregister.`,\n            );\n\n            return Promise.resolve({\n                success: false,\n                error: 'Context has not been initialized',\n            });\n        }\n\n        return this.theTasksService.unregisterTask(taskId);\n    };\n\n    get contextId(): string | null {\n        return this.theDataSyncService?.contextId ?? null;\n    }\n\n    get status(): AiContextStatus {\n        return this.theStatus;\n    }\n\n    hasItem(itemId: string): boolean {\n        return this.theDataSyncService?.hasItemWithId(itemId) ?? false;\n    }\n\n    hasRunnableTask(taskId: string): boolean {\n        return this.theTasksService?.canRunTask(taskId) ?? false;\n    }\n\n    hasTask(taskId: string): boolean {\n        return this.theTasksService?.hasTask(taskId) ?? false;\n    }\n}\n\nexport const createAiContext = (): AiContext => {\n    return new AiContextImpl();\n};\n","export const predefinedContextSize = {\n    '1k': 1000,\n    '10k': 10000,\n    '100k': 100000,\n    '1mb': 1000000,\n    '10mb': 10000000,\n};\n\n/**\n * Context data synchronization options.\n */\nexport type DataSyncOptions = {\n    /**\n     * Data synchronization strategy.\n     * - `auto` - Batch updates and automatically sync the context data.\n     * - `lazy` - Only sync when the user is about to send a message.\n     *\n     * Default: `auto`\n     */\n    syncStrategy?: 'auto' | 'lazy';\n\n    /**\n     * The maximum size of the context data to be allowed and synced.\n     * When the limit is reached, the oldest data will be removed.\n     *\n     * Default: `10kb`\n     */\n    contextSize?: number;\n};\n","// CHAT _____________________\n\nimport {AiChat} from './aiChat/aiChat';\n\nexport {AiChat} from './aiChat/aiChat';\n\nexport const createAiChat = <AiMsg = string>(): AiChat<AiMsg> => new AiChat<AiMsg>();\n\nexport {Observable} from './bus/observable';\n\nexport type {\n    ConversationOptions,\n    ConversationLayout,\n} from './aiChat/options/conversationOptions';\n\nexport type {ComposerOptions} from './aiChat/options/composerOptions';\n\nexport type {\n    ResponseRenderer,\n    PromptRendererProps,\n    PromptRenderer,\n    MessageOptions,\n} from './aiChat/options/messageOptions';\n\nexport type {DisplayOptions} from './aiChat/options/displayOptions';\n\nexport type {\n    PersonaOptions,\n    AssistantPersona,\n    UserPersona,\n} from './aiChat/options/personaOptions';\n\nexport type {\n    ConversationStarter,\n} from './types/conversationStarter';\n\nexport type {\n    IObserver,\n} from './bus/observer';\n\nexport type {\n    AiChatInternalProps,\n} from './types/aiChat/props';\n\nexport type {\n    AiChatStatus,\n} from './types/aiChat/aiChat';\n\nexport type {\n    EventName,\n    EventCallback,\n    EventsConfig,\n    EventsMap,\n    ErrorCallback,\n    ErrorEventDetails,\n    ReadyCallback,\n    ReadyEventDetails,\n    PreDestroyCallback,\n    PreDestroyEventDetails,\n    MessageSentCallback,\n    MessageSentEventDetails,\n    MessageStreamStartedCallback,\n    MessageStreamStartedEventDetails,\n    MessageReceivedCallback,\n    MessageReceivedEventDetails,\n    MessageRenderedCallback,\n    MessageRenderedEventDetails,\n} from './types/event';\n\nexport type {\n    StandardChatAdapter,\n} from '@shared/types/adapters/chat/standardChatAdapter';\n\nexport type {\n    StandardAdapterInfo,\n    AdapterEncodeFunction,\n    AdapterDecodeFunction,\n    InputFormat,\n    OutputFormat,\n} from '@shared/types/adapters/chat/standardAdapterConfig';\n\nexport type {\n    AiChatProps,\n    UpdatableAiChatProps,\n    AiChatPropsInEvents,\n} from './types/aiChat/props';\n\nexport type {\n    HistoryPayloadSize,\n} from './aiChat/options/conversationOptions';\n\nexport type {\n    ChatAdapter,\n    StreamingAdapterObserver,\n    DataTransferMode,\n    StreamSend,\n    BatchSend,\n} from '@shared/types/adapters/chat/chatAdapter';\n\nexport type {\n    ChatAdapterExtras,\n} from '@shared/types/adapters/chat/chatAdapterExtras';\n\nexport type {\n    ChatAdapterBuilder,\n} from '@shared/types/adapters/chat/chatAdapterBuilder';\n\nexport type {\n    AssistResult,\n    AssistAdapter,\n} from '@shared/types/adapters/assist/assistAdapter';\n\nexport type {\n    AssistAdapterBuilder,\n} from '@shared/types/adapters/assist/assistAdapterBuilder';\n\nexport type {\n    StreamParser,\n    StandardStreamParser,\n    StandardStreamParserOutput,\n} from '@shared/types/markdown/streamParser';\n\n// CONTEXT __________________\n\nexport type {\n    ContextItemDataType,\n    ContextObject,\n    ContextItems,\n    ContextTasks,\n    ContextItem,\n    ContextTask,\n} from '@shared/types/aiContext/data';\n\nexport type {\n    ContextAdapter,\n} from '@shared/types/adapters/context/contextAdapter';\n\nexport type {\n    ContextAdapterExtras,\n} from '@shared/types/adapters/context/contextAdapterExtras';\n\nexport type {\n    ContextTasksAdapter,\n} from '@shared/types/adapters/context/contextTasksAdapter';\n\nexport type {\n    ContextDataAdapter,\n} from '@shared/types/adapters/context/contextDataAdapter';\n\nexport type {\n    ContextAdapterBuilder,\n} from '@shared/types/adapters/context/contextAdapterBuilder';\n\nexport type {\n    AiContext,\n    AiContextStatus,\n} from '@shared/types/aiContext/aiContext';\n\nexport type {\n    ContextItemHandler,\n    ContextTaskHandler,\n    ContextDomElementHandler,\n} from '@shared/types/aiContext/contextObservers';\n\nexport type {\n    InitializeContextResult,\n    DestroyContextResult,\n    FlushContextResult,\n    RunTaskResult,\n    ContextActionResult,\n    SetContextResult,\n} from '@shared/types/aiContext/contextResults';\n\nexport type {\n    DataSyncOptions,\n} from './aiContext/options/dataSyncOptions';\n\nexport {\n    createAiContext,\n} from './aiContext/aiContext';\n\nexport {\n    predefinedContextSize,\n} from './aiContext/options/dataSyncOptions';\n\n\n// HIGHLIGHTER ______________\n\nexport type {\n    Highlighter,\n    HighlighterExtension,\n    HighlighterColorMode,\n    CreateHighlighterOptions,\n} from './aiChat/highlighter/highlighter';\n\n// HTML SANITIZER ___________\n\nexport type {\n    SanitizerExtension,\n} from '@shared/sanitizer/sanitizer';\n\n// CONVERSATION _____________\n\nexport type {\n    ChatItem,\n} from '@shared/types/conversation';\n\nexport type {\n    ParticipantRole,\n} from './types/participant';\n"],"names":["__publicField","className","directionClassName","applyNewDirectionClassName","statusClassName","applyNewStatusClassName","escape","text","args","ret","tokens","src","options","newHtml","updateContentOnStatusChange","messageClassName","avatarClassName","source","__decorateClass","newConversationContainer","autoScroll","callback","comp","description"],"mappings":"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"}