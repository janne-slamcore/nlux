{"version":3,"file":"nlux-react.js","sources":["../../../../packages/shared/src/utils/dequal.ts","../../../../packages/react/core/src/hooks/useDeepCompareEffect/index.ts","../../../../packages/shared/src/components/ExceptionsBox/create.ts","../../../../packages/shared/src/components/ExceptionsBox/control.ts","../../../../packages/shared/src/utils/uid.ts","../../../../packages/shared/src/utils/warn.ts","../../../../packages/shared/src/utils/chat/chatItemsToChatSegment.ts","../../../../packages/shared/src/utils/dom/getRootClassNames.ts","../../../../packages/shared/src/components/Loader/create.ts","../../../../packages/shared/src/components/SendIcon/create.ts","../../../../packages/shared/src/components/Composer/utils/applyNewStatusClassName.ts","../../../../packages/shared/src/components/Composer/create.ts","../../../../packages/shared/src/utils/isSubmitShortcutKey.ts","../../../../packages/shared/src/components/CancelIcon/create.ts","../../../../packages/react/core/src/components/CancelIcon/CancelIconComp.tsx","../../../../packages/react/core/src/components/SendIcon/SendIconComp.tsx","../../../../packages/react/core/src/sections/Composer/ComposerComp.tsx","../../../../packages/shared/src/utils/dom/getConversationLayout.ts","../../../../packages/react/core/src/exports/hooks/useConversationDisplayStyle.ts","../../../../packages/shared/src/utils/chat/participantNameFromRoleAndPersona.ts","../../../../packages/shared/src/utils/dom/getChatSegmentClassName.ts","../../../../packages/shared/src/components/Avatar/utils/createPhotoContainerFromUrl.ts","../../../../packages/shared/src/components/Avatar/create.ts","../../../../packages/shared/src/components/Message/utils/applyNewDirectionClassName.ts","../../../../packages/shared/src/components/Message/utils/applyNewStatusClassName.ts","../../../../packages/shared/src/markdown/copyToClipboard/attachCopyClickListener.ts","../../../../packages/shared/src/utils/dom/emptyInnerHtml.ts","../../../../packages/shared/src/markdown/copyToClipboard/insertCopyToClipboardButton.ts","../../../../packages/shared/src/markdown/snapshot/marked/defaults.ts","../../../../packages/shared/src/markdown/snapshot/marked/Hooks.ts","../../../../packages/shared/src/markdown/snapshot/marked/helpers.ts","../../../../packages/shared/src/markdown/snapshot/marked/rules.ts","../../../../packages/shared/src/markdown/snapshot/marked/Tokenizer.ts","../../../../packages/shared/src/markdown/snapshot/marked/Lexer.ts","../../../../packages/shared/src/markdown/snapshot/marked/Renderer.ts","../../../../packages/shared/src/markdown/snapshot/marked/TextRenderer.ts","../../../../packages/shared/src/markdown/snapshot/marked/Parser.ts","../../../../packages/shared/src/markdown/snapshot/marked/Instance.ts","../../../../packages/shared/src/markdown/snapshot/marked/marked.ts","../../../../packages/shared/src/markdown/snapshot/snapshotParser.ts","../../../../packages/shared/src/components/Message/create.ts","../../../../packages/shared/src/components/ChatItem/utils/applyNewDirectionClassName.ts","../../../../packages/shared/src/components/ChatItem/utils/applyNewLayoutClassName.ts","../../../../packages/shared/src/components/ChatItem/create.ts","../../../../packages/shared/src/markdown/stream/streamParser.ts","../../../../packages/react/core/src/sections/StreamContainer/StreamContainerComp.tsx","../../../../packages/react/core/src/sections/MessageRenderer/MarkdownSnapshotRenderer.tsx","../../../../packages/react/core/src/sections/ChatItem/hooks/useAssistantMessageRenderer.tsx","../../../../packages/react/core/src/components/Avatar/AvatarComp.tsx","../../../../packages/react/core/src/sections/ChatItem/hooks/userParticipantInfoRenderer.tsx","../../../../packages/react/core/src/sections/ChatItem/hooks/useUserMessageRenderer.tsx","../../../../packages/react/core/src/sections/ChatItem/ChatItemComp.tsx","../../../../packages/react/core/src/sections/ChatSegment/useItemsRefs.ts","../../../../packages/react/core/src/sections/ChatSegment/utils/avatarFromMessageAndPersona.ts","../../../../packages/react/core/src/sections/ChatSegment/utils/isPrimitiveReactNodeType.ts","../../../../packages/react/core/src/sections/ChatSegment/ChatSegmentComp.tsx","../../../../packages/react/core/src/sections/Conversation/hooks/useChatSegmentsController.ts","../../../../packages/react/core/src/sections/Conversation/hooks/useLastActiveSegment.ts","../../../../packages/react/core/src/sections/Conversation/ConversationComp.tsx","../../../../packages/react/core/src/components/ConversationStarters/ConversationStarters.tsx","../../../../packages/shared/src/components/Logo/getNluxSmallPngLogo.ts","../../../../packages/shared/src/components/Greeting/utils/updateGreetingText.ts","../../../../packages/shared/src/components/Greeting/create.ts","../../../../packages/react/core/src/components/Greeting/GreetingComp.tsx","../../../../packages/react/core/src/components/DefaultGreeting/DefaultGreetingComp.tsx","../../../../packages/react/core/src/sections/LaunchPad/LaunchPad.tsx","../../../../packages/react/core/src/utils/adapterParamToUsableAdapter.ts","../../../../packages/react/core/src/utils/reactPropsToCorePropsInEvents.ts","../../../../packages/react/core/src/exports/events/usePreDestroyEventTrigger.ts","../../../../packages/react/core/src/exports/events/useReadyEventTrigger.ts","../../../../packages/react/core/src/exports/hooks/useAiChatStyle.ts","../../../../packages/shared/src/types/error.ts","../../../../packages/shared/src/utils/throttle.ts","../../../../packages/shared/src/interactions/autoScroll/utils/conversationScrollHandler.ts","../../../../packages/shared/src/interactions/autoScroll/autoScrollController.ts","../../../../packages/react/core/src/exports/hooks/useAutoScrollController.ts","../../../../packages/react/core/src/exports/hooks/useCancelLastMessage.tsx","../../../../packages/react/core/src/exports/hooks/useLastActiveSegmentChangeHandler.ts","../../../../packages/react/core/src/exports/hooks/usePrimitivesContext.tsx","../../../../packages/react/core/src/exports/hooks/useResubmitPromptHandler.ts","../../../../packages/shared/src/types/adapters/chat/standardChatAdapter.ts","../../../../packages/shared/src/services/submitPrompt/utils/triggerAsyncCallback.ts","../../../../packages/shared/src/services/submitPrompt/batchText.ts","../../../../packages/shared/src/services/submitPrompt/streamServerComponent.ts","../../../../packages/shared/src/services/submitPrompt/streamText.ts","../../../../packages/shared/src/services/submitPrompt/utils/contentTypeToGenerate.ts","../../../../packages/shared/src/services/submitPrompt/utils/dataTransferModeToUse.ts","../../../../packages/shared/src/services/submitPrompt/utils/emptyCompleteSegment.ts","../../../../packages/shared/src/services/submitPrompt/utils/emptyErrorSegment.ts","../../../../packages/shared/src/services/submitPrompt/utils/userMessageFromPrompt.ts","../../../../packages/shared/src/services/submitPrompt/submitPromptImpl.ts","../../../../packages/shared/src/types/exceptions/errors.ts","../../../../packages/shared/src/utils/chat/chatSegmentsToChatItems.ts","../../../../packages/react/core/src/exports/hooks/useAdapterExtras.ts","../../../../packages/react/core/src/exports/hooks/useSubmitPromptHandler.ts","../../../../packages/react/core/src/components/Loader/LoaderComp.tsx","../../../../packages/react/core/src/exports/elements/Greeting.tsx","../../../../packages/react/core/src/exports/elements/Loader.tsx","../../../../packages/react/core/src/exports/AiChatUI.tsx","../../../../packages/react/core/src/exports/hooks/useUiOverrides.tsx","../../../../packages/react/core/src/exports/hooks/usMarkdownContainers.ts","../../../../packages/react/core/src/exports/AiChat.tsx","../../../../packages/react/core/src/exports/hooks/useAiChatApi.ts","../../../../packages/react/core/src/exports/primitives/Markdown.tsx","../../../../packages/react/core/src/exports/hooks/useAsBatchAdapter.ts","../../../../packages/react/core/src/exports/hooks/useAsStreamAdapter.ts","../../../../packages/react/core/src/exports/hooks/useAsRscAdapter.tsx","../../../../packages/react/core/src/providers/useAiContext.ts","../../../../packages/react/core/src/providers/useAiTask.ts","../../../../packages/react/core/src/providers/createAiContext.tsx","../../../../packages/react/core/src/index.tsx"],"sourcesContent":["//\n// The following code was extracted from the `dequal` package\n// * GitHub: https://github.com/lukeed/dequal\n// * npm: https://www.npmjs.com/package/dequal\n// * License: MIT\n//\n\nvar has = Object.prototype.hasOwnProperty;\n\nfunction find(iter: Array<any>, tar: any) {\n    for (let key of iter.keys()) {\n        if (dequal(key, tar)) {\n            return key;\n        }\n    }\n}\n\nexport function dequal(foo: any, bar: any) {\n    var ctor, len, tmp;\n    if (foo === bar) {\n        return true;\n    }\n\n    if (foo && bar && (ctor = foo.constructor) === bar.constructor) {\n        if (ctor === Date) {\n            return foo.getTime() === bar.getTime();\n        }\n        if (ctor === RegExp) {\n            return foo.toString() === bar.toString();\n        }\n\n        if (ctor === Array) {\n            if ((len = foo.length) === bar.length) {\n                while (len-- && dequal(foo[len], bar[len])) {\n\n                }\n            }\n            return len === -1;\n        }\n\n        if (ctor === Set) {\n            if (foo.size !== bar.size) {\n                return false;\n            }\n            for (len of foo) {\n                tmp = len;\n                if (tmp && typeof tmp === 'object') {\n                    tmp = find(bar, tmp);\n                    if (!tmp) {\n                        return false;\n                    }\n                }\n                if (!bar.has(tmp)) {\n                    return false;\n                }\n            }\n            return true;\n        }\n\n        if (ctor === Map) {\n            if (foo.size !== bar.size) {\n                return false;\n            }\n            for (len of foo) {\n                tmp = len[0];\n                if (tmp && typeof tmp === 'object') {\n                    tmp = find(bar, tmp);\n                    if (!tmp) {\n                        return false;\n                    }\n                }\n                if (!dequal(len[1], bar.get(tmp))) {\n                    return false;\n                }\n            }\n            return true;\n        }\n\n        if (ctor === ArrayBuffer) {\n            foo = new Uint8Array(foo);\n            bar = new Uint8Array(bar);\n        } else {\n            if (ctor === DataView) {\n                if ((len = foo.byteLength) === bar.byteLength) {\n                    while (len-- && foo.getInt8(len) === bar.getInt8(len)) {\n\n                    }\n                }\n                return len === -1;\n            }\n        }\n\n        if (ArrayBuffer.isView(foo)) {\n            if ((len = foo.byteLength) === bar.byteLength) {\n                while (len-- && (foo as any)[len] === bar[len]) {\n\n                }\n            }\n            return len === -1;\n        }\n\n        if (!ctor || typeof foo === 'object') {\n            len = 0;\n            for (ctor in foo) {\n                if (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) {\n                    return false;\n                }\n                if (!(ctor in bar) || !dequal(foo[ctor], bar[ctor])) {\n                    return false;\n                }\n            }\n            return Object.keys(bar).length === len;\n        }\n    }\n\n    return foo !== foo && bar !== bar;\n}\n","//\n// The following code was extracted from the `use-deep-compare-effect` package\n// * GitHub: https://github.com/kentcdodds/use-deep-compare-effect\n// * npm: https://www.npmjs.com/package/use-deep-compare-effect\n// * License: MIT\n//\n\nimport {dequal as deepEqual} from '@shared/utils/dequal';\nimport {useEffect, useMemo, useRef} from 'react';\n\ntype UseEffectParams = Parameters<typeof useEffect>\ntype EffectCallback = UseEffectParams[0]\ntype DependencyList = UseEffectParams[1]\n// yes, I know it's void, but I like what this communicates about\n// the intent of these functions: It's just like useEffect\ntype UseEffectReturn = ReturnType<typeof useEffect>\n\nfunction checkDeps(deps: DependencyList) {\n    if (!deps || !deps.length) {\n        throw new Error(\n            'useDeepCompareEffect should not be used with no dependencies. Use React.useEffect instead.',\n        );\n    }\n    if (deps.every(isPrimitive)) {\n        throw new Error(\n            'useDeepCompareEffect should not be used with dependencies that are all primitive values. Use React.useEffect instead.',\n        );\n    }\n}\n\nfunction isPrimitive(val: unknown) {\n    return val == null || /^[sbn]/.test(typeof val);\n}\n\n/**\n * @param value the value to be memoized (usually a dependency list)\n * @returns a memoized version of the value as long as it remains deeply equal\n */\nexport function useDeepCompareMemoize<T>(value: T) {\n    const ref = useRef<T>(value);\n    const signalRef = useRef<number>(0);\n\n    if (!deepEqual(value, ref.current)) {\n        ref.current = value;\n        signalRef.current += 1;\n    }\n\n    return useMemo(() => ref.current, [signalRef.current]);\n}\n\nfunction useDeepCompareEffect(\n    callback: EffectCallback,\n    dependencies: DependencyList,\n): UseEffectReturn {\n    if (process.env.NODE_ENV !== 'production') {\n        checkDeps(dependencies);\n    }\n\n    return useEffect(callback, useDeepCompareMemoize(dependencies));\n}\n\nexport function useDeepCompareEffectNoCheck(\n    callback: EffectCallback,\n    dependencies: DependencyList,\n): UseEffectReturn {\n    return useEffect(callback, useDeepCompareMemoize(dependencies));\n}\n\nexport default useDeepCompareEffect;\n","import {DomCreator} from '../../types/dom/DomCreator';\n\nexport const className = 'nlux-comp-exceptionBox';\n\nexport const createExceptionsBoxDom: DomCreator<void> = () => {\n    const exceptionsBox = document.createElement('div');\n    exceptionsBox.classList.add(className);\n\n    return exceptionsBox;\n};\n\nexport const createExceptionItemDom: DomCreator<{\n    message: string;\n}> = ({message}) => {\n    const exception = document.createElement('div');\n    exception.classList.add('nlux-comp-exceptionItem');\n\n    const messageElement = document.createElement('span');\n    messageElement.classList.add('nlux-comp-exp_itm_msg');\n    messageElement.append(document.createTextNode(message));\n    exception.append(messageElement);\n\n    return exception;\n};\n","import {createExceptionItemDom} from './create';\n\nconst exceptionDisplayTime = 3000;\nconst exceptionHideAnimationTime = 500;\n\nexport type ExceptionsBoxController = {\n    displayException: (message: string, ref?: string) => void;\n    destroy: () => void;\n};\n\nexport const createExceptionsBoxController = (root: HTMLElement): ExceptionsBoxController => {\n    const exceptionsQueue = new Set<{message: string}>();\n\n    let exceptionShown: boolean = false;\n    let exceptionItem: HTMLElement | null = null;\n    let timeout: ReturnType<typeof setTimeout> | null = null;\n\n    const processExceptionsQueue = () => {\n        if (exceptionShown) {\n            // If exception is shown, we need to wait for it to hide\n            // This method will be called again when it hides\n            return;\n        }\n\n        if (exceptionsQueue.size === 0) {\n            return;\n        }\n\n        exceptionShown = true;\n        const victim = exceptionsQueue.values().next().value;\n        exceptionsQueue.delete(victim);\n\n        exceptionItem = createExceptionItemDom(victim);\n        root.append(exceptionItem);\n        timeout = setTimeout(hideException, exceptionDisplayTime);\n    };\n\n    const hideException = () => {\n        exceptionItem?.classList.add('nlux-comp-exceptionItem--hiding');\n\n        // Wait for animation to finish\n        timeout = setTimeout(() => {\n            exceptionShown = false;\n            exceptionItem?.remove();\n            exceptionItem = null;\n\n            // Process next exception\n            processExceptionsQueue();\n        }, exceptionHideAnimationTime);\n    };\n\n    return {\n        displayException: (message: string) => {\n            exceptionsQueue.add({message});\n            if (!exceptionShown) {\n                processExceptionsQueue();\n            }\n        },\n        destroy: () => {\n            exceptionsQueue.clear();\n            exceptionItem?.remove();\n            if (timeout) {\n                clearTimeout(timeout);\n            }\n        },\n    };\n};\n","export const uid = () => {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (character) => {\n        const randomValue = Math.random() * 16 | 0;\n        const value = character == 'x' ? randomValue : (randomValue & 0x3 | 0x8);\n        return value.toString(16);\n    });\n};\n","export const warn = (message: unknown) => {\n    if (typeof message === 'string') {\n        console.warn(`[nlux] ${message}`);\n        return;\n    }\n\n    if (message && typeof message.toString === 'function') {\n        console.warn(`[nlux] ${message.toString()}`);\n        return;\n    }\n\n    console.warn('[nlux]');\n    console.log(JSON.stringify(message, null, 2));\n};\n\nconst warnedMessages: string[] = [];\nexport const warnOnce = (message: string) => {\n    if (warnedMessages.includes(message)) {\n        return;\n    }\n\n    warnedMessages.push(message);\n    warn(message);\n};\n","import {ChatSegment, ChatSegmentItem} from '../../types/chatSegment/chatSegment';\nimport {ChatSegmentAiMessage} from '../../types/chatSegment/chatSegmentAiMessage';\nimport {ChatSegmentUserMessage} from '../../types/chatSegment/chatSegmentUserMessage';\nimport {ChatItem} from '../../types/conversation';\nimport {uid} from '../uid';\nimport {warn} from '../warn';\n\nexport const chatItemsToChatSegment = <AiMsg>(\n    chatItems: ChatItem<AiMsg>[],\n): ChatSegment<AiMsg> => {\n    const segmentItems: ChatSegmentItem<AiMsg>[] = chatItems.map((message, index) => {\n        if (message.role !== 'assistant' && message.role !== 'user') {\n            warn(\n                `Invalid role for item at index ${index} in initial conversation: ` +\n                `Role must be \"assistant\" or \"user\"`,\n            );\n\n            return;\n        }\n\n        if (message.role === 'user') {\n            if (typeof message.message !== 'string') {\n                warn(\n                    `Invalid message type for item at index ${index} in initial conversation: ` +\n                    `When role is \"user\", message must be a string`,\n                );\n\n                return;\n            }\n\n            return {\n                uid: uid(),\n                time: new Date(),\n                status: 'complete',\n                participantRole: 'user',\n                content: message.message,\n                contentType: 'text',\n            } satisfies ChatSegmentUserMessage;\n        }\n\n        return {\n            uid: uid(),\n            time: new Date(),\n            status: 'complete',\n            participantRole: 'assistant',\n            content: message.message,\n            contentType: 'text',\n            serverResponse: message.serverResponse,\n            dataTransferMode: 'batch',\n        } satisfies ChatSegmentAiMessage<AiMsg>;\n    }).filter(\n        (segmentItem: ChatSegmentItem<AiMsg> | undefined): segmentItem is ChatSegmentItem<AiMsg> => {\n            return segmentItem !== undefined;\n        },\n    ) as ChatSegmentItem<AiMsg>[];\n\n    return {\n        uid: 'initial',\n        status: 'complete',\n        items: segmentItems,\n    } satisfies ChatSegment<AiMsg>;\n};\n","const rootClassName = 'nlux-AiChat-root';\nconst defaultThemeId = 'nova';\n\nexport const getSystemColorScheme = () => {\n    if (typeof globalThis !== undefined && globalThis.matchMedia && globalThis.matchMedia(\n        '(prefers-color-scheme: dark)')?.matches) {\n        return 'dark';\n    }\n\n    return 'light';\n};\n\nexport const getRootClassNames = (props: {\n    themeId?: string;\n    className?: string;\n}): string[] => {\n    const result = [rootClassName];\n    const themeId = props.themeId || defaultThemeId;\n    const themeClassName = `nlux-theme-${themeId}`;\n\n    result.push(themeClassName);\n\n    if (props.className) {\n        result.push(props.className);\n    }\n\n    return result;\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\n\nexport const className = 'nlux-comp-messageLoader';\n\nexport const createLoaderDom: DomCreator<void> = () => {\n    const loader = document.createElement('div');\n    loader.classList.add(className);\n\n    const spinnerLoader = document.createElement('span');\n    spinnerLoader.classList.add('spinning-loader');\n\n    const spinnerLoaderContainer = document.createElement('div');\n    spinnerLoaderContainer.classList.add('nlux-comp-loaderContainer');\n    spinnerLoaderContainer.appendChild(spinnerLoader);\n\n    loader.appendChild(spinnerLoaderContainer);\n    return loader;\n};\n","export const className = 'nlux-comp-sendIcon';\n\nexport const createSendIconDom = () => {\n    const sendIcon = document.createElement('div');\n    sendIcon.classList.add(className);\n\n    const sndIcnCtn = document.createElement('div');\n    sndIcnCtn.classList.add('nlux-comp-sendIcon-container');\n    sendIcon.appendChild(sndIcnCtn);\n\n    return sendIcon;\n};\n","import {ComposerStatus} from '../props';\n\nexport const statusClassName: {[key: string]: string} = {\n    typing: 'nlux-composer--typing',\n    'submitting-prompt': 'nlux-composer--submitting',\n    'submitting-conversation-starter': 'nlux-composer--submitting',\n    waiting: 'nlux-composer--waiting',\n};\n\nexport const applyNewStatusClassName = (element: HTMLElement, status: ComposerStatus) => {\n    const statuses = Object.keys(statusClassName);\n    statuses.forEach((statusName) => {\n        element.classList.remove(statusClassName[statusName]);\n    });\n\n    element.classList.add(statusClassName[status]);\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {createLoaderDom} from '../Loader/create';\nimport {createSendIconDom} from '../SendIcon/create';\nimport {ComposerProps} from './props';\nimport {applyNewStatusClassName} from './utils/applyNewStatusClassName';\n\nexport const className = 'nlux-comp-composer';\n\nexport const createComposerDom: DomCreator<ComposerProps> = (props) => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    const textarea = document.createElement('textarea');\n\n    textarea.placeholder = props.placeholder ?? '';\n    textarea.value = props.message ?? '';\n    if (props.autoFocus) {\n        textarea.autofocus = true;\n    }\n\n    const submitButton = document.createElement('button');\n    submitButton.append(createSendIconDom());\n    submitButton.append(createLoaderDom());\n\n    element.append(textarea);\n    element.append(submitButton);\n    applyNewStatusClassName(element, props.status);\n\n    if (props.status === 'submitting-conversation-starter' || props.status === 'submitting-prompt') {\n        textarea.disabled = true;\n        submitButton.disabled = true;\n    }\n\n    if (props.status === 'waiting') {\n        submitButton.disabled = true;\n    }\n\n    if (props.status === 'typing') {\n        submitButton.disabled = props.disableSubmitButton ?? textarea.value === '';\n    }\n\n    return element;\n};\n","import {KeyboardEvent} from 'react';\n\nexport const isSubmitShortcutKey = (\n    event: KeyboardEvent,\n    submitShortcut?: 'Enter' | 'CommandEnter',\n): boolean => {\n    if (!submitShortcut || submitShortcut === 'Enter') {\n        const isEnter = event.key === 'Enter' && !event.nativeEvent.isComposing;\n        const aModifierKeyIsPressed = event.altKey || event.ctrlKey || event.metaKey || event.shiftKey;\n        return isEnter && !aModifierKeyIsPressed;\n    }\n\n    if (submitShortcut === 'CommandEnter') {\n        const isCommandEnter = event.key === 'Enter' && (\n            event.getModifierState('Control') || event.getModifierState('Meta')\n        );\n\n        if (isCommandEnter) {\n            return true;\n        }\n    }\n\n    return false;\n};\n","export const className = 'nlux-comp-cancelIcon';\n\nexport const createCancelIconDom = () => {\n    const cancelIcon = document.createElement('div');\n    cancelIcon.classList.add(className);\n\n    const cnlIcnCtn = document.createElement('div');\n    cnlIcnCtn.classList.add('nlux-comp-cancelIcon-container');\n    cancelIcon.appendChild(cnlIcnCtn);\n\n    return cancelIcon;\n};\n","import {className as compCancelIconClassName} from '@shared/components/CancelIcon/create';\n\nexport const CancelIconComp = () => {\n    return (\n        <div className={compCancelIconClassName}>\n            <div className=\"nlux-comp-cancelIcon-container\"/>\n        </div>\n    );\n};\n","import {className as compSendIconClassName} from '@shared/components/SendIcon/create';\n\nexport const SendIconComp = () => {\n    return (\n        <div className={compSendIconClassName}>\n            <div className=\"nlux-comp-sendIcon-container\"/>\n        </div>\n    );\n};\n","import {className as compComposerClassName} from '@shared/components/Composer/create';\nimport {ComposerStatus} from '@shared/components/Composer/props';\nimport {\n    statusClassName as compComposerStatusClassName,\n} from '@shared/components/Composer/utils/applyNewStatusClassName';\nimport {isSubmitShortcutKey} from '@shared/utils/isSubmitShortcutKey';\nimport {ChangeEvent, KeyboardEvent, useEffect, useMemo, useRef} from 'react';\nimport {CancelIconComp} from '../../components/CancelIcon/CancelIconComp';\nimport {SendIconComp} from '../../components/SendIcon/SendIconComp';\nimport {ComposerProps} from './props';\n\nconst submittingPromptStatuses: Array<ComposerStatus> = [\n    'submitting-prompt',\n    'submitting-edit',\n    'submitting-conversation-starter',\n    'submitting-external-message',\n];\n\nexport const ComposerComp = (props: ComposerProps) => {\n    const compClassNameFromStats = compComposerStatusClassName[props.status] || '';\n    const className = `${compComposerClassName} ${compClassNameFromStats}`;\n\n    const disableTextarea = submittingPromptStatuses.includes(props.status);\n    const disableButton = !props.hasValidInput || props.status === 'waiting' || submittingPromptStatuses.includes(\n        props.status);\n    const showSendIcon = props.status === 'typing' || props.status === 'waiting';\n    const hideCancelButton = props.hideStopButton === true;\n    const showCancelButton = !hideCancelButton && (submittingPromptStatuses.includes(props.status) || props.status\n        === 'waiting');\n\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n    useEffect(() => {\n        if (props.status === 'typing' && props.autoFocus && textareaRef.current) {\n            textareaRef.current.focus();\n        }\n    }, [props.status, props.autoFocus, textareaRef.current]);\n\n    const handleChange = useMemo(() => (e: ChangeEvent<HTMLTextAreaElement>) => {\n        props.onChange?.(e.target.value);\n    }, [props.onChange]);\n\n    const handleSubmit = useMemo(() => () => {\n        props.onSubmit?.();\n    }, [props.onSubmit]);\n\n    const handleKeyDown = useMemo(() => (e: KeyboardEvent<HTMLTextAreaElement>) => {\n        if (isSubmitShortcutKey(e, props.submitShortcut)) {\n            e.preventDefault();\n            handleSubmit();\n        }\n    }, [handleSubmit, props.submitShortcut]);\n\n    useEffect(() => {\n        if (!textareaRef.current) {\n            return;\n        }\n        const adjustHeight = () => {\n            const textarea = textareaRef.current;\n            if (textarea) {\n                textarea.style.height = 'auto'; // Reset height\n                textarea.style.height = `${textarea.scrollHeight}px`; // Set new height based on content\n            }\n        };\n        textareaRef.current.addEventListener('input', adjustHeight);\n        return () => {\n            textareaRef.current?.removeEventListener('input', adjustHeight);\n        };\n\n    }, [textareaRef.current]);\n\n    return (\n        <div className={className}>\n            <textarea\n                tabIndex={0}\n                ref={textareaRef}\n                disabled={disableTextarea}\n                placeholder={props.placeholder}\n                value={props.prompt}\n                onChange={handleChange}\n                onKeyDown={handleKeyDown}\n                aria-label={props.placeholder}\n            />\n            {!showCancelButton && (\n                <button\n                    tabIndex={0}\n                    disabled={disableButton}\n                    onClick={() => props.onSubmit()}\n                    aria-label=\"Send\"\n                >\n                    {showSendIcon && <SendIconComp/>}\n                    {!showSendIcon && props.Loader}\n                </button>\n            )}\n            {showCancelButton && (\n                <button\n                    tabIndex={0}\n                    onClick={props.onCancel}\n                    aria-label=\"Cancel\"\n                >\n                    <CancelIconComp/>\n                </button>\n            )}\n        </div>\n    );\n};\n","import {ConversationLayout} from '../../../../js/core/src';\n\nexport const conversationDefaultLayout: ConversationLayout = 'bubbles';\n\nexport const getConversationLayout = (layout?: ConversationLayout): ConversationLayout => {\n    return layout ?? conversationDefaultLayout;\n};\n","import {ConversationLayout} from '@nlux/core';\nimport {useMemo} from 'react';\nimport {getConversationLayout} from '@shared/utils/dom/getConversationLayout';\nimport {ConversationOptions} from '../../types/conversationOptions';\n\nexport const useConversationDisplayStyle = (conversationOptions?: ConversationOptions): ConversationLayout => {\n    return useMemo(\n        () => getConversationLayout(conversationOptions?.layout),\n        [conversationOptions?.layout],\n    );\n};\n","import {ParticipantRole} from '../../../../js/core/src/index';\n\nconst defaultAiName = 'Assistant';\nconst defaultHumanName = 'User';\n\nexport const participantNameFromRoleAndPersona = (\n    role: ParticipantRole,\n    personaOptions: {\n        // Only using names as PersonaOptions differs between React and Vanilla JS\n        assistant?: {name?: string};\n        user?: {name?: string}\n    } | undefined,\n): string => {\n    if (role === 'assistant') {\n        return personaOptions?.assistant?.name ?? defaultAiName;\n    }\n\n    if (role === 'user') {\n        return personaOptions?.user?.name ?? defaultHumanName;\n    }\n\n    return '';\n};\n","import {ChatSegmentStatus} from '../../types/chatSegment/chatSegment';\n\nexport const getChatSegmentClassName = (status: ChatSegmentStatus): string => {\n    const baseClassName = 'nlux-chatSegment';\n    if (status === 'complete') {\n        return `${baseClassName} nlux-chatSegment--complete`;\n    }\n\n    if (status === 'error') {\n        return `${baseClassName} nlux-chatSegment--error`;\n    }\n\n    // Active status\n    return `${baseClassName} nlux-chatSegment--active`;\n};\n","export const renderedPhotoContainerClassName = 'nlux-comp-avatarContainer';\nexport const renderedPhotoClassName = 'nlux-comp-avatarPicture';\n\nexport const createPhotoContainerFromUrl = (url: string | undefined, name: string | undefined): HTMLElement => {\n    const photoContainer = document.createElement('div');\n    photoContainer.classList.add(renderedPhotoContainerClassName);\n\n    // We load the photo in the foreground\n    if (url) {\n        const photoDomElement = document.createElement('div');\n        photoDomElement.classList.add(renderedPhotoClassName);\n        photoDomElement.style.backgroundImage = `url(\"${encodeURI(url)}\")`;\n        photoContainer.append(photoDomElement);\n    }\n\n    return photoContainer;\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {AvatarProps} from './props';\nimport {createPhotoContainerFromUrl} from './utils/createPhotoContainerFromUrl';\n\nexport const className = 'nlux-comp-avatar';\n\nexport const createAvatarDom: DomCreator<AvatarProps> = (\n    props,\n): HTMLElement => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    if (!props.avatar && !props.name) {\n        return element;\n    }\n\n    if (props.name) {\n        element.title = props.name;\n    }\n\n    // When the avatar is an HTMLElement, we clone it and append it to the persona dom\n    // without any further processing!\n    if (props.avatar && props.avatar instanceof HTMLElement) {\n        element.append(props.avatar.cloneNode(true));\n        return element;\n    }\n\n    // Alternatively, treat the avatar as a string representing a URL of the photo to\n    // be loaded and render the photo accordingly.\n    element.append(createPhotoContainerFromUrl(props.avatar as string, props.name));\n    return element;\n};\n","import {MessageDirection} from '../props';\n\nexport const directionClassName: {[key: string]: string} = {\n    received: 'nlux_msg_received',\n    sent: 'nlux_msg_sent',\n};\n\nexport const applyNewDirectionClassName = (element: HTMLElement, direction: MessageDirection) => {\n    const directions = Object.keys(directionClassName);\n    directions.forEach((directionName) => {\n        element.classList.remove(directionClassName[directionName]);\n    });\n\n    if (directionClassName[direction]) {\n        element.classList.add(directionClassName[direction]);\n    }\n};\n","import {MessageStatus} from '../props';\n\nexport const statusClassName: {[key: string]: string} = {\n    streaming: 'nlux_msg_streaming',\n    complete: 'nlux_msg_complete',\n};\n\nexport const applyNewStatusClassName = (element: HTMLElement, status: MessageStatus) => {\n    const statuses = Object.keys(statusClassName);\n    statuses.forEach((statusName) => {\n        element.classList.remove(statusClassName[statusName]);\n    });\n\n    if (statusClassName[status]) {\n        element.classList.add(statusClassName[status]);\n    }\n};\n","const addListenersToCopyButton = (copyButton: Element) => {\n    if (!(copyButton instanceof HTMLButtonElement)) {\n        return;\n    }\n\n    // If button has click event listener, do not add another one\n    if (copyButton.dataset.clickListenerSet === 'true') {\n        return;\n    }\n\n    let clicked = false;\n    const codeBlock = copyButton.nextElementSibling as HTMLElement;\n    copyButton.addEventListener('click', () => {\n        if (clicked || !codeBlock) {\n            return;\n        }\n\n        // Copy code to clipboard\n        const code = codeBlock.innerText;\n        navigator.clipboard.writeText(code ?? '');\n\n        // Mark button as clicked for 1 second\n        clicked = true;\n        copyButton.classList.add('clicked');\n        setTimeout(() => {\n            clicked = false;\n            copyButton.classList.remove('clicked');\n        }, 1000);\n    });\n\n    // Set data attribute to indicate that click event listener has been set\n    copyButton.dataset.clickListenerSet = 'true';\n};\n\nexport const attachCopyClickListener = (markdownContainer: HTMLElement) => {\n    const copyButtonCssClass = 'nlux-comp-copyButton';\n    if (\n        markdownContainer instanceof HTMLButtonElement &&\n        markdownContainer.classList.contains(copyButtonCssClass)\n    ) {\n        addListenersToCopyButton(markdownContainer);\n        return;\n    }\n\n    markdownContainer.querySelectorAll(`.${copyButtonCssClass}`).forEach(addListenersToCopyButton);\n};\n","export const emptyInnerHtml = (element: HTMLElement): void => {\n    element.replaceChildren();\n};\n","export const insertCopyToClipboardButton = (markdownContainer: HTMLElement) => {\n    markdownContainer.querySelectorAll('.code-block').forEach((codeBlockContainer) => {\n        const codeBlock = codeBlockContainer.querySelector('pre');\n        if (!codeBlock) {\n            return;\n        }\n\n        // Check the adjacent element to see if a copy button is already present\n        if (codeBlockContainer.previousElementSibling?.classList.contains('nlux-comp-copyButton')) {\n            return;\n        }\n\n        const title = 'Copy code block to clipboard';\n        const copyButton = document.createElement('button');\n\n        copyButton.classList.add('nlux-comp-copyButton');\n        copyButton.setAttribute('aria-label', title);\n        copyButton.setAttribute('title', title);\n\n        const copyIcon = document.createElement('span');\n        copyIcon.classList.add('icon-copy');\n        copyButton.appendChild(copyIcon);\n\n        codeBlockContainer.appendChild(copyButton);\n    });\n};\n","import type {MarkedOptions} from './MarkedOptions';\n\n/**\n * Gets the original marked default options.\n */\nexport function _getDefaults(): MarkedOptions {\n    return {\n        async: false,\n        breaks: false,\n        extensions: null,\n        gfm: true,\n        hooks: null,\n        pedantic: false,\n        renderer: null,\n        silent: false,\n        tokenizer: null,\n        walkTokens: null,\n    };\n}\n\nexport let _defaults = _getDefaults();\n\nexport function changeDefaults(newDefaults: MarkedOptions) {\n    _defaults = newDefaults;\n}\n","import {_defaults} from './defaults';\nimport type {MarkedOptions} from './MarkedOptions';\nimport type {Token, TokensList} from './Tokens';\n\nexport class _Hooks {\n    static passThroughHooks = new Set([\n        'preprocess',\n        'postprocess',\n        'processAllTokens',\n    ]);\n    options: MarkedOptions;\n\n    constructor(options?: MarkedOptions) {\n        this.options = options || _defaults;\n    }\n\n    /**\n     * Process HTML after marked is finished\n     */\n    postprocess(html: string) {\n        return html;\n    }\n\n    /**\n     * Process markdown before marked\n     */\n    preprocess(markdown: string) {\n        return markdown;\n    }\n\n    /**\n     * Process all tokens before walk tokens\n     */\n    processAllTokens(tokens: Token[] | TokensList) {\n        return tokens;\n    }\n}\n","/**\n * Helpers\n */\nconst escapeTest = /[&<>\"']/;\nconst escapeReplace = new RegExp(escapeTest.source, 'g');\nconst escapeTestNoEncode = /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/;\nconst escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');\nconst escapeReplacements: {[index: string]: string} = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    '\\'': '&#39;',\n};\nconst getEscapeReplacement = (ch: string) => escapeReplacements[ch];\n\nexport function escape(html: string, encode?: boolean) {\n    if (encode) {\n        if (escapeTest.test(html)) {\n            return html.replace(escapeReplace, getEscapeReplacement);\n        }\n    } else {\n        if (escapeTestNoEncode.test(html)) {\n            return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n        }\n    }\n\n    return html;\n}\n\nconst unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\n\nexport function unescape(html: string) {\n    // explicitly match decimal, hex, and named HTML entities\n    return html.replace(unescapeTest, (_, n) => {\n        n = n.toLowerCase();\n        if (n === 'colon') {\n            return ':';\n        }\n        if (n.charAt(0) === '#') {\n            return n.charAt(1) === 'x'\n                ? String.fromCharCode(parseInt(n.substring(2), 16))\n                : String.fromCharCode(+n.substring(1));\n        }\n        return '';\n    });\n}\n\nconst caret = /(^|[^\\[])\\^/g;\n\nexport function edit(regex: string | RegExp, opt?: string) {\n    let source = typeof regex === 'string' ? regex : regex.source;\n    opt = opt || '';\n    const obj = {\n        replace: (name: string | RegExp, val: string | RegExp) => {\n            let valSource = typeof val === 'string' ? val : val.source;\n            valSource = valSource.replace(caret, '$1');\n            source = source.replace(name, valSource);\n            return obj;\n        },\n        getRegex: () => {\n            return new RegExp(source, opt);\n        },\n    };\n    return obj;\n}\n\nexport function cleanUrl(href: string) {\n    try {\n        href = encodeURI(href).replace(/%25/g, '%');\n    } catch (e) {\n        return null;\n    }\n    return href;\n}\n\nexport const noopTest = {exec: () => null} as unknown as RegExp;\n\nexport function splitCells(tableRow: string, count?: number) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    const row = tableRow.replace(/\\|/g, (match, offset, str) => {\n            let escaped = false;\n            let curr = offset;\n            while (--curr >= 0 && str[curr] === '\\\\') {\n                escaped = !escaped;\n            }\n            if (escaped) {\n                // odd number of slashes means | is escaped\n                // so we leave it alone\n                return '|';\n            } else {\n                // add space before unescaped |\n                return ' |';\n            }\n        }),\n        cells = row.split(/ \\|/);\n    let i = 0;\n\n    // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n    if (!cells[0].trim()) {\n        cells.shift();\n    }\n    if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n        cells.pop();\n    }\n\n    if (count) {\n        if (cells.length > count) {\n            cells.splice(count);\n        } else {\n            while (cells.length < count) {\n                cells.push('');\n            }\n        }\n    }\n\n    for (; i < cells.length; i++) {\n        // leading or trailing whitespace is ignored per the gfm spec\n        cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n    return cells;\n}\n\n/**\n * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n * /c*$/ is vulnerable to REDOS.\n *\n * @param str\n * @param c\n * @param invert Remove suffix of non-c chars instead. Default falsey.\n */\nexport function rtrim(str: string, c: string, invert?: boolean) {\n    const l = str.length;\n    if (l === 0) {\n        return '';\n    }\n\n    // Length of suffix matching the invert condition.\n    let suffLen = 0;\n\n    // Step left until we fail to match the invert condition.\n    while (suffLen < l) {\n        const currChar = str.charAt(l - suffLen - 1);\n        if (currChar === c && !invert) {\n            suffLen++;\n        } else {\n            if (currChar !== c && invert) {\n                suffLen++;\n            } else {\n                break;\n            }\n        }\n    }\n\n    return str.slice(0, l - suffLen);\n}\n\nexport function findClosingBracket(str: string, b: string) {\n    if (str.indexOf(b[1]) === -1) {\n        return -1;\n    }\n\n    let level = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str[i] === '\\\\') {\n            i++;\n        } else {\n            if (str[i] === b[0]) {\n                level++;\n            } else {\n                if (str[i] === b[1]) {\n                    level--;\n                    if (level < 0) {\n                        return i;\n                    }\n                }\n            }\n        }\n    }\n    return -1;\n}\n","import {edit, noopTest} from './helpers';\n\n/**\n * Block-Level Grammar\n */\n\nconst newline = /^(?: *(?:\\n|$))+/;\nconst blockCode = /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/;\nconst fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\nconst hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\nconst heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\nconst bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nconst lheading = edit(\n    /^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/)\n    .replace(/bull/g, bullet) // lists can interrupt\n    .replace(/blockCode/g, / {4}/) // indented code blocks can interrupt\n    .replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/) // fenced code blocks can interrupt\n    .replace(/blockquote/g, / {0,3}>/) // blockquote can interrupt\n    .replace(/heading/g, / {0,3}#{1,6}/) // ATX heading can interrupt\n    .replace(/html/g, / {0,3}<[^\\n>]+>\\n/) // block html can interrupt\n    .getRegex();\nconst _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\nconst blockText = /^[^\\n]+/;\nconst _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\nconst def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n *)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/)\n    .replace('label', _blockLabel)\n    .replace('title', /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/)\n    .getRegex();\n\nconst list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/)\n    .replace(/bull/g, bullet)\n    .getRegex();\n\nconst _tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n    + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n    + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n    + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n    + '|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title'\n    + '|tr|track|ul';\nconst _comment = /<!--(?:-?>|[\\s\\S]*?(?:-->|$))/;\nconst html = edit(\n    '^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7)\n    // closing\n    // tag\n    + ')', 'i')\n    .replace('comment', _comment)\n    .replace('tag', _tag)\n    .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n    .getRegex();\n\nconst paragraph = edit(_paragraph)\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n    .replace('|table', '')\n    .replace('blockquote', ' {0,3}>')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n    .getRegex();\n\nconst blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/)\n    .replace('paragraph', paragraph)\n    .getRegex();\n\n/**\n * Normal Block Grammar\n */\n\nconst blockNormal = {\n    blockquote,\n    code: blockCode,\n    def,\n    fences,\n    heading,\n    hr,\n    html,\n    lheading,\n    list,\n    newline,\n    paragraph,\n    table: noopTest,\n    text: blockText,\n};\n\ntype BlockKeys = keyof typeof blockNormal;\n\n/**\n * GFM Block Grammar\n */\n\nconst gfmTable = edit(\n    '^ *([^\\\\n ].*)\\\\n' // Header\n    + ' {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)') // Cells\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('blockquote', ' {0,3}>')\n    .replace('code', ' {4}[^\\\\n]')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // tables can be interrupted by type (6) html blocks\n    .getRegex();\n\nconst blockGfm: Record<BlockKeys, RegExp> = {\n    ...blockNormal,\n    table: gfmTable,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n        .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n        .replace('table', gfmTable) // interrupt paragraphs with table\n        .replace('blockquote', ' {0,3}>')\n        .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n        .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n        .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n        .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n        .getRegex(),\n};\n\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\n\nconst blockPedantic: Record<BlockKeys, RegExp> = {\n    ...blockNormal,\n    html: edit(\n        '^ *(?:comment *(?:\\\\n|\\\\s*$)'\n        + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n        + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n        .replace('comment', _comment)\n        .replace(/tag/g, '(?!(?:'\n            + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n            + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n            + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n        .getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest, // fences not supported\n    lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' *#{1,6} *[^\\n]')\n        .replace('lheading', lheading)\n        .replace('|table', '')\n        .replace('blockquote', ' {0,3}>')\n        .replace('|fences', '')\n        .replace('|list', '')\n        .replace('|html', '')\n        .replace('|tag', '')\n        .getRegex(),\n};\n\n/**\n * Inline-Level Grammar\n */\n\nconst escape = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\nconst inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\nconst br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\nconst inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\n\n// list of unicode punctuation marks, plus any missing characters from CommonMark spec\nconst _punctuation = '\\\\p{P}\\\\p{S}';\nconst punctuation = edit(/^((?![*_])[\\spunctuation])/, 'u')\n    .replace(/punctuation/g, _punctuation).getRegex();\n\n// sequences em should skip over [title](link), `code`, <html>\nconst blockSkip = /\\[[^[\\]]*?\\]\\([^\\(\\)]*?\\)|`[^`]*?`|<[^<>]*?>/g;\n\nconst emStrongLDelim = edit(/^(?:\\*+(?:((?!\\*)[punct])|[^\\s*]))|^_+(?:((?!_)[punct])|([^\\s_]))/, 'u')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n\nconst emStrongRDelimAst = edit(\n    '^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)' // Skip orphan inside strong\n    + '|[^*]+(?=[^*])' // Consume to delim\n    + '|(?!\\\\*)[punct](\\\\*+)(?=[\\\\s]|$)' // (1) #*** can only be a Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?!\\\\*)(?=[punct\\\\s]|$)' // (2) a***#, a*** can only be a Right Delimiter\n    + '|(?!\\\\*)[punct\\\\s](\\\\*+)(?=[^punct\\\\s])' // (3) #***a, ***a can only be Left Delimiter\n    + '|[\\\\s](\\\\*+)(?!\\\\*)(?=[punct])' // (4) ***# can only be Left Delimiter\n    + '|(?!\\\\*)[punct](\\\\*+)(?!\\\\*)(?=[punct])' // (5) #***# can be either Left or Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?=[^punct\\\\s])', 'gu') // (6) a***a can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n\n// (6) Not allowed for _\nconst emStrongRDelimUnd = edit(\n    '^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)' // Skip orphan inside strong\n    + '|[^_]+(?=[^_])' // Consume to delim\n    + '|(?!_)[punct](_+)(?=[\\\\s]|$)' // (1) #___ can only be a Right Delimiter\n    + '|[^punct\\\\s](_+)(?!_)(?=[punct\\\\s]|$)' // (2) a___#, a___ can only be a Right Delimiter\n    + '|(?!_)[punct\\\\s](_+)(?=[^punct\\\\s])' // (3) #___a, ___a can only be Left Delimiter\n    + '|[\\\\s](_+)(?!_)(?=[punct])' // (4) ___# can only be Left Delimiter\n    + '|(?!_)[punct](_+)(?!_)(?=[punct])', 'gu') // (5) #___# can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n\nconst anyPunctuation = edit(/\\\\([punct])/, 'gu')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n\nconst autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/)\n    .replace('scheme', /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/)\n    .replace('email',\n        /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,\n    )\n    .getRegex();\n\nconst _inlineComment = edit(_comment).replace('(?:-->|$)', '-->').getRegex();\nconst tag = edit(\n    '^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>') // CDATA section\n    .replace('comment', _inlineComment)\n    .replace('attribute', /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/)\n    .getRegex();\n\nconst _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\n\nconst link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/)\n    .replace('label', _inlineLabel)\n    .replace('href', /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/)\n    .replace('title', /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/)\n    .getRegex();\n\nconst reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/)\n    .replace('label', _inlineLabel)\n    .replace('ref', _blockLabel)\n    .getRegex();\n\nconst nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/)\n    .replace('ref', _blockLabel)\n    .getRegex();\n\nconst reflinkSearch = edit('reflink|nolink(?!\\\\()', 'g')\n    .replace('reflink', reflink)\n    .replace('nolink', nolink)\n    .getRegex();\n\n/**\n * Normal Inline Grammar\n */\n\nconst inlineNormal = {\n    _backpedal: noopTest, // only used for GFM url\n    anyPunctuation,\n    autolink,\n    blockSkip,\n    br,\n    code: inlineCode,\n    del: noopTest,\n    emStrongLDelim,\n    emStrongRDelimAst,\n    emStrongRDelimUnd,\n    escape,\n    link,\n    nolink,\n    punctuation,\n    reflink,\n    reflinkSearch,\n    tag,\n    text: inlineText,\n    url: noopTest,\n};\n\ntype InlineKeys = keyof typeof inlineNormal;\n\n/**\n * Pedantic Inline Grammar\n */\n\nconst inlinePedantic: Record<InlineKeys, RegExp> = {\n    ...inlineNormal,\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n};\n\n/**\n * GFM Inline Grammar\n */\n\nconst inlineGfm: Record<InlineKeys, RegExp> = {\n    ...inlineNormal,\n    escape: edit(escape).replace('])', '~|])').getRegex(),\n    url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, 'i')\n        .replace('email', /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/)\n        .getRegex(),\n    _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/,\n};\n\n/**\n * GFM + Line Breaks Inline Grammar\n */\n\nconst inlineBreaks: Record<InlineKeys, RegExp> = {\n    ...inlineGfm,\n    br: edit(br).replace('{2,}', '*').getRegex(),\n    text: edit(inlineGfm.text)\n        .replace('\\\\b_', '\\\\b_| {2,}\\\\n')\n        .replace(/\\{2,\\}/g, '*')\n        .getRegex(),\n};\n\n/**\n * exports\n */\n\nexport const block = {\n    normal: blockNormal,\n    gfm: blockGfm,\n    pedantic: blockPedantic,\n};\n\nexport const inline = {\n    normal: inlineNormal,\n    gfm: inlineGfm,\n    breaks: inlineBreaks,\n    pedantic: inlinePedantic,\n};\n\nexport interface Rules {\n    block: Record<BlockKeys, RegExp>;\n    inline: Record<InlineKeys, RegExp>;\n}\n","import {_defaults} from './defaults';\nimport {escape, findClosingBracket, rtrim, splitCells} from './helpers';\nimport type {_Lexer} from './Lexer';\nimport type {MarkedOptions} from './MarkedOptions';\nimport type {Rules} from './rules';\nimport type {Links, Tokens} from './Tokens';\n\nfunction outputLink(cap: string[], link: Pick<Tokens.Link, 'href' | 'title'>, raw: string, lexer: _Lexer): Tokens.Link | Tokens.Image {\n    const href = link.href;\n    const title = link.title ? escape(link.title) : null;\n    const text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n\n    if (cap[0].charAt(0) !== '!') {\n        lexer.state.inLink = true;\n        const token: Tokens.Link = {\n            type: 'link',\n            raw,\n            href,\n            title,\n            text,\n            tokens: lexer.inlineTokens(text),\n        };\n        lexer.state.inLink = false;\n        return token;\n    }\n    return {\n        type: 'image',\n        raw,\n        href,\n        title,\n        text: escape(text),\n    };\n}\n\nfunction indentCodeCompensation(raw: string, text: string) {\n    const matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n\n    if (matchIndentToCode === null) {\n        return text;\n    }\n\n    const indentToCode = matchIndentToCode[1];\n\n    return text\n        .split('\\n')\n        .map(node => {\n            const matchIndentInNode = node.match(/^\\s+/);\n            if (matchIndentInNode === null) {\n                return node;\n            }\n\n            const [indentInNode] = matchIndentInNode;\n\n            if (indentInNode.length >= indentToCode.length) {\n                return node.slice(indentToCode.length);\n            }\n\n            return node;\n        })\n        .join('\\n');\n}\n\n/**\n * Tokenizer\n */\nexport class _Tokenizer {\n    lexer!: _Lexer; // set by the lexer\n    options: MarkedOptions;\n    rules!: Rules; // set by the lexer\n\n    constructor(options?: MarkedOptions) {\n        this.options = options || _defaults;\n    }\n\n    autolink(src: string): Tokens.Link | undefined {\n        const cap = this.rules.inline.autolink.exec(src);\n        if (cap) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape(cap[1]);\n                href = 'mailto:' + text;\n            } else {\n                text = escape(cap[1]);\n                href = text;\n            }\n\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text,\n                    },\n                ],\n            };\n        }\n    }\n\n    blockquote(src: string): Tokens.Blockquote | undefined {\n        const cap = this.rules.block.blockquote.exec(src);\n        if (cap) {\n            // precede setext continuation with 4 spaces so it isn't a setext\n            let text = cap[0].replace(/\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g, '\\n    $1');\n            text = rtrim(text.replace(/^ *>[ \\t]?/gm, ''), '\\n');\n            const top = this.lexer.state.top;\n            this.lexer.state.top = true;\n            const tokens = this.lexer.blockTokens(text);\n            this.lexer.state.top = top;\n            return {\n                type: 'blockquote',\n                raw: cap[0],\n                tokens,\n                text,\n            };\n        }\n    }\n\n    br(src: string): Tokens.Br | undefined {\n        const cap = this.rules.inline.br.exec(src);\n        if (cap) {\n            return {\n                type: 'br',\n                raw: cap[0],\n            };\n        }\n    }\n\n    code(src: string): Tokens.Code | undefined {\n        const cap = this.rules.block.code.exec(src);\n        if (cap) {\n            const text = cap[0].replace(/^ {1,4}/gm, '');\n            return {\n                type: 'code',\n                raw: cap[0],\n                codeBlockStyle: 'indented',\n                text: !this.options.pedantic\n                    ? rtrim(text, '\\n')\n                    : text,\n            };\n        }\n    }\n\n    codespan(src: string): Tokens.Codespan | undefined {\n        const cap = this.rules.inline.code.exec(src);\n        if (cap) {\n            let text = cap[2].replace(/\\n/g, ' ');\n            const hasNonSpaceChars = /[^ ]/.test(text);\n            const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n            if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n                text = text.substring(1, text.length - 1);\n            }\n            text = escape(text, true);\n            return {\n                type: 'codespan',\n                raw: cap[0],\n                text,\n            };\n        }\n    }\n\n    def(src: string): Tokens.Def | undefined {\n        const cap = this.rules.block.def.exec(src);\n        if (cap) {\n            const tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n            const href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline.anyPunctuation, '$1') : '';\n            const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation,\n                '$1',\n            ) : cap[3];\n            return {\n                type: 'def',\n                tag,\n                raw: cap[0],\n                href,\n                title,\n            };\n        }\n    }\n\n    del(src: string): Tokens.Del | undefined {\n        const cap = this.rules.inline.del.exec(src);\n        if (cap) {\n            return {\n                type: 'del',\n                raw: cap[0],\n                text: cap[2],\n                tokens: this.lexer.inlineTokens(cap[2]),\n            };\n        }\n    }\n\n    emStrong(src: string, maskedSrc: string, prevChar = ''): Tokens.Em | Tokens.Strong | undefined {\n        let match = this.rules.inline.emStrongLDelim.exec(src);\n        if (!match) {\n            return;\n        }\n\n        // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n        if (match[3] && prevChar.match(/[\\p{L}\\p{N}]/u)) {\n            return;\n        }\n\n        const nextChar = match[1] || match[2] || '';\n\n        if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\n            // unicode Regex counts emoji as 1 char; spread into array for proper count (used multiple times below)\n            const lLength = [...(match as any)[0]].length - 1;\n            let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\n\n            const endReg = match[0][0] === '*'\n                ? this.rules.inline.emStrongRDelimAst\n                : this.rules.inline.emStrongRDelimUnd;\n            endReg.lastIndex = 0;\n\n            // Clip maskedSrc to same section of string as src (move to lexer?)\n            maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n\n            while ((match = endReg.exec(maskedSrc)) != null) {\n                rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n\n                if (!rDelim) {\n                    continue;\n                } // skip single * in __abc*abc__\n\n                rLength = [...rDelim].length;\n\n                if (match[3] || match[4]) { // found another Left Delim\n                    delimTotal += rLength;\n                    continue;\n                } else {\n                    if (match[5] || match[6]) { // either Left or Right Delim\n                        if (lLength % 3 && !((lLength + rLength) % 3)) {\n                            midDelimTotal += rLength;\n                            continue; // CommonMark Emphasis Rules 9-10\n                        }\n                    }\n                }\n\n                delimTotal -= rLength;\n\n                if (delimTotal > 0) {\n                    continue;\n                } // Haven't found enough closing delimiters\n\n                // Remove extra characters. *a*** -> *a*\n                rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n                // char length can be >1 for unicode characters;\n                const lastCharLength = [...(match as any)[0]][0].length;\n                const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\n\n                // Create `em` if smallest delimiter has odd char count. *a***\n                if (Math.min(lLength, rLength) % 2) {\n                    const text = raw.slice(1, -1);\n                    return {\n                        type: 'em',\n                        raw,\n                        text,\n                        tokens: this.lexer.inlineTokens(text),\n                    };\n                }\n\n                // Create 'strong' if smallest delimiter has even char count. **a***\n                const text = raw.slice(2, -2);\n                return {\n                    type: 'strong',\n                    raw,\n                    text,\n                    tokens: this.lexer.inlineTokens(text),\n                };\n            }\n        }\n    }\n\n    escape(src: string): Tokens.Escape | undefined {\n        const cap = this.rules.inline.escape.exec(src);\n        if (cap) {\n            return {\n                type: 'escape',\n                raw: cap[0],\n                text: escape(cap[1]),\n            };\n        }\n    }\n\n    fences(src: string): Tokens.Code | undefined {\n        const cap = this.rules.block.fences.exec(src);\n        if (cap) {\n            const raw = cap[0];\n            const text = indentCodeCompensation(raw, cap[3] || '');\n\n            return {\n                type: 'code',\n                raw,\n                lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, '$1') : cap[2],\n                text,\n            };\n        }\n    }\n\n    heading(src: string): Tokens.Heading | undefined {\n        const cap = this.rules.block.heading.exec(src);\n        if (cap) {\n            let text = cap[2].trim();\n\n            // remove trailing #s\n            if (/#$/.test(text)) {\n                const trimmed = rtrim(text, '#');\n                if (this.options.pedantic) {\n                    text = trimmed.trim();\n                } else {\n                    if (!trimmed || / $/.test(trimmed)) {\n                        // CommonMark requires space before trailing #s\n                        text = trimmed.trim();\n                    }\n                }\n            }\n\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[1].length,\n                text,\n                tokens: this.lexer.inline(text),\n            };\n        }\n    }\n\n    hr(src: string): Tokens.Hr | undefined {\n        const cap = this.rules.block.hr.exec(src);\n        if (cap) {\n            return {\n                type: 'hr',\n                raw: cap[0],\n            };\n        }\n    }\n\n    html(src: string): Tokens.HTML | undefined {\n        const cap = this.rules.block.html.exec(src);\n        if (cap) {\n            const token: Tokens.HTML = {\n                type: 'html',\n                block: true,\n                raw: cap[0],\n                pre: cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style',\n                text: cap[0],\n            };\n            return token;\n        }\n    }\n\n    inlineText(src: string): Tokens.Text | undefined {\n        const cap = this.rules.inline.text.exec(src);\n        if (cap) {\n            let text;\n            if (this.lexer.state.inRawBlock) {\n                text = cap[0];\n            } else {\n                text = escape(cap[0]);\n            }\n            return {\n                type: 'text',\n                raw: cap[0],\n                text,\n            };\n        }\n    }\n\n    lheading(src: string): Tokens.Heading | undefined {\n        const cap = this.rules.block.lheading.exec(src);\n        if (cap) {\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[2].charAt(0) === '=' ? 1 : 2,\n                text: cap[1],\n                tokens: this.lexer.inline(cap[1]),\n            };\n        }\n    }\n\n    link(src: string): Tokens.Link | Tokens.Image | undefined {\n        const cap = this.rules.inline.link.exec(src);\n        if (cap) {\n            const trimmedUrl = cap[2].trim();\n            if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n                // commonmark requires matching angle brackets\n                if (!(/>$/.test(trimmedUrl))) {\n                    return;\n                }\n\n                // ending angle bracket cannot be escaped\n                const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n                if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n                    return;\n                }\n            } else {\n                // find closing parenthesis\n                const lastParenIndex = findClosingBracket(cap[2], '()');\n                if (lastParenIndex > -1) {\n                    const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n                    const linkLen = start + cap[1].length + lastParenIndex;\n                    cap[2] = cap[2].substring(0, lastParenIndex);\n                    cap[0] = cap[0].substring(0, linkLen).trim();\n                    cap[3] = '';\n                }\n            }\n            let href = cap[2];\n            let title = '';\n            if (this.options.pedantic) {\n                // split pedantic href and title\n                const link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n\n                if (link) {\n                    href = link[1];\n                    title = link[3];\n                }\n            } else {\n                title = cap[3] ? cap[3].slice(1, -1) : '';\n            }\n\n            href = href.trim();\n            if (/^</.test(href)) {\n                if (this.options.pedantic && !(/>$/.test(trimmedUrl))) {\n                    // pedantic allows starting angle bracket without ending angle bracket\n                    href = href.slice(1);\n                } else {\n                    href = href.slice(1, -1);\n                }\n            }\n            return outputLink(cap, {\n                href: href ? href.replace(this.rules.inline.anyPunctuation, '$1') : href,\n                title: title ? title.replace(this.rules.inline.anyPunctuation, '$1') : title,\n            }, cap[0], this.lexer);\n        }\n    }\n\n    list(src: string): Tokens.List | undefined {\n        let cap = this.rules.block.list.exec(src);\n        if (cap) {\n            let bull = cap[1].trim();\n            const isordered = bull.length > 1;\n\n            const list: Tokens.List = {\n                type: 'list',\n                raw: '',\n                ordered: isordered,\n                start: isordered ? +bull.slice(0, -1) : '',\n                loose: false,\n                items: [],\n            };\n\n            bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\n\n            if (this.options.pedantic) {\n                bull = isordered ? bull : '[*+-]';\n            }\n\n            // Get next list item\n            const itemRegex = new RegExp(`^( {0,3}${bull})((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))`);\n            let raw = '';\n            let itemContents = '';\n            let endsWithBlankLine = false;\n            // Check if current bullet point can start a new List Item\n            while (src) {\n                let endEarly = false;\n                if (!(cap = itemRegex.exec(src))) {\n                    break;\n                }\n\n                if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)\n                    break;\n                }\n\n                raw = cap[0];\n                src = src.substring(raw.length);\n\n                let line = cap[2].split('\\n', 1)[0].replace(/^\\t+/, (t: string) => ' '.repeat(3 * t.length));\n                let nextLine = src.split('\\n', 1)[0];\n\n                let indent = 0;\n                if (this.options.pedantic) {\n                    indent = 2;\n                    itemContents = line.trimStart();\n                } else {\n                    indent = cap[2].search(/[^ ]/); // Find first non-space char\n                    indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n                    itemContents = line.slice(indent);\n                    indent += cap[1].length;\n                }\n\n                let blankLine = false;\n\n                if (!line && /^ *$/.test(nextLine)) { // Items begin with at most one blank line\n                    raw += nextLine + '\\n';\n                    src = src.substring(nextLine.length + 1);\n                    endEarly = true;\n                }\n\n                if (!endEarly) {\n                    const nextBulletRegex = new RegExp(\n                        `^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \\t][^\\\\n]*)?(?:\\\\n|$))`);\n                    const hrRegex = new RegExp(\n                        `^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`);\n                    const fencesBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`);\n                    const headingBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`);\n\n                    // Check if following lines should be included in List Item\n                    while (src) {\n                        const rawLine = src.split('\\n', 1)[0];\n                        nextLine = rawLine;\n\n                        // Re-align to follow commonmark nesting rules\n                        if (this.options.pedantic) {\n                            nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n                        }\n\n                        // End list item if found code fences\n                        if (fencesBeginRegex.test(nextLine)) {\n                            break;\n                        }\n\n                        // End list item if found start of new heading\n                        if (headingBeginRegex.test(nextLine)) {\n                            break;\n                        }\n\n                        // End list item if found start of new bullet\n                        if (nextBulletRegex.test(nextLine)) {\n                            break;\n                        }\n\n                        // Horizontal rule found\n                        if (hrRegex.test(src)) {\n                            break;\n                        }\n\n                        if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) { // Dedent if possible\n                            itemContents += '\\n' + nextLine.slice(indent);\n                        } else {\n                            // not enough indentation\n                            if (blankLine) {\n                                break;\n                            }\n\n                            // paragraph continuation unless last line was a different block level element\n                            if (line.search(/[^ ]/) >= 4) { // indented code block\n                                break;\n                            }\n                            if (fencesBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (headingBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (hrRegex.test(line)) {\n                                break;\n                            }\n\n                            itemContents += '\\n' + nextLine;\n                        }\n\n                        if (!blankLine && !nextLine.trim()) { // Check if current line is blank\n                            blankLine = true;\n                        }\n\n                        raw += rawLine + '\\n';\n                        src = src.substring(rawLine.length + 1);\n                        line = nextLine.slice(indent);\n                    }\n                }\n\n                if (!list.loose) {\n                    // If the previous item ended with a blank line, the list is loose\n                    if (endsWithBlankLine) {\n                        list.loose = true;\n                    } else {\n                        if (/\\n *\\n *$/.test(raw)) {\n                            endsWithBlankLine = true;\n                        }\n                    }\n                }\n\n                let istask: RegExpExecArray | null = null;\n                let ischecked: boolean | undefined;\n                // Check for task list items\n                if (this.options.gfm) {\n                    istask = /^\\[[ xX]\\] /.exec(itemContents);\n                    if (istask) {\n                        ischecked = istask[0] !== '[ ] ';\n                        itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n                    }\n                }\n\n                list.items.push({\n                    type: 'list_item',\n                    raw,\n                    task: !!istask,\n                    checked: ischecked,\n                    loose: false,\n                    text: itemContents,\n                    tokens: [],\n                });\n\n                list.raw += raw;\n            }\n\n            // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to\n            // simplify/speed up endsWithBlankLine logic\n            list.items[list.items.length - 1].raw = raw.trimEnd();\n            (list.items[list.items.length - 1]).text = itemContents.trimEnd();\n            list.raw = list.raw.trimEnd();\n\n            // Item child tokens handled here at end because we needed to have the final item to trim it first\n            for (let i = 0; i < list.items.length; i++) {\n                this.lexer.state.top = false;\n                list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n\n                if (!list.loose) {\n                    // Check if list should be loose\n                    const spacers = list.items[i].tokens.filter(t => t.type === 'space');\n                    const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => /\\n.*\\n/.test(t.raw));\n\n                    list.loose = hasMultipleLineBreaks;\n                }\n            }\n\n            // Set all items to loose if list is loose\n            if (list.loose) {\n                for (let i = 0; i < list.items.length; i++) {\n                    list.items[i].loose = true;\n                }\n            }\n\n            return list;\n        }\n    }\n\n    paragraph(src: string): Tokens.Paragraph | undefined {\n        const cap = this.rules.block.paragraph.exec(src);\n        if (cap) {\n            const text = cap[1].charAt(cap[1].length - 1) === '\\n'\n                ? cap[1].slice(0, -1)\n                : cap[1];\n            return {\n                type: 'paragraph',\n                raw: cap[0],\n                text,\n                tokens: this.lexer.inline(text),\n            };\n        }\n    }\n\n    reflink(src: string, links: Links): Tokens.Link | Tokens.Image | Tokens.Text | undefined {\n        let cap;\n        if ((cap = this.rules.inline.reflink.exec(src))\n            || (cap = this.rules.inline.nolink.exec(src))) {\n            const linkString = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n            const link = links[linkString.toLowerCase()];\n            if (!link) {\n                const text = cap[0].charAt(0);\n                return {\n                    type: 'text',\n                    raw: text,\n                    text,\n                };\n            }\n            return outputLink(cap, link, cap[0], this.lexer);\n        }\n    }\n\n    space(src: string): Tokens.Space | undefined {\n        const cap = this.rules.block.newline.exec(src);\n        if (cap && cap[0].length > 0) {\n            return {\n                type: 'space',\n                raw: cap[0],\n            };\n        }\n    }\n\n    table(src: string): Tokens.Table | undefined {\n        const cap = this.rules.block.table.exec(src);\n        if (!cap) {\n            return;\n        }\n\n        if (!/[:|]/.test(cap[2])) {\n            // delimiter row must have a pipe (|) or colon (:) otherwise it is a setext heading\n            return;\n        }\n\n        const headers = splitCells(cap[1]);\n        const aligns = cap[2].replace(/^\\||\\| *$/g, '').split('|');\n        const rows = cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : [];\n\n        const item: Tokens.Table = {\n            type: 'table',\n            raw: cap[0],\n            header: [],\n            align: [],\n            rows: [],\n        };\n\n        if (headers.length !== aligns.length) {\n            // header and align columns must be equal, rows can be different.\n            return;\n        }\n\n        for (const align of aligns) {\n            if (/^ *-+: *$/.test(align)) {\n                item.align.push('right');\n            } else {\n                if (/^ *:-+: *$/.test(align)) {\n                    item.align.push('center');\n                } else {\n                    if (/^ *:-+ *$/.test(align)) {\n                        item.align.push('left');\n                    } else {\n                        item.align.push(null);\n                    }\n                }\n            }\n        }\n\n        for (const header of headers) {\n            item.header.push({\n                text: header,\n                tokens: this.lexer.inline(header),\n            });\n        }\n\n        for (const row of rows) {\n            item.rows.push(splitCells(row, item.header.length).map(cell => {\n                return {\n                    text: cell,\n                    tokens: this.lexer.inline(cell),\n                };\n            }));\n        }\n\n        return item;\n    }\n\n    tag(src: string): Tokens.Tag | undefined {\n        const cap = this.rules.inline.tag.exec(src);\n        if (cap) {\n            if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n                this.lexer.state.inLink = true;\n            } else {\n                if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n                    this.lexer.state.inLink = false;\n                }\n            }\n            if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = true;\n            } else {\n                if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                    this.lexer.state.inRawBlock = false;\n                }\n            }\n\n            return {\n                type: 'html',\n                raw: cap[0],\n                inLink: this.lexer.state.inLink,\n                inRawBlock: this.lexer.state.inRawBlock,\n                block: false,\n                text: cap[0],\n            };\n        }\n    }\n\n    text(src: string): Tokens.Text | undefined {\n        const cap = this.rules.block.text.exec(src);\n        if (cap) {\n            return {\n                type: 'text',\n                raw: cap[0],\n                text: cap[0],\n                tokens: this.lexer.inline(cap[0]),\n            };\n        }\n    }\n\n    url(src: string): Tokens.Link | undefined {\n        let cap;\n        if (cap = this.rules.inline.url.exec(src)) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape(cap[0]);\n                href = 'mailto:' + text;\n            } else {\n                // do extended autolink path validation\n                let prevCapZero;\n                do {\n                    prevCapZero = cap[0];\n                    cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? '';\n                }\n                while (prevCapZero !== cap[0]);\n                text = escape(cap[0]);\n                if (cap[1] === 'www.') {\n                    href = 'http://' + cap[0];\n                } else {\n                    href = cap[0];\n                }\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text,\n                    },\n                ],\n            };\n        }\n    }\n}\n","import {_defaults} from './defaults';\nimport type {MarkedOptions, TokenizerExtension} from './MarkedOptions';\nimport {block, inline} from './rules';\nimport {_Tokenizer} from './Tokenizer';\nimport type {Token, Tokens, TokensList} from './Tokens';\n\n/**\n * Block Lexer\n */\nexport class _Lexer {\n    options: MarkedOptions;\n    state: {\n        inLink: boolean;\n        inRawBlock: boolean;\n        top: boolean;\n    };\n    tokens: TokensList;\n    private inlineQueue: {src: string, tokens: Token[]}[];\n    private tokenizer: _Tokenizer;\n\n    constructor(options?: MarkedOptions) {\n        // TokenList cannot be created in one go\n        this.tokens = [] as unknown as TokensList;\n        this.tokens.links = Object.create(null);\n        this.options = options || _defaults;\n        this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\n        this.tokenizer = this.options.tokenizer;\n        this.tokenizer.options = this.options;\n        this.tokenizer.lexer = this;\n        this.inlineQueue = [];\n        this.state = {\n            inLink: false,\n            inRawBlock: false,\n            top: true,\n        };\n\n        const rules = {\n            block: block.normal,\n            inline: inline.normal,\n        };\n\n        if (this.options.pedantic) {\n            rules.block = block.pedantic;\n            rules.inline = inline.pedantic;\n        } else {\n            if (this.options.gfm) {\n                rules.block = block.gfm;\n                if (this.options.breaks) {\n                    rules.inline = inline.breaks;\n                } else {\n                    rules.inline = inline.gfm;\n                }\n            }\n        }\n        this.tokenizer.rules = rules;\n    }\n\n    /**\n     * Expose Rules\n     */\n    static get rules() {\n        return {\n            block,\n            inline,\n        };\n    }\n\n    /**\n     * Static Lex Method\n     */\n    static lex(src: string, options?: MarkedOptions) {\n        const lexer = new _Lexer(options);\n        return lexer.lex(src);\n    }\n\n    /**\n     * Static Lex Inline Method\n     */\n    static lexInline(src: string, options?: MarkedOptions) {\n        const lexer = new _Lexer(options);\n        return lexer.inlineTokens(src);\n    }\n\n    /**\n     * Lexing\n     */\n    blockTokens(src: string, tokens?: Token[]): Token[];\n\n    blockTokens(src: string, tokens?: TokensList): TokensList;\n\n    blockTokens(src: string, tokens: Token[] = []) {\n        if (this.options.pedantic) {\n            src = src.replace(/\\t/g, '    ').replace(/^ +$/gm, '');\n        } else {\n            src = src.replace(/^( *)(\\t+)/gm, (_, leading, tabs) => {\n                return leading + '    '.repeat(tabs.length);\n            });\n        }\n\n        let token: Tokens.Generic | undefined;\n        let lastToken;\n        let cutSrc;\n        let lastParagraphClipped;\n\n        while (src) {\n            if (this.options.extensions\n                && this.options.extensions.block\n                && this.options.extensions.block.some((extTokenizer: TokenizerExtension['tokenizer']) => {\n                    if (token = extTokenizer.call({lexer: this}, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n\n            // newline\n            if (token = this.tokenizer.space(src)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.length === 1 && tokens.length > 0) {\n                    // if there's a single \\n as a spacer, it's terminating the last line,\n                    // so move it there so that we don't get unnecessary paragraph tags\n                    tokens[tokens.length - 1].raw += '\\n';\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            // code\n            if (token = this.tokenizer.code(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                // An indented code block cannot interrupt a paragraph.\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            // fences\n            if (token = this.tokenizer.fences(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // heading\n            if (token = this.tokenizer.heading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // hr\n            if (token = this.tokenizer.hr(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // blockquote\n            if (token = this.tokenizer.blockquote(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // list\n            if (token = this.tokenizer.list(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // html\n            if (token = this.tokenizer.html(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // def\n            if (token = this.tokenizer.def(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.raw;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                } else {\n                    if (!this.tokens.links[token.tag]) {\n                        this.tokens.links[token.tag] = {\n                            href: token.href,\n                            title: token.title,\n                        };\n                    }\n                }\n                continue;\n            }\n\n            // table (gfm)\n            if (token = this.tokenizer.table(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // lheading\n            if (token = this.tokenizer.lheading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // top-level paragraph\n            // prevent paragraph consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startBlock) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startBlock.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({lexer: this}, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n                lastToken = tokens[tokens.length - 1];\n                if (lastParagraphClipped && lastToken.type === 'paragraph') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                } else {\n                    tokens.push(token);\n                }\n                lastParagraphClipped = (cutSrc.length !== src.length);\n                src = src.substring(token.raw.length);\n                continue;\n            }\n\n            // text\n            if (token = this.tokenizer.text(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                } else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n\n        this.state.top = true;\n        return tokens;\n    }\n\n    inline(src: string, tokens: Token[] = []) {\n        this.inlineQueue.push({src, tokens});\n        return tokens;\n    }\n\n    /**\n     * Lexing/Compiling\n     */\n    inlineTokens(src: string, tokens: Token[] = []): Token[] {\n        let token, lastToken, cutSrc;\n\n        // String with links masked to avoid interference with em and strong\n        let maskedSrc = src;\n        let match;\n        let keepPrevChar, prevChar;\n\n        // Mask out reflinks\n        if (this.tokens.links) {\n            const links = Object.keys(this.tokens.links);\n            if (links.length > 0) {\n                while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n                    if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n                        maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']'\n                            + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n                    }\n                }\n            }\n        }\n        // Mask out other blocks\n        while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(\n                this.tokenizer.rules.inline.blockSkip.lastIndex);\n        }\n\n        // Mask out escaped characters\n        while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(\n                this.tokenizer.rules.inline.anyPunctuation.lastIndex);\n        }\n\n        while (src) {\n            if (!keepPrevChar) {\n                prevChar = '';\n            }\n            keepPrevChar = false;\n\n            // extensions\n            if (this.options.extensions\n                && this.options.extensions.inline\n                && this.options.extensions.inline.some((extTokenizer) => {\n                    if (token = extTokenizer.call({lexer: this}, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n\n            // escape\n            if (token = this.tokenizer.escape(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // tag\n            if (token = this.tokenizer.tag(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            // link\n            if (token = this.tokenizer.link(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // reflink, nolink\n            if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            // em & strong\n            if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // code\n            if (token = this.tokenizer.codespan(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // br\n            if (token = this.tokenizer.br(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // del (gfm)\n            if (token = this.tokenizer.del(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // autolink\n            if (token = this.tokenizer.autolink(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // url (gfm)\n            if (!this.state.inLink && (token = this.tokenizer.url(src))) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n\n            // text\n            // prevent inlineText consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startInline) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startInline.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({lexer: this}, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (token = this.tokenizer.inlineText(cutSrc)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started\n                    prevChar = token.raw.slice(-1);\n                }\n                keepPrevChar = true;\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                } else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                } else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n\n        return tokens;\n    }\n\n    /**\n     * Preprocessing\n     */\n    lex(src: string) {\n        src = src\n            .replace(/\\r\\n|\\r/g, '\\n');\n\n        this.blockTokens(src, this.tokens);\n\n        for (let i = 0; i < this.inlineQueue.length; i++) {\n            const next = this.inlineQueue[i];\n            this.inlineTokens(next.src, next.tokens);\n        }\n        this.inlineQueue = [];\n\n        return this.tokens;\n    }\n}\n","import {_defaults} from './defaults';\nimport {cleanUrl, escape} from './helpers';\nimport type {MarkedOptions} from './MarkedOptions';\n\n/**\n * Renderer\n */\nexport class _Renderer {\n    options: MarkedOptions;\n\n    constructor(options?: MarkedOptions) {\n        this.options = options || _defaults;\n    }\n\n    blockquote(quote: string): string {\n        return `<blockquote>\\n${quote}</blockquote>\\n`;\n    }\n\n    br(): string {\n        return '<br>';\n    }\n\n    checkbox(checked: boolean): string {\n        return '<input '\n            + (checked ? 'checked=\"\" ' : '')\n            + 'disabled=\"\" type=\"checkbox\">';\n    }\n\n    code(code: string, infostring: string | undefined, escaped: boolean): string {\n        const lang = (infostring || '').match(/^\\S*/)?.[0];\n\n        code = code.replace(/\\n$/, '') + '\\n';\n\n        if (!lang) {\n            return '<pre><code>'\n                + (escaped ? code : escape(code, true))\n                + '</code></pre>\\n';\n        }\n\n        return '<pre><code class=\"language-'\n            + escape(lang)\n            + '\">'\n            + (escaped ? code : escape(code, true))\n            + '</code></pre>\\n';\n    }\n\n    codespan(text: string): string {\n        return `<code>${text}</code>`;\n    }\n\n    del(text: string): string {\n        return `<del>${text}</del>`;\n    }\n\n    em(text: string): string {\n        return `<em>${text}</em>`;\n    }\n\n    heading(text: string, level: number, raw: string): string {\n        // ignore IDs\n        return `<h${level}>${text}</h${level}>\\n`;\n    }\n\n    hr(): string {\n        return '<hr>\\n';\n    }\n\n    html(html: string, block?: boolean): string {\n        return html;\n    }\n\n    image(href: string, title: string | null, text: string): string {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n\n        let out = `<img src=\"${href}\" alt=\"${text}\"`;\n        if (title) {\n            out += ` title=\"${title}\"`;\n        }\n        out += '>';\n        return out;\n    }\n\n    link(href: string, title: string | null | undefined, text: string): string {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = '<a href=\"' + href + '\"';\n        if (title) {\n            out += ' title=\"' + title + '\"';\n        }\n        out += '>' + text + '</a>';\n        return out;\n    }\n\n    list(body: string, ordered: boolean, start: number | ''): string {\n        const type = ordered ? 'ol' : 'ul';\n        const startatt = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n        return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n    }\n\n    listitem(text: string, task: boolean, checked: boolean): string {\n        return `<li>${text}</li>\\n`;\n    }\n\n    paragraph(text: string): string {\n        return `<p>${text}</p>\\n`;\n    }\n\n    /**\n     * span level renderer\n     */\n    strong(text: string): string {\n        return `<strong>${text}</strong>`;\n    }\n\n    table(header: string, body: string): string {\n        if (body) {\n            body = `<tbody>${body}</tbody>`;\n        }\n\n        return '<table>\\n'\n            + '<thead>\\n'\n            + header\n            + '</thead>\\n'\n            + body\n            + '</table>\\n';\n    }\n\n    tablecell(content: string, flags: {\n        header: boolean;\n        align: 'center' | 'left' | 'right' | null;\n    }): string {\n        const type = flags.header ? 'th' : 'td';\n        const tag = flags.align\n            ? `<${type} align=\"${flags.align}\">`\n            : `<${type}>`;\n        return tag + content + `</${type}>\\n`;\n    }\n\n    tablerow(content: string): string {\n        return `<tr>\\n${content}</tr>\\n`;\n    }\n\n    text(text: string): string {\n        return text;\n    }\n}\n","/**\n * TextRenderer\n * returns only the textual part of the token\n */\nexport class _TextRenderer {\n    br() {\n        return '';\n    }\n\n    codespan(text: string) {\n        return text;\n    }\n\n    del(text: string) {\n        return text;\n    }\n\n    em(text: string) {\n        return text;\n    }\n\n    html(text: string) {\n        return text;\n    }\n\n    image(href: string, title: string | null, text: string) {\n        return '' + text;\n    }\n\n    link(href: string, title: string | null | undefined, text: string) {\n        return '' + text;\n    }\n\n    // no need for block level renderers\n    strong(text: string) {\n        return text;\n    }\n\n    text(text: string) {\n        return text;\n    }\n}\n","import {_defaults} from './defaults';\nimport {unescape} from './helpers';\nimport type {MarkedOptions} from './MarkedOptions';\nimport {_Renderer} from './Renderer';\nimport {_TextRenderer} from './TextRenderer';\nimport type {Token, Tokens} from './Tokens';\n\n/**\n * Parsing & Compiling\n */\nexport class _Parser {\n    options: MarkedOptions;\n    renderer: _Renderer;\n    textRenderer: _TextRenderer;\n\n    constructor(options?: MarkedOptions) {\n        this.options = options || _defaults;\n        this.options.renderer = this.options.renderer || new _Renderer();\n        this.renderer = this.options.renderer;\n        this.renderer.options = this.options;\n        this.textRenderer = new _TextRenderer();\n    }\n\n    /**\n     * Static Parse Method\n     */\n    static parse(tokens: Token[], options?: MarkedOptions) {\n        const parser = new _Parser(options);\n        return parser.parse(tokens);\n    }\n\n    /**\n     * Static Parse Inline Method\n     */\n    static parseInline(tokens: Token[], options?: MarkedOptions) {\n        const parser = new _Parser(options);\n        return parser.parseInline(tokens);\n    }\n\n    /**\n     * Parse Loop\n     */\n    parse(tokens: Token[], top = true): string {\n        let out = '';\n\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers\n                && this.options.extensions.renderers[token.type]) {\n                const genericToken = token as Tokens.Generic;\n                const ret = this.options.extensions.renderers[genericToken.type].call({parser: this}, genericToken);\n                if (ret !== false || ![\n                    'space',\n                    'hr',\n                    'heading',\n                    'code',\n                    'table',\n                    'blockquote',\n                    'list',\n                    'html',\n                    'paragraph',\n                    'text',\n                ].includes(genericToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n\n            switch (token.type) {\n                case 'space': {\n                    continue;\n                }\n                case 'hr': {\n                    out += this.renderer.hr();\n                    continue;\n                }\n                case 'heading': {\n                    const headingToken = token as Tokens.Heading;\n                    out += this.renderer.heading(\n                        this.parseInline(headingToken.tokens),\n                        headingToken.depth,\n                        unescape(this.parseInline(headingToken.tokens, this.textRenderer)),\n                    );\n                    continue;\n                }\n                case 'code': {\n                    const codeToken = token as Tokens.Code;\n                    out += this.renderer.code(codeToken.text,\n                        codeToken.lang,\n                        !!codeToken.escaped,\n                    );\n                    continue;\n                }\n                case 'table': {\n                    const tableToken = token as Tokens.Table;\n                    let header = '';\n\n                    // header\n                    let cell = '';\n                    for (let j = 0; j < tableToken.header.length; j++) {\n                        cell += this.renderer.tablecell(\n                            this.parseInline(tableToken.header[j].tokens),\n                            {header: true, align: tableToken.align[j]},\n                        );\n                    }\n                    header += this.renderer.tablerow(cell);\n\n                    let body = '';\n                    for (let j = 0; j < tableToken.rows.length; j++) {\n                        const row = tableToken.rows[j];\n\n                        cell = '';\n                        for (let k = 0; k < row.length; k++) {\n                            cell += this.renderer.tablecell(\n                                this.parseInline(row[k].tokens),\n                                {header: false, align: tableToken.align[k]},\n                            );\n                        }\n\n                        body += this.renderer.tablerow(cell);\n                    }\n                    out += this.renderer.table(header, body);\n                    continue;\n                }\n                case 'blockquote': {\n                    const blockquoteToken = token as Tokens.Blockquote;\n                    const body = this.parse(blockquoteToken.tokens);\n                    out += this.renderer.blockquote(body);\n                    continue;\n                }\n                case 'list': {\n                    const listToken = token as Tokens.List;\n                    const ordered = listToken.ordered;\n                    const start = listToken.start;\n                    const loose = listToken.loose;\n\n                    let body = '';\n                    for (let j = 0; j < listToken.items.length; j++) {\n                        const item = listToken.items[j];\n                        const checked = item.checked;\n                        const task = item.task;\n\n                        let itemBody = '';\n                        if (item.task) {\n                            const checkbox = this.renderer.checkbox(!!checked);\n                            if (loose) {\n                                if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0\n                                        && item.tokens[0].tokens[0].type === 'text') {\n                                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                                    }\n                                } else {\n                                    item.tokens.unshift({\n                                        type: 'text',\n                                        text: checkbox + ' ',\n                                    } as Tokens.Text);\n                                }\n                            } else {\n                                itemBody += checkbox + ' ';\n                            }\n                        }\n\n                        itemBody += this.parse(item.tokens, loose);\n                        body += this.renderer.listitem(itemBody, task, !!checked);\n                    }\n\n                    out += this.renderer.list(body, ordered, start);\n                    continue;\n                }\n                case 'html': {\n                    const htmlToken = token as Tokens.HTML;\n                    out += this.renderer.html(htmlToken.text, htmlToken.block);\n                    continue;\n                }\n                case 'paragraph': {\n                    const paragraphToken = token as Tokens.Paragraph;\n                    out += this.renderer.paragraph(this.parseInline(paragraphToken.tokens));\n                    continue;\n                }\n                case 'text': {\n                    let textToken = token as Tokens.Text;\n                    let body = textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text;\n                    while (i + 1 < tokens.length && tokens[i + 1].type === 'text') {\n                        textToken = tokens[++i] as Tokens.Text;\n                        body += '\\n' + (textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text);\n                    }\n                    out += top ? this.renderer.paragraph(body) : body;\n                    continue;\n                }\n\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    } else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n\n        return out;\n    }\n\n    /**\n     * Parse Inline Tokens\n     */\n    parseInline(tokens: Token[], renderer?: _Renderer | _TextRenderer): string {\n        renderer = renderer || this.renderer;\n        let out = '';\n\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers\n                && this.options.extensions.renderers[token.type]) {\n                const ret = this.options.extensions.renderers[token.type].call({parser: this}, token);\n                if (ret !== false || ![\n                    'escape',\n                    'html',\n                    'link',\n                    'image',\n                    'strong',\n                    'em',\n                    'codespan',\n                    'br',\n                    'del',\n                    'text',\n                ].includes(token.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n\n            switch (token.type) {\n                case 'escape': {\n                    const escapeToken = token as Tokens.Escape;\n                    out += renderer.text(escapeToken.text);\n                    break;\n                }\n                case 'html': {\n                    const tagToken = token as Tokens.Tag;\n                    out += renderer.html(tagToken.text);\n                    break;\n                }\n                case 'link': {\n                    const linkToken = token as Tokens.Link;\n                    out += renderer.link(linkToken.href, linkToken.title, this.parseInline(linkToken.tokens, renderer));\n                    break;\n                }\n                case 'image': {\n                    const imageToken = token as Tokens.Image;\n                    out += renderer.image(imageToken.href, imageToken.title, imageToken.text);\n                    break;\n                }\n                case 'strong': {\n                    const strongToken = token as Tokens.Strong;\n                    out += renderer.strong(this.parseInline(strongToken.tokens, renderer));\n                    break;\n                }\n                case 'em': {\n                    const emToken = token as Tokens.Em;\n                    out += renderer.em(this.parseInline(emToken.tokens, renderer));\n                    break;\n                }\n                case 'codespan': {\n                    const codespanToken = token as Tokens.Codespan;\n                    out += renderer.codespan(codespanToken.text);\n                    break;\n                }\n                case 'br': {\n                    out += renderer.br();\n                    break;\n                }\n                case 'del': {\n                    const delToken = token as Tokens.Del;\n                    out += renderer.del(this.parseInline(delToken.tokens, renderer));\n                    break;\n                }\n                case 'text': {\n                    const textToken = token as Tokens.Text;\n                    out += renderer.text(textToken.text);\n                    break;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    } else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n}\n","import {_getDefaults} from './defaults';\nimport {escape} from './helpers';\nimport {_Hooks} from './Hooks';\nimport {_Lexer} from './Lexer';\nimport type {MarkedExtension, MarkedOptions} from './MarkedOptions';\nimport {_Parser} from './Parser';\nimport {_Renderer} from './Renderer';\nimport {_TextRenderer} from './TextRenderer';\nimport {_Tokenizer} from './Tokenizer';\nimport type {Token, Tokens, TokensList} from './Tokens';\n\nexport type MaybePromise = void | Promise<void>;\n\ntype UnknownFunction = (...args: unknown[]) => unknown;\ntype GenericRendererFunction = (...args: unknown[]) => string | false;\n\nexport class Marked {\n    Hooks = _Hooks;\n    Lexer = _Lexer;\n    Parser = _Parser;\n    Renderer = _Renderer;\n    TextRenderer = _TextRenderer;\n    Tokenizer = _Tokenizer;\n    defaults = _getDefaults();\n    options = this.setOptions;\n    parse = this.#parseMarkdown(_Lexer.lex, _Parser.parse);\n    parseInline = this.#parseMarkdown(_Lexer.lexInline, _Parser.parseInline);\n\n    constructor(...args: MarkedExtension[]) {\n        this.use(...args);\n    }\n\n    lexer(src: string, options?: MarkedOptions) {\n        return _Lexer.lex(src, options ?? this.defaults);\n    }\n\n    parser(tokens: Token[], options?: MarkedOptions) {\n        return _Parser.parse(tokens, options ?? this.defaults);\n    }\n\n    setOptions(opt: MarkedOptions) {\n        this.defaults = {...this.defaults, ...opt};\n        return this;\n    }\n\n    use(...args: MarkedExtension[]) {\n        const extensions: MarkedOptions['extensions'] = this.defaults.extensions || {renderers: {}, childTokens: {}};\n\n        args.forEach((pack) => {\n            // copy options to new object\n            const opts = {...pack} as unknown as MarkedOptions;\n\n            // set async to true if it was set to true before\n            opts.async = this.defaults.async || opts.async || false;\n\n            // ==-- Parse \"addon\" extensions --== //\n            if (pack.extensions) {\n                pack.extensions.forEach((ext) => {\n                    if (!ext.name) {\n                        throw new Error('extension name required');\n                    }\n                    if ('renderer' in ext) { // Renderer extensions\n                        const prevRenderer = extensions.renderers[ext.name];\n                        if (prevRenderer) {\n                            // Replace extension with func to run new extension but fall back if false\n                            extensions.renderers[ext.name] = function (...args) {\n                                let ret = ext.renderer.apply(this, args);\n                                if (ret === false) {\n                                    ret = prevRenderer.apply(this, args);\n                                }\n                                return ret;\n                            };\n                        } else {\n                            extensions.renderers[ext.name] = ext.renderer;\n                        }\n                    }\n                    if ('tokenizer' in ext) { // Tokenizer Extensions\n                        if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {\n                            throw new Error('extension level must be \\'block\\' or \\'inline\\'');\n                        }\n                        const extLevel = extensions[ext.level];\n                        if (extLevel) {\n                            extLevel.unshift(ext.tokenizer);\n                        } else {\n                            extensions[ext.level] = [ext.tokenizer];\n                        }\n                        if (ext.start) { // Function to check for start of token\n                            if (ext.level === 'block') {\n                                if (extensions.startBlock) {\n                                    extensions.startBlock.push(ext.start);\n                                } else {\n                                    extensions.startBlock = [ext.start];\n                                }\n                            } else {\n                                if (ext.level === 'inline') {\n                                    if (extensions.startInline) {\n                                        extensions.startInline.push(ext.start);\n                                    } else {\n                                        extensions.startInline = [ext.start];\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if ('childTokens' in ext && ext.childTokens) { // Child tokens to be visited by walkTokens\n                        extensions.childTokens[ext.name] = ext.childTokens;\n                    }\n                });\n                opts.extensions = extensions;\n            }\n\n            // ==-- Parse \"overwrite\" extensions --== //\n            if (pack.renderer) {\n                const renderer = this.defaults.renderer || new _Renderer(this.defaults);\n                for (const prop in pack.renderer) {\n                    if (!(prop in renderer)) {\n                        throw new Error(`renderer '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const rendererProp = prop as Exclude<keyof _Renderer, 'options'>;\n                    const rendererFunc = pack.renderer[rendererProp] as GenericRendererFunction;\n                    const prevRenderer = renderer[rendererProp] as GenericRendererFunction;\n                    // Replace renderer with func to run extension, but fall back if false\n                    renderer[rendererProp] = (...args: unknown[]) => {\n                        let ret = rendererFunc.apply(renderer, args);\n                        if (ret === false) {\n                            ret = prevRenderer.apply(renderer, args);\n                        }\n                        return ret || '';\n                    };\n                }\n                opts.renderer = renderer;\n            }\n            if (pack.tokenizer) {\n                const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\n                for (const prop in pack.tokenizer) {\n                    if (!(prop in tokenizer)) {\n                        throw new Error(`tokenizer '${prop}' does not exist`);\n                    }\n                    if (['options', 'rules', 'lexer'].includes(prop)) {\n                        // ignore options, rules, and lexer properties\n                        continue;\n                    }\n                    const tokenizerProp = prop as Exclude<keyof _Tokenizer, 'options' | 'rules' | 'lexer'>;\n                    const tokenizerFunc = pack.tokenizer[tokenizerProp] as UnknownFunction;\n                    const prevTokenizer = tokenizer[tokenizerProp] as UnknownFunction;\n\n                    // Replace tokenizer with func to run extension, but fall back if false\n                    // @ts-ignore\n                    tokenizer[tokenizerProp] = (...args: unknown[]) => {\n                        let ret = tokenizerFunc.apply(tokenizer, args);\n                        if (ret === false) {\n                            ret = prevTokenizer.apply(tokenizer, args);\n                        }\n                        return ret;\n                    };\n                }\n                opts.tokenizer = tokenizer;\n            }\n\n            // ==-- Parse Hooks extensions --== //\n            if (pack.hooks) {\n                const hooks = this.defaults.hooks || new _Hooks();\n                for (const prop in pack.hooks) {\n                    if (!(prop in hooks)) {\n                        throw new Error(`hook '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const hooksProp = prop as Exclude<keyof _Hooks, 'options'>;\n                    const hooksFunc = pack.hooks[hooksProp] as UnknownFunction;\n                    const prevHook = hooks[hooksProp] as UnknownFunction;\n                    if (_Hooks.passThroughHooks.has(prop)) {\n                        // @ts-ignore\n                        hooks[hooksProp] = (arg: unknown) => {\n                            if (this.defaults.async) {\n                                return Promise.resolve(hooksFunc.call(hooks, arg)).then(ret => {\n                                    return prevHook.call(hooks, ret);\n                                });\n                            }\n\n                            const ret = hooksFunc.call(hooks, arg);\n                            return prevHook.call(hooks, ret);\n                        };\n                    } else {\n                        // @ts-ignore\n                        hooks[hooksProp] = (...args: unknown[]) => {\n                            let ret = hooksFunc.apply(hooks, args);\n                            if (ret === false) {\n                                ret = prevHook.apply(hooks, args);\n                            }\n                            return ret;\n                        };\n                    }\n                }\n                opts.hooks = hooks;\n            }\n\n            // ==-- Parse WalkTokens extensions --== //\n            if (pack.walkTokens) {\n                const walkTokens = this.defaults.walkTokens;\n                const packWalktokens = pack.walkTokens;\n                opts.walkTokens = function (token) {\n                    let values: MaybePromise[] = [];\n                    values.push(packWalktokens.call(this, token));\n                    if (walkTokens) {\n                        values = values.concat(walkTokens.call(this, token));\n                    }\n                    return values;\n                };\n            }\n\n            this.defaults = {...this.defaults, ...opts};\n        });\n\n        return this;\n    }\n\n    /**\n     * Run callback for every token\n     */\n    walkTokens(tokens: Token[] | TokensList, callback: (token: Token) => MaybePromise | MaybePromise[]) {\n        let values: MaybePromise[] = [];\n        for (const token of tokens) {\n            values = values.concat(callback.call(this, token));\n            switch (token.type) {\n                case 'table': {\n                    const tableToken = token as Tokens.Table;\n                    for (const cell of tableToken.header) {\n                        values = values.concat(this.walkTokens(cell.tokens, callback));\n                    }\n                    for (const row of tableToken.rows) {\n                        for (const cell of row) {\n                            values = values.concat(this.walkTokens(cell.tokens, callback));\n                        }\n                    }\n                    break;\n                }\n                case 'list': {\n                    const listToken = token as Tokens.List;\n                    values = values.concat(this.walkTokens(listToken.items, callback));\n                    break;\n                }\n                default: {\n                    const genericToken = token as Tokens.Generic;\n                    if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\n                        this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\n                            const tokens = genericToken[childTokens].flat(Infinity) as Token[] | TokensList;\n                            values = values.concat(this.walkTokens(tokens, callback));\n                        });\n                    } else {\n                        if (genericToken.tokens) {\n                            values = values.concat(this.walkTokens(genericToken.tokens, callback));\n                        }\n                    }\n                }\n            }\n        }\n        return values;\n    }\n\n    // @ts-ignore\n    #onError(silent: boolean, async: boolean) {\n        return (e: Error): string | Promise<string> => {\n            e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n\n            if (silent) {\n                const msg = '<p>An error occurred:</p><pre>'\n                    + escape(e.message + '', true)\n                    + '</pre>';\n                if (async) {\n                    return Promise.resolve(msg);\n                }\n                return msg;\n            }\n\n            if (async) {\n                return Promise.reject(e);\n            }\n            throw e;\n        };\n    }\n\n    // @ts-ignore\n    #parseMarkdown(lexer: (src: string, options?: MarkedOptions) => TokensList | Token[], parser: (tokens: Token[], options?: MarkedOptions) => string) {\n        return (src: string, options?: MarkedOptions | undefined | null): string | Promise<string> => {\n            const origOpt = {...options};\n            const opt = {...this.defaults, ...origOpt};\n\n            // Show warning if an extension set async to true but the parse was called with async: false\n            if (this.defaults.async === true && origOpt.async === false) {\n                if (!opt.silent) {\n                    console.warn(\n                        'marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored.');\n                }\n\n                opt.async = true;\n            }\n\n            const throwError = this.#onError(!!opt.silent, !!opt.async);\n\n            // throw error in case of non string input\n            if (typeof src === 'undefined' || src === null) {\n                return throwError(new Error('marked(): input parameter is undefined or null'));\n            }\n            if (typeof src !== 'string') {\n                return throwError(new Error('marked(): input parameter is of type '\n                    + Object.prototype.toString.call(src) + ', string expected'));\n            }\n\n            if (opt.hooks) {\n                opt.hooks.options = opt;\n            }\n\n            if (opt.async) {\n                return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src)\n                              .then(src => lexer(src, opt))\n                              .then(tokens => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens)\n                              .then(\n                                  tokens => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(\n                                      () => tokens) : tokens)\n                              .then(tokens => parser(tokens, opt))\n                              .then(html => opt.hooks ? opt.hooks.postprocess(html) : html)\n                              .catch(throwError);\n            }\n\n            try {\n                if (opt.hooks) {\n                    src = opt.hooks.preprocess(src) as string;\n                }\n                let tokens = lexer(src, opt);\n                if (opt.hooks) {\n                    tokens = opt.hooks.processAllTokens(tokens) as Token[] | TokensList;\n                }\n                if (opt.walkTokens) {\n                    this.walkTokens(tokens, opt.walkTokens);\n                }\n                let html = parser(tokens, opt);\n                if (opt.hooks) {\n                    html = opt.hooks.postprocess(html) as string;\n                }\n                return html;\n            } catch (e) {\n                return throwError(e as Error);\n            }\n        };\n    }\n}\n","import {_defaults, _getDefaults, changeDefaults} from './defaults';\nimport {_Hooks} from './Hooks';\nimport type {MaybePromise} from './Instance';\nimport {Marked} from './Instance';\nimport {_Lexer} from './Lexer';\nimport type {MarkedExtension, MarkedOptions} from './MarkedOptions';\nimport {_Parser} from './Parser';\nimport {_Renderer} from './Renderer';\nimport {_TextRenderer} from './TextRenderer';\nimport {_Tokenizer} from './Tokenizer';\nimport type {Token, TokensList} from './Tokens';\n\nconst markedInstance = new Marked();\n\nexport function marked(src: string, opt?: MarkedOptions): string | Promise<string> {\n    return markedInstance.parse(src, opt);\n}\n\n/**\n * Sets the default options.\n *\n * @param options Hash of options\n */\nmarked.options =\n    marked.setOptions = function (options: MarkedOptions) {\n        markedInstance.setOptions(options);\n        marked.defaults = markedInstance.defaults;\n        changeDefaults(marked.defaults);\n        return marked;\n    };\n\n/**\n * Gets the original marked default options.\n */\nmarked.getDefaults = _getDefaults;\n\nmarked.defaults = _defaults;\n\n/**\n * Use Extension\n */\n\nmarked.use = function (...args: MarkedExtension[]) {\n    markedInstance.use(...args);\n    marked.defaults = markedInstance.defaults;\n    changeDefaults(marked.defaults);\n    return marked;\n};\n\n/**\n * Run callback for every token\n */\n\nmarked.walkTokens = function (tokens: Token[] | TokensList, callback: (token: Token) => MaybePromise | MaybePromise[]) {\n    return markedInstance.walkTokens(tokens, callback);\n};\n\n/**\n * Compiles markdown to HTML without enclosing `p` tag.\n *\n * @param src String of markdown source to be compiled\n * @param options Hash of options\n * @return String of compiled HTML\n */\nmarked.parseInline = markedInstance.parseInline;\n\n/**\n * Expose\n */\nmarked.Parser = _Parser;\nmarked.parser = _Parser.parse;\nmarked.Renderer = _Renderer;\nmarked.TextRenderer = _TextRenderer;\nmarked.Lexer = _Lexer;\nmarked.lexer = _Lexer.lex;\nmarked.Tokenizer = _Tokenizer;\nmarked.Hooks = _Hooks;\nmarked.parse = marked;\n\nexport const options = marked.options;\nexport const setOptions = marked.setOptions;\nexport const use = marked.use;\nexport const walkTokens = marked.walkTokens;\nexport const parseInline = marked.parseInline;\nexport const parse = marked;\nexport const parser = _Parser.parse;\nexport const lexer = _Lexer.lex;\nexport {_defaults as defaults, _getDefaults as getDefaults} from './defaults';\nexport {_Lexer as Lexer} from './Lexer';\nexport {_Parser as Parser} from './Parser';\nexport {_Tokenizer as Tokenizer} from './Tokenizer';\nexport {_Renderer as Renderer} from './Renderer';\nexport {_TextRenderer as TextRenderer} from './TextRenderer';\nexport {_Hooks as Hooks} from './Hooks';\nexport {Marked} from './Instance';\nexport type * from './MarkedOptions';\nexport type * from './rules';\nexport type * from './Tokens';\n","import {SnapshotParser} from '../../types/markdown/snapshotParser';\nimport {emptyInnerHtml} from '../../utils/dom/emptyInnerHtml';\nimport {insertCopyToClipboardButton} from '../copyToClipboard/insertCopyToClipboardButton';\nimport {marked} from './marked/marked';\n\nexport const parseMdSnapshot: SnapshotParser = (\n    snapshot,\n    options,\n): string => {\n\n    const {\n        showCodeBlockCopyButton,\n        markdownLinkTarget,\n        syntaxHighlighter,\n        htmlSanitizer,\n    } = options || {};\n\n    const parsedMarkdown = marked(snapshot, {\n        async: false,\n        breaks: true,\n    });\n\n    if (typeof parsedMarkdown !== 'string') {\n        throw new Error('Markdown parsing failed');\n    }\n\n    const element = document.createElement('div');\n    element.innerHTML = htmlSanitizer ? htmlSanitizer(parsedMarkdown) : parsedMarkdown;\n\n    element.querySelectorAll('pre').forEach((block) => {\n        const newBlock = document.createElement('div');\n        newBlock.className = 'code-block';\n\n        const codeElement = block.querySelector('code');\n        if (!codeElement) {\n            // No code can be found, so just copy the innerHTML of the block.\n            const html = block.innerHTML;\n            newBlock.innerHTML = htmlSanitizer ? htmlSanitizer(html) : html;\n            block.replaceWith(newBlock);\n            return;\n        }\n\n        //\n        // When a code block is found\n        // 1. Adjust the class name and HTML structure to style the code block\n        // 2. Apply syntax highlighting\n        // 3. Add a copy to clipboard button\n        // 4. Apply link target\n        //\n\n        let language: string | undefined;\n        for (let i = 0; i < codeElement.classList.length; i++) {\n            const className = codeElement.classList[i];\n            if (className.startsWith('language-')) {\n                language = className.slice(9);\n                break;\n            }\n        }\n\n        const newCodeElement = document.createElement('pre');\n        const newHtml = '<div>' + codeElement.innerHTML + '</div>';\n        newCodeElement.innerHTML = options?.htmlSanitizer ? options.htmlSanitizer(newHtml) : newHtml;\n\n        if (language) {\n            newCodeElement.setAttribute('data-language', language);\n\n            //\n            // Apply syntax highlighting\n            //\n            if (syntaxHighlighter) {\n                const highlight = syntaxHighlighter.createHighlighter();\n                const newHtml = '<div>' + highlight(codeElement.textContent || '', language) + '</div>';\n\n                newCodeElement.innerHTML = htmlSanitizer ? htmlSanitizer(newHtml) : newHtml;\n                newCodeElement.className = 'highlighter-dark';\n            }\n        }\n\n        emptyInnerHtml(newBlock);\n        newBlock.appendChild(newCodeElement);\n        block.replaceWith(newBlock);\n    });\n\n    if (showCodeBlockCopyButton !== false) { // Default to true\n        insertCopyToClipboardButton(element);\n    }\n\n    if (markdownLinkTarget !== 'self') { // Default to 'blank'\n        element.querySelectorAll('a').forEach((link) => {\n            link.setAttribute('target', '_blank');\n        });\n    }\n\n    return element.innerHTML;\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {MessageProps, MessageStatus} from './props';\nimport {applyNewDirectionClassName} from './utils/applyNewDirectionClassName';\nimport {applyNewStatusClassName} from './utils/applyNewStatusClassName';\nimport {createMessageContent} from './utils/createMessageContent';\n\nexport const className = 'nlux-comp-message';\n\nexport const createMessageDom: DomCreator<MessageProps> = (props): HTMLElement => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    const status: MessageStatus = props.status ? props.status : 'complete';\n    applyNewStatusClassName(element, status);\n    applyNewDirectionClassName(element, props.direction);\n\n    if (status === 'streaming') {\n        return element;\n    }\n\n    //\n    // Default status is — rendered\n    //\n\n    if (props.message) {\n        element.append(createMessageContent(props.message, props.format, {\n            htmlSanitizer: props.htmlSanitizer,\n        }));\n    }\n\n    return element;\n};\n","import {MessageDirection} from '../../Message/props';\n\nexport const directionClassName: {[key: string]: string} = {\n    received: 'nlux-comp-chatItem--received',\n    sent: 'nlux-comp-chatItem--sent',\n};\n\nexport const applyNewDirectionClassName = (element: HTMLElement, direction: MessageDirection) => {\n    const directions = Object.keys(directionClassName);\n    directions.forEach((directionName) => {\n        element.classList.remove(directionClassName[directionName]);\n    });\n\n    if (directionClassName[direction]) {\n        element.classList.add(directionClassName[direction]);\n    }\n};\n","import {ConversationLayout} from '../../../../../js/core/src/aiChat/options/conversationOptions';\n\nexport const conversationLayoutClassName: {[key: string]: string} = {\n    bubbles: 'nlux-comp-chatItem--bubblesLayout',\n    list: 'nlux-comp-chatItem--listLayout',\n};\n\nexport const applyNewLayoutClassName = (element: HTMLElement, layout: ConversationLayout) => {\n    const layouts = Object.keys(conversationLayoutClassName);\n    layouts.forEach((layoutName) => {\n        element.classList.remove(conversationLayoutClassName[layoutName]);\n    });\n\n    if (conversationLayoutClassName[layout]) {\n        element.classList.add(conversationLayoutClassName[layout]);\n    }\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {createAvatarDom} from '../Avatar/create';\nimport {AvatarProps} from '../Avatar/props';\nimport {createMessageDom} from '../Message/create';\nimport {MessageProps} from '../Message/props';\nimport {ChatItemProps} from './props';\nimport {applyNewDirectionClassName} from './utils/applyNewDirectionClassName';\nimport {applyNewLayoutClassName} from './utils/applyNewLayoutClassName';\n\nexport const className = 'nlux-comp-chatItem';\n\nexport const participantInfoContainerClassName = 'nlux-comp-chatItem-participantInfo';\nexport const participantNameClassName = 'nlux-comp-chatItem-participantName';\n\nexport const createChatItemDom: DomCreator<ChatItemProps> = (\n    props,\n): HTMLElement => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    const messageProps: MessageProps = {\n        direction: props.direction,\n        status: props.status,\n        message: props.message,\n        htmlSanitizer: props.htmlSanitizer,\n    };\n\n    // Create an avatar if avatar is provided\n    let avatarDom: HTMLElement | undefined;\n    if (props.avatar !== undefined) {\n        const avatarProps: AvatarProps = {\n            name: props.name,\n            avatar: props.avatar,\n        };\n\n        avatarDom = createAvatarDom(avatarProps);\n    }\n\n    // Create name\n    const participantNameDom = document.createElement('span');\n    participantNameDom.classList.add(participantNameClassName);\n    participantNameDom.textContent = props.name;\n\n    // Add persona and name\n    {\n        const participantInfoContainer = document.createElement('div');\n        participantInfoContainer.classList.add(participantInfoContainerClassName);\n\n        if (avatarDom !== undefined) {\n            participantInfoContainer.append(avatarDom);\n        }\n\n        participantInfoContainer.append(participantNameDom);\n        element.append(participantInfoContainer);\n    }\n\n    applyNewDirectionClassName(element, props.direction);\n    applyNewLayoutClassName(element, props.layout);\n\n    const message = createMessageDom(messageProps);\n    element.append(message);\n    return element;\n};\n","import {StandardStreamParser} from '../../types/markdown/streamParser';\nimport {warn} from '../../utils/warn';\nimport {attachCopyClickListener} from '../copyToClipboard/attachCopyClickListener';\nimport {parseMdSnapshot} from '../snapshot/snapshotParser';\n\nconst defaultDelayInMsBeforeComplete = 2000;\nconst defaultDelayInMsBetweenBufferChecks = 8;\nconst endOfStreamChar = '\\n';\n\nconst getScheduler = (type: 'timeout' | 'animationFrame') => {\n    if (type === 'timeout') {\n        return (callback: () => void) => setTimeout(callback, 0);\n    }\n\n    return (callback: () => void) => requestAnimationFrame(callback);\n};\n\nexport const createMdStreamRenderer: StandardStreamParser = (\n    root: HTMLElement,\n    options,\n) => {\n    let streamIsComplete = false;\n\n    const letterByLetter = true;\n    const {onComplete} = options || {};\n\n    //\n    // Buffer to store the chunks of markdown to be parsed\n    // Scheduler to control the speed of the streaming animation\n    //\n    const buffer: string[] = [];\n    const scheduler = getScheduler(\n        options?.skipStreamingAnimation ? 'timeout' : 'animationFrame',\n    );\n\n    //\n    // Container for markdown being parsed and that can be updated\n    //\n    const wipContainer = document.createElement('div');\n    wipContainer.classList.add('md-in-progress');\n    root.append(wipContainer);\n\n    //\n    // Functions to commit the WIP content to the DOM\n    // And to complete the parsing\n    //\n    const commitWipContent = () => {\n        while (wipContainer.firstChild) {\n            const childToCommit = wipContainer.firstChild;\n            if (childToCommit instanceof HTMLElement) {\n                attachCopyClickListener(childToCommit);\n            }\n\n            wipContainer.before(childToCommit);\n        }\n    };\n\n    const completeParsing = () => {\n        streamIsComplete = true;\n        if (parsingInterval) {\n            clearInterval(parsingInterval);\n            parsingInterval = undefined;\n        }\n\n        commitWipContent();\n        wipContainer.remove();\n        onComplete?.();\n    };\n\n    const delayBetweenBufferChecks = (\n        !options?.skipStreamingAnimation && options?.streamingAnimationSpeed && options.streamingAnimationSpeed >= 0\n    ) ? options.streamingAnimationSpeed : (options?.skipStreamingAnimation ? 0 : defaultDelayInMsBetweenBufferChecks);\n\n    const parsingContext: {\n        timeSinceLastProcessing: number;\n        currentMarkdown: string;\n        previousHtml: string | undefined;\n    } = {\n        timeSinceLastProcessing: new Date().getTime(),\n        currentMarkdown: '',\n        previousHtml: undefined,\n    };\n\n    let parsingInterval: number | undefined = setInterval(() => {\n        const nowTime = new Date().getTime();\n        const shouldAutomaticallyCompleteAfterDelay = options?.waitTimeBeforeStreamCompletion !== 'never';\n        if (buffer.length === 0 && shouldAutomaticallyCompleteAfterDelay) {\n            const delayBeforeCompleteParsing = (typeof options?.waitTimeBeforeStreamCompletion === 'number')\n                ? options.waitTimeBeforeStreamCompletion : defaultDelayInMsBeforeComplete;\n\n            if (streamIsComplete || nowTime - parsingContext.timeSinceLastProcessing > delayBeforeCompleteParsing) {\n                completeParsing();\n            }\n\n            return;\n        }\n\n        parsingContext.timeSinceLastProcessing = nowTime;\n        const chunk = buffer.shift();\n        if (chunk === undefined || typeof chunk !== 'string') {\n            return;\n        }\n\n        scheduler(() => {\n            // We should only parse the last chunk (in it release context) instead of the whole text\n            // In order to do that, we need to distinguish between:\n            //   - We will have WIP text to being parsed, and may be incomplete (example: `# Hello, `)\n            //   - Text that is committed to the DOM and will not change (example: `# Hello World!\\n\\n`)\n\n            // Append the new chunk to the raw text and parse\n            const markdownToParse = parsingContext.currentMarkdown + chunk;\n            const parsedHtml = parseMdSnapshot(markdownToParse, options).trim();\n\n            if (typeof parsedHtml !== 'string') {\n                // Remove the last chunk if parsing failed\n                parsingContext.currentMarkdown = parsingContext.currentMarkdown.slice(0, -chunk.length);\n                warn('Markdown parsing failed');\n                return;\n            }\n\n            if (\n                parsingContext.previousHtml &&\n                parsedHtml.length > parsingContext.previousHtml.length &&\n                parsedHtml.startsWith(parsingContext.previousHtml)\n            ) {\n                // Case 1: No changes to the previous HTML — And new HTML added on top of it\n                // Which means the new chunk added new HTML content outside the last parsed markdown\n                // Which means that the last parsed markdown is complete and should be committed to the DOM\n                // Commit the last parsed content to the DOM\n\n                commitWipContent();\n\n                // Extract new HTML and insert it into WIP container\n                const currentHtml = parsedHtml.slice(parsingContext.previousHtml.length).trim();\n                wipContainer.innerHTML = options?.htmlSanitizer ? options.htmlSanitizer(currentHtml) : currentHtml;\n\n                // Focus on everything that is new\n                parsingContext.currentMarkdown = chunk;\n                parsingContext.previousHtml = undefined;\n            } else {\n                // Case 2: Changes to the previous HTML\n                // This means that new chunk goes inside previous HTML and no root level changes\n\n                // Append the new chunk to the current markdown\n                wipContainer.innerHTML = options?.htmlSanitizer ? options.htmlSanitizer(parsedHtml) : parsedHtml;\n\n                // Update the current markdown and previous HTML for the next iteration\n                parsingContext.currentMarkdown = markdownToParse;\n                parsingContext.previousHtml = parsedHtml;\n            }\n        });\n    }, delayBetweenBufferChecks) as unknown as number;\n\n    return {\n        next: (chunk: string) => {\n            if (streamIsComplete) {\n                warn('Stream is already complete. No more chunks can be added');\n                return;\n            }\n\n            if (letterByLetter) {\n                for (const char of chunk) {\n                    buffer.push(char);\n                }\n            } else {\n                buffer.push(chunk);\n            }\n        },\n        complete: () => {\n            buffer.push(endOfStreamChar);\n            streamIsComplete = true;\n        },\n        cancel: () => {\n            if (parsingInterval) {\n                clearInterval(parsingInterval);\n                parsingInterval = undefined;\n            }\n\n            streamIsComplete = true;\n            wipContainer.remove();\n        },\n        error: () => {\n            // No special handling for errors\n            // Just complete the stream\n            streamIsComplete = true;\n        },\n    };\n};\n","import {className as compMessageClassName} from '@shared/components/Message/create';\nimport {\n    directionClassName as compMessageDirectionClassName,\n} from '@shared/components/Message/utils/applyNewDirectionClassName';\nimport {statusClassName as compMessageStatusClassName} from '@shared/components/Message/utils/applyNewStatusClassName';\nimport {createMdStreamRenderer} from '@shared/markdown/stream/streamParser';\nimport {StandardStreamParserOutput} from '@shared/types/markdown/streamParser';\nimport {Ref, RefObject, useEffect, useImperativeHandle, useRef, useState} from 'react';\nimport {ResponseRenderer} from '../../exports/messageOptions';\nimport {StreamContainerImperativeProps, StreamContainerProps} from './props';\n\nexport const StreamContainerComp = function <AiMsg>(\n    props: StreamContainerProps<AiMsg>,\n    ref: Ref<StreamContainerImperativeProps<AiMsg>>,\n) {\n    const {\n        uid,\n        status,\n        responseRenderer,\n        markdownOptions,\n        initialMarkdownMessage,\n        markdownContainersController,\n    } = props;\n\n    const [content, setContent] = useState<Array<AiMsg>>([]);\n\n    // We use references in this component to avoid re-renders — as streaming happens outside of React\n    // rendering cycle, we don't want to trigger re-renders on every chunk of data received.\n    const rootElRef = useRef<HTMLDivElement | null>(null);\n    const rootElRefPreviousValue = useRef<HTMLDivElement | null>(null);\n    const mdStreamParserRef = useRef<StandardStreamParserOutput | null>(null);\n    const appendChunkToStateRef = useRef<((newContent: AiMsg) => void) | null>(null);\n    const [streamContainer, setStreamContainer] = useState<HTMLDivElement>();\n\n    useEffect(() => {\n        if (rootElRef.current !== rootElRefPreviousValue.current) {\n            rootElRefPreviousValue.current = rootElRef.current;\n            setStreamContainer(rootElRef.current || undefined);\n        }\n    }); // No dependencies, this effect should run on every render.\n    // The 'if' statement inside the effect plays a similar role to a useEffect dependency array\n    // to prevent setting the streamContainer state to the same value multiple times.\n\n    useEffect(() => {\n        if (streamContainer) {\n            const element = markdownContainersController.getStreamingDomElement(uid);\n            streamContainer.append(element);\n        }\n    }, [streamContainer]);\n\n    useEffect(() => {\n        appendChunkToStateRef.current = (newContent: AiMsg) => {\n            setContent((prevContent) => [...prevContent, newContent]);\n        };\n    }, [setContent]);\n\n    // We update the stream parser when key options (markdownLinkTarget, syntaxHighlighter, etc.) change.\n    useEffect(() => {\n        const element = markdownContainersController.getStreamingDomElement(uid);\n        mdStreamParserRef.current = createMdStreamRenderer(element, {\n            syntaxHighlighter: markdownOptions?.syntaxHighlighter,\n            htmlSanitizer: markdownOptions?.htmlSanitizer,\n            markdownLinkTarget: markdownOptions?.markdownLinkTarget,\n            showCodeBlockCopyButton: markdownOptions?.showCodeBlockCopyButton,\n            skipStreamingAnimation: markdownOptions?.skipStreamingAnimation,\n            streamingAnimationSpeed: markdownOptions?.streamingAnimationSpeed,\n            waitTimeBeforeStreamCompletion: markdownOptions?.waitTimeBeforeStreamCompletion,\n            onComplete: markdownOptions?.onStreamComplete,\n        });\n\n        if (initialMarkdownMessage) {\n            mdStreamParserRef.current.next(initialMarkdownMessage);\n        }\n\n        return () => {\n            // Technical — The DOM element will be re-used if the same message (with the same UID)\n            // is re-rendered in the chat segment. This is handled by the createStreamingDomService.\n            markdownContainersController.deleteStreamingDomElement(uid);\n        };\n    }, []); // No dependencies, this effect should run only once.\n\n    useEffect(() => {\n        return () => {\n            rootElRefPreviousValue.current = null;\n            mdStreamParserRef.current = null;\n            appendChunkToStateRef.current = null;\n            setStreamContainer(undefined);\n        };\n    }, []);\n\n    useImperativeHandle(ref, () => ({\n        streamChunk: (chunk: AiMsg) => {\n            // This will append the chunk to the state\n            const appendChunkToState = appendChunkToStateRef.current;\n            if (appendChunkToState) {\n                appendChunkToStateRef.current?.(chunk);\n            }\n\n            if (typeof chunk === 'string') {\n                mdStreamParserRef.current?.next(chunk);\n            }\n        },\n        completeStream: () => {\n            mdStreamParserRef.current?.complete();\n        },\n        cancelStream: () => {\n            mdStreamParserRef.current?.cancel();\n        },\n    }), []);\n\n    const compDirectionClassName = compMessageDirectionClassName['received'];\n    const compStatusClassName = compMessageStatusClassName[status];\n    const className = `${compMessageClassName} ${compStatusClassName} ${compDirectionClassName}`;\n    const StreamResponseRendererComp = responseRenderer ? responseRenderer as ResponseRenderer<AiMsg> : undefined;\n\n    return <div className={className}>\n        {StreamResponseRendererComp && (\n            <StreamResponseRendererComp\n                uid={uid}\n                status={status}\n                containerRef={rootElRef as RefObject<never>}\n                content={content}\n                contentType={'text'}\n                serverResponse={[]}\n                dataTransferMode={'stream'}\n            />\n        )}\n        {!StreamResponseRendererComp && (\n            <div className={'nlux-markdownStream-root'} ref={rootElRef}/>\n        )}\n    </div>;\n};\n","import {attachCopyClickListener} from '@shared/markdown/copyToClipboard/attachCopyClickListener';\nimport {parseMdSnapshot} from '@shared/markdown/snapshot/snapshotParser';\nimport {SnapshotParserOptions} from '@shared/types/markdown/snapshotParser';\nimport {isSubmitShortcutKey} from '@shared/utils/isSubmitShortcutKey';\nimport {warn} from '@shared/utils/warn';\nimport {Component, FocusEvent, KeyboardEvent, PropsWithChildren, useCallback, useEffect, useMemo, useRef} from 'react';\n\ntype MarkdownSnapshotRendererProps = {\n    messageUid: string;\n    content: string;\n    markdownOptions?: SnapshotParserOptions;\n    onMarkdownRenderingError?: (error: Error) => void;\n    canResubmit?: boolean;\n    onResubmit?: (newPrompt: string) => void;\n    submitShortcutKey?: 'Enter' | 'CommandEnter';\n};\n\nconst MarkdownSnapshotRendererImpl = (props: MarkdownSnapshotRendererProps) => {\n    const {markdownOptions} = props;\n    const markdownContainerRef = useRef<HTMLDivElement>(null);\n\n    const parsedContent = useMemo(() => {\n        if (!props.content) {\n            return '';\n        }\n\n        return parseMdSnapshot(props.content, {\n            syntaxHighlighter: markdownOptions?.syntaxHighlighter,\n            htmlSanitizer: markdownOptions?.htmlSanitizer,\n            markdownLinkTarget: markdownOptions?.markdownLinkTarget,\n            showCodeBlockCopyButton: markdownOptions?.showCodeBlockCopyButton,\n        });\n    }, [\n        props.content, markdownOptions?.markdownLinkTarget, markdownOptions?.syntaxHighlighter,\n        markdownOptions?.htmlSanitizer, markdownOptions?.showCodeBlockCopyButton,\n    ]);\n\n    useEffect(() => {\n        if (markdownContainerRef.current && markdownOptions?.showCodeBlockCopyButton !== false) {\n            attachCopyClickListener(markdownContainerRef.current);\n        }\n    }, [parsedContent, markdownContainerRef.current, markdownOptions?.showCodeBlockCopyButton]);\n\n    const trustedHtml = useMemo(() => {\n        return markdownOptions?.htmlSanitizer ? markdownOptions.htmlSanitizer(parsedContent) : parsedContent;\n    }, [parsedContent, markdownOptions?.htmlSanitizer]);\n\n    const handleKeyDown = useCallback((event: KeyboardEvent<HTMLDivElement>) => {\n        if (!props.canResubmit) {\n            return;\n        }\n\n        const newPromptTyped = event.currentTarget.textContent;\n        if (!newPromptTyped) {\n            return;\n        }\n\n        if (isSubmitShortcutKey(event, props.submitShortcutKey)) {\n            event.preventDefault();\n            if (props.onResubmit) {\n                props.onResubmit(newPromptTyped);\n            }\n\n            return;\n        }\n\n        if (event.key === 'Escape') {\n            event.preventDefault();\n            event.currentTarget.textContent = props.content;\n            event.currentTarget.blur();\n        }\n    }, [props.canResubmit, props.onResubmit, props.content]);\n\n    const handleBlur = useCallback((event: FocusEvent<HTMLDivElement>) => {\n        if (!props.canResubmit) {\n            return;\n        }\n\n        event.preventDefault();\n        event.currentTarget.textContent = props.content;\n        event.currentTarget.blur();\n    }, [props.canResubmit, props.content]);\n\n    const handleFocus = useCallback((event: FocusEvent<HTMLDivElement>) => {\n        if (!props.canResubmit) {\n            return;\n        }\n\n        event.preventDefault();\n        // Select all text when the user focuses on the content\n        const range = document.createRange();\n        range.selectNodeContents(event.currentTarget);\n\n        const selection = window.getSelection();\n        selection?.removeAllRanges();\n        selection?.addRange(range);\n\n    }, [props.canResubmit]);\n\n    const editableStyle = props.canResubmit ? 'editable-markdown-container' : '';\n\n    return (\n        <MarkdownParserErrorBoundary>\n            <div className={`nlux-markdownStream-root${editableStyle ? ` ${editableStyle}` : ''}`}>\n                <div\n                    className={`nlux-markdown-container`}\n                    ref={markdownContainerRef}\n                    dangerouslySetInnerHTML={{__html: trustedHtml}}\n                    contentEditable={props.canResubmit}\n                    onKeyDown={handleKeyDown}\n                    onBlur={handleBlur}\n                    onFocus={handleFocus}\n                />\n            </div>\n        </MarkdownParserErrorBoundary>\n    );\n};\n\nclass MarkdownParserErrorBoundary extends Component<{\n    onMarkdownRenderingError?: (error: Error) => void;\n} & PropsWithChildren> {\n    state = {hasError: false};\n\n    static getDerivedStateFromError() {\n        return {hasError: true};\n    }\n\n    componentDidCatch(errorInfo: Error) {\n        warn(\n            'Markdown rendering error occurred. This could be due to a malformed markdown content, ' +\n            'or it could be because the page requires an HTML sanitizer. Please check the error message ' +\n            'for more details and consider configuring NLUX with a compatible sanitizer.',\n        );\n\n        if (this.props.onMarkdownRenderingError) {\n            this.props.onMarkdownRenderingError(errorInfo);\n        }\n    }\n\n    render() {\n        if (this.state.hasError) {\n            return null;\n        }\n\n        return this.props.children;\n    }\n}\n\nexport const MarkdownSnapshotRenderer = (props: MarkdownSnapshotRendererProps) => {\n    return (\n        <MarkdownParserErrorBoundary>\n            <MarkdownSnapshotRendererImpl {...props}/>\n        </MarkdownParserErrorBoundary>\n    );\n};\n","import {StreamedServerComponent} from '@shared/types/adapters/chat/serverComponentChatAdapter';\nimport {FC, FunctionComponent, isValidElement} from 'react';\nimport {ResponseRendererProps} from '../../../exports/messageOptions';\nimport {MarkdownSnapshotRenderer} from '../../MessageRenderer/MarkdownSnapshotRenderer';\nimport {ChatItemProps} from '../props';\n\nexport const useAssistantMessageRenderer = function <AiMsg>(\n    props: ChatItemProps<AiMsg>,\n): FunctionComponent {\n    const {\n        uid,\n        status,\n        dataTransferMode,\n        contentType,\n        fetchedContent,\n        streamedContent,\n        streamedServerResponse,\n        fetchedServerResponse,\n        direction,\n        messageOptions,\n    } = props;\n\n    //\n    // A custom response renderer is provided by the user.\n    //\n    if (messageOptions?.responseRenderer !== undefined) {\n        //\n        // Streaming into a custom renderer.\n        //\n        if (dataTransferMode === 'stream') {\n            const props: ResponseRendererProps<AiMsg> = {\n                uid,\n                status,\n                dataTransferMode,\n                contentType,\n                content: streamedContent ?? [],\n                serverResponse: streamedServerResponse ?? [],\n            };\n\n            return () => {\n                const Comp = (messageOptions.responseRenderer as FC<ResponseRendererProps<AiMsg>>);\n                return <Comp {...props} />;\n            };\n        }\n\n        //\n        // Batching data and displaying it in a custom renderer.\n        //\n        const isServerComponent = isValidElement(fetchedContent);\n        const serverComponent = isServerComponent ?\n            (fetchedContent as unknown as StreamedServerComponent)\n            : undefined;\n\n        const content: AiMsg[] = !fetchedContent\n            ? []\n            : (isServerComponent ? [] : [(fetchedContent as AiMsg)]);\n\n        const props: ResponseRendererProps<AiMsg> = {\n            uid,\n            status: 'complete',\n            dataTransferMode,\n            contentType,\n            content,\n            serverComponent,\n            serverResponse: fetchedServerResponse ? [fetchedServerResponse] : [],\n        };\n\n        return () => {\n            const Comp = (messageOptions.responseRenderer as FC<ResponseRendererProps<AiMsg>>);\n            return <Comp {...props} />;\n        };\n    }\n\n    if (direction === 'sent') {\n        if (typeof fetchedContent === 'string') {\n            const messageToRender: string = fetchedContent;\n            return () => <>{messageToRender}</>;\n        }\n\n        return () => '';\n    }\n\n    if (typeof fetchedContent === 'string') {\n        const messageToRender: string = fetchedContent;\n        return () => (\n            <MarkdownSnapshotRenderer\n                messageUid={uid}\n                content={messageToRender}\n                markdownOptions={{\n                    syntaxHighlighter: messageOptions?.syntaxHighlighter,\n                    htmlSanitizer: messageOptions?.htmlSanitizer,\n                    markdownLinkTarget: messageOptions?.markdownLinkTarget,\n                    showCodeBlockCopyButton: messageOptions?.showCodeBlockCopyButton,\n                    skipStreamingAnimation: messageOptions?.skipStreamingAnimation,\n                }}\n            />\n        );\n    }\n\n    if (isValidElement(fetchedContent)) {\n        return () => <>{fetchedContent}</>;\n    }\n\n    // No custom renderer and message is not a string!\n    return () => '';\n};\n","import {className as compAvatarClassName} from '@shared/components/Avatar/create';\nimport {\n    renderedPhotoClassName as compAvatarPhotoClassName,\n    renderedPhotoContainerClassName as compAvatarPhotoContainerClassName,\n} from '@shared/components/Avatar/utils/createPhotoContainerFromUrl';\nimport {isValidElement} from 'react';\nimport {AvatarProps} from './props';\n\nexport const AvatarComp = (props: AvatarProps) => {\n    const isAvatarUrl = typeof props.avatar === 'string';\n    const isAvatarElement = !isAvatarUrl && isValidElement(props.avatar);\n\n    return (\n        <div className={compAvatarClassName}>\n            {isAvatarElement && props.avatar}\n            {!isAvatarElement && isAvatarUrl && (\n                <div className={compAvatarPhotoContainerClassName}>\n                    {props.avatar && (\n                        <div\n                            className={compAvatarPhotoClassName}\n                            style={{\n                                backgroundImage: `url(\"${encodeURI(props.avatar as string)}\")`,\n                            }}\n                        />\n                    )}\n                </div>\n            )}\n        </div>\n    );\n};\n","import {FunctionComponent, useMemo} from 'react';\nimport {AvatarComp} from '../../../components/Avatar/AvatarComp';\nimport {ChatItemProps} from '../props';\n\nexport const useParticipantInfoRenderer = function <AiMsg>(\n    props: ChatItemProps<AiMsg>,\n): FunctionComponent {\n    const participantInfo = useMemo(() => {\n        return (\n            <div className=\"nlux-comp-chatItem-participantInfo\">\n                {(props.avatar !== undefined) && (\n                    <AvatarComp name={props.name} avatar={props.avatar}/>\n                )}\n                <span className=\"nlux-comp-chatItem-participantName\">{props.name}</span>\n            </div>\n        );\n\n    }, [props.avatar, props.name]);\n\n    return () => <>{participantInfo}</>;\n};\n","import {FunctionComponent, useCallback} from 'react';\nimport {MarkdownSnapshotRenderer} from '../../MessageRenderer/MarkdownSnapshotRenderer';\nimport {ChatItemProps} from '../props';\n\nexport const useUserMessageRenderer = function <AiMsg>(\n    props: ChatItemProps<AiMsg>,\n): FunctionComponent {\n    return useCallback(() => {\n        if (props.messageOptions?.promptRenderer === undefined) {\n            return (\n                <MarkdownSnapshotRenderer\n                    messageUid={props.uid}\n                    content={props.fetchedContent as string}\n                    markdownOptions={{\n                        htmlSanitizer: props.messageOptions?.htmlSanitizer,\n                        // User message does not need syntax highlighting, advanced markdown options\n                        // Only HTML sanitization is needed\n                    }}\n                    canResubmit={props.messageOptions?.editableUserMessages}\n                    submitShortcutKey={props.submitShortcutKey}\n                    onResubmit={(newPrompt) => {\n                        props.onPromptResubmit ? props.onPromptResubmit(newPrompt) : undefined;\n                    }}\n                />\n            );\n        }\n\n        const PromptRenderer = props.messageOptions.promptRenderer;\n        const onResubmit = (newPrompt: string) => {\n            props.onPromptResubmit ? props.onPromptResubmit(newPrompt) : undefined;\n        };\n\n        return (\n            <PromptRenderer\n                uid={props.uid}\n                prompt={props.fetchedContent as string}\n                onResubmit={onResubmit}\n            />\n        );\n    }, [props.messageOptions?.promptRenderer, props.fetchedContent, props.uid]);\n};","import {className as compChatItemClassName} from '@shared/components/ChatItem/create';\nimport {\n    directionClassName as compChatItemDirectionClassName,\n} from '@shared/components/ChatItem/utils/applyNewDirectionClassName';\nimport {conversationLayoutClassName} from '@shared/components/ChatItem/utils/applyNewLayoutClassName';\nimport {className as compMessageClassName} from '@shared/components/Message/create';\nimport {\n    directionClassName as compMessageDirectionClassName,\n} from '@shared/components/Message/utils/applyNewDirectionClassName';\nimport {statusClassName as compMessageStatusClassName} from '@shared/components/Message/utils/applyNewStatusClassName';\nimport {\n    forwardRef,\n    ReactElement,\n    ReactNode,\n    Ref,\n    useCallback,\n    useEffect,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n} from 'react';\nimport {StreamContainerImperativeProps} from '../StreamContainer/props';\nimport {StreamContainerComp} from '../StreamContainer/StreamContainerComp';\nimport {useAssistantMessageRenderer} from './hooks/useAssistantMessageRenderer';\nimport {useParticipantInfoRenderer} from './hooks/userParticipantInfoRenderer';\nimport {useUserMessageRenderer} from './hooks/useUserMessageRenderer';\nimport {ChatItemImperativeProps, ChatItemProps} from './props';\n\nexport const ChatItemComp: <AiMsg>(\n    props: ChatItemProps<AiMsg>,\n    ref: Ref<ChatItemImperativeProps<AiMsg>>,\n) => ReactElement = function <AiMsg>(\n    props: ChatItemProps<AiMsg>,\n    ref: Ref<ChatItemImperativeProps<AiMsg>>,\n): ReactElement {\n    const streamContainer = useRef<\n        StreamContainerImperativeProps<AiMsg> | null>(null);\n\n    useImperativeHandle(ref, () => ({\n        streamChunk: (chunk: AiMsg) => setTimeout(() => streamContainer?.current?.streamChunk(chunk)),\n        completeStream: () => setTimeout(() => streamContainer?.current?.completeStream()),\n        cancelStream: () => streamContainer?.current?.cancelStream(),\n    }), []);\n\n    const isServerComponent = props.contentType === 'server-component';\n    const isAssistantMessage = props.direction === 'received';\n    const isUserMessage = props.direction === 'sent';\n    const isStreamed = props.dataTransferMode === 'stream';\n    const isPartOfInitialSegment = props.isPartOfInitialSegment;\n\n    const markdownStreamRenderedCallback = useCallback(() => props.onMarkdownStreamRendered?.(props.uid), [props.uid]);\n    useEffect(() => {\n        if (!isStreamed && !isServerComponent && !isPartOfInitialSegment) {\n            props.onMarkdownStreamRendered?.(props.uid);\n        }\n    }, []);\n\n    const AssistantBatchedMessage = useAssistantMessageRenderer(props);\n    const UserMessage = useUserMessageRenderer(props);\n    const ForwardRefStreamContainerComp = useMemo(() => forwardRef(StreamContainerComp<AiMsg>), []);\n    const ParticipantInfo = useParticipantInfoRenderer(props);\n\n    const directionClassNameForChatItem = props.direction\n        ? compChatItemDirectionClassName[props.direction]\n        : compChatItemDirectionClassName['received'];\n    const convStyleClassName = props.layout === 'bubbles'\n        ? conversationLayoutClassName['bubbles']\n        : conversationLayoutClassName['list'];\n    const containerClassName = `${compChatItemClassName} ${directionClassNameForChatItem} ${convStyleClassName}`;\n\n    const messageStatusClassName = props.status\n        ? compMessageStatusClassName[props.status]\n        : compMessageStatusClassName['rendered'];\n    const messageDirectionClassName = props.direction\n        ? compMessageDirectionClassName[props.direction]\n        : compMessageDirectionClassName['received'];\n    const messageClassName = `${compMessageClassName} ${messageStatusClassName} ${messageDirectionClassName}`;\n\n    return (\n        <div className={containerClassName}>\n            <ParticipantInfo/>\n            {isAssistantMessage && isStreamed && !isServerComponent && (\n                <ForwardRefStreamContainerComp\n                    key={'do-not-change'}\n                    uid={props.uid}\n                    status={props.status}\n                    ref={streamContainer}\n                    direction={props.direction}\n                    responseRenderer={props.messageOptions?.responseRenderer}\n                    markdownContainersController={props.markdownContainersController}\n                    markdownOptions={{\n                        syntaxHighlighter: props.messageOptions?.syntaxHighlighter,\n                        htmlSanitizer: props.messageOptions?.htmlSanitizer,\n                        markdownLinkTarget: props.messageOptions?.markdownLinkTarget,\n                        showCodeBlockCopyButton: props.messageOptions?.showCodeBlockCopyButton,\n                        skipStreamingAnimation: props.messageOptions?.skipStreamingAnimation,\n                        streamingAnimationSpeed: props.messageOptions?.streamingAnimationSpeed,\n                        waitTimeBeforeStreamCompletion: props.messageOptions?.waitTimeBeforeStreamCompletion,\n                        onStreamComplete: markdownStreamRenderedCallback,\n                    }}\n                />\n            )}\n            {isAssistantMessage && isStreamed && isServerComponent && (\n                <div className={messageClassName}>\n                    {props.fetchedContent as ReactNode}\n                </div>\n            )}\n            {isAssistantMessage && !isStreamed && (\n                <div className={messageClassName}>\n                    <AssistantBatchedMessage/>\n                </div>\n            )}\n            {isUserMessage && (\n                <div className={messageClassName}>\n                    <UserMessage/>\n                </div>\n            )}\n        </div>\n    );\n};\n","import {StreamedServerComponent} from '@shared/types/adapters/chat/serverComponentChatAdapter';\nimport {ChatSegmentItem} from '@shared/types/chatSegment/chatSegment';\nimport {FunctionComponent, MutableRefObject, ReactNode, RefObject, useEffect} from 'react';\nimport {ChatItemImperativeProps} from '../ChatItem/props';\n\nexport const useItemsRefs = <AiMsg>(\n    chatSegmentItems: ChatSegmentItem<AiMsg>[],\n    serverComponentsRef: MutableRefObject<Map<string, ReactNode | StreamedServerComponent>>,\n    serverComponentsFunctionsRef: MutableRefObject<Map<string, FunctionComponent>>,\n    chatItemsRef: Map<string, RefObject<ChatItemImperativeProps<AiMsg>>>,\n) => {\n    useEffect(() => {\n        if (chatSegmentItems.length === 0) {\n            chatItemsRef.clear();\n            serverComponentsRef.current.clear();\n            serverComponentsFunctionsRef.current.clear();\n            return;\n        }\n\n        const itemsInRefsMap = new Set<string>(chatItemsRef.keys());\n        const itemsInSegments = new Set<string>(chatSegmentItems.map((item) => item.uid));\n        itemsInRefsMap.forEach((itemInRefsMap) => {\n            if (!itemsInSegments.has(itemInRefsMap)) {\n                chatItemsRef.delete(itemInRefsMap);\n            }\n        });\n\n        const serverComponentsInRefsMap = new Set<string>(serverComponentsRef.current.keys());\n        serverComponentsInRefsMap.forEach((itemInRefsMap) => {\n            if (!itemsInSegments.has(itemInRefsMap)) {\n                serverComponentsRef.current.delete(itemInRefsMap);\n                serverComponentsFunctionsRef.current.delete(itemInRefsMap);\n            }\n        });\n    }, [chatSegmentItems]);\n};\n","import {ParticipantRole} from '@nlux/core';\nimport {PersonaOptions} from '../../../exports/personaOptions';\n\nexport const avatarFromMessageAndPersona = (\n    role: ParticipantRole,\n    personaOptions?: PersonaOptions,\n) => {\n    if (role === 'assistant') {\n        return personaOptions?.assistant?.avatar;\n    }\n\n    if (role === 'user') {\n        return personaOptions?.user?.avatar;\n    }\n\n    return undefined;\n};\n","export const isPrimitiveReactNodeType = (value: unknown) => {\n    return typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean' || value === null\n        || value === undefined;\n};\n","import {StreamedServerComponent} from '@shared/types/adapters/chat/serverComponentChatAdapter';\nimport {ChatSegment, ChatSegmentItem} from '@shared/types/chatSegment/chatSegment';\nimport {AiBatchedMessage} from '@shared/types/chatSegment/chatSegmentAiMessage';\nimport {participantNameFromRoleAndPersona} from '@shared/utils/chat/participantNameFromRoleAndPersona';\nimport {getChatSegmentClassName} from '@shared/utils/dom/getChatSegmentClassName';\nimport {warn, warnOnce} from '@shared/utils/warn';\nimport {\n    createRef,\n    forwardRef,\n    ForwardRefExoticComponent,\n    FunctionComponent,\n    isValidElement,\n    MutableRefObject,\n    ReactNode,\n    Ref,\n    RefAttributes,\n    RefObject,\n    useCallback,\n    useEffect,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState,\n} from 'react';\nimport {ChatItemComp} from '../ChatItem/ChatItemComp';\nimport {ChatItemImperativeProps, ChatItemProps} from '../ChatItem/props';\nimport {ChatSegmentImperativeProps, ChatSegmentProps} from './props';\nimport {useItemsRefs} from './useItemsRefs';\nimport {avatarFromMessageAndPersona} from './utils/avatarFromMessageAndPersona';\nimport {isPrimitiveReactNodeType} from './utils/isPrimitiveReactNodeType';\n\nexport const ChatSegmentComp: <AiMsg>(\n    props: ChatSegmentProps<AiMsg>,\n    ref: Ref<ChatSegmentImperativeProps<AiMsg>>,\n) => ReactNode = function <AiMsg>(\n    props: ChatSegmentProps<AiMsg>,\n    ref: Ref<ChatSegmentImperativeProps<AiMsg>>,\n): ReactNode {\n    const {chatSegment, containerRef} = props;\n    const [completeOnInitialRender, setCompleteOnInitialRender] = useState<boolean>(false);\n    const chatItemsRef = useMemo(\n        () => new Map<string, RefObject<ChatItemImperativeProps<AiMsg>>>(), []);\n\n    const chatItemsStreamingBuffer = useMemo(() => new Map<string, Array<AiMsg>>(), []);\n    const serverComponentsRef = useRef<Map<string, ReactNode | StreamedServerComponent>>(new Map());\n    const serverComponentsFunctionsRef = useRef<Map<string, FunctionComponent>>(new Map<string, FunctionComponent>());\n\n    // Updates server component and chat item refs, and server component functions refs\n    // when the chat segment items change.\n    useItemsRefs(chatSegment.items, serverComponentsRef, serverComponentsFunctionsRef, chatItemsRef);\n\n    useImperativeHandle(ref, () => ({\n        streamChunk: (chatItemId: string, chunk: AiMsg) => {\n            const chatItemCompRef = chatItemsRef.get(chatItemId);\n            if (chatItemCompRef?.current) {\n                const streamChunk = chatItemCompRef.current.streamChunk;\n                const chatItemStreamingBuffer = chatItemsStreamingBuffer.get(chatItemId) ?? [];\n                chatItemStreamingBuffer.forEach((bufferedChunk) => {\n                    streamChunk(bufferedChunk);\n                });\n\n                chatItemsStreamingBuffer.delete(chatItemId);\n                streamChunk(chunk);\n            } else {\n                // Buffer the chunk if the chat item is not rendered yet.\n                const chatItemStreamingBuffer = chatItemsStreamingBuffer.get(chatItemId) ?? [];\n                chatItemsStreamingBuffer.set(chatItemId, [...chatItemStreamingBuffer, chunk]);\n            }\n        },\n        completeStream: (chatItemId: string) => {\n            const chatItemCompRef = chatItemsRef.get(chatItemId);\n            if (!chatItemCompRef?.current) {\n                setCompleteOnInitialRender(true);\n                return;\n            }\n\n            chatItemCompRef.current.completeStream();\n            chatItemsRef.delete(chatItemId);\n        },\n        cancelStreams: () => {\n            chatItemsStreamingBuffer.clear();\n            chatItemsRef.forEach((ref) => {\n                ref.current?.cancelStream();\n            });\n        },\n    }), [\n        // setCompleteOnInitialRender is not needed as a dependency here, even though it is used inside.\n    ]);\n\n    // Every time the chat segment is rendered, we check if there are any streamed chunks buffered waiting for a\n    // chat item to be rendered. If buffered chunks are found, along with the chat item reference, we stream the chunks\n    // to the chat item.\n    useEffect(() => {\n        if (chatItemsStreamingBuffer.size > 0) {\n            chatItemsStreamingBuffer.forEach((bufferedChunks, chatItemId) => {\n                const chatItemCompRef = chatItemsRef.get(chatItemId);\n                if (chatItemCompRef?.current) {\n                    // A chat item with buffered chunks is found.\n                    bufferedChunks.forEach((chunk) => {\n                        chatItemCompRef?.current?.streamChunk(chunk);\n                    });\n                    chatItemsStreamingBuffer.delete(chatItemId);\n\n                    if (completeOnInitialRender) {\n                        chatItemCompRef.current.completeStream();\n                        setCompleteOnInitialRender(false);\n                    }\n                }\n            });\n        }\n    }); // No dependencies — We always want to run this effect after every render.\n\n    const Loader = useMemo(() => {\n        if (chatSegment.status !== 'active') {\n            return null;\n        }\n\n        return (<div className={'nlux-chatSegment-loader-container'}>{props.Loader}</div>);\n    }, [chatSegment.status, props.Loader]);\n\n    const ForwardRefChatItemComp = useMemo(() => forwardRef(ChatItemComp<AiMsg>), []);\n\n    const onMarkdownStreamRendered = useCallback((chatItemId: string) => {\n        props.onMarkdownStreamRendered?.(chatSegment.uid, chatItemId);\n    }, []);\n\n    if (chatSegment.items.length === 0) {\n        return null;\n    }\n\n    return (\n        <div ref={containerRef} className={getChatSegmentClassName(chatSegment.status)}>\n            {chatSegment.items.map((chatItem) => chatItemToReactNode(\n                props,\n                ForwardRefChatItemComp,\n                chatSegment,\n                chatItem,\n                chatItemsRef,\n                serverComponentsFunctionsRef,\n                serverComponentsRef,\n                onMarkdownStreamRendered,\n            ))}\n            {Loader}\n        </div>\n    );\n};\n\n//\n// IMPORTANT: The function below is to convert a chat item to a React node.\n//\nconst chatItemToReactNode = function <AiMsg>(\n    props: ChatSegmentProps<AiMsg>,\n    ForwardRefChatItemComp: ForwardRefExoticComponent<ChatItemProps<AiMsg> & RefAttributes<ChatItemImperativeProps<AiMsg>>>,\n    chatSegment: ChatSegment<AiMsg>,\n    chatItem: ChatSegmentItem<AiMsg>,\n    chatItemsRef: Map<string, RefObject<ChatItemImperativeProps<AiMsg>>>,\n    serverComponentsFunctionsRef: MutableRefObject<Map<string, FunctionComponent>>,\n    serverComponentsRef: MutableRefObject<Map<string, ReactNode | StreamedServerComponent>>,\n    onMarkdownStreamRendered: (chatItemId: string) => void,\n): ReactNode {\n\n    const isPartOfInitialSegment = props.isInitialSegment;\n    let ref: RefObject<ChatItemImperativeProps<AiMsg>> | undefined = chatItemsRef.get(chatItem.uid);\n    if (!ref) {\n        ref = createRef<ChatItemImperativeProps<AiMsg>>();\n        chatItemsRef.set(chatItem.uid, ref);\n    }\n\n    //\n    // 2 key variables that are used to store the content to render in the chat item component:\n    // - contentToUse: The content to be used in the chat item component.\n    // - contentType: The type of the content to be used in the chat item component.\n    //\n    let contentToUse: AiMsg[] | ReactNode | StreamedServerComponent | undefined = (chatItem as {\n        content?: Array<AiMsg>\n    }).content;\n    let contentType: 'text' | 'server-component' = 'text';\n\n    //\n    // If the content is a function, we render it as a React component (Use case: React Server Component adapter).\n    // Here are attempting to resolve the server component function to a React element.\n    // We handle the case where the function is not a valid React element in the try/catch block.\n    //\n    if (typeof contentToUse === 'function') {\n        const functionRef = serverComponentsFunctionsRef.current.get(chatItem.uid);\n        const serverComponentRef = serverComponentsRef.current.get(chatItem.uid);\n\n        if (functionRef && serverComponentRef) {\n            contentToUse = serverComponentRef;\n            contentType = 'server-component';\n        } else {\n            serverComponentsRef.current.delete(chatItem.uid);\n            serverComponentsFunctionsRef.current.delete(chatItem.uid);\n\n            try {\n                const ContentToUseFC = contentToUse as FunctionComponent;\n                contentToUse = <ContentToUseFC/>;\n\n                if (!contentToUse || !isValidElement(contentToUse)) {\n                    throw new Error(`Invalid React element returned from the AI chat content function.`);\n                } else {\n                    contentType = 'server-component';\n                    serverComponentsRef.current.set(chatItem.uid, contentToUse);\n                    serverComponentsFunctionsRef.current.set(chatItem.uid, ContentToUseFC);\n                }\n            } catch (_error) {\n                warn(\n                    `The type of the AI chat content is an invalid function.\\n` +\n                    `If you're looking to render a React Server Components, please refer to ` +\n                    `docs.nlkit.com/nlux for more information.\\n`,\n                );\n\n                return null;\n            }\n        }\n    }\n\n    //\n    // Handling user messages, that are always expected to be in complete state.\n    //\n    if (chatItem.participantRole === 'user') {\n\n        // User chat item — That should always be in complete state.\n        if (chatItem.status !== 'complete') {\n            warnOnce(\n                `User chat item should be always be in complete state — ` +\n                `Current status: ${(chatItem as AiBatchedMessage<AiMsg>).status} — ` +\n                `Segment UID: ${chatSegment.uid}`,\n            );\n\n            return null;\n        }\n\n        if (!isPrimitiveReactNodeType(contentToUse)) {\n            warnOnce(\n                `User chat item should have primitive content (string, number, boolean, null) — ` +\n                `Current content: ${JSON.stringify(contentToUse)} — ` +\n                `Segment UID: ${chatSegment.uid}`,\n            );\n\n            return null;\n        }\n\n        return (\n            <ForwardRefChatItemComp\n                ref={ref}\n                key={chatItem.uid}\n                uid={chatItem.uid}\n                status={'complete'}\n                direction={'sent'}\n                contentType={contentType}\n                dataTransferMode={'batch'} // User chat items are always in batch mode.\n\n                fetchedContent={chatItem.content as AiMsg} // Same comp is used for user and AI chat items.\n                markdownContainersController={props.markdownContainersController}\n\n                // Options required for rendering the chat item.\n                layout={props.layout}\n                messageOptions={props.messageOptions}\n                isPartOfInitialSegment={isPartOfInitialSegment}\n                name={participantNameFromRoleAndPersona(chatItem.participantRole, props.personaOptions)}\n                avatar={avatarFromMessageAndPersona(chatItem.participantRole, props.personaOptions)}\n\n                // Using to edit and re-submit user messages.\n                submitShortcutKey={props.submitShortcutKey}\n                onPromptResubmit={(newPrompt) => props.onPromptResubmit(props.chatSegment.uid, chatItem.uid, newPrompt)}\n            />\n        );\n    }\n\n\n    //\n    // At this point, we are sure that the chat item is an AI chat item.\n    // Below, we handle the assistant messages, that can be in complete or active state.\n    //\n\n    // AI chat item in complete state.\n    if (chatItem.status === 'complete') {\n        //\n        // When the AI chat item is in complete state and the data transfer mode is stream,\n        // we do not render the message content — as it is streamed.\n        // We do not rely on custom renderer here since the content is streamed as string.\n        //\n        if (chatItem.dataTransferMode === 'stream') {\n            const typedChatItem = chatItem as {serverResponse?: Array<string | object | undefined>};\n            return (\n                <ForwardRefChatItemComp\n                    ref={ref}\n                    key={chatItem.uid}\n                    uid={chatItem.uid}\n                    status={chatItem.status}\n                    direction={'received'}\n                    contentType={contentType}\n                    dataTransferMode={chatItem.dataTransferMode}\n\n                    markdownContainersController={props.markdownContainersController}\n                    onMarkdownStreamRendered={onMarkdownStreamRendered}\n                    streamedContent={contentToUse as AiMsg[]}\n                    streamedServerResponse={typedChatItem.serverResponse}\n                    // fetchedContent not used in stream mode.\n                    // fetchedServerResponse not used in stream mode.\n\n                    // Options required for rendering the chat item.\n                    layout={props.layout}\n                    messageOptions={props.messageOptions}\n                    isPartOfInitialSegment={isPartOfInitialSegment}\n                    name={participantNameFromRoleAndPersona(chatItem.participantRole, props.personaOptions)}\n                    avatar={avatarFromMessageAndPersona(chatItem.participantRole, props.personaOptions)}\n                />\n            );\n        } else {\n            //\n            // When the AI chat item is in complete state and the data transfer mode is batch,\n            // we render the message content. We also check if the content is primitive and if a custom\n            // renderer is provided.\n            //\n            if (contentType === 'text' && !isPrimitiveReactNodeType(contentToUse)\n                && !props.messageOptions?.responseRenderer) {\n                warn(\n                    `When the type of the AI chat content is not primitive (object or array), ` +\n                    `a custom renderer must be provided — ` +\n                    `Current content: ${JSON.stringify(contentToUse)} — ` +\n                    `Segment UID: ${chatSegment.uid}`,\n                );\n\n                return null;\n            }\n\n            return (\n                <ForwardRefChatItemComp\n                    ref={ref}\n                    key={chatItem.uid}\n                    uid={chatItem.uid}\n                    status={'complete'}\n                    direction={'received'}\n                    contentType={contentType}\n                    dataTransferMode={chatItem.dataTransferMode}\n\n                    markdownContainersController={props.markdownContainersController}\n                    onMarkdownStreamRendered={onMarkdownStreamRendered}\n\n                    fetchedContent={contentToUse as AiMsg}\n                    fetchedServerResponse={chatItem.serverResponse}\n                    // streamedContent not used\n                    // streamedServerResponse not used\n\n                    // Options required for rendering the chat item.\n                    layout={props.layout}\n                    messageOptions={props.messageOptions}\n                    isPartOfInitialSegment={isPartOfInitialSegment}\n                    name={participantNameFromRoleAndPersona(chatItem.participantRole, props.personaOptions)}\n                    avatar={avatarFromMessageAndPersona(chatItem.participantRole, props.personaOptions)}\n                />\n            );\n        }\n    }\n\n    //\n    // AI chat item in streaming state.\n    //\n    if (chatItem.status === 'streaming') {\n\n        // In the case of a server component, we render the server component content.\n        // The server component will be rendered as a React component and its content will be streamed via React RSC\n        // API.\n        const serverComponent = (contentType === 'server-component' && isValidElement(contentToUse))\n            ? contentToUse // Server component content that is being streamed.\n            : undefined;\n\n        // When the content is not a React server component, the streaming will be handled via\n        // markdownContainersController. which will stream the content as a string.\n\n        return (\n            <ForwardRefChatItemComp\n                ref={ref}\n                key={chatItem.uid}\n                uid={chatItem.uid}\n                status={'streaming'}\n                direction={'received'}\n                contentType={contentType}\n                dataTransferMode={chatItem.dataTransferMode}\n\n                markdownContainersController={props.markdownContainersController}\n                onMarkdownStreamRendered={onMarkdownStreamRendered}\n\n                fetchedContent={serverComponent}\n                // fetchedServerResponse not used\n                // streamedContent not used\n                // streamedServerResponse not used\n\n                // Options required for rendering the chat item.\n                layout={props.layout}\n                messageOptions={props.messageOptions}\n                isPartOfInitialSegment={isPartOfInitialSegment}\n                name={participantNameFromRoleAndPersona(chatItem.participantRole, props.personaOptions)}\n                avatar={avatarFromMessageAndPersona(chatItem.participantRole, props.personaOptions)}\n            />\n        );\n    }\n\n    // We do render a chat item on 'loading' or 'error' states:\n    // - On 'loading' state — A loading spinner will be displayed.\n    // - On 'error' state — An error message will be shown.\n};\n","import {ChatSegment} from '@shared/types/chatSegment/chatSegment';\nimport {RefObject, useEffect, useMemo} from 'react';\nimport {ChatSegmentImperativeProps} from '../../ChatSegment/props';\n\nexport const useChatSegmentsController = function <AiMsg>(\n    segments: ChatSegment<AiMsg>[],\n) {\n    const chatSegmentsRef = useMemo(\n        () => new Map<string, RefObject<ChatSegmentImperativeProps<AiMsg>>>(), [],\n    );\n\n    useEffect(() => {\n        if (segments.length === 0) {\n            chatSegmentsRef.clear();\n            return;\n        }\n\n        const itemsInRefsMap = new Set<string>(chatSegmentsRef.keys());\n        const itemsInSegments = new Set<string>(segments.map((segment) => segment.uid));\n        itemsInRefsMap.forEach((itemInRefsMap) => {\n            if (!itemsInSegments.has(itemInRefsMap)) {\n                chatSegmentsRef.delete(itemInRefsMap);\n            }\n        });\n    }, [segments]);\n\n    return {\n        get: (uid: string) => chatSegmentsRef.get(uid)?.current,\n        getRef: (uid: string) => chatSegmentsRef.get(uid),\n        set: (uid: string, ref: RefObject<ChatSegmentImperativeProps<AiMsg>>) => {\n            chatSegmentsRef.set(uid, ref);\n        },\n        remove: (uid: string) => {\n            chatSegmentsRef.delete(uid);\n        },\n    };\n};\n","import {ChatSegment} from '@shared/types/chatSegment/chatSegment';\nimport {RefObject, useEffect, useMemo, useRef} from 'react';\n\nexport const useLastActiveSegment = function <AiMsg>(\n    segments: ChatSegment<AiMsg>[],\n    lastSegmentContainerRef: RefObject<HTMLDivElement>,\n    onLastActiveSegmentChange?: (data: {uid: string; div: HTMLDivElement} | undefined) => void,\n) {\n    const lastActiveSegmentId = useMemo(() => {\n        const lastSegment = segments.length > 0 ? segments[segments.length - 1] : undefined;\n        return lastSegment?.status === 'active' ? lastSegment.uid : undefined;\n    }, [segments]);\n\n    const lastCallbackData = useRef<{uid: string; div: HTMLDivElement} | undefined>(undefined);\n\n    //\n    // Whenever the last active segment div+id changes, call the onLastActiveSegmentChange callback\n    // Since the div is not part of a component state, we need to use a ref to check every render cycle.\n    // We use lastCallbackData to avoid calling the callback if the data hasn't changed.\n    //\n\n    useEffect(() => {\n        if (!onLastActiveSegmentChange) {\n            return;\n        }\n\n        const lastReportedData = lastCallbackData.current;\n        if (lastActiveSegmentId === lastReportedData?.uid\n            && lastSegmentContainerRef.current === lastReportedData?.div) {\n            return;\n        }\n\n        const data = (lastActiveSegmentId && lastSegmentContainerRef.current) ? {\n            uid: lastActiveSegmentId,\n            div: lastSegmentContainerRef.current,\n        } : undefined;\n\n        if (!data && !lastCallbackData.current) {\n            return;\n        }\n\n        onLastActiveSegmentChange(data);\n        lastCallbackData.current = data;\n    });\n\n    // No dependencies on purpose — we want to run this effect on every render cycle\n    // 'if' statements inside the effect will prevent unnecessary calls to the callback\n};\n","import {createRef, forwardRef, ReactNode, Ref, useImperativeHandle, useMemo} from 'react';\nimport {useConversationDisplayStyle} from '../../exports/hooks/useConversationDisplayStyle';\nimport {ChatSegmentComp} from '../ChatSegment/ChatSegmentComp';\nimport {useChatSegmentsController} from './hooks/useChatSegmentsController';\nimport {useLastActiveSegment} from './hooks/useLastActiveSegment';\nimport {ConversationCompProps, ImperativeConversationCompProps} from './props';\n\nexport type ConversationCompType = <AiMsg>(\n    props: ConversationCompProps<AiMsg>,\n    ref: Ref<ImperativeConversationCompProps<AiMsg>>,\n) => ReactNode;\n\nexport const ConversationComp: ConversationCompType = function <AiMsg>(\n    props: ConversationCompProps<AiMsg>,\n    ref: Ref<ImperativeConversationCompProps<AiMsg>>,\n): ReactNode {\n    const {\n        segments,\n        personaOptions,\n        conversationOptions,\n        onLastActiveSegmentChange,\n    } = props;\n\n    const lastSegmentContainerRef = createRef<HTMLDivElement>();\n    useLastActiveSegment<AiMsg>(segments, lastSegmentContainerRef, onLastActiveSegmentChange);\n\n    const segmentsController = useChatSegmentsController<AiMsg>(segments);\n    const conversationLayout = useConversationDisplayStyle(conversationOptions);\n\n    useImperativeHandle(ref, () => ({\n        streamChunk: (segmentId: string, messageId: string, chunk: AiMsg) => {\n            const chatSegment = segmentsController.get(segmentId);\n            chatSegment?.streamChunk(messageId, chunk);\n        },\n        completeStream: (segmentId: string, messageId: string) => {\n            const chatSegment = segmentsController.get(segmentId);\n            chatSegment?.completeStream(messageId);\n        },\n        cancelSegmentStreams: (segmentId: string) => {\n            const chatSegment = segmentsController.get(segmentId);\n            chatSegment?.cancelStreams();\n        },\n    }), []);\n\n    const ForwardRefChatSegmentComp = useMemo(() => forwardRef(\n        ChatSegmentComp<AiMsg>,\n    ), []);\n\n    return (\n        <div className=\"nlux-chatSegments-container\">\n            {segments.map((segment, index) => {\n                const isLastSegment = index === segments.length - 1;\n                const isInitialSegment = segment.uid === 'initial';\n\n                let ref = segmentsController.getRef(segment.uid);\n                if (!ref) {\n                    ref = createRef();\n                    segmentsController.set(segment.uid, ref);\n                }\n\n                return (\n                    <ForwardRefChatSegmentComp\n                        ref={ref}\n                        key={segment.uid}\n                        containerRef={isLastSegment ? lastSegmentContainerRef : undefined}\n                        markdownContainersController={props.markdownContainersController}\n                        chatSegment={segment}\n                        isInitialSegment={isInitialSegment}\n                        layout={conversationLayout}\n                        personaOptions={personaOptions}\n                        messageOptions={props.messageOptions}\n                        Loader={props.Loader}\n                        submitShortcutKey={props.submitShortcutKey}\n                        onPromptResubmit={props.onPromptResubmit}\n                        onMarkdownStreamRendered={props.onMarkdownStreamRendered}\n                    />\n                );\n            })}\n        </div>\n    );\n};\n","import {ConversationStarter} from '../../types/conversationStarter';\nimport {ConversationStartersProps} from './props';\n\nexport const ConversationStarters = (props: ConversationStartersProps) => {\n    const {onConversationStarterSelected} = props;\n    return (\n        <div className=\"nlux-comp-conversationStarters\">\n            {props.items.map((conversationStarter, index) => (\n                <button\n                    key={index}\n                    className=\"nlux-comp-conversationStarter\"\n                    onClick={() => onConversationStarterSelected(conversationStarter)}\n                >\n                    <ConversationStarterIcon icon={conversationStarter.icon}/>\n                    <span className=\"nlux-comp-conversationStarter-prompt\">\n            {conversationStarter.label ?? conversationStarter.prompt}\n          </span>\n                </button>\n            ))}\n        </div>\n    );\n};\n\nexport const ConversationStarterIcon = ({\n    icon,\n}: {\n    icon: ConversationStarter['icon'];\n}) => {\n    if (!icon) {\n        return null;\n    }\n    if (typeof icon === 'string') {\n        return <img src={icon} width={16}/>;\n    }\n    return (\n        <div className=\"nlux-comp-conversationStarter-icon-container\">{icon}</div>\n    );\n};\n","export const getNluxSmallPngLogo = () => {\n    return (\n        `data:image/png;base64,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`\n    );\n};\n","export const greetingTextClassName = 'nlux-comp-welcomeMessage-text';\n\nexport const updateGreetingText = (\n    root: HTMLElement,\n    newGreeting: string | undefined,\n) => {\n    const greetingContainer = root.querySelector(`.${greetingTextClassName}`);\n    if (newGreeting === '' || newGreeting === undefined) {\n        greetingContainer?.remove();\n        return;\n    }\n\n    if (greetingContainer) {\n        greetingContainer.textContent = newGreeting;\n    } else {\n        const greetingTextContainer = document.createElement('div');\n        greetingTextContainer.classList.add(greetingTextClassName);\n        greetingTextContainer.textContent = newGreeting;\n        root.appendChild(greetingTextContainer);\n    }\n};\n","import {DomCreator} from '../../types/dom/DomCreator';\nimport {createAvatarDom} from '../Avatar/create';\nimport {GreetingProps} from './props';\nimport {updateGreetingText} from './utils/updateGreetingText';\n\nexport const className = 'nlux-comp-welcomeMessage';\nexport const personaNameClassName = 'nlux-comp-welcomeMessage-personaName';\n\nexport const createGreetingDom: DomCreator<GreetingProps> = (\n    props,\n): HTMLElement => {\n    const element = document.createElement('div');\n    element.classList.add(className);\n\n    const personaAvatar = createAvatarDom({\n        name: props.name,\n        avatar: props.avatar,\n    });\n    element.append(personaAvatar);\n\n    const personaName = document.createElement('div');\n    const nameTextNode = document.createTextNode(props.name);\n    personaName.append(nameTextNode);\n    personaName.classList.add(personaNameClassName);\n    element.append(personaName);\n\n    updateGreetingText(element, props.message);\n\n    return element;\n};\n","import {\n    className as compGreetingClassName,\n    personaNameClassName as compGreetingPersonaNameClassName,\n} from '@shared/components/Greeting/create';\nimport {\n    greetingTextClassName as compGreetingTextClassName,\n} from '@shared/components/Greeting/utils/updateGreetingText';\nimport {ReactNode} from 'react';\nimport {AvatarComp} from '../Avatar/AvatarComp';\nimport {GreetingProps} from './props';\n\nexport const GreetingComp = (props: GreetingProps) => {\n    return (\n        <div className={compGreetingClassName}>\n            <AvatarComp\n                avatar={props.avatar}\n                name={props.name}\n            />\n            <div className={compGreetingPersonaNameClassName}>\n                {props.name}\n            </div>\n            {props.message && (\n                <div className={compGreetingTextClassName}>{props.message}</div>\n            )}\n        </div>\n    );\n};\n\nexport const GreetingContainer = ({children}: {children: ReactNode}) => {\n    return (\n        <div className={compGreetingClassName}>\n            {children}\n        </div>\n    );\n};\n","import {getNluxSmallPngLogo} from '@shared/components/Logo/getNluxSmallPngLogo';\nimport {useMemo} from 'react';\nimport {GreetingComp} from '../Greeting/GreetingComp';\n\n// Default message to show when no messages are present in the chat room\n// and when no assistant persona is configured.\nexport const DefaultGreetingComp = () => {\n    const urlEncodedLogo = useMemo(() => getNluxSmallPngLogo(), []);\n    return (\n        <GreetingComp avatar={urlEncodedLogo} name={''}/>\n    );\n};\n","import {warnOnce} from '@shared/utils/warn';\nimport {ReactNode, useEffect, useMemo} from 'react';\nimport {ConversationStarters} from '../../components/ConversationStarters/ConversationStarters';\nimport {DefaultGreetingComp} from '../../components/DefaultGreeting/DefaultGreetingComp';\nimport {GreetingComp, GreetingContainer} from '../../components/Greeting/GreetingComp';\nimport {LaunchPadProps} from './props';\n\nexport type LaunchPadCompType = <AiMsg>(\n    props: LaunchPadProps<AiMsg>,\n) => ReactNode;\n\nexport const LaunchPad: LaunchPadCompType = (props) => {\n    const {\n        segments,\n        personaOptions,\n        conversationOptions,\n        userDefinedGreeting,\n    } = props;\n\n    const hasMessages = useMemo(() => segments.some((segment) => segment.items.length > 0), [segments]);\n    const showDefaultGreeting = useMemo(\n        () => !userDefinedGreeting // Only show the default greeting if the user has not provided a custom greeting\n            && !hasMessages\n            && personaOptions?.assistant === undefined\n            && conversationOptions?.showWelcomeMessage !== false,\n        [\n            hasMessages,\n            personaOptions?.assistant,\n            conversationOptions?.showWelcomeMessage,\n            userDefinedGreeting,\n        ],\n    );\n\n    const showGreetingFromPersonaOptions = useMemo(\n        () => !userDefinedGreeting\n            && !hasMessages\n            && personaOptions?.assistant !== undefined\n            && conversationOptions?.showWelcomeMessage !== false,\n        [\n            userDefinedGreeting,\n            hasMessages,\n            personaOptions?.assistant,\n            conversationOptions?.showWelcomeMessage,\n        ],\n    );\n\n    const showConversationStarters = useMemo(\n        () => !hasMessages && conversationOptions?.conversationStarters\n            && conversationOptions?.conversationStarters.length > 0,\n        [hasMessages, conversationOptions?.conversationStarters],\n    );\n\n    const showUserDefinedGreeting = useMemo(\n        () => userDefinedGreeting !== undefined && conversationOptions?.showWelcomeMessage !== false,\n        [userDefinedGreeting],\n    );\n\n    useEffect(() => {\n        if (userDefinedGreeting && conversationOptions?.showWelcomeMessage === false) {\n            warnOnce(\n                'Configuration conflict: The greeting UI override provided via <AiChatUI.Greeting> will not be shown ' +\n                'because conversationOptions.showWelcomeMessage is set to false.',\n            );\n        }\n    }, [\n        conversationOptions?.showWelcomeMessage,\n        userDefinedGreeting,\n    ]);\n\n    const showEmptyGreeting = !showDefaultGreeting && !showGreetingFromPersonaOptions\n        && !showUserDefinedGreeting && !hasMessages;\n\n    return (\n        <>\n            {showDefaultGreeting && (\n                <DefaultGreetingComp/>\n            )}\n            {showGreetingFromPersonaOptions && (\n                <GreetingComp\n                    name={personaOptions!.assistant!.name}\n                    avatar={personaOptions!.assistant!.avatar}\n                    message={personaOptions!.assistant!.tagline}\n                />\n            )}\n            {showUserDefinedGreeting && (\n                <GreetingContainer>\n                    {userDefinedGreeting}\n                </GreetingContainer>\n            )}\n            {showEmptyGreeting && (\n                <GreetingContainer>{null}</GreetingContainer>\n            )}\n            <div className=\"nlux-conversationStarters-container\">\n                {showConversationStarters && (\n                    <ConversationStarters\n                        items={conversationOptions!.conversationStarters ?? []}\n                        onConversationStarterSelected={props.onConversationStarterSelected}\n                    />\n                )}\n            </div>\n        </>\n    );\n};\n","import {ChatAdapterBuilder} from '@shared/types/adapters/chat/chatAdapterBuilder';\nimport {StandardChatAdapter} from '@shared/types/adapters/chat/standardChatAdapter';\nimport {warn} from '@shared/utils/warn';\nimport {ChatAdapter} from '../types/chatAdapter';\n\nexport const adapterParamToUsableAdapter = <AiMsg>(\n    anAdapterOrAdapterBuilder: ChatAdapter<AiMsg> | ChatAdapterBuilder<AiMsg> | unknown,\n): ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg> | undefined => {\n    const adapterAsAny = anAdapterOrAdapterBuilder as Record<string, unknown>;\n    if (typeof adapterAsAny?.create === 'function') {\n        const adapterBuilder = adapterAsAny as unknown as ChatAdapterBuilder<AiMsg>;\n        return adapterBuilder.create();\n    }\n\n    if (\n        typeof adapterAsAny?.batchText === 'function' ||\n        typeof adapterAsAny?.streamText === 'function' ||\n        typeof adapterAsAny?.streamServerComponent === 'function'\n    ) {\n        return anAdapterOrAdapterBuilder as ChatAdapter<AiMsg>;\n    }\n\n    warn('Unable to determine the type of the adapter! Missing batchText or streamText method.');\n    return undefined;\n};\n","import {AiChatPropsInEvents, PersonaOptions} from '@nlux/core';\nimport {AiChatProps} from '../exports/props';\n\nexport const reactPropsToCorePropsInEvents = <AiMsg>(\n    props: AiChatProps<AiMsg>,\n): AiChatPropsInEvents<AiMsg> => {\n\n    const result: AiChatPropsInEvents<AiMsg> = {};\n    const keys = Object.keys(props);\n    for (let i = 0; i < keys.length; i++) {\n        const key = keys[i] as keyof AiChatProps<AiMsg>;\n        if (\n            key === 'personaOptions' ||\n            key === 'messageOptions' ||\n            key === 'adapter' ||\n            key === 'events'\n        ) {\n            continue;\n        }\n\n        Object.assign(result, {[key]: props[key]});\n    }\n\n    if (props.personaOptions) {\n        result.personaOptions = {} as PersonaOptions;\n        if (props.personaOptions.assistant) {\n            result.personaOptions.assistant = {\n                name: props.personaOptions.assistant.name,\n                avatar: typeof props.personaOptions.assistant.avatar === 'string'\n                    ? props.personaOptions.assistant.avatar\n                    : '<REACT ELEMENT />',\n                tagline: props.personaOptions.assistant.tagline,\n            };\n        }\n\n        if (props.personaOptions.user) {\n            result.personaOptions.user = {\n                name: props.personaOptions.user.name,\n                avatar: typeof props.personaOptions.user.avatar === 'string'\n                    ? props.personaOptions.user.avatar\n                    : '<REACT ELEMENT />',\n            };\n        }\n    }\n\n    if (props.messageOptions) {\n        result.messageOptions = {\n            ...props.messageOptions,\n            responseRenderer: props.messageOptions.responseRenderer ? () => null : undefined,\n            promptRenderer: props.messageOptions.promptRenderer ? () => null : undefined,\n        };\n    }\n\n    if (props.conversationOptions?.conversationStarters) {\n        result.conversationOptions = {\n            ...props.conversationOptions,\n            conversationStarters: props.conversationOptions.conversationStarters.map((starter) => ({\n                ...starter,\n                icon: starter.icon ? '<REACT ELEMENT />' : undefined,\n            })),\n        };\n    }\n\n    return result as AiChatPropsInEvents<AiMsg>;\n};\n","import {ChatItem, PreDestroyCallback, PreDestroyEventDetails} from '@nlux/core';\nimport {ChatSegment} from '@shared/types/chatSegment/chatSegment';\nimport {useEffect, useRef} from 'react';\nimport {reactPropsToCorePropsInEvents} from '../../utils/reactPropsToCorePropsInEvents';\nimport {AiChatProps} from '../props';\n\nexport const usePreDestroyEventTrigger = <AiMsg>(\n    props: AiChatProps<AiMsg>,\n    segments: ChatSegment<AiMsg>[],\n): void => {\n    const getChatHistoryRef = useRef<() => ChatItem<AiMsg>[]>();\n    const preDestroyCallbackRef = useRef<PreDestroyCallback<AiMsg> | undefined>();\n\n    useEffect(() => {\n        // The callback function to obtain chat history is only called before the component is destroyed.\n        // but its value depends on the segments, so we need to update it every time the segments change.\n        getChatHistoryRef.current = () => {\n            const result: ChatItem<AiMsg>[] = [];\n            segments.forEach((segment) => {\n                if (!segment.items || segment.items.length === 0) {\n                    return;\n                }\n\n                segment.items.forEach((item) => {\n                    if (item.status !== 'complete') {\n                        return;\n                    }\n\n                    if (item.participantRole === 'assistant') {\n                        result.push({role: 'assistant', message: item.content as AiMsg});\n                        return;\n                    }\n\n                    if (item.participantRole === 'user') {\n                        result.push({role: 'user', message: item.content});\n                    }\n                });\n            });\n\n            return result;\n        };\n    }, [segments]);\n\n    useEffect(() => {\n        preDestroyCallbackRef.current = props.events?.preDestroy;\n    }, [props.events?.preDestroy]);\n\n    // Ready event is only triggered once.\n    // And only if the ready event callback is provided.\n    useEffect(() => {\n        return () => {\n            const preDestroyCallback = preDestroyCallbackRef.current;\n            if (!preDestroyCallback) {\n                return;\n            }\n\n            const coreProps = reactPropsToCorePropsInEvents<AiMsg>(props);\n            const conversationHistory = getChatHistoryRef.current?.() ?? [];\n\n            const preDestroyEvent: PreDestroyEventDetails<AiMsg> = {\n                aiChatProps: coreProps,\n                conversationHistory,\n            };\n\n            preDestroyCallback(preDestroyEvent);\n            getChatHistoryRef.current = undefined;\n        };\n    }, []);\n};\n","import {ReadyEventDetails} from '@nlux/core';\nimport {useEffect} from 'react';\nimport {reactPropsToCorePropsInEvents} from '../../utils/reactPropsToCorePropsInEvents';\nimport {AiChatProps} from '../props';\n\nexport const useReadyEventTrigger = <AiMsg>(\n    props: AiChatProps<AiMsg>,\n): void => {\n    // Ready event is only triggered once.\n    // And only if the ready event callback is provided.\n    useEffect(() => {\n        const readyCallback = props.events?.ready;\n        if (!readyCallback) {\n            return;\n        }\n\n        const coreProps = reactPropsToCorePropsInEvents<AiMsg>(props);\n        const readyEvent: ReadyEventDetails<AiMsg> = {\n            aiChatProps: coreProps,\n        };\n\n        readyCallback(readyEvent);\n    }, []);\n};\n","import {DisplayOptions} from '@nlux/core';\nimport {CSSProperties, useMemo} from 'react';\n\nexport const useAiChatStyle = (displayOptions: DisplayOptions | undefined): CSSProperties => {\n    return useMemo(() => {\n        const result: CSSProperties = {\n            minWidth: '280px',\n            minHeight: '280px',\n        };\n\n        if (displayOptions?.width) {\n            result.width = displayOptions.width;\n        }\n\n        if (displayOptions?.height) {\n            result.height = displayOptions.height;\n        }\n\n        return result;\n    }, [displayOptions?.width, displayOptions?.height]);\n};\n","import {NLErrorId} from './exceptions/errors';\n\nexport type NluxRawError = {\n    readonly message?: string;\n    readonly type?: string;\n    readonly source?: string;\n    readonly exceptionId?: NLErrorId;\n};\n\nexport class NluxError extends Error {\n    readonly exceptionId?: NLErrorId;\n    readonly message: string;\n    readonly source?: string;\n    readonly type: string;\n\n    constructor(rawError: NluxRawError = {}) {\n        super(rawError.message);\n\n        this.message = rawError.message ?? '';\n        this.source = rawError.source;\n        this.type = this.constructor.name;\n        this.exceptionId = rawError.exceptionId;\n    }\n}\n\nexport class NluxUsageError extends NluxError {\n}\n\nexport class NluxValidationError extends NluxError {\n}\n\nexport class NluxRenderingError extends NluxError {\n}\n","import {NluxError} from '../types/error';\n\nexport const throttle = <CallbackType>(callback: CallbackType, limitInMilliseconds: number) => {\n    let waiting = false;\n    if (typeof callback !== 'function') {\n        throw new NluxError({\n            source: 'x/throttle',\n            message: 'Callback must be a function',\n        });\n    }\n\n    const throttled = ((...args: []) => {\n        if (!waiting) {\n            callback.apply(this, args);\n            waiting = true;\n            setTimeout(function () {\n                waiting = false;\n            }, limitInMilliseconds);\n        }\n    }) as CallbackType;\n\n    return throttled;\n};\n","export type ConversationScrollParams = Readonly<{\n    scrolledToBottom: boolean;\n    scrollDirection: 'up' | 'down' | undefined;\n}>;\n\nexport type ConversationScrollCallback = (params: ConversationScrollParams) => void;\n\nexport const createConversationScrollHandler = (callback: ConversationScrollCallback): EventListener => {\n    let lastScrollTop: number | undefined = undefined;\n    let lastHeight: number | undefined = undefined;\n\n    return (event: Event) => {\n        const target = event.target as HTMLElement | null;\n        if (!(target instanceof HTMLElement)) {\n            return;\n        }\n\n        const {\n            scrollTop,\n            clientHeight,\n            scrollHeight,\n        } = target;\n\n        const minExpectedScrollTop = scrollHeight - 30;\n        const scrolledToBottom = Math.ceil(scrollTop + clientHeight) >= minExpectedScrollTop;\n\n        const scrollDirection = (lastScrollTop === undefined || lastHeight === undefined) ? undefined :\n            (scrollTop > lastScrollTop && lastHeight === scrollHeight) ? 'down' :\n                (scrollTop < lastScrollTop && lastHeight === scrollHeight) ? 'up' :\n                    undefined;\n\n        lastHeight = scrollHeight;\n        lastScrollTop = scrollTop;\n\n        callback({scrolledToBottom, scrollDirection});\n    };\n};\n","import {throttle} from '../../utils/throttle';\nimport {AutoScrollController} from './type';\nimport {createConversationScrollHandler} from './utils/conversationScrollHandler';\n\nexport const createAutoScrollController = (\n    newConversationContainer: HTMLElement,\n    autoScroll: boolean,\n): AutoScrollController => {\n    let shouldScrollWhenGenerating: boolean = autoScroll;\n    let conversationContainer: HTMLElement | undefined = newConversationContainer;\n    let scrollingStickToConversationEnd: boolean = true;\n    let activeChatSegment: {uid: string; container: HTMLElement} | undefined = undefined;\n\n    const scrollHandler = throttle(createConversationScrollHandler((\n        {\n            scrolledToBottom, scrollDirection,\n        }) => {\n        if (scrollingStickToConversationEnd) {\n            // When the user is already at the bottom of the conversation, we stick to the bottom\n            // and only unstick when the user scrolls up.\n            if (scrollDirection === 'up') {\n                scrollingStickToConversationEnd = false;\n            }\n        } else {\n            // When the user is not at the bottom of the conversation, we only stick to the bottom\n            // when the user scrolls down and reaches the bottom.\n            if (scrollDirection === 'down' && scrolledToBottom) {\n                scrollingStickToConversationEnd = true;\n            }\n        }\n    }), 50);\n\n    const initConversationContainer = (newConversationContainer: HTMLElement) => {\n        newConversationContainer.addEventListener('scroll', scrollHandler);\n    };\n\n    const resetConversationContainer = (oldConversationContainer?: HTMLElement) => {\n        oldConversationContainer?.removeEventListener('scroll', scrollHandler);\n    };\n\n    const handleDoneWithSegment = (segmentId: string) => {\n        if (activeChatSegment?.uid === segmentId) {\n            resizeObserver?.disconnect();\n            mutationObserver?.disconnect();\n            activeChatSegment = undefined;\n            resizeObserver = undefined;\n            mutationObserver = undefined;\n        }\n    };\n\n    let resizeObserver: ResizeObserver | undefined;\n    let mutationObserver: MutationObserver | undefined;\n\n    const scrollToBottom = () => {\n        // Using a very large number to make sure the scroll position is set to the bottom.\n        // The alternative is to use scrollHeight, but that would result in an extra reflow - that can\n        // be avoided by using a very large number.\n        // Downside: if the scrollHeight is larger than the max value (50000 pixels), this will not work.\n        conversationContainer?.scrollTo({\n            top: 50000,\n            behavior: 'instant',\n        });\n    };\n\n    const handleActiveChatSegmentResized = () => {\n        if (conversationContainer && shouldScrollWhenGenerating && scrollingStickToConversationEnd) {\n            scrollToBottom();\n        }\n    };\n\n    const handleActiveChatSegmentDomChanged = () => {\n        handleActiveChatSegmentResized();\n    };\n\n    initConversationContainer(conversationContainer);\n\n    return {\n        updateConversationContainer: (newConversationContainer: HTMLElement) => {\n            resetConversationContainer(conversationContainer);\n            initConversationContainer(newConversationContainer);\n            conversationContainer = newConversationContainer;\n        },\n        updateProps: ({autoScroll}) => {\n            shouldScrollWhenGenerating = autoScroll;\n        },\n        handleNewChatSegmentAdded: (segmentId, segmentContainer) => {\n            if (activeChatSegment) {\n                resizeObserver?.disconnect();\n                mutationObserver?.disconnect();\n            }\n\n            activeChatSegment = {uid: segmentId, container: segmentContainer};\n\n            resizeObserver = new ResizeObserver(handleActiveChatSegmentResized);\n            resizeObserver.observe(segmentContainer);\n\n            mutationObserver = new MutationObserver(handleActiveChatSegmentDomChanged);\n            mutationObserver.observe(segmentContainer, {\n                childList: true,\n                subtree: true,\n                characterData: true,\n            });\n\n            if (shouldScrollWhenGenerating) {\n                scrollToBottom();\n            }\n        },\n        handleChatSegmentRemoved: (segmentId) => handleDoneWithSegment(segmentId),\n        handleChatSegmentComplete: (segmentId) => handleDoneWithSegment(segmentId),\n        destroy: () => {\n            if (activeChatSegment) {\n                handleDoneWithSegment(activeChatSegment.uid);\n                activeChatSegment = undefined;\n            }\n\n            resetConversationContainer(conversationContainer);\n            conversationContainer = undefined;\n        },\n    };\n};\n","import {createAutoScrollController} from '@shared/interactions/autoScroll/autoScrollController';\nimport {AutoScrollController} from '@shared/interactions/autoScroll/type';\nimport {MutableRefObject, useEffect, useRef, useState} from 'react';\n\nconst defaultAutoScrollOption = true;\n\nexport const useAutoScrollController = (\n    conversationContainerRef: MutableRefObject<HTMLDivElement | null>,\n    autoScroll?: boolean,\n) => {\n    const [autoScrollController, setAutoScrollController] = useState<AutoScrollController>();\n    const [conversationContainer, setConversationContainer] = useState<HTMLDivElement>();\n\n    const autoScrollControllerRef = useRef(autoScrollController);\n    const autoScrollPropRef = useRef(autoScroll);\n\n    useEffect(() => {\n        const currentConversationContainer = conversationContainerRef.current || undefined;\n        if (currentConversationContainer !== conversationContainer) {\n            setConversationContainer(currentConversationContainer);\n        }\n    }); // No dependencies - If statement inside the effect will handle the update\n\n    useEffect(() => {\n        if (!conversationContainer) {\n            if (autoScrollControllerRef.current) {\n                autoScrollControllerRef.current.destroy();\n                setAutoScrollController(undefined);\n                autoScrollControllerRef.current = undefined;\n            }\n\n            return;\n        }\n\n        if (autoScrollControllerRef.current) {\n            autoScrollControllerRef.current.updateConversationContainer(conversationContainer);\n        } else {\n            autoScrollControllerRef.current = createAutoScrollController(\n                conversationContainer,\n                autoScrollPropRef.current ?? defaultAutoScrollOption,\n            );\n            setAutoScrollController(autoScrollControllerRef.current);\n        }\n    }, [conversationContainer]);\n\n    useEffect(() => {\n        autoScrollPropRef.current = autoScroll;\n        if (autoScrollControllerRef.current) {\n            autoScrollControllerRef.current.updateProps({\n                autoScroll: autoScroll ?? defaultAutoScrollOption,\n            });\n        }\n    }, [autoScroll]);\n\n    return autoScrollController;\n};\n","import {ComposerStatus} from '@shared/components/Composer/props';\nimport {ChatSegment} from '@shared/types/chatSegment/chatSegment';\nimport {Dispatch, RefObject, SetStateAction, useCallback} from 'react';\nimport {ImperativeConversationCompProps} from '../../sections/Conversation/props';\n\nexport const useCancelLastMessage = function <AiMsg>(\n    newSegments: ChatSegment<AiMsg>[],\n    cancelledSegmentIds: string[],\n    cancelledMessageIds: string[],\n    setChatSegments: Dispatch<SetStateAction<ChatSegment<AiMsg>[]>>,\n    setCancelledSegmentIds: Dispatch<SetStateAction<string[]>>,\n    setCancelledMessageIds: Dispatch<SetStateAction<string[]>>,\n    conversationRef: RefObject<ImperativeConversationCompProps<AiMsg>>,\n    setComposerStatus: Dispatch<SetStateAction<ComposerStatus>>,\n) {\n    return useCallback(() => {\n        const lastSegment = newSegments.length > 0 ? newSegments[newSegments.length - 1] : undefined;\n        if (lastSegment?.status === 'active') {\n            // Remove the last message from the conversation\n            setChatSegments(newSegments.slice(0, -1));\n            setCancelledSegmentIds([...cancelledSegmentIds, lastSegment.uid]);\n            setCancelledMessageIds([\n                ...cancelledMessageIds,\n                ...lastSegment.items.map(item => item.uid),\n            ]);\n\n            // TODO - Cancel the HTTP request if it is still pending or streaming\n\n            // Instructions to cancel markdown streaming, if it is still active\n            conversationRef.current?.cancelSegmentStreams(lastSegment.uid);\n        }\n\n        setComposerStatus('typing');\n    }, [\n        newSegments,\n        cancelledSegmentIds,\n        cancelledMessageIds,\n        setChatSegments,\n        setCancelledSegmentIds,\n        setCancelledMessageIds,\n        conversationRef,\n        setComposerStatus,\n    ]);\n};\n","import {MutableRefObject, useCallback} from 'react';\nimport {AutoScrollController} from '@shared/interactions/autoScroll/type';\n\ntype LastActiveSegmentData = {uid: string; div: HTMLDivElement};\n\nexport const useLastActiveSegmentChangeHandler = (\n    autoScrollController: AutoScrollController | undefined,\n    lastActiveSegmentIdRef: MutableRefObject<string | undefined>,\n) => {\n    return useCallback((data: LastActiveSegmentData | undefined) => {\n        if (!autoScrollController) {\n            return;\n        }\n\n        if (data) {\n            lastActiveSegmentIdRef.current = data.uid;\n            autoScrollController.handleNewChatSegmentAdded(data.uid, data.div);\n        }\n    }, [autoScrollController]);\n};\n","import {createContext, ReactElement, useEffect, useMemo, useState} from 'react';\nimport {PrimitivesContextData} from '../../types/PrimitivesContext';\n\nexport const primitivesContext = createContext<\n    PrimitivesContextData<any>\n>({});\n\nexport const usePrimitivesContext = function <AiMsg>(\n    contextData: PrimitivesContextData<AiMsg>,\n) {\n    const [\n        contextState,\n        setContextState,\n    ] = useState<PrimitivesContextData<AiMsg>>(contextData);\n\n    useEffect(() => {\n        setContextState(contextData);\n    }, [\n        // Right now, the only primitive relying on contextData is <Markdown />\n        contextData?.messageOptions?.htmlSanitizer,\n        contextData?.messageOptions?.syntaxHighlighter,\n        contextData?.messageOptions?.markdownLinkTarget,\n        contextData?.messageOptions?.showCodeBlockCopyButton,\n        contextData?.messageOptions?.skipStreamingAnimation,\n        contextData?.messageOptions?.streamingAnimationSpeed,\n        contextData?.messageOptions?.waitTimeBeforeStreamCompletion,\n        contextData?.messageOptions?.responseRenderer,\n        contextData?.messageOptions?.promptRenderer,\n    ]);\n\n    const PrimitivesContextProvider = useMemo(() =>\n            ({children}: {children: ReactElement}) => {\n                return (\n                    <primitivesContext.Provider value={contextState}>\n                        {children}\n                    </primitivesContext.Provider>\n                );\n            },\n        [contextState],\n    );\n\n    return {\n        PrimitivesContextProvider,\n        primitivesContext,\n    };\n};\n","import {useCallback} from 'react';\nimport {ComposerStatus} from '@shared/components/Composer/props';\nimport {ChatSegment} from '@shared/types/chatSegment/chatSegment';\n\nexport const useResubmitPromptHandler = <AiMsg>(\n    initialSegment: ChatSegment<AiMsg> | undefined,\n    setInitialSegment: (segment: ChatSegment<AiMsg>) => void,\n    chatSegments: ChatSegment<AiMsg>[],\n    setChatSegments: (segments: ChatSegment<AiMsg>[]) => void,\n    setPrompt: (prompt: string) => void,\n    setComposerStatus: (status: ComposerStatus) => void,\n) => {\n    return useCallback((segmentId: string, messageId: string, newPrompt: string) => {\n        //\n        // Handle the case where the message being edited is in the initial segment\n        //\n        if (segmentId === 'initial' && initialSegment) {\n            const newInitialSegmentItems = [];\n            for (const item of initialSegment.items) {\n                if (item.uid !== messageId) {\n                    newInitialSegmentItems.push(item);\n                } else {\n                    break;\n                }\n            }\n\n            const newInitialSegment: ChatSegment<AiMsg> = {\n                ...initialSegment,\n                items: newInitialSegmentItems,\n            };\n\n            setInitialSegment(newInitialSegment);\n            setChatSegments([]);\n            setPrompt(newPrompt);\n            setComposerStatus('submitting-edit');\n            return;\n        }\n\n        //\n        // Handle the case where the message being edited is in a chat segment\n        //\n        // Find the segment\n        const segmentIndex = chatSegments.findIndex((segment) => segment.uid === segmentId);\n\n        // Remove the segment from the chatSegments array\n        const newChatSegments = chatSegments.slice(0, segmentIndex);\n        setChatSegments(newChatSegments);\n\n        // Submit the new prompt\n        setPrompt(newPrompt);\n        setComposerStatus('submitting-edit');\n    }, [\n        chatSegments,\n        setChatSegments,\n        initialSegment,\n        setInitialSegment,\n        setPrompt,\n        setComposerStatus,\n    ]);\n};","import {DataTransferMode, StreamingAdapterObserver} from './chatAdapter';\nimport {ChatAdapterExtras} from './chatAdapterExtras';\nimport {StandardAdapterInfo} from './standardAdapterConfig';\n\n/**\n * This interface is used by standard adapters provided by nlux to communicate with the AiChat component.\n */\nexport interface StandardChatAdapter<AiMsg = string> {\n    batchText(\n        message: string,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): Promise<string | object | undefined>;\n    get dataTransferMode(): DataTransferMode;\n    get id(): string;\n\n    get info(): StandardAdapterInfo;\n\n    // Receives a message from the API and returns a message that can be sent to the user.\n    // can be displayed to the user (either text or input for a custom component).\n    preProcessAiBatchedMessage(\n        message: string | object | undefined,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): AiMsg | undefined;\n    // This method is called by AiChat when the API sends a message to convert that message into a format that\n    preProcessAiStreamedChunk(\n        chunk: string | object | undefined,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): AiMsg | undefined;\n    streamText(\n        message: string,\n        observer: StreamingAdapterObserver<string | object | undefined>,\n        extras: ChatAdapterExtras<AiMsg>,\n    ): void;\n}\n\n/**\n * This function is used to determine if an object is a standard chat adapter or not.\n * @param adapter\n */\nexport const isStandardChatAdapter = (adapter: unknown): boolean => {\n    if (typeof adapter !== 'object' || adapter === null) {\n        return false;\n    }\n\n    const typedAdapter = adapter as Record<string, unknown>;\n    return (typeof typedAdapter.streamText === 'function' || typeof typedAdapter.batchText === 'function')\n        && ['stream', 'batch'].includes(typedAdapter.dataTransferMode as string)\n        && typeof typedAdapter.id === 'string'\n        && (typeof typedAdapter.info === 'object' && typedAdapter.info !== null)\n        && (typeof typedAdapter.preProcessAiBatchedMessage === 'function')\n        && (typeof typedAdapter.preProcessAiStreamedChunk === 'function');\n};\n","import {CallbackFunction} from '../../../types/callbackFunction';\n\nconst isHighPerfJsEngine = typeof navigator !== 'undefined' && navigator?.userAgent?.includes('Safari');\n\n// TODO: To be replaced with a pure React implementation for submitPrompt that relies on React rendering cycle\nconst defaultAsyncDelay: 1 | 100 = isHighPerfJsEngine ? 100 : 1; // Efficient async scheduling for Safari\n\nexport const triggerAsyncCallback = (trigger: CallbackFunction, delay: number = defaultAsyncDelay) => {\n    setTimeout(() => {\n        trigger();\n    }, delay);\n};\n","import {ChatAdapter} from '../../types/adapters/chat/chatAdapter';\nimport {ChatAdapterExtras} from '../../types/adapters/chat/chatAdapterExtras';\nimport {isStandardChatAdapter, StandardChatAdapter} from '../../types/adapters/chat/standardChatAdapter';\nimport {ChatSegment} from '../../types/chatSegment/chatSegment';\nimport {AiBatchedMessage} from '../../types/chatSegment/chatSegmentAiMessage';\nimport {\n    AiMessageReceivedCallback,\n    ChatSegmentCompleteCallback,\n    ChatSegmentErrorCallback,\n} from '../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentUserMessage} from '../../types/chatSegment/chatSegmentUserMessage';\nimport {NLErrorId} from '../../types/exceptions/errors';\nimport {uid} from '../../utils/uid';\nimport {warn} from '../../utils/warn';\nimport {triggerAsyncCallback} from './utils/triggerAsyncCallback';\n\nexport const submitAndBatchTextResponse = async <AiMsg>(\n    segmentId: string,\n    userMessage: ChatSegmentUserMessage,\n    adapter: ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n    extras: ChatAdapterExtras<AiMsg>,\n    aiMessageReceivedCallbacks: Set<AiMessageReceivedCallback<AiMsg>>,\n    chatSegmentCompleteCallbacks: Set<ChatSegmentCompleteCallback<AiMsg>>,\n    chatSegmentExceptionCallbacks: Set<ChatSegmentErrorCallback>,\n): Promise<void> => {\n    try {\n        const prompt = userMessage.content;\n\n        const adapterAsStandardAdapter = isStandardChatAdapter(adapter)\n            ? adapter as unknown as StandardChatAdapter<AiMsg>\n            : undefined;\n\n        const isStandardAdapter = adapterAsStandardAdapter !== undefined;\n\n\n        const responseUid = uid();\n        const participantRole = 'assistant';\n        const status = 'complete';\n        const time = new Date();\n        const dataTransferMode = 'batch';\n\n        let aiResponse: AiBatchedMessage<AiMsg> | undefined = undefined;\n        if (isStandardAdapter) {\n            const rawResponse = await adapterAsStandardAdapter.batchText!(prompt, extras);\n            const preProcessedResponse = adapterAsStandardAdapter.preProcessAiBatchedMessage(rawResponse, extras);\n            if (preProcessedResponse !== undefined && preProcessedResponse !== null) {\n                aiResponse = {\n                    uid: responseUid,\n                    content: preProcessedResponse,\n                    contentType: 'text',\n                    serverResponse: rawResponse,\n                    participantRole, status, time, dataTransferMode,\n                };\n            }\n        } else {\n            const response = await (adapter as ChatAdapter<AiMsg>).batchText!(prompt, extras);\n            aiResponse = {\n                uid: responseUid,\n                content: response,\n                contentType: 'text',\n                serverResponse: undefined,\n                participantRole, status, time, dataTransferMode,\n            };\n        }\n\n        if (!aiResponse) {\n            throw new Error('Response from adapter was undefined or cannot be processed');\n        }\n\n        //\n        // We emit the AI message received event.\n        //\n        const validAiResponse = aiResponse as AiBatchedMessage<AiMsg> & {\n            status: 'complete';\n        };\n\n        triggerAsyncCallback(() => {\n            aiMessageReceivedCallbacks.forEach((callback) => {\n                callback(validAiResponse);\n            });\n        });\n\n        //\n        // We emit the chat segment complete event.\n        //\n        const updatedChatSegment: ChatSegment<AiMsg> = {\n            uid: segmentId,\n            status: 'complete',\n            items: [\n                userMessage,\n                aiResponse,\n            ],\n        };\n\n        triggerAsyncCallback(() => {\n            chatSegmentCompleteCallbacks.forEach((callback) => {\n                callback(updatedChatSegment);\n            });\n        });\n    } catch (error) {\n        warn(error);\n\n        const errorObject = error instanceof Error\n            ? error\n            : (\n                typeof error === 'string' ? new Error(error) : new Error('Unknown error')\n            );\n\n        triggerAsyncCallback(() => {\n            const errorId: NLErrorId = 'failed-to-load-content';\n            chatSegmentExceptionCallbacks\n                .forEach((callback) => callback(errorId, errorObject));\n        });\n    }\n};\n","import {ChatAdapterExtras} from '../../types/adapters/chat/chatAdapterExtras';\nimport {\n    ServerComponentChatAdapter,\n    ServerComponentExecutionResult,\n} from '../../types/adapters/chat/serverComponentChatAdapter';\nimport {ChatSegment} from '../../types/chatSegment/chatSegment';\nimport {AiStreamedServerComponentMessage} from '../../types/chatSegment/chatSegmentAiMessage';\nimport {\n    AiServerComponentStreamedCallback,\n    AiServerComponentStreamStartedCallback,\n    ChatSegmentCompleteCallback,\n    ChatSegmentErrorCallback,\n} from '../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentUserMessage} from '../../types/chatSegment/chatSegmentUserMessage';\nimport {NLErrorId} from '../../types/exceptions/errors';\nimport {uid} from '../../utils/uid';\nimport {warn} from '../../utils/warn';\nimport {triggerAsyncCallback} from './utils/triggerAsyncCallback';\n\nexport const submitAndStreamServerComponentResponse = <AiMsg>(\n    segmentId: string,\n    userMessage: ChatSegmentUserMessage,\n    adapter: ServerComponentChatAdapter<AiMsg>,\n    extras: ChatAdapterExtras<AiMsg>,\n    aiServerComponentStreamStartedCallbacks: Set<AiServerComponentStreamStartedCallback>,\n    aiServerComponentStreamedCallbacks: Set<AiServerComponentStreamedCallback>,\n    chatSegmentCompleteCallbacks: Set<ChatSegmentCompleteCallback<AiMsg>>,\n    chatSegmentExceptionCallbacks: Set<ChatSegmentErrorCallback>,\n): Promise<void> => {\n    return new Promise((resolve, reject) => {\n        try {\n            const prompt = userMessage.content;\n            const responseUid = uid();\n            const participantRole = 'assistant';\n            const status: 'streaming' | 'complete' | 'error' = 'streaming';\n            const time = new Date();\n            const dataTransferMode = 'stream';\n\n            let aiResponse: AiStreamedServerComponentMessage | undefined = undefined;\n            let serverComponent: ServerComponentExecutionResult | undefined = undefined;\n\n            const handleComplete = () => {\n                //\n                // We emit the AI message received event.\n                //\n                triggerAsyncCallback(() => {\n                    aiServerComponentStreamedCallbacks.forEach((callback) => {\n                        if (aiResponse && serverComponent) {\n                            callback({\n                                ...aiResponse,\n                                content: serverComponent,\n                                status: 'complete',\n                            });\n                        }\n                    });\n                }, 20);\n\n                //\n                // We emit the chat segment complete event.\n                //\n                const updatedChatSegment: ChatSegment<AiMsg> = {\n                    uid: segmentId,\n                    status: 'complete',\n                    items: [\n                        userMessage,\n                        aiResponse!,\n                    ],\n                };\n\n                triggerAsyncCallback(() => {\n                    chatSegmentCompleteCallbacks.forEach((callback) => {\n                        callback(updatedChatSegment);\n                    });\n\n                    resolve();\n                }, 20);\n            };\n\n            const handleError = () => {\n                chatSegmentExceptionCallbacks.forEach((callback) => {\n                    callback('failed-to-stream-server-component', new Error('Failed to load content'));\n                });\n            };\n\n            serverComponent = adapter.streamServerComponent!(\n                prompt,\n                extras,\n                {\n                    onServerComponentReceived: handleComplete,\n                    onError: handleError,\n                },\n            );\n\n            aiResponse = {\n                uid: responseUid,\n                content: serverComponent,\n                contentType: 'server-component',\n                participantRole,\n                status,\n                time,\n                dataTransferMode,\n            };\n\n            //\n            // We emit the AI message received event.\n            //\n            triggerAsyncCallback(() => {\n                aiServerComponentStreamStartedCallbacks.forEach((callback) => {\n                    callback(aiResponse);\n                });\n            }, 10);\n        } catch (error) {\n            warn(error);\n\n            const errorObject = error instanceof Error\n                ? error\n                : (\n                    typeof error === 'string' ? new Error(error) : new Error('Unknown error')\n                );\n\n            triggerAsyncCallback(() => {\n                const errorId: NLErrorId = 'failed-to-load-content';\n                chatSegmentExceptionCallbacks\n                    .forEach((callback) => callback(errorId, errorObject));\n            });\n        }\n    });\n};\n","import {ChatAdapter, StreamingAdapterObserver} from '../../types/adapters/chat/chatAdapter';\nimport {ChatAdapterExtras} from '../../types/adapters/chat/chatAdapterExtras';\nimport {isStandardChatAdapter, StandardChatAdapter} from '../../types/adapters/chat/standardChatAdapter';\nimport {ChatSegment} from '../../types/chatSegment/chatSegment';\nimport {AiStreamedMessage} from '../../types/chatSegment/chatSegmentAiMessage';\nimport {\n    AiMessageChunkReceivedCallback,\n    AiMessageStreamedCallback,\n    AiMessageStreamStartedCallback,\n    ChatSegmentCompleteCallback,\n    ChatSegmentErrorCallback,\n} from '../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentUserMessage} from '../../types/chatSegment/chatSegmentUserMessage';\nimport {NLErrorId} from '../../types/exceptions/errors';\nimport {uid} from '../../utils/uid';\nimport {warn} from '../../utils/warn';\nimport {triggerAsyncCallback} from './utils/triggerAsyncCallback';\n\nexport const submitAndStreamTextResponse = <AiMsg>(\n    segmentId: string,\n    userMessage: ChatSegmentUserMessage,\n    adapter: ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n    extras: ChatAdapterExtras<AiMsg>,\n    aiMessageStreamStartedCallbacks: Set<AiMessageStreamStartedCallback<AiMsg>>,\n    aiMessageStreamedCallbacks: Set<AiMessageStreamedCallback<AiMsg>>,\n    aiMessageChunkReceivedCallbacks: Set<AiMessageChunkReceivedCallback<AiMsg>>,\n    chatSegmentCompleteCallbacks: Set<ChatSegmentCompleteCallback<AiMsg>>,\n    chatSegmentErrorCallbacks: Set<ChatSegmentErrorCallback>,\n): Promise<void> => {\n    return new Promise<void>((resolve) => {\n        const streamedMessageId = uid();\n        const streamedContent: Array<AiMsg> = [];\n        const streamedRawContent: Array<string | object | undefined> = [];\n\n        let firstChunkReceived = false;\n        let errorOccurred = false;\n        let completeOccurred = false;\n\n        const emitAiMessageStreamStartedEvent = () => {\n            if (firstChunkReceived) {\n                return;\n            }\n\n            firstChunkReceived = true;\n            triggerAsyncCallback(() => {\n                aiMessageStreamStartedCallbacks.forEach(callback => {\n                    callback({\n                        uid: streamedMessageId,\n                        status: 'streaming',\n                        time: new Date(),\n                        participantRole: 'assistant',\n                        dataTransferMode: 'stream',\n                    });\n                });\n            });\n        };\n\n        const isStandardAdapter = isStandardChatAdapter(adapter);\n        const observer: StreamingAdapterObserver<unknown> = {\n            next: (chunk: unknown) => {\n                if (errorOccurred || completeOccurred) {\n                    return;\n                }\n\n                let aiMsgChunk: AiMsg | undefined;\n                let rawChunk: string | object | undefined;\n                if (isStandardAdapter) {\n                    const chunkAsRaw = chunk as string | object | undefined;\n\n                    const adapterAsStandardAdapter = adapter as unknown as StandardChatAdapter<AiMsg>;\n                    const preProcessedChunk = adapterAsStandardAdapter.preProcessAiStreamedChunk(chunkAsRaw, extras);\n                    if (preProcessedChunk !== undefined && preProcessedChunk !== null) {\n                        aiMsgChunk = preProcessedChunk;\n                        rawChunk = chunkAsRaw;\n\n                        streamedContent.push(aiMsgChunk);\n                        streamedRawContent.push(rawChunk);\n                    }\n                } else {\n                    // For non-standard adapters, the check pre-processed chunk is done by the adapter.\n                    aiMsgChunk = chunk as AiMsg;\n                    streamedContent.push(aiMsgChunk);\n                }\n\n                if (aiMsgChunk === undefined || aiMsgChunk === null) {\n                    warn('Adapter returned an undefined or null value from streamText. This chunk will be ignored.');\n                    return;\n                }\n\n                if (!firstChunkReceived) {\n                    emitAiMessageStreamStartedEvent();\n                }\n\n                triggerAsyncCallback(() => {\n                    aiMessageChunkReceivedCallbacks.forEach(callback => {\n                        callback({\n                            chunk: aiMsgChunk,\n                            messageId: streamedMessageId,\n                            serverResponse: rawChunk,\n                        });\n                    });\n                });\n            },\n            complete: () => {\n                if (errorOccurred || completeOccurred) {\n                    return;\n                }\n\n                completeOccurred = true;\n\n                //\n                // EVENT: AI MESSAGE FULLY STREAMED\n                //\n                triggerAsyncCallback(() => {\n                    type StreamedAiMessage<AiMsg> = AiStreamedMessage<AiMsg> & {\n                        status: 'complete',\n                        content: Array<AiMsg>\n                    };\n\n                    const aiMessage: StreamedAiMessage<AiMsg> = {\n                        uid: streamedMessageId,\n                        status: 'complete',\n                        content: streamedContent,\n                        contentType: 'text',\n                        serverResponse: undefined,\n                        time: new Date(),\n                        participantRole: 'assistant',\n                        dataTransferMode: 'stream',\n                    };\n\n                    aiMessageStreamedCallbacks.forEach(callback => {\n                        callback(aiMessage);\n                    });\n\n                    //\n                    // WE RESOLVE THE PROMISE HERE\n                    // Only after the AI message has been fully streamed\n                    //\n                    resolve();\n                });\n\n                //\n                // EVENT: CHAT SEGMENT COMPLETE\n                //\n                triggerAsyncCallback(() => {\n                    const updatedChatSegment: ChatSegment<AiMsg> = {\n                        uid: segmentId,\n                        status: 'complete',\n                        items: [\n                            userMessage,\n                            {\n                                uid: streamedMessageId,\n                                status: 'complete',\n                                contentType: 'text',\n                                content: streamedContent,\n                                serverResponse: streamedRawContent,\n                                time: new Date(),\n                                participantRole: 'assistant',\n                                dataTransferMode: 'stream',\n                            },\n                        ],\n                    };\n\n                    chatSegmentCompleteCallbacks.forEach(callback => {\n                        callback(updatedChatSegment);\n                    });\n                });\n            },\n            error: (error) => {\n                if (errorOccurred || completeOccurred) {\n                    return;\n                }\n\n                errorOccurred = true;\n\n                //\n                // EVENT: CHAT SEGMENT STREAMING ERROR\n                //\n                triggerAsyncCallback(() => {\n                    const errorId: NLErrorId = 'failed-to-stream-content';\n                    chatSegmentErrorCallbacks.forEach(callback => {\n                        callback(errorId, error);\n                    });\n\n                    //\n                    // WE RESOLVE THE PROMISE HERE\n                    // Only after the AI message has been fully streamed\n                    //\n                    resolve();\n                });\n            },\n        };\n\n        adapter.streamText!(userMessage.content, observer, extras);\n    });\n};\n","import {ChatAdapter} from '../../../types/adapters/chat/chatAdapter';\nimport {ServerComponentChatAdapter} from '../../../types/adapters/chat/serverComponentChatAdapter';\nimport {StandardChatAdapter} from '../../../types/adapters/chat/standardChatAdapter';\n\nexport const getContentTypeToGenerate = <AiMsg>(\n    adapter: ChatAdapter<AiMsg> | ServerComponentChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n): 'text' | 'server-component' => {\n    if ('streamServerComponent' in adapter) {\n        return 'server-component';\n    }\n\n    return 'text';\n};\n","import {ChatAdapter as CoreChatAdapter, DataTransferMode} from '../../../types/adapters/chat/chatAdapter';\nimport {ServerComponentChatAdapter} from '../../../types/adapters/chat/serverComponentChatAdapter';\nimport {isStandardChatAdapter, StandardChatAdapter} from '../../../types/adapters/chat/standardChatAdapter';\n\nexport const getDataTransferModeToUse = <AiMsg>(\n    adapter: CoreChatAdapter<AiMsg> | ServerComponentChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n): DataTransferMode => {\n    const supportedDataTransferModes: DataTransferMode[] = [];\n    const adapterAsCoreAdapter: CoreChatAdapter<AiMsg> | undefined = adapter as CoreChatAdapter<AiMsg> | undefined;\n    const adapterAsEsmAdapter: ServerComponentChatAdapter<AiMsg> | undefined = adapter as ServerComponentChatAdapter<AiMsg> | undefined;\n\n    if (adapterAsCoreAdapter?.streamText !== undefined || adapterAsEsmAdapter?.streamServerComponent !== undefined) {\n        supportedDataTransferModes.push('stream');\n    }\n    if (adapterAsCoreAdapter?.batchText !== undefined) {\n        supportedDataTransferModes.push('batch');\n    }\n\n    const adapterAsStandardAdapter: StandardChatAdapter<AiMsg> | undefined = isStandardChatAdapter(\n        adapter,\n    ) ? adapter as StandardChatAdapter<AiMsg> : undefined;\n\n    const adapterDataTransferMode: DataTransferMode | undefined = adapterAsStandardAdapter?.dataTransferMode\n        ?? undefined;\n\n    const defaultDataTransferMode = supportedDataTransferModes.length === 1\n        ? supportedDataTransferModes[0]\n        : 'stream';\n\n    return adapterDataTransferMode ?? defaultDataTransferMode;\n};\n","import {ChatSegment} from '../../../types/chatSegment/chatSegment';\nimport {ChatSegmentCompleteCallback, ChatSegmentEventsMap} from '../../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentObservable} from '../../../types/chatSegment/chatSegmentObservable';\nimport {uid} from '../../../utils/uid';\nimport {triggerAsyncCallback} from './triggerAsyncCallback';\n\nexport const createEmptyCompleteSegment = <AiMsg>(): {\n    segment: ChatSegment<AiMsg>,\n    observable: ChatSegmentObservable<AiMsg>,\n    dataTransferMode: 'batch',\n} => {\n    const completeListeners = new Set<\n        ChatSegmentEventsMap<AiMsg>['complete']\n    >();\n\n    const segmentId = uid();\n\n    const segment: ChatSegment<AiMsg> = {\n        uid: segmentId,\n        status: 'complete',\n        items: [],\n    };\n\n    triggerAsyncCallback(() => {\n        completeListeners.forEach((listener) => {\n            listener(segment);\n        });\n\n        completeListeners.clear();\n    });\n\n    return {\n        segment,\n        observable: {\n            on: (event, callback) => {\n                if (event === 'complete') {\n                    completeListeners.add(callback as unknown as ChatSegmentCompleteCallback<AiMsg>);\n                }\n            },\n            removeListener: (event, callback) => {\n                completeListeners.delete(callback as unknown as ChatSegmentCompleteCallback<AiMsg>);\n            },\n            destroy: () => {\n                completeListeners.clear();\n            },\n            get segmentId(): string {\n                return segmentId;\n            },\n        },\n        dataTransferMode: 'batch',\n    };\n};\n","import {ChatSegment} from '../../../types/chatSegment/chatSegment';\nimport {ChatSegmentErrorCallback, ChatSegmentEventsMap} from '../../../types/chatSegment/chatSegmentEvents';\nimport {ChatSegmentObservable} from '../../../types/chatSegment/chatSegmentObservable';\nimport {NLErrorId} from '../../../types/exceptions/errors';\nimport {uid} from '../../../utils/uid';\nimport {triggerAsyncCallback} from './triggerAsyncCallback';\n\nexport const createEmptyErrorSegment = <AiMsg>(\n    errorId: NLErrorId,\n): {\n    segment: ChatSegment<AiMsg>,\n    dataTransferMode: 'stream',\n    observable: ChatSegmentObservable<AiMsg>,\n} => {\n    const errorListeners = new Set<\n        ChatSegmentEventsMap<AiMsg>['error']\n    >();\n\n    const segmentId = uid();\n\n    const segment: ChatSegment<AiMsg> = {\n        uid: segmentId,\n        status: 'error',\n        items: [],\n    };\n\n    triggerAsyncCallback(() => {\n        errorListeners.forEach((listener) => listener(errorId));\n        errorListeners.clear();\n    });\n\n    return {\n        segment,\n        dataTransferMode: 'stream',\n        observable: {\n            on: (event, callback) => {\n                if (event === 'error') {\n                    errorListeners.add(callback as unknown as ChatSegmentErrorCallback);\n                }\n            },\n            removeListener: (event, callback) => {\n                errorListeners.delete(callback as unknown as ChatSegmentErrorCallback);\n            },\n            destroy: () => {\n                errorListeners.clear();\n            },\n            get segmentId(): string {\n                return segmentId;\n            },\n        },\n    };\n};\n","import {ChatSegmentUserMessage} from '../../../types/chatSegment/chatSegmentUserMessage';\nimport {uid} from '../../../utils/uid';\n\nexport const getUserMessageFromPrompt = (prompt: string): ChatSegmentUserMessage => {\n    return {\n        uid: uid(),\n        time: new Date(),\n        status: 'complete',\n        participantRole: 'user',\n        content: prompt,\n        contentType: 'text',\n    };\n};\n","import {ChatAdapter} from '../../types/adapters/chat/chatAdapter';\nimport {ChatAdapterExtras} from '../../types/adapters/chat/chatAdapterExtras';\nimport {ServerComponentChatAdapter} from '../../types/adapters/chat/serverComponentChatAdapter';\nimport {StandardChatAdapter} from '../../types/adapters/chat/standardChatAdapter';\nimport {\n    AiMessageChunkReceivedCallback,\n    AiMessageReceivedCallback,\n    AiMessageStreamedCallback,\n    AiMessageStreamStartedCallback,\n    AiServerComponentStreamedCallback,\n    AiServerComponentStreamStartedCallback,\n    ChatSegmentCompleteCallback,\n    ChatSegmentErrorCallback,\n    UserMessageReceivedCallback,\n} from '../../types/chatSegment/chatSegmentEvents';\nimport {uid} from '../../utils/uid';\nimport {submitAndBatchTextResponse} from './batchText';\nimport {submitAndStreamServerComponentResponse} from './streamServerComponent';\nimport {submitAndStreamTextResponse} from './streamText';\nimport {SubmitPrompt} from './submitPrompt';\nimport {getContentTypeToGenerate} from './utils/contentTypeToGenerate';\nimport {getDataTransferModeToUse} from './utils/dataTransferModeToUse';\nimport {createEmptyCompleteSegment} from './utils/emptyCompleteSegment';\nimport {createEmptyErrorSegment} from './utils/emptyErrorSegment';\nimport {triggerAsyncCallback} from './utils/triggerAsyncCallback';\nimport {getUserMessageFromPrompt} from './utils/userMessageFromPrompt';\n\nexport const submitPrompt: SubmitPrompt = <AiMsg>(\n    prompt: string,\n    adapter: ChatAdapter<AiMsg> | ServerComponentChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n    extras: ChatAdapterExtras<AiMsg>,\n) => {\n    //\n    // We check if the prompt is empty and that the adapter supports at least one data transfer mode.\n    //\n    if (!prompt) {\n        return createEmptyCompleteSegment<AiMsg>();\n    }\n\n    const adapterAsAny = adapter as Record<string, unknown>;\n    if (adapterAsAny.streamText === undefined && adapterAsAny.batchText === undefined\n        && adapterAsAny.streamServerComponent === undefined) {\n        return createEmptyErrorSegment<AiMsg>('no-data-transfer-mode-supported');\n    }\n\n    //\n    // We know that we will attempt to submit the prompt to the adapter.\n    // We create data structures for event listeners and submit function.\n    //\n    const segmentId = uid();\n    const userMessage = getUserMessageFromPrompt(prompt);\n\n    // (a.i). USER MESSAGE RECEIVED + (a.ii) CHAT SEGMENT COMPLETE + (a.iii) CHAT SEGMENT EXCEPTION\n    let userMessageReceivedCallbacks: Set<UserMessageReceivedCallback> | undefined = new Set();\n    let chatSegmentCompleteCallbacks: Set<ChatSegmentCompleteCallback<AiMsg>> | undefined = new Set();\n    let chatSegmentExceptionCallbacks: Set<ChatSegmentErrorCallback> | undefined = new Set();\n\n    // (b). AI MESSAGE RECEIVED\n    let aiMessageReceivedCallbacks: Set<AiMessageReceivedCallback<AiMsg>> | undefined = undefined;\n\n    // (c). AI ESM RECEIVED\n    let aiEsmStreamStartedCallbacks: Set<AiServerComponentStreamStartedCallback> | undefined = undefined;\n    let aiEsmStreamedCallbacks: Set<AiServerComponentStreamedCallback> | undefined = undefined;\n\n    // (d). AI MESSAGE STREAMED ( 3 events )\n    let aiMessageStreamStartedCallbacks: Set<AiMessageStreamStartedCallback<AiMsg>> | undefined = undefined;\n    let aiMessageStreamedCallbacks: Set<AiMessageStreamedCallback<AiMsg>> | undefined = undefined;\n    let aiMessageChunkReceivedCallbacks: Set<AiMessageChunkReceivedCallback<AiMsg>> | undefined = undefined;\n\n    //\n    // We start by emitting a user message received event.\n    //\n    triggerAsyncCallback(() => {\n        if (!userMessageReceivedCallbacks?.size) {\n            return;\n        }\n\n        userMessageReceivedCallbacks.forEach((callback) => {\n            callback(userMessage);\n        });\n\n        //\n        // (a.i) — USER MESSAGE RECEIVED — NOT NEEDED ANYMORE AFTER THIS POINT.\n        //\n        // Since the user message can only be emitted once, we don't need to keep the callbacks around.\n        // - We clear the callbacks after they have been called.\n        // - We also set the set to indicate that we should not register any more callbacks.\n        userMessageReceivedCallbacks.clear();\n        userMessageReceivedCallbacks = undefined;\n    });\n\n    const dataTransferModeToUse = getDataTransferModeToUse(adapter);\n    const contentTypeToGenerate = getContentTypeToGenerate(adapter);\n\n    if (contentTypeToGenerate === 'server-component') {\n        // (c). AI ESM RECEIVED — Only needed in ESM mode.\n        aiEsmStreamedCallbacks = new Set();\n        aiEsmStreamStartedCallbacks = new Set();\n\n        submitAndStreamServerComponentResponse(\n            segmentId,\n            userMessage,\n            adapter as ServerComponentChatAdapter<AiMsg>,\n            extras,\n            aiEsmStreamStartedCallbacks,\n            aiEsmStreamedCallbacks,\n            chatSegmentCompleteCallbacks,\n            chatSegmentExceptionCallbacks,\n        ).finally(() => {\n                // Finally -> Final status of the segment after complete or error has been emitted.\n                // At this point:\n                //   - No more items can be added to the segment.\n                //   - No more events will be emitted.\n                // We remove all listeners in an async manner to ensure that all events have been emitted.\n                triggerAsyncCallback(() => removeAllListeners());\n            },\n        );\n    } else {\n        if (dataTransferModeToUse === 'batch') {\n            // (b). AI MESSAGE RECEIVED — Only needed in batch mode.\n            aiMessageReceivedCallbacks = new Set();\n\n            submitAndBatchTextResponse(\n                segmentId,\n                userMessage,\n                adapter as ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n                extras,\n                aiMessageReceivedCallbacks,\n                chatSegmentCompleteCallbacks,\n                chatSegmentExceptionCallbacks,\n            ).finally(() => {\n                // Finally -> Final status of the segment after complete or error has been emitted.\n                // At this point:\n                //   - No more items can be added to the segment.\n                //   - No more events will be emitted.\n                // We remove all listeners in an async manner to ensure that all events have been emitted.\n                triggerAsyncCallback(() => removeAllListeners());\n            });\n        } else {\n            // (d). AI MESSAGE STREAMED ( 3 events ) — Only needed in streaming mode.\n            aiMessageStreamStartedCallbacks = new Set();\n            aiMessageStreamedCallbacks = new Set();\n            aiMessageChunkReceivedCallbacks = new Set();\n\n            submitAndStreamTextResponse(\n                segmentId,\n                userMessage,\n                adapter as ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>,\n                extras,\n                aiMessageStreamStartedCallbacks,\n                aiMessageStreamedCallbacks,\n                aiMessageChunkReceivedCallbacks,\n                chatSegmentCompleteCallbacks,\n                chatSegmentExceptionCallbacks,\n            ).finally(() => {\n                // Finally -> Final status of the segment after complete or error has been emitted.\n                // At this point:\n                //   - No more items can be added to the segment.\n                //   - No more events will be emitted.\n                // We remove all listeners in an async manner to ensure that all events have been emitted.\n                triggerAsyncCallback(() => removeAllListeners());\n            });\n        }\n    }\n\n    // Remove all listeners and destroy the segment.\n    const removeAllListeners = () => {\n        userMessageReceivedCallbacks?.clear();\n        userMessageReceivedCallbacks = undefined;\n\n        aiMessageReceivedCallbacks?.clear();\n        aiMessageReceivedCallbacks = undefined;\n\n        aiEsmStreamStartedCallbacks?.clear();\n        aiEsmStreamStartedCallbacks = undefined;\n\n        aiEsmStreamedCallbacks?.clear();\n        aiEsmStreamedCallbacks = undefined;\n\n        aiMessageStreamStartedCallbacks?.clear();\n        aiMessageStreamStartedCallbacks = undefined;\n\n        aiMessageStreamedCallbacks?.clear();\n        aiMessageStreamedCallbacks = undefined;\n\n        aiMessageChunkReceivedCallbacks?.clear();\n        aiMessageChunkReceivedCallbacks = undefined;\n\n        chatSegmentCompleteCallbacks?.clear();\n        chatSegmentCompleteCallbacks = undefined;\n\n        chatSegmentExceptionCallbacks?.clear();\n        chatSegmentExceptionCallbacks = undefined;\n    };\n\n    return {\n        segment: {\n            status: 'active',\n            uid: segmentId,\n            items: [], // Initially empty — User message will be added in callback above.\n        },\n        dataTransferMode: dataTransferModeToUse,\n        observable: {\n            get segmentId(): string {\n                return segmentId;\n            },\n            on: (event, callback) => {\n                if (event === 'userMessageReceived' && userMessageReceivedCallbacks) {\n                    userMessageReceivedCallbacks.add(\n                        callback as UserMessageReceivedCallback,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageReceived' && aiMessageReceivedCallbacks) {\n                    aiMessageReceivedCallbacks.add(\n                        callback as AiMessageReceivedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiServerComponentStreamStarted' && aiEsmStreamStartedCallbacks) {\n                    aiEsmStreamStartedCallbacks.add(\n                        callback as unknown as AiServerComponentStreamStartedCallback,\n                    );\n                    return;\n                }\n\n                if (event === 'aiServerComponentStreamed' && aiEsmStreamedCallbacks) {\n                    aiEsmStreamedCallbacks.add(\n                        callback as unknown as AiServerComponentStreamedCallback,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageStreamStarted' && aiMessageStreamStartedCallbacks) {\n                    aiMessageStreamStartedCallbacks.add(\n                        callback as AiMessageStreamStartedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageStreamed' && aiMessageStreamedCallbacks) {\n                    aiMessageStreamedCallbacks.add(\n                        callback as AiMessageStreamedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiChunkReceived' && aiMessageChunkReceivedCallbacks) {\n                    aiMessageChunkReceivedCallbacks.add(\n                        callback as unknown as AiMessageChunkReceivedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'complete' && chatSegmentCompleteCallbacks) {\n                    chatSegmentCompleteCallbacks.add(\n                        callback as unknown as ChatSegmentCompleteCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'error' && chatSegmentExceptionCallbacks) {\n                    chatSegmentExceptionCallbacks.add(\n                        callback as ChatSegmentErrorCallback,\n                    );\n                    return;\n                }\n            },\n            removeListener: (event, callback) => {\n                if (event === 'userMessageReceived') {\n                    userMessageReceivedCallbacks?.delete(\n                        callback as UserMessageReceivedCallback,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageReceived') {\n                    aiMessageReceivedCallbacks?.delete(\n                        callback as AiMessageReceivedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageStreamStarted') {\n                    aiMessageStreamStartedCallbacks?.delete(\n                        callback as AiMessageStreamStartedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiMessageStreamed') {\n                    aiMessageStreamedCallbacks?.delete(\n                        callback as AiMessageStreamedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'aiChunkReceived') {\n                    aiMessageChunkReceivedCallbacks?.delete(\n                        callback as unknown as AiMessageChunkReceivedCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'complete') {\n                    chatSegmentCompleteCallbacks?.delete(\n                        callback as unknown as ChatSegmentCompleteCallback<AiMsg>,\n                    );\n                    return;\n                }\n\n                if (event === 'error') {\n                    chatSegmentExceptionCallbacks?.delete(\n                        callback as ChatSegmentErrorCallback,\n                    );\n                    return;\n                }\n            },\n            destroy: () => removeAllListeners(),\n        },\n    };\n};\n","export const NLErrors = {\n    //\n    // Adapter config errors\n    //\n    'data-transfer-mode-not-supported': 'Requested data transfer mode is not supported',\n    'no-data-transfer-mode-supported': 'Adapter does not support any valid data transfer modes',\n\n    //\n    // Internet, HTTP, and API errors\n    //\n    'connection-error': 'Connection error',\n    'invalid-credentials': 'Invalid credentials',\n    'invalid-api-key': 'Invalid API key',\n    'http-server-side-error': 'HTTP server side error',\n    'http-client-side-error': 'HTTP client side error',\n\n    //\n    // Generic data loading errors\n    //\n    'failed-to-load-content': 'Failed to load content',\n    'failed-to-stream-content': 'Failed to stream content',\n    'failed-to-stream-server-component': 'Failed to stream server component',\n\n    //\n    // Content rendering errors\n    //\n    'failed-to-render-content': 'Failed to display content',\n};\n\nexport type NLErrorId = keyof typeof NLErrors;\n","import {ChatSegment} from '../../types/chatSegment/chatSegment';\nimport {ChatItem} from '../../types/conversation';\n\nexport const chatSegmentsToChatItems = <AiMsg>(\n    chatSegments: ChatSegment<AiMsg>[],\n): ChatItem<AiMsg>[] => {\n    const chatItems: ChatItem<AiMsg>[] = [];\n    chatSegments.forEach((segment) => {\n        segment.items.forEach((item) => {\n            if (item.status !== 'complete') {\n                return;\n            }\n\n            if (item.participantRole === 'assistant') {\n                chatItems.push({\n                    role: 'assistant',\n                    message: item.content as AiMsg,\n                });\n            } else {\n                if (item.participantRole === 'user') {\n                    return chatItems.push({\n                        role: 'user',\n                        message: item.content,\n                    });\n                }\n            }\n        });\n    });\n\n    return chatItems;\n};\n","import {ChatAdapterExtras} from '@shared/types/adapters/chat/chatAdapterExtras';\nimport {ChatSegment} from '@shared/types/chatSegment/chatSegment';\nimport {chatSegmentsToChatItems} from '@shared/utils/chat/chatSegmentsToChatItems';\nimport {useMemo} from 'react';\nimport {HistoryPayloadSize} from '../../../../../js/core/src';\nimport {reactPropsToCorePropsInEvents} from '../../utils/reactPropsToCorePropsInEvents';\nimport {AiChatProps} from '../props';\n\nexport const useAdapterExtras = <AiMsg>(\n    aiChatProps: AiChatProps<AiMsg>,\n    chatSegments: ChatSegment<AiMsg>[],\n    historyPayloadSize?: HistoryPayloadSize,\n): ChatAdapterExtras<AiMsg> => {\n    return useMemo(() => {\n        const allHistory = chatSegmentsToChatItems(chatSegments);\n        const conversationHistory = (historyPayloadSize === 'max' || historyPayloadSize === undefined)\n            ? allHistory\n            : (historyPayloadSize > 0)\n                ? allHistory.slice(-historyPayloadSize)\n                : undefined;\n\n        return {\n            aiChatProps: reactPropsToCorePropsInEvents<AiMsg>(aiChatProps),\n            conversationHistory,\n        };\n\n    }, [aiChatProps, chatSegments, historyPayloadSize]);\n};\n","import {ComposerOptions, EventsMap} from '@nlux/core';\nimport {ComposerStatus} from '@shared/components/Composer/props';\nimport {submitPrompt} from '@shared/services/submitPrompt/submitPromptImpl';\nimport {ChatAdapter as CoreChatAdapter} from '@shared/types/adapters/chat/chatAdapter';\nimport {ChatAdapterExtras} from '@shared/types/adapters/chat/chatAdapterExtras';\nimport {ServerComponentChatAdapter} from '@shared/types/adapters/chat/serverComponentChatAdapter';\nimport {isStandardChatAdapter, StandardChatAdapter} from '@shared/types/adapters/chat/standardChatAdapter';\nimport {ChatSegment} from '@shared/types/chatSegment/chatSegment';\nimport {ChatSegmentAiMessage} from '@shared/types/chatSegment/chatSegmentAiMessage';\nimport {ChatSegmentUserMessage} from '@shared/types/chatSegment/chatSegmentUserMessage';\nimport {NLErrors} from '@shared/types/exceptions/errors';\nimport {warn} from '@shared/utils/warn';\nimport {MutableRefObject, useCallback, useEffect, useMemo, useRef} from 'react';\nimport {ImperativeConversationCompProps} from '../../sections/Conversation/props';\nimport {ChatAdapter} from '../../types/chatAdapter';\nimport {AiChatProps} from '../props';\nimport {useAdapterExtras} from './useAdapterExtras';\n\ntype SubmitPromptHandlerProps<AiMsg> = {\n    aiChatProps: AiChatProps<AiMsg>;\n    adapterToUse?: ChatAdapter<AiMsg> | StandardChatAdapter<AiMsg>;\n    prompt: string;\n    composerOptions?: ComposerOptions;\n    initialSegment?: ChatSegment<AiMsg>;\n    cancelledSegmentIds: Array<string>;\n    cancelledMessageIds: Array<string>;\n    newSegments: ChatSegment<AiMsg>[];\n    showException: (message: string) => void;\n    setChatSegments: (segments: ChatSegment<AiMsg>[]) => void;\n    setComposerStatus: (status: ComposerStatus) => void;\n    setPrompt: (prompt: string) => void;\n    conversationRef: MutableRefObject<ImperativeConversationCompProps<AiMsg> | null>\n};\n\nexport const useSubmitPromptHandler = <AiMsg>(props: SubmitPromptHandlerProps<AiMsg>) => {\n    const {\n        aiChatProps,\n        adapterToUse,\n        prompt: promptTyped,\n        composerOptions,\n        showException,\n        initialSegment,\n        newSegments,\n        cancelledSegmentIds,\n        cancelledMessageIds,\n        setChatSegments,\n        setComposerStatus,\n        setPrompt,\n        conversationRef,\n    } = props;\n\n    const hasValidInput = useMemo(() => promptTyped.length > 0, [promptTyped]);\n\n    // The prompt typed will be read by the submitPrompt function, but it will not be used as a\n    // dependency for the submitPrompt function (only the promptToSubmit is a dependency to useCallback).\n    // Hence, the use of useRef to store the value and access it within the submitPrompt function, without\n    // causing the memoized function to be re-created.\n    const promptTypedRef = useRef(promptTyped);\n    promptTypedRef.current = promptTyped;\n\n    // React functions and state that can be accessed by non-React DOM update code\n    const domToReactRef = useRef({\n        newSegments,\n        cancelledSegmentIds,\n        cancelledMessageIds,\n        setChatSegments,\n        setComposerStatus,\n        showException,\n        setPrompt,\n    });\n\n    // Callback events can be used by the non-React DOM update code\n    const callbackEvents = useRef<Partial<EventsMap<AiMsg>>>({});\n\n    useEffect(() => {\n        domToReactRef.current = {\n            newSegments,\n            cancelledSegmentIds,\n            cancelledMessageIds,\n            setChatSegments,\n            setComposerStatus,\n            showException,\n            setPrompt,\n        };\n    }, [\n        newSegments, cancelledSegmentIds, cancelledMessageIds,\n        setChatSegments, setComposerStatus, showException, setPrompt,\n    ]);\n\n    const adapterExtras: ChatAdapterExtras<AiMsg> = useAdapterExtras(\n        aiChatProps,\n        initialSegment ? [initialSegment, ...newSegments] : newSegments,\n        aiChatProps.conversationOptions?.historyPayloadSize,\n    );\n\n    useEffect(() => {\n        callbackEvents.current = aiChatProps.events || {};\n    }, [aiChatProps.events]);\n\n    return useCallback(\n        () => {\n            if (!adapterToUse) {\n                warn('No valid adapter was provided to AiChat component');\n                return;\n            }\n\n            if (!hasValidInput) {\n                return;\n            }\n\n            if (composerOptions?.disableSubmitButton) {\n                return;\n            }\n\n            setComposerStatus('submitting-prompt');\n            const promptToSubmit = promptTyped;\n            const streamedMessageIds: Set<string> = new Set();\n\n            const adapterBridge: CoreChatAdapter<AiMsg> | ServerComponentChatAdapter<AiMsg> | StandardChatAdapter<AiMsg> = isStandardChatAdapter(\n                adapterToUse)\n                ? adapterToUse as StandardChatAdapter<AiMsg>\n                : (\n                    (adapterToUse as ChatAdapter<AiMsg>).streamServerComponent ? {\n                        streamServerComponent: (adapterToUse as ChatAdapter<AiMsg>).streamServerComponent!,\n                    } satisfies ServerComponentChatAdapter<AiMsg> : {\n                        batchText: (adapterToUse as CoreChatAdapter<AiMsg>).batchText,\n                        streamText: (adapterToUse as CoreChatAdapter<AiMsg>).streamText,\n                    } satisfies CoreChatAdapter<AiMsg>\n                );\n\n            //\n            // ⭐️ Important\n            // This is where the prompt is submitted to the API.\n            //\n            const {\n                segment: chatSegment,\n                observable: chatSegmentObservable,\n            } = submitPrompt<AiMsg>(\n                promptToSubmit,\n                adapterBridge,\n                adapterExtras,\n            );\n\n            if (chatSegment.status === 'error') {\n                warn('Error occurred while submitting prompt');\n                showException('Error occurred while submitting prompt');\n                setComposerStatus('typing');\n\n                // Reset the prompt if the composer is empty\n                if (promptTypedRef.current === '') {\n                    setPrompt(promptToSubmit);\n                }\n                return;\n            }\n\n            // THE FOLLOWING CODE IS USED TO TRIGGER AN UPDATE OF THE REACT STATE.\n            // The 'on' event listeners are implemented by @nlux/core non-React prompt handler.\n            // On 'complete' and 'update' events, the chat segment is updated, but in order\n            // to trigger a check and potentially re-render the React component, we need to change\n            // the reference of the parts array by creating a new array.\n\n            const handleSegmentItemReceived = (item: ChatSegmentAiMessage<AiMsg> | ChatSegmentUserMessage) => {\n                const currentChatSegments = domToReactRef.current.newSegments;\n                const newChatSegments: ChatSegment<AiMsg>[] = currentChatSegments.map(\n                    (currentChatSegment) => {\n                        if (currentChatSegment.uid !== chatSegmentObservable.segmentId) {\n                            return currentChatSegment;\n                        }\n\n                        return {\n                            ...currentChatSegment,\n                            items: [\n                                ...currentChatSegment.items,\n                                {...item},\n                            ],\n                        };\n                    },\n                );\n\n                domToReactRef.current.setChatSegments(newChatSegments);\n            };\n\n            chatSegmentObservable.on('userMessageReceived', (userMessage) => {\n                if (domToReactRef.current?.cancelledMessageIds.includes(userMessage.uid)) {\n                    return;\n                }\n\n                handleSegmentItemReceived(userMessage);\n                if (callbackEvents.current?.messageSent) {\n                    callbackEvents.current.messageSent({\n                        uid: userMessage.uid,\n                        message: userMessage.content,\n                    });\n                }\n            });\n\n            chatSegmentObservable.on('aiMessageStreamStarted', (aiStreamedMessage) => {\n                if (domToReactRef.current?.cancelledMessageIds.includes(aiStreamedMessage.uid)) {\n                    return;\n                }\n\n                handleSegmentItemReceived(aiStreamedMessage);\n                domToReactRef.current.setComposerStatus('waiting');\n                if (promptTypedRef.current === promptToSubmit) {\n                    domToReactRef.current.setPrompt('');\n                }\n\n                streamedMessageIds.add(aiStreamedMessage.uid);\n                if (callbackEvents.current?.messageStreamStarted) {\n                    callbackEvents.current.messageStreamStarted({uid: aiStreamedMessage.uid});\n                }\n            });\n\n            chatSegmentObservable.on('aiServerComponentStreamStarted', (aiServerComponentMessage) => {\n                if (domToReactRef.current?.cancelledMessageIds.includes(aiServerComponentMessage.uid)) {\n                    return;\n                }\n\n                handleSegmentItemReceived(aiServerComponentMessage);\n                domToReactRef.current.setComposerStatus('waiting');\n                if (promptTypedRef.current === promptToSubmit) {\n                    domToReactRef.current.setPrompt('');\n                }\n\n                streamedMessageIds.add(aiServerComponentMessage.uid);\n                if (callbackEvents.current?.serverComponentStreamStarted) {\n                    callbackEvents.current?.serverComponentStreamStarted({uid: aiServerComponentMessage.uid});\n                }\n            });\n\n            chatSegmentObservable.on('aiServerComponentStreamed', (streamedServerComponent) => {\n                if (domToReactRef.current?.cancelledMessageIds.includes(streamedServerComponent.uid)) {\n                    return;\n                }\n\n                if (callbackEvents.current?.serverComponentRendered\n                    && !domToReactRef.current.cancelledMessageIds.includes(streamedServerComponent.uid)) {\n                    callbackEvents.current?.serverComponentRendered({uid: streamedServerComponent.uid});\n                }\n            });\n\n            chatSegmentObservable.on('aiMessageReceived', (aiMessage) => {\n                if (domToReactRef.current?.cancelledMessageIds.includes(aiMessage.uid)) {\n                    return;\n                }\n\n                const currentChatSegments = domToReactRef.current.newSegments;\n                const newChatSegments: ChatSegment<AiMsg>[] = currentChatSegments.map(\n                    (currentChatSegment) => {\n                        if (currentChatSegment.uid !== chatSegmentObservable.segmentId) {\n                            return currentChatSegment;\n                        }\n\n                        return {...currentChatSegment, items: [...currentChatSegment.items, {...aiMessage}]};\n                    },\n                );\n\n                domToReactRef.current.setChatSegments(newChatSegments);\n                if (callbackEvents.current?.messageReceived) {\n                    callbackEvents.current.messageReceived({\n                        uid: aiMessage.uid,\n                        message: aiMessage.content,\n                    });\n                }\n            });\n\n            chatSegmentObservable.on('complete', (completeChatSegment) => {\n                if (domToReactRef.current?.cancelledMessageIds.includes(completeChatSegment.uid)) {\n                    return;\n                }\n\n                domToReactRef.current.setComposerStatus('typing');\n                const currentChatSegments = domToReactRef.current.newSegments;\n                const newChatSegments: ChatSegment<AiMsg>[] = currentChatSegments.map(\n                    (currentChatSegment) => {\n                        if (currentChatSegment.uid !== chatSegmentObservable.segmentId) {\n                            return currentChatSegment;\n                        }\n\n                        return {...completeChatSegment};\n                    },\n                );\n\n                domToReactRef.current.setChatSegments(newChatSegments);\n                if (promptTypedRef.current === promptToSubmit) {\n                    setPrompt('');\n                }\n\n                if (streamedMessageIds.size > 0) {\n                    streamedMessageIds.forEach((messageId) => {\n                        requestAnimationFrame(() => {\n                            conversationRef.current?.completeStream(chatSegmentObservable.segmentId, messageId);\n                        });\n                    });\n\n                    streamedMessageIds.clear();\n                }\n            });\n\n            chatSegmentObservable.on('aiChunkReceived', ({messageId, chunk}) => {\n                if (domToReactRef.current?.cancelledMessageIds.includes(messageId)) {\n                    return;\n                }\n\n                conversationRef.current?.streamChunk(chatSegment.uid, messageId, chunk);\n            });\n\n            chatSegmentObservable.on('aiMessageStreamed', (streamedMessage) => {\n                if (domToReactRef.current?.cancelledMessageIds.includes(streamedMessage.uid)) {\n                    return;\n                }\n\n                if (callbackEvents.current?.messageReceived) {\n                    callbackEvents.current?.messageReceived({\n                        uid: streamedMessage.uid,\n                        // In streamed messages, the AiMsg is always a string\n                        message: streamedMessage.content as AiMsg,\n                    });\n                }\n            });\n\n            chatSegmentObservable.on('error', (errorId, errorObject) => {\n                const parts = domToReactRef.current.newSegments;\n                const newParts = parts.filter((part) => part.uid !== chatSegment.uid);\n                const errorMessage = NLErrors[errorId];\n\n                domToReactRef.current.setChatSegments(newParts);\n                domToReactRef.current.setComposerStatus('typing');\n                domToReactRef.current.showException(errorMessage);\n\n                if (promptTypedRef.current === '') {\n                    setPrompt(promptToSubmit);\n                }\n\n                if (callbackEvents.current?.error) {\n                    callbackEvents.current.error({\n                        errorId,\n                        message: errorMessage,\n                        errorObject,\n                    });\n                }\n            });\n\n            domToReactRef.current.setChatSegments([\n                ...domToReactRef.current.newSegments,\n                chatSegment,\n            ]);\n        },\n        [\n            promptTyped,\n            adapterToUse,\n            adapterExtras,\n            showException,\n            domToReactRef,\n            composerOptions?.disableSubmitButton,\n        ],\n    );\n};\n","import {className as compLoaderClassName} from '@shared/components/Loader/create';\n\nexport const LoaderComp = () => {\n    return (\n        <div className={compLoaderClassName}>\n            <div className=\"nlux-comp-loaderContainer\"><span className=\"spinning-loader\"></span></div>\n        </div>\n    );\n};\n","import {FunctionComponent, PropsWithChildren} from 'react';\n\n/**\n * A wrapper around a user-provided greeting component.\n * When used, it will override the default greeting component.\n */\nexport const Greeting: FunctionComponent<PropsWithChildren> = (props) => {\n    return <>{props.children}</>;\n};\n","import {FunctionComponent, PropsWithChildren} from 'react';\n\n/**\n * A wrapper around a user-provided Loader.\n * When used, it will override the default NLUX Loader.\n */\nexport const Loader: FunctionComponent<PropsWithChildren> = (props) => {\n    return <>{props.children}</>;\n};\n","import {ReactElement} from 'react';\nimport {Greeting} from './elements/Greeting';\nimport {Loader} from './elements/Loader';\n\nexport type AiChatUIOverrides = {\n    Loader: ReactElement;\n    Greeting?: ReactElement;\n}\n\n/**\n * Wrapper for possible UI components that can be overridden in the default NLUX chat components.\n */\nexport const AiChatUI = {\n    Loader,\n    Greeting,\n};\n","import {PropsWithChildren, ReactElement, useMemo} from 'react';\nimport {LoaderComp} from '../../components/Loader/LoaderComp';\nimport {AiChatUI, AiChatUIOverrides} from '../AiChatUI';\n\nexport const useUiOverrides = (props: PropsWithChildren): AiChatUIOverrides => {\n    const possibleUiOverrides: Array<ReactElement> = useMemo(() => {\n        if (!props.children) {\n            return [];\n        }\n\n        return Array.isArray(props.children) ? props.children : [props.children];\n    }, [props.children]);\n\n    const Loader: ReactElement = useMemo(() => {\n        if (possibleUiOverrides.length === 0) {\n            return <LoaderComp/>;\n        }\n\n        const loaderOverride = possibleUiOverrides\n            .find((child) => child.type === AiChatUI.Loader);\n        return loaderOverride || <LoaderComp/>;\n    }, [possibleUiOverrides]);\n\n    const Greeting: ReactElement | undefined = useMemo(() => {\n        if (possibleUiOverrides.length === 0) {\n            return undefined;\n        }\n\n        return possibleUiOverrides\n            .find((child) => child.type === AiChatUI.Greeting);\n    }, [possibleUiOverrides]);\n\n    return {\n        Loader,\n        Greeting,\n    };\n};\n","import {useMemo} from 'react';\n\n/**\n * In order to implement an optimized streaming experience, we cannot rely on React to manage the DOM elements\n * of the streaming messages. React UI is a function of state, and re-rendering the entire UI for every message\n * chunk would be inefficient. Instead, we use a service to manage the DOM elements of the streaming messages.\n *\n * This service creates a DOM element for each message ID and caches it. When a message ID is no longer needed,\n * the service deletes the DOM element. This way, we only have to update the DOM elements that are currently\n * visible on the screen.\n *\n * The NLUX stream renderer uses this service to obtain the DOM element for each message ID and will update them\n * in a very efficient way when new chunks are received.\n */\n\nexport type MarkdownContainersController = {\n    getStreamingDomElement: (messageId: string) => HTMLDivElement;\n    deleteStreamingDomElement: (messageId: string) => void;\n};\n\nexport const usMarkdownContainers: () => MarkdownContainersController = () => {\n    const streamingDomElementsByMessageId: Record<string, HTMLDivElement> = {};\n    const victimMessageIds: Set<string> = new Set();\n\n    return useMemo<MarkdownContainersController>(() => ({\n        getStreamingDomElement: (messageId: string) => {\n            if (victimMessageIds.has(messageId)) {\n                victimMessageIds.delete(messageId);\n            }\n\n            if (streamingDomElementsByMessageId[messageId] === undefined) {\n                const newStreamContainer = document.createElement('div');\n                newStreamContainer.setAttribute('nlux-message-id', messageId);\n                newStreamContainer.className = 'nlux-markdown-container';\n                streamingDomElementsByMessageId[messageId] = newStreamContainer;\n            }\n\n            return streamingDomElementsByMessageId[messageId];\n        },\n        deleteStreamingDomElement: (messageId: string) => {\n            victimMessageIds.add(messageId);\n            setTimeout(() => {\n                victimMessageIds.forEach((victimMessageId) => {\n                    if (streamingDomElementsByMessageId[victimMessageId]) {\n                        streamingDomElementsByMessageId[victimMessageId].remove();\n                        delete streamingDomElementsByMessageId[victimMessageId];\n                    }\n                });\n\n                victimMessageIds.clear();\n            }, 1000);\n        },\n    }), []);\n};\n","'use client';\nimport {ComposerStatus} from '@shared/components/Composer/props';\nimport {createExceptionsBoxController} from '@shared/components/ExceptionsBox/control';\nimport {className as compExceptionsBoxClassName} from '@shared/components/ExceptionsBox/create';\nimport {ChatSegment} from '@shared/types/chatSegment/chatSegment';\nimport {chatItemsToChatSegment} from '@shared/utils/chat/chatItemsToChatSegment';\nimport {getRootClassNames, getSystemColorScheme} from '@shared/utils/dom/getRootClassNames';\nimport {warnOnce} from '@shared/utils/warn';\nimport {forwardRef, ReactElement, useCallback, useEffect, useMemo, useRef, useState} from 'react';\nimport {ComposerComp} from '../sections/Composer/ComposerComp';\nimport {ConversationComp} from '../sections/Conversation/ConversationComp';\nimport {ImperativeConversationCompProps} from '../sections/Conversation/props';\nimport {LaunchPad} from '../sections/LaunchPad/LaunchPad';\nimport {ConversationStarter} from '../types/conversationStarter';\nimport {adapterParamToUsableAdapter} from '../utils/adapterParamToUsableAdapter';\nimport {usePreDestroyEventTrigger} from './events/usePreDestroyEventTrigger';\nimport {useReadyEventTrigger} from './events/useReadyEventTrigger';\nimport {AiChatInternalApi} from './hooks/useAiChatApi';\nimport {useAiChatStyle} from './hooks/useAiChatStyle';\nimport {useAutoScrollController} from './hooks/useAutoScrollController';\nimport {useCancelLastMessage} from './hooks/useCancelLastMessage';\nimport {useLastActiveSegmentChangeHandler} from './hooks/useLastActiveSegmentChangeHandler';\nimport {usePrimitivesContext} from './hooks/usePrimitivesContext';\nimport {useResubmitPromptHandler} from './hooks/useResubmitPromptHandler';\nimport {useSubmitPromptHandler} from './hooks/useSubmitPromptHandler';\nimport {useUiOverrides} from './hooks/useUiOverrides';\nimport {usMarkdownContainers} from './hooks/usMarkdownContainers';\nimport {AiChatProps} from './props';\n\nexport const AiChat: <AiMsg>(\n    props: AiChatProps<AiMsg>,\n) => ReactElement = function <AiMsg>(\n    props: AiChatProps<AiMsg>,\n): ReactElement {\n    const {\n        adapter, className, initialConversation,\n        conversationOptions, composerOptions, displayOptions,\n    } = props;\n\n    const {themeId, colorScheme} = displayOptions ?? {};\n\n    // References to DOM elements and React components:\n    // These are used for advanced interactions such as scrolling, streaming, and exceptions animation\n    const conversationRef = useRef<ImperativeConversationCompProps<AiMsg>>(null);\n    const conversationContainerRef = useRef<HTMLDivElement>(null);\n    const lastActiveSegmentIdRef = useRef<string | undefined>(undefined);\n    const exceptionBoxRef = useRef<HTMLDivElement>(null);\n\n    // Controllers for some of the references above\n    const autoScrollController = useAutoScrollController(conversationContainerRef, conversationOptions?.autoScroll);\n    const exceptionBoxController = useMemo(() => {\n        return exceptionBoxRef.current ? createExceptionsBoxController(exceptionBoxRef.current) : undefined;\n    }, [exceptionBoxRef.current]);\n    const markdownContainersController = usMarkdownContainers();\n\n    // Context state\n    const {PrimitivesContextProvider} = usePrimitivesContext({messageOptions: props.messageOptions});\n\n    // Regular component state\n    const [prompt, setPrompt] = useState('');\n    const [composerStatus, setComposerStatus] = useState<ComposerStatus>('typing');\n    const [initialSegment, setInitialSegment] = useState<ChatSegment<AiMsg>>();\n    const [newSegments, setChatSegments] = useState<ChatSegment<AiMsg>[]>([]);\n    const [cancelledSegmentIds, setCancelledSegmentIds] = useState<Array<string>>([]);\n    const [cancelledMessageIds, setCancelledMessageIds] = useState<Array<string>>([]);\n\n    // Derived state and memoized values\n    const segments = useMemo(\n        () => (initialSegment ? [initialSegment, ...newSegments] : newSegments),\n        [initialSegment, newSegments],\n    );\n\n    const adapterToUse = useMemo(() => adapterParamToUsableAdapter<AiMsg>(adapter), [adapter]);\n    const rootStyle = useAiChatStyle(displayOptions);\n    const rootClassNames = useMemo(\n        () => getRootClassNames({className, themeId}).join(' '),\n        [className, themeId],\n    );\n\n    const colorSchemeToApply = useMemo(\n        () => (colorScheme === 'auto' || !colorScheme) ? getSystemColorScheme() : colorScheme,\n        [colorScheme],\n    );\n\n    // Callbacks and handlers for user interactions and events\n    const showException = useCallback(\n        (message: string) => exceptionBoxController?.displayException(message),\n        [exceptionBoxController],\n    );\n\n    const cancelLastMessageRequest = useCancelLastMessage<AiMsg>(\n        newSegments, cancelledSegmentIds, cancelledMessageIds,\n        setChatSegments, setCancelledSegmentIds, setCancelledMessageIds,\n        conversationRef, setComposerStatus,\n    );\n\n    const handlePromptChange = useCallback((value: string) => setPrompt(value), [setPrompt]);\n    const handleSubmitPrompt = useSubmitPromptHandler<AiMsg>({\n        aiChatProps: props, adapterToUse, conversationRef, initialSegment, newSegments,\n        cancelledMessageIds, cancelledSegmentIds, prompt, composerOptions, showException,\n        setChatSegments, setComposerStatus, setPrompt,\n    });\n\n    const handleResubmitPrompt = useResubmitPromptHandler(\n        initialSegment, setInitialSegment, newSegments, setChatSegments, setPrompt, setComposerStatus,\n    );\n\n    const handleMarkdownStreamRendered = useCallback((_segmentId: string, messageId: string) => {\n        if (props.events?.messageRendered) {\n            props.events.messageRendered({uid: messageId});\n        }\n    }, []);\n\n    const handleConversationStarterSelected = useCallback(\n        (conversationStarter: ConversationStarter) => {\n            setPrompt(conversationStarter.prompt);\n            setComposerStatus('submitting-conversation-starter');\n        },\n        [setPrompt, setComposerStatus],\n    );\n\n    const handleLastActiveSegmentChange = useLastActiveSegmentChangeHandler(\n        autoScrollController, lastActiveSegmentIdRef,\n    );\n\n    useEffect(() => {\n        // Effect used to wait for the 'submitting-conversation-starter' status to submit the prompt\n        if (composerStatus === 'submitting-conversation-starter' || composerStatus === 'submitting-external-message'\n            || composerStatus === 'submitting-edit') {\n            handleSubmitPrompt();\n        }\n    }, [composerStatus, handleSubmitPrompt]);\n\n    useEffect(() => setInitialSegment(\n        initialConversation ? chatItemsToChatSegment(initialConversation) : undefined,\n    ), [initialConversation]);\n\n    useEffect(() => {\n        if (initialSegment) {\n            conversationContainerRef.current?.scrollTo({behavior: 'smooth', top: 50000});\n        }\n    }, [initialSegment]);\n\n    const internalApiRef = useRef<AiChatInternalApi | undefined>(undefined);\n\n    useEffect(() => {\n        const internalApi = props.api as unknown as AiChatInternalApi | undefined;\n        internalApiRef.current = internalApi;\n\n        if (typeof internalApi?.__setHost === 'function') {\n            internalApi.__setHost({\n                sendMessage: (prompt: string) => {\n                    setPrompt(prompt);\n                    setComposerStatus('submitting-external-message');\n                },\n                resetConversation: () => {\n                    setChatSegments([]);\n                    setInitialSegment(undefined);\n                },\n                cancelLastMessageRequest,\n            });\n        } else {\n            warnOnce(\n                'API object passed was is not compatible with AiChat.\\n' +\n                'Only use API objects created by the useAiChatApi() hook.',\n            );\n        }\n    }, [\n        props.api, cancelLastMessageRequest,\n        setPrompt, setComposerStatus, setChatSegments, setInitialSegment,\n    ]);\n\n    useEffect(() => () => {\n        if (typeof internalApiRef.current?.__unsetHost === 'function') {\n            internalApiRef.current.__unsetHost();\n            internalApiRef.current = undefined;\n        }\n    }, []);\n\n    // Lifecycle event triggers\n    useReadyEventTrigger<AiMsg>(props);\n    usePreDestroyEventTrigger<AiMsg>(props, segments);\n    const ForwardConversationComp = useMemo(\n        () => forwardRef(ConversationComp<AiMsg>), [],\n    );\n\n    // UI overrides\n    const uiOverrides = useUiOverrides(props);\n\n    // Variables that do not require memoization or effect\n    const hasValidInput = prompt.length > 0;\n    const compChatRoomStatusClassName = segments.length === 0 ? 'nlux-chatRoom-starting' : 'nlux-chatRoom-active';\n\n    // This should never happen when using typescript, but since adapter critical to the rest of the <AiChat />\n    // component, do add a check and a warning in case it is not provided.\n    if (!adapterToUse) {\n        warnOnce('AiChat: No valid adapter provided. The component will not render.');\n        return <></>;\n    }\n\n    return (\n        <PrimitivesContextProvider>\n            <div className={rootClassNames} style={rootStyle} data-color-scheme={colorSchemeToApply}>\n                <div className={compExceptionsBoxClassName} ref={exceptionBoxRef}/>\n                <div className={`nlux-chatRoom-container ${compChatRoomStatusClassName}`}>\n                    <div className=\"nlux-launchPad-container\">\n                        <LaunchPad\n                            segments={segments}\n                            onConversationStarterSelected={handleConversationStarterSelected}\n                            conversationOptions={conversationOptions}\n                            personaOptions={props.personaOptions}\n                            userDefinedGreeting={uiOverrides.Greeting}\n                        />\n                    </div>\n                    <div className=\"nlux-conversation-container\" ref={conversationContainerRef} aria-label=\"Chat conversation\" role=\"log\">\n                        <ForwardConversationComp\n                            ref={conversationRef}\n                            segments={segments}\n                            conversationOptions={props.conversationOptions}\n                            personaOptions={props.personaOptions}\n                            messageOptions={props.messageOptions}\n                            onLastActiveSegmentChange={handleLastActiveSegmentChange}\n                            Loader={uiOverrides.Loader}\n                            markdownContainersController={markdownContainersController}\n                            submitShortcutKey={props.composerOptions?.submitShortcut}\n                            onPromptResubmit={handleResubmitPrompt}\n                            onMarkdownStreamRendered={handleMarkdownStreamRendered}\n                        />\n                    </div>\n                    <div className=\"nlux-composer-container\">\n                        <ComposerComp\n                            status={composerStatus}\n                            prompt={prompt}\n                            hasValidInput={hasValidInput}\n                            placeholder={props.composerOptions?.placeholder}\n                            autoFocus={props.composerOptions?.autoFocus}\n                            submitShortcut={props.composerOptions?.submitShortcut}\n                            hideStopButton={props.composerOptions?.hideStopButton}\n                            onChange={handlePromptChange}\n                            onSubmit={handleSubmitPrompt}\n                            onCancel={cancelLastMessageRequest}\n                            Loader={uiOverrides.Loader}\n                        />\n                    </div>\n                </div>\n            </div>\n        </PrimitivesContextProvider>\n    );\n};\n","import {useRef} from 'react';\n\n/**\n * AiChat API methods.\n */\nexport type AiChatApi = {\n    /**\n     * API methods related to sending messages.\n     */\n    composer: {\n        /**\n         * Types the message in the composer and sends it to the chat adapter automatically.\n         *\n         * @param {string} prompt\n         */\n        send: (prompt: string) => void;\n\n        /**\n         * Cancel the request being sent.\n         * If a message is being sent, it will be cancelled.\n         * If a message is being generated (in streaming mode), the generation will stop and the message will deleted.\n         * If no message is being sent, this method does nothing.\n         */\n        cancel: () => void;\n    },\n    /**\n     * API methods related to the conversation.\n     */\n    conversation: {\n        /**\n         * Reset the conversation.\n         */\n        reset: () => void;\n    }\n};\n\nexport type AiChatInternalApi = AiChatApi & {\n    __setHost: (host: AiChatHost) => void;\n    __unsetHost: () => void;\n};\n\nexport type AiChatHost = {\n    sendMessage: (prompt: string) => void;\n    resetConversation: () => void;\n    cancelLastMessageRequest: () => void;\n};\n\nconst createVoidInternalApi = (setHost: (host: AiChatHost) => void = () => {\n}): AiChatInternalApi => {\n    return {\n        composer: {\n            send: (prompt: string) => {\n                throw new Error('AiChatApi is not connected to a host <AiChat /> component.');\n            },\n            cancel: () => {\n                throw new Error('AiChatApi is not connected to a host <AiChat /> component.');\n            },\n        },\n\n        conversation: {\n            reset: () => {\n                throw new Error('AiChatApi is not connected to a host <AiChat /> component.');\n            },\n        },\n\n        // @ts-ignore\n        __setHost: (host: AiChatApiHost) => {\n            setHost(host);\n        },\n\n        // @ts-ignore\n        __unsetHost: () => {\n            // Do nothing\n        },\n    };\n};\n\n/**\n * Hook to get the AiChat API reference.\n *\n * @returns {AiChatApi}\n */\nexport const useAiChatApi = (): AiChatApi => {\n    const currentHost = useRef<AiChatHost | null>(null);\n    const api = useRef<AiChatInternalApi>(createVoidInternalApi());\n\n    api.current.composer.send = (prompt: string) => {\n        if (!currentHost.current) {\n            throw new Error('AiChatApi is not connected to a host <AiChat /> component.');\n        }\n\n        currentHost.current.sendMessage(prompt);\n    };\n\n    api.current.composer.cancel = () => {\n        if (!currentHost.current) {\n            throw new Error('AiChatApi is not connected to a host <AiChat /> component.');\n        }\n\n        currentHost.current.cancelLastMessageRequest();\n    };\n\n    api.current.conversation.reset = () => {\n        if (!currentHost.current) {\n            throw new Error('AiChatApi is not connected to a host <AiChat /> component.');\n        }\n\n        currentHost.current.resetConversation();\n    };\n\n    // @ts-ignore\n    api.current.__setHost = (host: AiChatHost) => {\n        currentHost.current = host;\n    };\n\n    // @ts-ignore\n    api.current.__unsetHost = () => {\n        currentHost.current = null;\n    };\n\n    return api.current;\n};\n","import {useContext, useMemo} from 'react';\nimport {MarkdownSnapshotRenderer} from '../../sections/MessageRenderer/MarkdownSnapshotRenderer';\nimport {primitivesContext} from '../hooks/usePrimitivesContext';\n\n/**\n * A primitive to parse markdown using the same parser as the one used in markdown streams.\n * This will also generate the appropriate HTML tags for code blocks and syntax highlighting.\n *\n * @param children\n */\nexport const Markdown = ({children}: MarkdownProps) => {\n    const uid = useMemo(() => Math.random().toString(36).substring(7), []);\n    const primitivesContextData = useContext(primitivesContext);\n    const childrenAsString = Array.isArray(children) ? children.join('') : children;\n    return (\n        <MarkdownSnapshotRenderer\n            markdownOptions={primitivesContextData.messageOptions}\n            content={childrenAsString}\n            messageUid={uid}\n        />\n    );\n};\n\nexport type MarkdownProps = {\n    /**\n     * The markdown content to be parsed, provided as a string or an array of strings\n     * inside the component.\n     */\n    children: string | Array<string>;\n};\n","import {BatchSend} from '@shared/types/adapters/chat/chatAdapter';\nimport {DependencyList, useMemo} from 'react';\nimport {ChatAdapter} from '../../types/chatAdapter';\n\n/**\n * Use the function provided as a batch adapter to send and receive messages in a single batch.\n *\n * @param send\n * @param dependencies\n */\nexport const useAsBatchAdapter = function <AiMsg = string>(\n    send: BatchSend<AiMsg>,\n    dependencies?: DependencyList,\n): ChatAdapter<AiMsg> {\n\n    return useMemo(\n        () => ({batchText: send}),\n        dependencies ?? [{}], // If no dependencies are provided, we use an empty object to force the hook\n        // to run every time (no memoization).\n    );\n};\n","import {StreamSend} from '@shared/types/adapters/chat/chatAdapter';\nimport {DependencyList, useMemo} from 'react';\nimport {ChatAdapter} from '../../types/chatAdapter';\n\n/**\n * Use the function provided as a stream adapter to send messages and receive responses in a stream of chunks.\n *\n * @param submit\n * @param dependencies\n */\nexport const useAsStreamAdapter = function <AiMsg = string>(\n    submit: StreamSend<AiMsg>, dependencies?: DependencyList,\n): ChatAdapter<AiMsg> {\n\n    return useMemo(\n        () => ({streamText: submit}),\n        dependencies ?? [{}], // If no dependencies are provided, we use an empty object to force the hook\n        // to run every time (no memoization).\n    );\n};\n","import {FunctionComponent, isValidElement, lazy, ReactNode, Suspense, useEffect, useState} from 'react';\nimport {warn} from '@shared/utils/warn';\nimport {ChatAdapter} from '../../types/chatAdapter';\nimport {\n    StreamedServerComponent,\n    StreamedServerComponentProps,\n} from '@shared/types/adapters/chat/serverComponentChatAdapter';\n\nexport type RscAdapterState = 'idle' | 'loading' | 'success' | 'error';\n\n/**\n * This hook is used to create a ChatAdapter that uses a React Server Component (RSC) as the assistant message.\n * The RSC is loaded asynchronously. The user prompt and the adapter extras are passed to the RSC as props.\n *\n * @param {Promise<StreamedServerComponent>} moduleLoadingPromise\n * @param {React.ReactNode} loader\n * @returns {ChatAdapter}\n */\nexport const useAsRscAdapter = function (\n    moduleLoadingPromise: Promise<StreamedServerComponent>,\n    loader?: ReactNode,\n): ChatAdapter {\n    return {\n        streamServerComponent: (\n            message,\n            extras,\n            events,\n        ) => {\n            return () => {\n                const [state, setState] = useState<\n                    RscAdapterState\n                >('idle');\n\n                const [\n                    AssistantMessage,\n                    setAssistantMessage,\n                ] = useState<FunctionComponent | null>(null);\n\n                // Start loading the RSC as soon as the component is mounted\n                useEffect(() => {\n                    setState('loading');\n                    moduleLoadingPromise.then((module) => {\n                        if (typeof module.default !== 'function') {\n                            const errorMessage = 'The module passed to useAsRscAdapter() ' +\n                                'as server component does not have a valid default export.';\n\n                            warn(errorMessage);\n                            setState('error');\n                            events.onError(new Error(errorMessage));\n                            return;\n                        }\n\n                        setState('success');\n                        setAssistantMessage(() => {\n                            return lazy(async () => {\n                                let resultFromServer: unknown = undefined;\n                                let rscExecutionOutput: unknown = undefined;\n                                try {\n                                    //\n                                    // ⭐️ This is where the RSC is executed\n                                    //\n                                    rscExecutionOutput = module.default(\n                                        { message, extras } satisfies StreamedServerComponentProps\n                                    );\n                                    resultFromServer = await Promise.resolve(rscExecutionOutput);\n                                } catch (_error) {\n                                    warn(\n                                        'An error occurred while rendering the React Server Component (RSC).\\n' +\n                                        'Please ensure that no server error has occurred.'\n                                    );\n\n                                    events.onError(new Error('Error while rendering RSC.'));\n                                }\n\n                                events.onServerComponentReceived();\n\n                                if (resultFromServer === undefined || !isValidElement(resultFromServer)) {\n                                    events.onError(\n                                        new Error(\n                                            'Unable to render RSC. The RSC adapter should return a valid React element.'\n                                        ),\n                                    );\n                                    return {default: () => <></>};\n                                } else {\n                                    return {default: () => <>{resultFromServer}</>};\n                                }\n                            });\n                        });\n                    }).catch((e) => {\n                        warn(\n                            'The module passed to useAsRscAdapter() is not a valid ES module, or did not properly ' +\n                            'load! The first parameter passed to useAsRscAdapter() should be the result of a ' +\n                            'dynamic import() call [ without await or .then() ]. The module should also have a ' +\n                            'default export. Your bundler should be able to handle dynamic imports and ES modules.' +\n                            '\\n\\nReference: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#dynamic_imports',\n                        );\n                        setState('error');\n                        events.onError(e);\n                    });\n                }, []);\n\n                if (state === 'idle') {\n                    return null;\n                }\n\n                if (state === 'loading') {\n                    return null;\n                }\n\n                if (state === 'error') {\n                    warn('Error loading RSC');\n                    return <>Error loading RSC</>;\n                }\n\n                return (\n                    <Suspense fallback={loader ? loader : null}>\n                        {AssistantMessage && <AssistantMessage/>}\n                    </Suspense>\n                );\n            };\n        },\n    };\n};\n","import {ContextItemDataType, ContextItemHandler} from '@nlux/core';\nimport {useContext, useEffect, useRef, useState} from 'react';\nimport {AiContext} from '../types/AiContext';\n\nexport type UpdateContextItem = (itemValue: ContextItemDataType) => void;\nexport type DiscardContextItem = () => void;\n\n/**\n * Use this hook to sync parts of the component state with the AI context.\n * It will create a new AI context item and will keep it in sync with the AI context.\n * When the state item changes, the itemValue will should be kept up to date.\n * When the component is unmounted, the context item will be discarded.\n *\n * @param {AiContext} aiContext The AI context instance to use, created with createAiContext()\n * @param {string} itemDescription The description of the item. This will be used by LLMs to understand context\n * @param {ContextItemDataType} itemValue The item value to be synced. Changing this value will update the AI context.\n *\n * Usage example:\n *\n * ```tsx\n * const MyComponent = () => {\n *    const [myStateItem, setMyStateItem] = useState('initial value');\n *    useAiContext(MyAiContext, 'Detailed description of my state item', myStateItem);\n *    return <div>...</div>;\n * };\n */\nexport const useAiContext = (\n    aiContext: AiContext,\n    itemDescription: string,\n    itemValue: ContextItemDataType,\n) => {\n    const result = useContext(aiContext.ref);\n    const [itemId] = useState(() => {\n        let itemUniqueId: string;\n        do {\n            itemUniqueId = Math.random().toString(36).substring(2, 15);\n        }\n        while (result.hasItem(itemUniqueId));\n\n        return itemUniqueId;\n    });\n\n    const observerRef = useRef<ContextItemHandler | undefined>();\n\n    // IMPORTANT: Discard when component is unmounted\n    useEffect(() => {\n        observerRef.current = result.observeState(\n            itemId,\n            itemDescription,\n            itemValue,\n        );\n\n        return () => {\n            observerRef.current?.discard();\n            observerRef.current = undefined;\n        };\n    }, []);\n\n    useEffect(() => {\n        observerRef.current?.setDescription(itemDescription);\n    }, [itemDescription]);\n\n    useEffect(() => {\n        observerRef.current?.setData(itemValue);\n    }, [itemValue]);\n};\n","import {ContextTaskHandler} from '@nlux/core';\nimport {CallbackFunction} from '@shared/types/callbackFunction';\nimport {useContext, useEffect, useRef, useState} from 'react';\nimport {AiContext} from '../types/AiContext';\n\n/**\n * Use this hook to register a new task that can be trigger by the AI during <AiChat /> conversations.\n * It will create a new AI context task and will keep it in sync with the AI context.\n * The description is used by LLMs to understand the purpose of the task.\n * The callback is the function that will be called when the task is triggered.\n * The parametersDescription is used by LLMs to determine the value of each parameter to be passed to the task.\n *\n * @param {AiContext} aiContext The AI context instance to use, created with createAiContext()\n * @param {string} taskDescription The description of the task. This will be used by LLMs to understand context.\n * @param {Function} callback The function to be called when the task is triggered.\n * @param {string[]} parametersDescription An array of descriptions for each parameter of the task.\n *\n * Usage example:\n *\n * ```tsx\n * const MyComponent = () => {\n *   const taskCallback = useCallback((param1, param2) => {\n *     // Do something with the parameters\n *   }, []);\n *\n *   useAiTask(\n *      MyAiContext, 'Description of the task',\n *      taskCallback, ['Description of the first parameter', 'Description of the second parameter']\n *    );\n *\n *   return <div>...</div>;\n * };\n * ```\n */\nexport const useAiTask = (\n    aiContext: AiContext, taskDescription: string, callback: CallbackFunction, parametersDescription?: string[],\n) => {\n    const coreAiContext = useContext(aiContext.ref);\n    const [taskId] = useState(() => {\n        let itemUniqueId: string;\n        do {\n            itemUniqueId = Math.random().toString(36).substring(2, 15);\n        }\n        while (coreAiContext.hasTask(itemUniqueId));\n\n        return itemUniqueId;\n    });\n\n    const observerRef = useRef<ContextTaskHandler | undefined>();\n\n    useEffect(() => {\n        observerRef.current = coreAiContext.registerTask(\n            taskId,\n            taskDescription,\n            callback,\n            parametersDescription,\n        );\n\n        return () => {\n            observerRef.current?.discard();\n            observerRef.current = undefined;\n        };\n    }, []);\n\n    useEffect(() => {\n        observerRef.current?.setDescription(taskDescription);\n    }, [taskDescription]);\n\n    useEffect(() => {\n        observerRef.current?.setCallback(callback);\n    }, [callback]);\n\n    useEffect(() => {\n        observerRef.current?.setParamDescriptions(parametersDescription ?? []);\n    }, [parametersDescription]);\n};\n","import {\n    AiContext as CoreAiContext,\n    ContextAdapter,\n    ContextAdapterBuilder,\n    createAiContext as createCoreAiContext,\n    InitializeContextResult,\n    predefinedContextSize,\n} from '@nlux/core';\nimport {createContext, useEffect, useState} from 'react';\nimport {AiContext, AiContextProviderProps} from '../types/AiContext';\n\n/**\n * Creates a new AI context with a React context provider that can be used to sync application state\n * with the backend for AI processing.\n *\n * The input is a context adapter that handles the communication with the backend. nlux provides several\n * context adapters out of the box, but developers can also create their own adapters by implementing the\n * ContextAdapter interface.\n *\n * Usage:\n *\n * At the root level of the application, create the AI context and wrap the app with the context provider:\n * ```tsx\n * const MyAiContext = createAiContext(contextAdapter);\n *\n * const App = () => (\n *   <MyAiContext.Provider>\n *     <MyApp/>\n *   </MyAiContext.Provider>\n * );\n * ```\n *\n * Then, in any component that needs to access the AI context, use the context reference:\n *\n * ```tsx\n * useAiContext(MyAiContext, 'Description of the data', dataToSync);\n * useAiTask(MyAiContext, 'Description of the task', callbackFunction, ['Description of the parameters']);\n * ```\n *\n * @param {ContextAdapter | ContextAdapterBuilder} adapter\n * @returns {AiContext}\n */\nexport const createAiContext = (adapter: ContextAdapter | ContextAdapterBuilder): AiContext => {\n\n    // The const name below starts with 'unused' because its only purpose is to create the adapter,\n    // As soon as the React context is rendered (via the context.Provider component return below),\n    // a new coreAiContext instance is created used with that adapter.\n    const unusedAiContext = createCoreAiContext();\n    const ReactContext = createContext<CoreAiContext>(unusedAiContext);\n\n    return {\n        // React component that provides the AI context to the children\n        // To be used as <aiContextInstance.Provider> context aware app .. </aiContextInstance.Provider>\n        Provider: (props: AiContextProviderProps) => {\n            //\n            // Provider\n            //\n            const [\n                contextId,\n                setContextId,\n            ] = useState<string | undefined>();\n\n            const [\n                contextInitError,\n                setContextInitError,\n            ] = useState<Error | undefined>();\n\n            const [\n                coreAiContext,\n                setCoreAiContext,\n            ] = useState<CoreAiContext>();\n\n            //\n            // Initialize the AI context and get the contextId\n            //\n            useEffect(() => {\n                let usableContext = true;\n                const newContext = createCoreAiContext()\n                    .withAdapter(adapter)\n                    .withDataSyncOptions({\n                        syncStrategy: 'auto',\n                        contextSize: predefinedContextSize['100k'],\n                    });\n\n                setCoreAiContext(newContext);\n\n                newContext\n                    .initialize(props.initialItems || {})\n                    .then((result: InitializeContextResult) => {\n                        if (!usableContext) {\n                            return;\n                        }\n\n                        if (result.success) {\n                            setContextId(result.contextId);\n                        } else {\n                            setContextInitError(new Error(result.error));\n                        }\n                    });\n\n                return () => {\n                    usableContext = false;\n                    newContext.destroy();\n                };\n            }, []);\n\n            const {children} = props;\n\n            if (contextInitError) {\n                if (props.errorComponent) {\n                    return <props.errorComponent error={contextInitError.message}/>;\n                }\n\n                return (\n                    <div>\n                        <h1>Error initializing AI context</h1>\n                        <p>{contextInitError.message}</p>\n                    </div>\n                );\n            }\n\n            if (!contextId || !coreAiContext) {\n                if (props.loadingComponent) {\n                    return <props.loadingComponent/>;\n                }\n\n                return null;\n            }\n\n            return (\n                <ReactContext.Provider value={coreAiContext}>\n                    {children}\n                </ReactContext.Provider>\n            );\n        },\n        ref: ReactContext,\n    };\n};\n","import useDeepCompareEffectHook from './hooks/useDeepCompareEffect';\n\n// Exporting from — @nlux/core\n\nexport type {\n    DisplayOptions,\n    ComposerOptions,\n    ConversationLayout,\n    HistoryPayloadSize,\n    HighlighterExtension,\n    AiChatPropsInEvents,\n    UpdatableAiChatProps,\n} from '@nlux/core';\n\nexport type {\n    EventName,\n    EventCallback,\n    EventsConfig,\n    ErrorCallback,\n    ErrorEventDetails,\n    ReadyCallback,\n    ReadyEventDetails,\n    PreDestroyCallback,\n    PreDestroyEventDetails,\n    MessageSentCallback,\n    MessageSentEventDetails,\n    MessageStreamStartedCallback,\n    MessageStreamStartedEventDetails,\n    MessageReceivedCallback,\n    MessageReceivedEventDetails,\n    MessageRenderedCallback,\n    MessageRenderedEventDetails,\n    IObserver,\n} from '@nlux/core';\n\n// Exporting from — shared\n\nexport type {\n    ChatItem,\n} from '@shared/types/conversation';\n\nexport type {\n    SanitizerExtension,\n} from '@shared/sanitizer/sanitizer';\n\nexport type {\n    StreamingAdapterObserver,\n    DataTransferMode,\n    StreamSend,\n    BatchSend,\n} from '@shared/types/adapters/chat/chatAdapter';\n\nexport type {\n    ChatAdapterBuilder,\n} from '@shared/types/adapters/chat/chatAdapterBuilder';\n\nexport type {\n    ChatAdapterExtras,\n} from '@shared/types/adapters/chat/chatAdapterExtras';\n\nexport type {\n    StandardChatAdapter,\n} from '@shared/types/adapters/chat/standardChatAdapter';\n\nexport type {\n    StandardAdapterInfo,\n} from '@shared/types/adapters/chat/standardAdapterConfig';\n\nexport type {\n    StreamedServerComponent,\n    StreamedServerComponentProps,\n} from '@shared/types/adapters/chat/serverComponentChatAdapter';\n\n// Exporting from — @nlux/react\n\nexport type {\n    PersonaOptions,\n    AssistantPersona,\n    UserPersona,\n} from './exports/personaOptions';\n\nexport type {\n    AiChatProps,\n} from './exports/props';\n\nexport type {\n    ChatAdapter,\n} from './types/chatAdapter';\n\nexport type {\n    ConversationOptions,\n} from './types/conversationOptions';\n\nexport type {\n    AiChatApi,\n} from './exports/hooks/useAiChatApi';\n\nexport type {\n    MessageOptions,\n    ResponseRenderer,\n    ResponseRendererProps,\n    PromptRenderer,\n    PromptRendererProps,\n} from './exports/messageOptions';\n\nexport type {\n    ConversationStarter,\n} from './types/conversationStarter';\n\nexport {\n    AiChat,\n} from './exports/AiChat';\n\nexport {\n    useAiChatApi,\n} from './exports/hooks/useAiChatApi';\n\nexport {\n    Markdown,\n} from './exports/primitives/Markdown';\n\nexport type {\n    AiChatUIOverrides,\n} from './exports/AiChatUI';\n\nexport {\n    AiChatUI,\n} from './exports/AiChatUI';\n\nexport {\n    useAsBatchAdapter,\n} from './exports/hooks/useAsBatchAdapter';\n\nexport {\n    useAsStreamAdapter,\n} from './exports/hooks/useAsStreamAdapter';\n\nexport {\n    useAsRscAdapter,\n} from './exports/hooks/useAsRscAdapter';\n\nexport type {\n    UpdateContextItem,\n    DiscardContextItem,\n} from './providers/useAiContext';\n\nexport {\n    useAiContext,\n} from './providers/useAiContext';\n\nexport {\n    useAiTask,\n} from './providers/useAiTask';\n\nexport type {\n    AiContext,\n    AiContextProviderProps,\n} from './types/AiContext';\n\nexport {\n    createAiContext,\n} from './providers/createAiContext';\n\nexport const useDeepCompareEffect = useDeepCompareEffectHook;\n"],"names":["useRef","deepEqual","useMemo","useDeepCompareEffect","useEffect","className","statusClassName","jsx","compCancelIconClassName","compSendIconClassName","compComposerStatusClassName","compComposerClassName","jsxs","directionClassName","__publicField","escape","text","args","ret","tokens","src","options","newHtml","useState","useImperativeHandle","compMessageDirectionClassName","compMessageStatusClassName","compMessageClassName","useCallback","Component","props","isValidElement","compAvatarClassName","compAvatarPhotoContainerClassName","compAvatarPhotoClassName","forwardRef","compChatItemDirectionClassName","compChatItemClassName","ref","createRef","compGreetingClassName","compGreetingPersonaNameClassName","compGreetingTextClassName","Fragment","newConversationContainer","autoScroll","createContext","compLoaderClassName","prompt","compExceptionsBoxClassName","useContext","lazy","Suspense","createCoreAiContext","predefinedContextSize","useDeepCompareEffectHook"],"mappings":"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"}