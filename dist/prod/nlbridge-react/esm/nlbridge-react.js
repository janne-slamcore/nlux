import{createChatAdapter as e}from"@nlux/nlbridge";export{createChatAdapter,createContextAdapter}from"@nlux/nlbridge";import{useState as t,useEffect as r,useContext as o}from"react";const n=t=>{const{url:r,mode:o,context:n,headers:i}=t||{};if(o&&"copilot"!==o&&"chat"!==o)throw new Error("Data transfer mode not supported");if(!r)throw new Error("Runnable URL is required");let d=e().withUrl(r);return o&&(d=d.withMode(o)),n&&(d=d.withContext(n)),i&&(d=d.withHeaders(i)),d.create()},i=e=>{const{context:i,url:d,mode:c,headers:s}=e,[a,l]=t(s);r(()=>{if(s||!a)if(!s||a){if(s&&a){if(Object.keys(s).length!==Object.keys(a).length)return void l(s);for(const e in s)if(s[e]!==a[e])return void l(s)}}else l(s);else l(void 0)},[s]);const f=i?.ref?o(i.ref):void 0,[h,u]=t(n({url:d,mode:c,context:f,headers:s}));return r(()=>{const e=n({url:d,mode:c,headers:a,context:f});u(e)},[d,c,a,f]),h};export{i as useChatAdapter};
